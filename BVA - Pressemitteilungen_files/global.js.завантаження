  // Init log level
  var gsb_loglevel = 'error';
   /* Start logging */
   /*!
 * GSB-Plugin zur Bereitstellung von globalen Logging-Methoden
 * Benoetigt Variable "gsb_loglevel" aus global.js, ueberschreibbar durch Konfigurationseintrag "/standardlsg/SiteGlobals/_config/JSLogWarnlevel"
 *
 * Author: rkrusenb
 * --GSBDocStart
 * @module logging
 * @version 1.1.3
 * @see {@link http://semver.org|Semantic Versioning}
 * @author rkrusenb
 *
 * @desc GSB-Plugin zur Bereitstellung von globalen Logging-Methoden
 *  Benoetigt Variable "gsb_loglevel" aus global.js, ueberschreibbar durch Konfigurationseintrag "/standardlsg/SiteGlobals/_config/JSLogWarnlevel"
 *--GSBDocEnd
 */
;var gsb;gsb=gsb||{};(function(namespace){var loglevels={debug:8,log:4,warn:2,error:1,none:0};var loglevel=gsb_loglevel;var hiddenMessages=[];var env,deferred;function consoleExists(method){if(!method){return typeof console!=="undefined";}else{return typeof console!=="undefined"&&typeof console[method]==="function";}}function wrap(method){return function(){hiddenMessages.push([method,arguments]);};}function flushHiddenMessages(){var i,l,temp,method,args;if(consoleExists()){for(i=0,l=hiddenMessages.length;i<l;i++){temp=hiddenMessages[i];method=temp[0];args=temp[1];if(consoleExists(method)){hiddenMessages[i]=null;env[method].apply(null,args);}}hiddenMessages=hiddenMessages.filter(function(value){return value!==null;});}}function setLogLevel(newLevel){loglevel=newLevel;["error","warn","log","debug"].forEach(function(str){if(loglevels[str]===loglevels.error){if(loglevels[newLevel]>=loglevels.error&&consoleExists("error")){namespace.error=env.error;}else{namespace.error=deferred.error;}}else{if(loglevels[str]===loglevels.warn){if(loglevels[newLevel]>=loglevels.warn&&consoleExists("warn")){namespace.warn=env.warn;}else{namespace.warn=deferred.warn;}}else{if(loglevels[str]===loglevels.log){if(loglevels[newLevel]>=loglevels.log&&consoleExists("log")){namespace[str]=env.log;}else{namespace[str]=deferred.log;}}else{if(loglevels[newLevel]>=loglevels.debug&&consoleExists("debug")){namespace[str]=env.debug;}else{namespace[str]=deferred.debug;}}}}});}env={debug:console.debug.bind(console),log:console.log.bind(console),warn:console.warn.bind(console),error:console.error.bind(console)};deferred={debug:wrap("debug"),log:wrap("log"),warn:wrap("warn"),error:wrap("error")};setLogLevel(loglevel);try{if(typeof localStorage!=="undefined"&&typeof localStorage.getItem==="function"&&localStorage.getItem("gsb_frontend_loglevel")){setLogLevel(localStorage.getItem("gsb_frontend_loglevel"));}}catch(e){console.debug("Auslesen des Loglevels aus dem localStorage nicht möglich.");}namespace.flushHiddenMessages=flushHiddenMessages;})(gsb);
   /* Ende logging */
   /* Start variables_LABELS */
       var PRINT_PAGE_TEXT = 'drucken';
    var PRINT_TOOLTIP = 'Seite drucken (öffnet Dialog)';
    var TWOCLICKSHARE_TITLE = 'Inhalte teilen';
    var TWOCLICKSHARE_FORMLINKTEXT = 'Freunden per E-Mail schicken';
    var NAV_MOBILE_MENU = 'Menü';
    var NAV_MOBILE_SEARCH = 'Suchen';
    var SHOW_LESS = 'Weniger anzeigen';
    var SHOW_MORE = 'Erfahren Sie mehr';
    var CLOSE = 'Schliessen';
    var NEXT = 'Nächste Seite';
    var BACK = 'Vorherige Seite';
    var NEXT_INACTIVE = 'Keine nächste Seite';
    var BACK_INACTIVE = 'Keine vorherige Seite';
    var PLAY = 'Animation starten';
    var PAUSE = 'Animation stoppen';
    var PAGE = 'Seite';
    var BITTE_AUSWAHL = 'bitte auswählen...';
    var AUTOSUGGEST_USER_DEFINED_SUGGESTIONS_HEADLINE = 'Verwandte Suchbegriffe';
    var AUTOSUGGEST_FULLTEXT_SUGGESTIONS_HEADLINE = 'Volltext';
    var TEXTAREA_COUNT_PREFIX = 'Verbleibende Zeichen:&nbsp;';
    var TEXTAREA_COUNT_POSTFIX = '';
    var MAP_TAB_LABEL = 'Kartenansicht';
    var MAP_FILTER_LIST_AURAL = 'Es folgt eine Liste aus Schaltern welche die Anzeige von Markierungen innerhalb der Karte steuert';
    var MAP_ZOOM_IN_BUTTON_TITLE = 'Reinzoomen';
    var MAP_ZOOM_OUT_BUTTON_TITLE = 'Rauszoomen';
    var MAP_FULLSCREEN_BUTTON_TITLE = 'Vollbild umschalten';
    var TRACKING_OBLIGATORY = 'Technisch notwendig (nicht abwählbar)';
    var TRACKING_OPTIONAL = 'Statistik';
    var TRACKING_CONFIRM = 'Auswahl bestätigen';
    var SHARIFF_MAIL_SUBJECT = 'Empfehlung einer Seite von www.bva.bund.de';
    var SHARIFF_MAIL_BODY = 'Dieser Link wurde Ihnen empfohlen:\n\n{url}\n\n---------------------------------------------------------------------------------------------\nHinweis: Dieser Artikel und ggf. die Mitteilung des Absenders wurde Ihnen über die Website www.bva.bund.de zugeschickt.\nDas Bundesverwaltungsamt als Betreiber dieser Webseite übernimmt keine Verantwortung für den Inhalt dieser Mitteilung. Die Korrektheit des angegebenen Namens und/oder der angegebenen E-Mail Adresse des Absenders kann nicht garantiert werden';
    var MSG_ANSPRECHPARTNER_AJAX_ERROR = 'Beim Laden der Ansprechpartner ist ein Fehler aufgetreten';
    var MSG_ANSPRECHPARTNER_AJAX_LOADING = 'Lade Ansprechpartner';
   /* Ende variables_LABELS */
   /* Start variables_JSON */
         var json_url_mobileMenu = 'SiteGlobals/Modules/MobileNavigation/DE/Allgemein/MobileNavigation.html?view=renderMobileNavigation';
      var json_url_navPrimary = 'SiteGlobals/Functions/Navigation/Navigation.html?view=renderNavigation';
      var json_url_largeFlyoutTemplate = 'SiteGlobals/Functions/Navigation/largeFlyout_mstTpl.html?view=render';
      var json_url_smallFlyoutTemplate = 'SiteGlobals/Functions/Navigation/smallFlyout_mstTpl.html?view=render';
      var json_url_moreButtonURL = 'SiteGlobals/Functions/xhr/more_button.html?view=render';
      var json_url_jobofferLink = 'DE/Home/home_node.html?view=renderJSON';
      var json_url_shariffInfo = 'DE/Service/Datenschutz/datenschutz_node.html';
   /* Ende variables_JSON */
   /* Start variables_IMG */
       var image_url_close = '/SiteGlobals/Frontend/Images/icons/close-b.svg?__blob=normal&amp;v=2';
    var image_url_close_b = '/SiteGlobals/Frontend/Images/icons/close-b.svg?__blob=normal&amp;v=2';
    var image_url_next = '<svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"   width="70px" height="70px" viewBox="0 0 70 70" style="enable-background:new 0 0 70 70;" xml:space="preserve"> <style type="text/css">  .st0{fill:#99C6D4;}  .st1{fill:#00607E;} </style> <desc>Created with Sketch.</desc> <g id="_x2A__x2A__x2A_Symbols_x2A__x2A__x2A_">  <g id="lightbox_pfeil_rechts">   <g id="left" transform="translate(35.000000, 35.000000) rotate(-180.000000) translate(-35.000000, -35.000000) ">    <circle id="Oval-4-Copy-3" class="st0" cx="35" cy="35" r="35"/>         <g id="akkordeon_down-copy-5" transform="translate(35.000000, 35.000000) rotate(-270.000000) translate(-35.000000, -35.000000) translate(21.000000, 29.000000)">     <polygon class="st1" points="0.5,0.3 3.5,-2.3 14,9.9 24.5,-2.3 27.5,0.3 14,16.1     "/>    </g>   </g>  </g> </g> </svg>';
    var image_url_back = '<svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"   width="70px" height="70px" viewBox="0 0 70 70" style="enable-background:new 0 0 70 70;" xml:space="preserve"> <style type="text/css">  .st0{fill:#99C6D4;}  .st1{fill:#00607E;} </style> <desc>Created with Sketch.</desc> <g id="_x2A__x2A__x2A_Symbols_x2A__x2A__x2A_">  <g id="lightbox_pfeil_links">   <g id="left">    <circle id="Oval-4-Copy-3" class="st0" cx="35" cy="35" r="35"/>         <g id="akkordeon_down-copy-5" transform="translate(35.000000, 35.000000) rotate(-270.000000) translate(-35.000000, -35.000000) translate(21.000000, 29.000000)">     <polygon class="st1" points="27.5,0.3 14,16.1 0.5,0.3 3.5,-2.3 14,9.9 24.5,-2.3     "/>    </g>   </g>  </g> </g> </svg>';
    var image_url_back_g = '<svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"   width="70px" height="70px" viewBox="0 0 70 70" style="enable-background:new 0 0 70 70;" xml:space="preserve"> <style type="text/css">  .st0{fill:#F1F0ED;}  .st1{fill:#007194;} </style> <desc>Created with Sketch.</desc> <g id="_x2A__x2A__x2A_Symbols_x2A__x2A__x2A_">  <g id="lightbox_pfeil_links">   <g id="left">    <circle id="Oval-4-Copy-3" class="st0" cx="35" cy="35" r="35"/>         <g id="akkordeon_down-copy-5" transform="translate(35.000000, 35.000000) rotate(-270.000000) translate(-35.000000, -35.000000) translate(21.000000, 29.000000)">     <polygon class="st1" points="27.5,0.3 14,16.1 0.5,0.3 3.5,-2.3 14,9.9 24.5,-2.3     "/>    </g>   </g>  </g> </g> </svg>';
    var image_url_next_g = '<svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"   width="70px" height="70px" viewBox="0 0 70 70" style="enable-background:new 0 0 70 70;" xml:space="preserve"> <style type="text/css">  .st0{fill:#99C6D4;}  .st1{fill:#FFFFFF;} </style> <desc>Created with Sketch.</desc> <g id="_x2A__x2A__x2A_Symbols_x2A__x2A__x2A_">  <g id="lightbox_pfeil_rechts">   <g id="left" transform="translate(35.000000, 35.000000) rotate(-180.000000) translate(-35.000000, -35.000000) ">    <circle id="Oval-4-Copy-3" class="st0" cx="35" cy="35" r="35"/>         <g id="akkordeon_down-copy-5" transform="translate(35.000000, 35.000000) rotate(-270.000000) translate(-35.000000, -35.000000) translate(21.000000, 29.000000)">     <polygon class="st1" points="0.5,0.3 3.5,-2.3 14,9.9 24.5,-2.3 27.5,0.3 14,16.1     "/>    </g>   </g>  </g> </g> </svg>';
    var image_url_close_w = '/SiteGlobals/Frontend/Images/icons/close-w.svg?__blob=normal&amp;v=2';
    var image_url_loupe_b = '/SiteGlobals/Frontend/Images/icons/loupe-b.svg?__blob=normal&amp;v=2';
    var image_url_paused = '/SiteGlobals/Frontend/Images/icons/pause.svg?__blob=normal&amp;v=2';
    var image_url_play = '/SiteGlobals/Frontend/Images/icons/play.svg?__blob=normal&amp;v=2';
    var image_url_share_facebook_inactive = '/SiteGlobals/Frontend/Images/icons/socialshareprivacy/share_facebook_inactive.png.png?__blob=normal&amp;v=2';
    var image_url_share_twitter_inactive = '/SiteGlobals/Frontend/Images/icons/socialshareprivacy/share_twitter_inactive.png?__blob=normal&amp;v=2';
    var image_url_share_gplus_inactive = '/SiteGlobals/Frontend/Images/icons/socialshareprivacy/share_gplus_inactive.png?__blob=normal&amp;v=2';
    var image_url_gmaps_marker = '/SiteGlobals/Frontend/Images/icons/marker.svg?__blob=normal&amp;v=2';
    var image_url_zoom_in = '/SiteGlobals/Frontend/Images/icons/isb/map-zoom-in.svg?__blob=normal&amp;v=2';
    var image_url_zoom_out = '/SiteGlobals/Frontend/Images/icons/isb/map-zoom-out.svg?__blob=normal&amp;v=2';
    var image_url_open_fullscreen = '/SiteGlobals/Frontend/Images/icons/isb/map-fullscreen.svg?__blob=normal&amp;v=2';
    var image_url_close_fullscreen = '/SiteGlobals/Frontend/Images/icons/isb/map-close.svg?__blob=normal&amp;v=2';
    var image_url_marker = '/SiteGlobals/Frontend/Images/icons/isb/marker.svg?__blob=normal&amp;v=2';
   /* Ende variables_IMG */
   /* Start docLibs */
   /**
 * @external jQuery
 * @version 1.11.1
 * @see https://api.jquery.com/
 * @desc jQuery ist eine freie Bibliothek, welche Funktionen zur DOM-Navigation und -Manipulation zur Verfügung stellt
 *
 */

/**
 * @external jQueryUI
 * @version 1.11.4
 * @see https://api.jqueryui.com/
 * @desc jQuery UI ist eine Erweiterung der jQuery Bibliothek und bietet Lösungen zur Gestaltung und Funktionalität der Benutzeroberfläche an
 */

/**
 * @external mustache
 * @version 0.8.1
 * @see https://github.com/janl/mustache.js/tree/0.8.1
 * @desc Template-Engine Bibliothek, welche es ermöglicht Template-Dateien nachzuladen (optional) und deren Platzhalter durch Werte zu ersetzen
 */

/**
 * @external autolinker
 * @version 0.11.0
 * @see https://github.com/gregjacobs/Autolinker.js/tree/0.11.0
 */

/**
 * @external jQuery Cookie
 * @version 1.4.1
 * @see  https://github.com/carhartl/jquery-cookie/tree/v1.4.1
 */

/**
 * @external foundation
 * @version 5.4.2
 * @see http://foundation.zurb.com/docs/
 */

/**
 * @external hammerjs
 * @version 2.0.2
 * @see https://github.com/hammerjs/hammer.js/tree/2.0.2
 */

/**
 * @external jquery-hammerjs
 * @version 2.0.0
 * @see https://github.com/hammerjs/jquery.hammer.js/tree/2.0.0
 */

/**
 * @external magnific-popup
 * @version 0.9.9
 * @see http://dimsemenov.com/plugins/magnific-popup/documentation.html
 */

/**
 * @external mediaelementjs
 * @version 2.15.1
 * @see https://github.com/johndyer/mediaelement/tree/2.15.1
 */

/**
 * @external mmenu
 * @version 4.4.0
 * @see http://mmenu.frebsite.nl/documentation/options/
 */

/**
 * @external mmenu-searchfield
 * @version x.x.x
 * @see http://mmenu.frebsite.nl/documentation/addons/searchfield.html
 */

/**
 * @external modernizr
 * @version 2.6.2
 * @see https://modernizr.com/docs
 */

/**
 * @external moment
 * @version 2.7.0
 * @see http://momentjs.com/docs/
 */

/**
 * @external slick
 * @version 1.3.15
 * @see https://github.com/kenwheeler/slick/tree/1.3.15
 */

/**
 * @external socialshareprivacy
 * @version 1.4.1
 * @see http://www.heise.de/extras/socialshareprivacy/
 */
   /* Ende docLibs */
   /* Start jquery */
   /*!
 * --GSBDocStart
 * @module jQuery JavaScript Library
 * @version 1.11.1
 * @see {@link (http://jquery.com/)}
 * @author jQuery Foundation, Inc. and other contributors
 * @license JS Foundation
 * 
 * @desc Einbettung der jQuery Library
 *--GSBDocEnd
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 
 * Released under the MIT license
 * http://jquery.org/license
 */
(function(global,factory){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document");}return factory(w);};}else{factory(global);}}(typeof window!=="undefined"?window:this,function(window,noGlobal){var deletedIds=[];var slice=deletedIds.slice;var concat=deletedIds.concat;var push=deletedIds.push;var indexOf=deletedIds.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var support={};var version="1.11.1",jQuery=function(selector,context){return new jQuery.fn.init(selector,context);},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase();};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this);},get:function(num){return num!=null?(num<0?this[num+this.length]:this[num]):slice.call(this);},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret;},each:function(callback,args){return jQuery.each(this,callback,args);},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},slice:function(){return this.pushStack(slice.apply(this,arguments));},first:function(){return this.eq(0);},last:function(){return this.eq(-1);},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[]);},end:function(){return this.prevObject||this.constructor(null);},push:push,sort:deletedIds.sort,splice:deletedIds.splice};jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++;}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={};}if(i===length){target=this;i--;}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue;}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[];}else{clone=src&&jQuery.isPlainObject(src)?src:{};}target[name]=jQuery.extend(deep,clone,copy);}else{if(copy!==undefined){target[name]=copy;}}}}}return target;};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg);},noop:function(){},isFunction:function(obj){return jQuery.type(obj)==="function";},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array";},isWindow:function(obj){return obj!=null&&obj==obj.window;},isNumeric:function(obj){return !jQuery.isArray(obj)&&obj-parseFloat(obj)>=0;},isEmptyObject:function(obj){var name;for(name in obj){return false;}return true;},isPlainObject:function(obj){var key;if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false;}try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false;}}catch(e){return false;}if(support.ownLast){for(key in obj){return hasOwn.call(obj,key);}}for(key in obj){}return key===undefined||hasOwn.call(obj,key);},type:function(obj){if(obj==null){return obj+"";}return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj;},globalEval:function(data){if(data&&jQuery.trim(data)){(window.execScript||function(data){window["eval"].call(window,data);})(data);}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase);},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase();},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break;}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break;}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break;}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break;}}}}return obj;},trim:function(text){return text==null?"":(text+"").replace(rtrim,"");},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr);}else{push.call(ret,arr);}}return ret;},inArray:function(elem,arr,i){var len;if(arr){if(indexOf){return indexOf.call(arr,elem,i);}len=arr.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in arr&&arr[i]===elem){return i;}}}return -1;},merge:function(first,second){var len=+second.length,j=0,i=first.length;while(j<len){first[i++]=second[j++];}if(len!==len){while(second[j]!==undefined){first[i++]=second[j++];}}first.length=i;return first;},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i]);}}return matches;},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}return concat.apply([],ret);},guid:1,proxy:function(fn,context){var args,proxy,tmp;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp;}if(!jQuery.isFunction(fn)){return undefined;}args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)));};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy;},now:function(){return +(new Date());},support:support});jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase();});function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);if(type==="function"||jQuery.isWindow(obj)){return false;}if(obj.nodeType===1&&length){return true;}return type==="array"||length===0||typeof length==="number"&&length>0&&(length-1) in obj;}var Sizzle=
/*!
 * Sizzle CSS Selector Engine v1.10.19
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-04-18
 */
(function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-(new Date()),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true;}return 0;},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i;}}return -1;},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={"ID":new RegExp("^#("+characterEncoding+")"),"CLASS":new RegExp("^\\.("+characterEncoding+")"),"TAG":new RegExp("^("+characterEncoding.replace("w","w*")+")"),"ATTR":new RegExp("^"+attributes),"PSEUDO":new RegExp("^"+pseudos),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),"bool":new RegExp("^(?:"+booleans+")$","i"),"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320);};try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType;}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els));}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}target.length=j-1;}};}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context);}context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results;}if((nodeType=context.nodeType)!==1&&nodeType!==9){return[];}if(documentIsHTML&&!seed){if((match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results;}}else{return results;}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results;}}}else{if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results;}else{if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results;}}}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if((old=context.getAttribute("id"))){nid=old.replace(rescape,"\\$&");}else{context.setAttribute("id",nid);}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i]);}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",");}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results;}catch(qsaError){}finally{if(!old){context.removeAttribute("id");}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed);}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()];}return(cache[key+" "]=value);}return cache;}function markFunction(fn){fn[expando]=true;return fn;}function assert(fn){var div=document.createElement("div");try{return !!fn(div);}catch(e){return false;}finally{if(div.parentNode){div.parentNode.removeChild(div);}div=null;}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler;}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff;}if(cur){while((cur=cur.nextSibling)){if(cur===b){return -1;}}}return a?1:-1;}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type;};}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type;};}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j]);}}});});}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context;}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false;};setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document;}document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",function(){setDocument();},false);}else{if(parent.attachEvent){parent.attachEvent("onunload",function(){setDocument();});}}}support.attributes=assert(function(div){div.className="i";return !div.getAttribute("className");});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return !div.getElementsByTagName("*").length;});support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2;});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return !doc.getElementsByName||!doc.getElementsByName(expando).length;});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[];}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId;};};}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId;};};}Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag);}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem);}}return tmp;}return results;};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className);}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(doc.querySelectorAll))){assert(function(div){div.innerHTML="<select msallowclip=''><option selected=''></option></select>";if(div.querySelectorAll("[msallowclip^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");}if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked");}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=");}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled");}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:");});}if((support.matchesSelector=rnative.test((matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos);});}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16));}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true;}}}return false;};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0;}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare;}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return -1;}if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1;}return sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0;}return compare&4?-1:1;}:function(a,b){if(a===b){hasDuplicate=true;return 0;}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0;}else{if(aup===bup){return siblingCheck(a,b);}}cur=a;while((cur=cur.parentNode)){ap.unshift(cur);}cur=b;while((cur=cur.parentNode)){bp.unshift(cur);}while(ap[i]===bp[i]){i++;}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0;};return doc;};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements);};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem);}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret;}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0;};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context);}return contains(context,elem);};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem);}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null;};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i);}}while(j--){results.splice(duplicates[j],1);}}sortInput=null;return results;};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while((node=elem[i++])){ret+=getText(node);}}else{if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent;}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem);}}}else{if(nodeType===3||nodeType===4){return elem.nodeValue;}}}return ret;};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" ";}return match.slice(0,4);},"CHILD":function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0]);}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd");}else{if(match[3]){Sizzle.error(match[0]);}}return match;},"PSEUDO":function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null;}if(match[3]){match[2]=match[4]||match[5]||"";}else{if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess);}}return match.slice(0,3);}},filter:{"TAG":function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true;}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;};},"CLASS":function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"");});},"ATTR":function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!=";}if(!operator){return true;}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false;};},"CHILD":function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return !!elem.parentNode;}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false;}}start=dir=type==="only"&&!start&&"nextSibling";}return true;}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break;}}}else{if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1];}else{while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff];}if(node===elem){break;}}}}}diff-=last;return diff===first||(diff%first===0&&diff/first>=0);}};},"PSEUDO":function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument);}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i]);}}):function(elem){return fn(elem,0,args);};}return fn;}},pseudos:{"not":markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem);}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return !results.pop();};}),"has":markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0;};}),"contains":markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1;};}),"lang":markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang);}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0;}}while((elem=elem.parentNode)&&elem.nodeType===1);return false;};}),"target":function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id;},"root":function(elem){return elem===docElem;},"focus":function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);},"enabled":function(elem){return elem.disabled===false;},"disabled":function(elem){return elem.disabled===true;},"checked":function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected);},"selected":function(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}return elem.selected===true;},"empty":function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false;}}return true;},"parent":function(elem){return !Expr.pseudos["empty"](elem);},"header":function(elem){return rheader.test(elem.nodeName);},"input":function(elem){return rinputs.test(elem.nodeName);},"button":function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button";},"text":function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text");},"first":createPositionalPseudo(function(){return[0];}),"last":createPositionalPseudo(function(matchIndexes,length){return[length-1];}),"eq":createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument];}),"even":createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i);}return matchIndexes;}),"odd":createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i);}return matchIndexes;}),"lt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i);}return matchIndexes;}),"gt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i);}return matchIndexes;})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in {radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i);}for(i in {submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i);}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0);}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar;}groups.push((tokens=[]));}matched=false;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length);}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length);}}if(!matched){break;}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0);};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value;}return selector;}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml);}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true;}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return(newCache[2]=oldCache[2]);}else{outerCache[dir]=newCache;if((newCache[2]=matcher(elem,context,xml))){return true;}}}}}};}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false;}}return true;}:matchers[0];}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results);}return results;}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i);}}}}return newUnmatched;}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter);}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector);}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml);}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem));}}postFinder(null,(matcherOut=[]),temp,xml);}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem);}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml);}else{push.apply(results,matcherOut);}}});}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext;},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1;},implicitRelative,true),matchers=[function(elem,context,xml){return(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)];}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break;}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens));}matchers.push(matcher);}}return elementMatcher(matchers);}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1),len=elems.length;if(outermost){outermostContext=context!==document&&context;}for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while((matcher=elementMatchers[j++])){if(matcher(elem,context,xml)){results.push(elem);break;}}if(outermost){dirruns=dirrunsUnique;}}if(bySet){if((elem=!matcher&&elem)){matchedCount--;}if(seed){unmatched.push(elem);}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml);}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results);}}}setMatched=condense(setMatched);}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results);}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup;}return unmatched;};return bySet?markFunction(superMatcher):superMatcher;}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector);}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached);}else{elementMatchers.push(cached);}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector;}return cached;};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize((selector=compiled.selector||selector));results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results;}else{if(compiled){context=context.parentNode;}}selector=selector.slice(tokens.shift().value.length);}i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break;}if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results;}break;}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results;};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1;});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#";})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2);}});}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")==="";})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue;}});}if(!assert(function(div){return div.getAttribute("disabled")==null;})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null;}});}return Sizzle;})(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=(/^<(\w+)\s*\/?>(?:<\/\1>|)$/);var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return !!qualifier.call(elem,i,elem)!==not;});}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not;});}if(typeof qualifier==="string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not);}qualifier=jQuery.filter(qualifier,elements);}return jQuery.grep(elements,function(elem){return(jQuery.inArray(elem,qualifier)>=0)!==not;});}jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")";}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1;}));};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true;}}}));}for(i=0;i<len;i++){jQuery.find(selector,self[i],ret);}ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret;},filter:function(selector){return this.pushStack(winnow(this,selector||[],false));},not:function(selector){return this.pushStack(winnow(this,selector||[],true));},is:function(selector){return !!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length;}});var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector){return this;}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null];}else{match=rquickExpr.exec(selector);}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match]);}else{this.attr(match,context[match]);}}}return this;}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector);}this.length=1;this[0]=elem;}this.context=document;this.selector=selector;return this;}}else{if(!context||context.jquery){return(context||rootjQuery).find(selector);}else{return this.constructor(context).find(selector);}}}else{if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this;}else{if(jQuery.isFunction(selector)){return typeof rootjQuery.ready!=="undefined"?rootjQuery.ready(selector):selector(jQuery);}}}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context;}return jQuery.makeArray(selector,this);};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.extend({dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur);}cur=cur[dir];}return matched;},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n);}}return r;}});jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++){if(jQuery.contains(this,targets[i])){return true;}}});},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break;}}}return this.pushStack(matched.length>1?jQuery.unique(matched):matched);},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1;}if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem));}return jQuery.inArray(elem.jquery?elem[0]:elem,this);},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))));},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));}});function sibling(cur,dir){do{cur=cur[dir];}while(cur&&cur.nodeType!==1);return cur;}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null;},parents:function(elem){return jQuery.dir(elem,"parentNode");},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until);},next:function(elem){return sibling(elem,"nextSibling");},prev:function(elem){return sibling(elem,"previousSibling");},nextAll:function(elem){return jQuery.dir(elem,"nextSibling");},prevAll:function(elem){return jQuery.dir(elem,"previousSibling");},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until);},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until);},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem);},children:function(elem){return jQuery.sibling(elem.firstChild);},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes);}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until;}if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret);}if(this.length>1){if(!guaranteedUnique[name]){ret=jQuery.unique(ret);}if(rparentsprev.test(name)){ret=ret.reverse();}}return this.pushStack(ret);};});var rnotwhite=(/\S+/g);var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=true;});return object;}jQuery.Callbacks=function(options){options=typeof options==="string"?(optionsCache[options]||createOptions(options)):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break;}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift());}}else{if(memory){list=[];}else{self.disable();}}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg);}}else{if(arg&&arg.length&&type!=="string"){add(arg);}}});})(arguments);if(firing){firingLength=list.length;}else{if(memory){firingStart=start;fire(memory);}}}return this;},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--;}if(index<=firingIndex){firingIndex--;}}}});}return this;},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length);},empty:function(){list=[];firingLength=0;return this;},disable:function(){list=stack=memory=undefined;return this;},disabled:function(){return !list;},lock:function(){stack=undefined;if(!memory){self.disable();}return this;},locked:function(){return !stack;},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args);}else{fire(args);}}return this;},fire:function(){self.fireWith(this,arguments);return this;},fired:function(){return !!fired;}};return self;};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state;},always:function(){deferred.done(arguments).fail(arguments);return this;},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify);}else{newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments);}});});fns=null;}).promise();},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise;}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString;},tuples[i^1][2].disable,tuples[2][2].lock);}deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this;};deferred[tuple[0]+"With"]=list.fireWith;});promise.promise(deferred);if(func){func.call(deferred,deferred);}return deferred;},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values);}else{if(!(--remaining)){deferred.resolveWith(contexts,values);}}};},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues));}else{--remaining;}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues);}return deferred.promise();}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this;};jQuery.extend({isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++;}else{jQuery.ready(true);}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return;}if(!document.body){return setTimeout(jQuery.ready);}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return;}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready");}}});function detach(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false);}else{document.detachEvent("onreadystatechange",completed);window.detachEvent("onload",completed);}}function completed(){if(document.addEventListener||event.type==="load"||document.readyState==="complete"){detach();jQuery.ready();}}jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready);}else{if(document.addEventListener){document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false);}else{document.attachEvent("onreadystatechange",completed);window.attachEvent("onload",completed);var top=false;try{top=window.frameElement==null&&document.documentElement;}catch(e){}if(top&&top.doScroll){(function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left");}catch(e){return setTimeout(doScrollCheck,50);}detach();jQuery.ready();}})();}}}}return readyList.promise(obj);};var strundefined=typeof undefined;var i;for(i in jQuery(support)){break;}support.ownLast=i!=="0";support.inlineBlockNeedsLayout=false;jQuery(function(){var val,div,body,container;body=document.getElementsByTagName("body")[0];if(!body||!body.style){return;}div=document.createElement("div");container=document.createElement("div");container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px";body.appendChild(container).appendChild(div);if(typeof div.style.zoom!==strundefined){div.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1";support.inlineBlockNeedsLayout=val=div.offsetWidth===3;if(val){body.style.zoom=1;}}body.removeChild(container);});(function(){var div=document.createElement("div");if(support.deleteExpando==null){support.deleteExpando=true;try{delete div.test;}catch(e){support.deleteExpando=false;}}div=null;})();jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;return nodeType!==1&&nodeType!==9?false:!noData||noData!==true&&elem.getAttribute("classid")===noData;};var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data;}catch(e){}jQuery.data(elem,key,data);}else{data=undefined;}}return data;}function isEmptyDataObject(obj){var name;for(name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue;}if(name!=="toJSON"){return false;}}return true;}function internalData(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return;}var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if((!id||!cache[id]||(!pvt&&!cache[id].data))&&data===undefined&&typeof name==="string"){return;}if(!id){if(isNode){id=elem[internalKey]=deletedIds.pop()||jQuery.guid++;}else{id=internalKey;}}if(!cache[id]){cache[id]=isNode?{}:{toJSON:jQuery.noop};}if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name);}else{cache[id].data=jQuery.extend(cache[id].data,name);}}thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={};}thisCache=thisCache.data;}if(data!==undefined){thisCache[jQuery.camelCase(name)]=data;}if(typeof name==="string"){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)];}}else{ret=thisCache;}return ret;}function internalRemoveData(elem,name,pvt){if(!jQuery.acceptData(elem)){return;}var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return;}if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name];}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name];}else{name=name.split(" ");}}}else{name=name.concat(jQuery.map(name,jQuery.camelCase));}i=name.length;while(i--){delete thisCache[name[i]];}if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache)){return;}}}if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return;}}if(isNode){jQuery.cleanData([elem],true);}else{if(support.deleteExpando||cache!=cache.window){delete cache[id];}else{cache[id]=null;}}}jQuery.extend({cache:{},noData:{"applet ":true,"embed ":true,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return !!elem&&!isEmptyDataObject(elem);},data:function(elem,name,data){return internalData(elem,name,data);},removeData:function(elem,name){return internalRemoveData(elem,name);},_data:function(elem,name,data){return internalData(elem,name,data,true);},_removeData:function(elem,name){return internalRemoveData(elem,name,true);}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=jQuery.data(elem);if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name]);}}}jQuery._data(elem,"parsedAttrs",true);}}return data;}if(typeof key==="object"){return this.each(function(){jQuery.data(this,key);});}return arguments.length>1?this.each(function(){jQuery.data(this,key,value);}):elem?dataAttr(elem,key,jQuery.data(elem,key)):undefined;},removeData:function(key){return this.each(function(){jQuery.removeData(this,key);});}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=jQuery._data(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=jQuery._data(elem,type,jQuery.makeArray(data));}else{queue.push(data);}}return queue||[];}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type);};if(fn==="inprogress"){fn=queue.shift();startLength--;}if(fn){if(type==="fx"){queue.unshift("inprogress");}delete hooks.stop;fn.call(elem,next,hooks);}if(!startLength&&hooks){hooks.empty.fire();}},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue");jQuery._removeData(elem,key);})});}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--;}if(arguments.length<setter){return jQuery.queue(this[0],type);}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type);}});},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type);});},clearQueue:function(type){return this.queue(type||"fx",[]);},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements]);}};if(typeof type!=="string"){obj=type;type=undefined;}type=type||"fx";while(i--){tmp=jQuery._data(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve);}}resolve();return defer.promise(obj);}});var pnum=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;var cssExpand=["Top","Right","Bottom","Left"];var isHidden=function(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem);};var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw);}}else{if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true;}if(bulk){if(raw){fn.call(elems,value);fn=null;}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value);};}}if(fn){for(;i<length;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));}}}}return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet;};var rcheckableType=(/^(?:checkbox|radio)$/i);(function(){var input=document.createElement("input"),div=document.createElement("div"),fragment=document.createDocumentFragment();div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";support.leadingWhitespace=div.firstChild.nodeType===3;support.tbody=!div.getElementsByTagName("tbody").length;support.htmlSerialize=!!div.getElementsByTagName("link").length;support.html5Clone=document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";input.type="checkbox";input.checked=true;fragment.appendChild(input);support.appendChecked=input.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue;fragment.appendChild(div);div.innerHTML="<input type='radio' checked='checked' name='t'/>";support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;support.noCloneEvent=true;if(div.attachEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false;});div.cloneNode(true).click();}if(support.deleteExpando==null){support.deleteExpando=true;try{delete div.test;}catch(e){support.deleteExpando=false;}}})();(function(){var i,eventName,div=document.createElement("div");for(i in {submit:true,change:true,focusin:true}){eventName="on"+i;if(!(support[i+"Bubbles"]=eventName in window)){div.setAttribute(eventName,"t");support[i+"Bubbles"]=div.attributes[eventName].expando===false;}}div=null;})();var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true;}function returnFalse(){return false;}function safeActiveElement(){try{return document.activeElement;}catch(err){}}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(!elemData){return;}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector;}if(!handler.guid){handler.guid=jQuery.guid++;}if(!(events=elemData.events)){events=elemData.events={};}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined;};eventHandle.elem=elem;}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue;}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false);}else{if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle);}}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid;}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj);}else{handlers.push(handleObj);}jQuery.event.global[type]=true;}elem=null;},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(!elemData||!(events=elemData.events)){return;}types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true);}continue;}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--;}if(special.remove){special.remove.call(elem,handleObj);}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle);}delete events[type];}}if(jQuery.isEmptyObject(events)){delete elemData.handle;jQuery._removeData(elem,"events");}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return;}if(rfocusMorph.test(type+jQuery.event.triggered)){return;}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort();}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem;}data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return;}if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode;}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur;}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window);}}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data);}handle=ontype&&cur[ontype];if(handle&&handle.apply&&jQuery.acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault();}}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null;}jQuery.event.triggered=type;try{elem[type]();}catch(e){}jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp;}}}}return event.result;},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return;}handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation();}}}}}if(special.postDispatch){special.postDispatch.call(this,event);}return event.result;},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!=this;cur=cur.parentNode||this){if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length;}if(matches[sel]){matches.push(handleObj);}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches});}}}}if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)});}return handlerQueue;},fix:function(event){if(event[jQuery.expando]){return event;}var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{};}copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop];}if(!event.target){event.target=originalEvent.srcElement||document;}if(event.target.nodeType===3){event.target=event.target.parentNode;}event.metaKey=!!event.metaKey;return fixHook.filter?fixHook.filter(event,originalEvent):event;},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode;}return event;}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);}if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement;}if(!event.which&&button!==undefined){event.which=(button&1?1:(button&2?3:(button&4?2:0)));}return event;}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){try{this.focus();return false;}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false;}},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false;}},_default:function(event){return jQuery.nodeName(event.target,"a");}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result;}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem);}else{jQuery.event.dispatch.call(elem,e);}if(e.isDefaultPrevented()){event.preventDefault();}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false);}}:function(elem,type,handle){var name="on"+type;if(elem.detachEvent){if(typeof elem[name]===strundefined){elem[name]=null;}elem.detachEvent(name,handle);}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props);}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse;}else{this.type=src;}if(props){jQuery.extend(this,props);}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true;};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(!e){return;}if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(!e){return;}if(e.stopPropagation){e.stopPropagation();}e.cancelBubble=true;},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&e.stopImmediatePropagation){e.stopImmediatePropagation();}this.stopPropagation();}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix;}return ret;}};});if(!support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false;}jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!jQuery._data(form,"submitBubbles")){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=true;});jQuery._data(form,"submitBubbles",true);}});},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true);}}},teardown:function(){if(jQuery.nodeName(this,"form")){return false;}jQuery.event.remove(this,"._submit");}};}if(!support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true;}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false;}jQuery.event.simulate("change",this,event,true);});}return false;}jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true);}});jQuery._data(elem,"changeBubbles",true);}});},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){return event.handleObj.handler.apply(this,arguments);}},teardown:function(){jQuery.event.remove(this,"._change");return !rformElems.test(this.nodeName);}};}if(!support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true);};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true);}jQuery._data(doc,fix,(attaches||0)+1);},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);jQuery._removeData(doc,fix);}else{jQuery._data(doc,fix,attaches);}}};});}jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined;}for(type in types){this.on(type,selector,data,types[type],one);}return this;}if(data==null&&fn==null){fn=selector;data=selector=undefined;}else{if(fn==null){if(typeof selector==="string"){fn=data;data=undefined;}else{fn=data;data=selector;selector=undefined;}}}if(fn===false){fn=returnFalse;}else{if(!fn){return this;}}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments);};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++);}return this.each(function(){jQuery.event.add(this,types,fn,data,selector);});},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1);},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this;}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type]);}return this;}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined;}if(fn===false){fn=returnFalse;}return this.each(function(){jQuery.event.remove(this,types,fn,selector);});},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this);});},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true);}}});function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop());}}return safeFrag;}var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found){for(found=[],elems=context.childNodes||context;(elem=elems[i])!=null;i++){if(!tag||jQuery.nodeName(elem,tag)){found.push(elem);}else{jQuery.merge(found,getAll(elem,tag));}}}return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found;}function fixDefaultChecked(elem){if(rcheckableType.test(elem.type)){elem.defaultChecked=elem.checked;}}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem;}function disableScript(elem){elem.type=(jQuery.find.attr(elem,"type")!==null)+"/"+elem.type;return elem;}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1];}else{elem.removeAttribute("type");}return elem;}function setGlobalEval(elems,refElements){var elem,i=0;for(;(elem=elems[i])!=null;i++){jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"));}}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return;}var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i]);}}}if(curData.data){curData.data=jQuery.extend({},curData.data);}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(dest.nodeType!==1){return;}nodeName=dest.nodeName.toLowerCase();if(!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events){jQuery.removeEvent(dest,e,data.handle);}dest.removeAttribute(jQuery.expando);}if(nodeName==="script"&&dest.text!==src.text){disableScript(dest).text=src.text;restoreScript(dest);}else{if(nodeName==="object"){if(dest.parentNode){dest.outerHTML=src.outerHTML;}if(support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){dest.innerHTML=src.innerHTML;}}else{if(nodeName==="input"&&rcheckableType.test(src.type)){dest.defaultChecked=dest.checked=src.checked;if(dest.value!==src.value){dest.value=src.value;}}else{if(nodeName==="option"){dest.defaultSelected=dest.selected=src.defaultSelected;}else{if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue;}}}}}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){clone=elem.cloneNode(true);}else{fragmentDiv.innerHTML=elem.outerHTML;fragmentDiv.removeChild(clone=fragmentDiv.firstChild);}if((!support.noCloneEvent||!support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0;(node=srcElements[i])!=null;++i){if(destElements[i]){fixCloneNodeIssues(node,destElements[i]);}}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0;(node=srcElements[i])!=null;i++){cloneCopyEvent(node,destElements[i]);}}else{cloneCopyEvent(elem,clone);}}destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"));}destElements=srcElements=node=null;return clone;},buildFragment:function(elems,context,scripts,selection){var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem);}else{if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem));}else{tmp=tmp||safe.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild;}if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)){nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]));}if(!support.tbody){elem=tag==="table"&&!rtbody.test(elem)?tmp.firstChild:wrap[1]==="<table>"&&!rtbody.test(elem)?tmp:0;j=elem&&elem.childNodes.length;while(j--){if(jQuery.nodeName((tbody=elem.childNodes[j]),"tbody")&&!tbody.childNodes.length){elem.removeChild(tbody);}}}jQuery.merge(nodes,tmp.childNodes);tmp.textContent="";while(tmp.firstChild){tmp.removeChild(tmp.firstChild);}tmp=safe.lastChild;}}}}if(tmp){safe.removeChild(tmp);}if(!support.appendChecked){jQuery.grep(getAll(nodes,"input"),fixDefaultChecked);}i=0;while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)!==-1){continue;}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(safe.appendChild(elem),"script");if(contains){setGlobalEval(tmp);}if(scripts){j=0;while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem);}}}}tmp=null;return safe;},cleanData:function(elems,acceptData){var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;for(;(elem=elems[i])!=null;i++){if(acceptData||jQuery.acceptData(elem)){id=elem[internalKey];data=id&&cache[id];if(data){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type);}else{jQuery.removeEvent(elem,type,data.handle);}}}if(cache[id]){delete cache[id];if(deleteExpando){delete elem[internalKey];}else{if(typeof elem.removeAttribute!==strundefined){elem.removeAttribute(internalKey);}else{elem[internalKey]=null;}}deletedIds.push(id);}}}}}});jQuery.fn.extend({text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value));},null,value,arguments.length);},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem);}});},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild);}});},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this);}});},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling);}});},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem));}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"));}elem.parentNode.removeChild(elem);}}return this;},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));}while(elem.firstChild){elem.removeChild(elem.firstChild);}if(elem.options&&jQuery.nodeName(elem,"select")){elem.options.length=0;}}return this;},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents);});},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):undefined;}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(support.htmlSerialize||!rnoshimcache.test(value))&&(support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value;}}elem=0;}catch(e){}}if(elem){this.empty().append(value);}},null,value,arguments.length);},replaceWith:function(){var arg=arguments[0];this.domManip(arguments,function(elem){arg=this.parentNode;jQuery.cleanData(getAll(this));if(arg){arg.replaceChild(elem,this);}});return arg&&(arg.length||arg.nodeType)?this:this.remove();},detach:function(selector){return this.remove(selector,true);},domManip:function(args,callback){args=concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||(l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value))){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html());}self.domManip(args,callback);});}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first;}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"));}}callback.call(this[i],node,i);}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src);}}else{jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""));}}}}fragment=first=null;}}return this;}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get());}return this.pushStack(ret);};});var iframe,elemdisplay={};function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");elem.detach();return display;}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach();}elemdisplay[nodeName]=display;}return display;}(function(){var shrinkWrapBlocksVal;support.shrinkWrapBlocks=function(){if(shrinkWrapBlocksVal!=null){return shrinkWrapBlocksVal;}shrinkWrapBlocksVal=false;var div,body,container;body=document.getElementsByTagName("body")[0];if(!body||!body.style){return;}div=document.createElement("div");container=document.createElement("div");container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px";body.appendChild(container).appendChild(div);if(typeof div.style.zoom!==strundefined){div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;"+"box-sizing:content-box;display:block;margin:0;border:0;"+"padding:1px;width:1px;zoom:1";div.appendChild(document.createElement("div")).style.width="5px";shrinkWrapBlocksVal=div.offsetWidth!==3;}body.removeChild(container);return shrinkWrapBlocksVal;};})();var rmargin=(/^margin/);var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles,curCSS,rposition=/^(top|right|bottom|left)$/;if(window.getComputedStyle){getStyles=function(elem){return elem.ownerDocument.defaultView.getComputedStyle(elem,null);};curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed.getPropertyValue(name)||computed[name]:undefined;if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name);}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth;}}return ret===undefined?ret:ret+"";};}else{if(document.documentElement.currentStyle){getStyles=function(elem){return elem.currentStyle;};curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed[name]:undefined;if(ret==null&&style&&style[name]){ret=style[name];}if(rnumnonpx.test(ret)&&!rposition.test(name)){left=style.left;rs=elem.runtimeStyle;rsLeft=rs&&rs.left;if(rsLeft){rs.left=elem.currentStyle.left;}style.left=name==="fontSize"?"1em":ret;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){rs.left=rsLeft;}}return ret===undefined?ret:ret+""||"auto";};}}function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();if(condition==null){return;}if(condition){delete this.get;return;}return(this.get=hookFn).apply(this,arguments);}};}(function(){var div,style,a,pixelPositionVal,boxSizingReliableVal,reliableHiddenOffsetsVal,reliableMarginRightVal;div=document.createElement("div");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";a=div.getElementsByTagName("a")[0];style=a&&a.style;if(!style){return;}style.cssText="float:left;opacity:.5";support.opacity=style.opacity==="0.5";support.cssFloat=!!style.cssFloat;div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";support.boxSizing=style.boxSizing===""||style.MozBoxSizing===""||style.WebkitBoxSizing==="";jQuery.extend(support,{reliableHiddenOffsets:function(){if(reliableHiddenOffsetsVal==null){computeStyleTests();}return reliableHiddenOffsetsVal;},boxSizingReliable:function(){if(boxSizingReliableVal==null){computeStyleTests();}return boxSizingReliableVal;},pixelPosition:function(){if(pixelPositionVal==null){computeStyleTests();}return pixelPositionVal;},reliableMarginRight:function(){if(reliableMarginRightVal==null){computeStyleTests();}return reliableMarginRightVal;}});function computeStyleTests(){var div,body,container,contents;body=document.getElementsByTagName("body")[0];if(!body||!body.style){return;}div=document.createElement("div");container=document.createElement("div");container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px";body.appendChild(container).appendChild(div);div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;"+"box-sizing:border-box;display:block;margin-top:1%;top:1%;"+"border:1px;padding:1px;width:4px;position:absolute";pixelPositionVal=boxSizingReliableVal=false;reliableMarginRightVal=true;if(window.getComputedStyle){pixelPositionVal=(window.getComputedStyle(div,null)||{}).top!=="1%";boxSizingReliableVal=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px";contents=div.appendChild(document.createElement("div"));contents.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;"+"box-sizing:content-box;display:block;margin:0;border:0;padding:0";contents.style.marginRight=contents.style.width="0";div.style.width="1px";reliableMarginRightVal=!parseFloat((window.getComputedStyle(contents,null)||{}).marginRight);}div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";contents=div.getElementsByTagName("td");contents[0].style.cssText="margin:0;border:0;padding:0;display:none";reliableHiddenOffsetsVal=contents[0].offsetHeight===0;if(reliableHiddenOffsetsVal){contents[0].style.display="";contents[1].style.display="none";reliableHiddenOffsetsVal=contents[0].offsetHeight===0;}body.removeChild(container);}})();jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name];}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name];}return ret;};var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name;}var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name;}}return origName;}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue;}values[index]=jQuery._data(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display="";}if(elem.style.display===""&&isHidden(elem)){values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName));}}else{hidden=isHidden(elem);if(display&&display!=="none"||!hidden){jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"));}}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue;}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none";}}return elements;}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value;}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles);}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles);}if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}}return val;}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name];}if(rnumnonpx.test(val)){return val;}valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0;}return(val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles))+"px";}jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret;}}}},cssNumber:{"columnCount":true,"fillOpacity":true,"flexGrow":true,"flexShrink":true,"fontWeight":true,"lineHeight":true,"opacity":true,"order":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return;}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number";}if(value==null||value!==value){return;}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px";}if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit";}if(!hooks||!("set" in hooks)||(value=hooks.set(elem,value,extra))!==undefined){try{style[name]=value;}catch(e){}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret;}return style[name];}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get" in hooks){val=hooks.get(elem,true,extra);}if(val===undefined){val=curCSS(elem,name,styles);}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name];}if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val;}return val;}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&elem.offsetWidth===0?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra);}):getWidthOrHeight(elem,name,extra);}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0);}};});if(!support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":computed?"1":"";},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if((value>=1||value==="")&&jQuery.trim(filter.replace(ralpha,""))===""&&style.removeAttribute){style.removeAttribute("filter");if(value===""||currentStyle&&!currentStyle.filter){return;}}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity;}};}jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed){return jQuery.swap(elem,{"display":"inline-block"},curCSS,[elem,"marginRight"]);}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];}return expanded;}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber;}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles);}return map;}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name);},name,value,arguments.length>1);},show:function(){return showHide(this,true);},hide:function(){return showHide(this);},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide();}return this.each(function(){if(isHidden(this)){jQuery(this).show();}else{jQuery(this).hide();}});}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing);}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px");},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this);},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration);}else{this.pos=eased=percent;}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this);}if(hooks&&hooks.set){hooks.set(this);}else{Tween.propHooks._default.set(this);}return this;}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop];}result=jQuery.css(tween.elem,tween.prop,"");return !result||result==="auto"?0:result;},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween);}else{if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit);}else{tween.elem[tween.prop]=tween.now;}}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now;}}};jQuery.easing={linear:function(p){return p;},swing:function(p){return 0.5-Math.cos(p*Math.PI)/2;}};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit);}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations);}if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2];}return tween;}]};function createFxNow(){setTimeout(function(){fxNow=undefined;});return(fxNow=jQuery.now());}function genFx(type,includeWidth){var which,attrs={height:type},i=0;includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type;}if(includeWidth){attrs.opacity=attrs.width=type;}return attrs;}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if((tween=collection[index].call(animation,prop,value))){return tween;}}}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire();}};}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire();}});});}if(elem.nodeType===1&&("height" in props||"width" in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");checkDisplay=display==="none"?jQuery._data(elem,"olddisplay")||defaultDisplay(elem.nodeName):display;if(checkDisplay==="inline"&&jQuery.css(elem,"float")==="none"){if(!support.inlineBlockNeedsLayout||defaultDisplay(elem.nodeName)==="inline"){style.display="inline-block";}else{style.zoom=1;}}}if(opts.overflow){style.overflow="hidden";if(!support.shrinkWrapBlocks()){anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2];});}}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true;}else{continue;}}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop);}else{display=undefined;}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden" in dataShow){hidden=dataShow.hidden;}}else{dataShow=jQuery._data(elem,"fxshow",{});}if(toggle){dataShow.hidden=!hidden;}if(hidden){jQuery(elem).show();}else{anim.done(function(){jQuery(elem).hide();});}anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop]);}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0;}}}}else{if((display==="none"?defaultDisplay(elem.nodeName):display)==="inline"){style.display=display;}}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0];}if(index!==name){props[name]=value;delete props[index];}hooks=jQuery.cssHooks[name];if(hooks&&"expand" in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing;}}}else{specialEasing[name]=easing;}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem;}),tick=function(){if(stopped){return false;}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent);}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining;}else{deferred.resolveWith(elem,[animation]);return false;}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween;},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this;}stopped=true;for(;index<length;index++){animation.tweens[index].run(1);}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd]);}else{deferred.rejectWith(elem,[animation,gotoEnd]);}return this;}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result;}}jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation);}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always);}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"];}else{props=props.split(" ");}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback);}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback);}else{animationPrefilters.push(callback);}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx";}opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this);}if(opt.queue){jQuery.dequeue(this,opt.queue);}};return opt;};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback);},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||jQuery._data(this,"finish")){anim.stop(true);}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation);},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd);};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined;}if(clearQueue&&type!==false){this.queue(type||"fx",[]);}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index]);}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index]);}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1);}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type);}});},finish:function(type){if(type!==false){type=type||"fx";}return this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true);}for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1);}}for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this);}}delete data.finish;});}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback);};});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback);};});jQuery.timers=[];jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1);}}if(!timers.length){jQuery.fx.stop();}fxNow=undefined;};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);if(timer()){jQuery.fx.start();}else{jQuery.timers.pop();}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval);}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null;};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout);};});};(function(){var input,div,select,a,opt;div=document.createElement("div");div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";a=div.getElementsByTagName("a")[0];select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];a.style.cssText="top:1px";support.getSetAttribute=div.className!=="t";support.style=/top/.test(a.getAttribute("style"));support.hrefNormalized=a.getAttribute("href")==="/a";support.checkOn=!!input.value;support.optSelected=opt.selected;support.enctype=!!document.createElement("form").enctype;select.disabled=true;support.optDisabled=!opt.disabled;input=document.createElement("input");input.setAttribute("value","");support.input=input.getAttribute("value")==="";input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";})();var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get" in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret;}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret;}return;}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return;}if(isFunction){val=value.call(this,i,jQuery(this).val());}else{val=value;}if(val==null){val="";}else{if(typeof val==="number"){val+="";}else{if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+"";});}}}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set" in hooks)||hooks.set(this,val,"value")===undefined){this.value=val;}});}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:jQuery.trim(jQuery.text(elem));}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value;}values.push(value);}}return values;},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0){try{option.selected=optionSet=true;}catch(_){option.scrollHeight;}}else{option.selected=false;}}if(!optionSet){elem.selectedIndex=-1;}return options;}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0);}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value;};}});var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1);},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name);});}});jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return;}if(typeof elem.getAttribute===strundefined){return jQuery.prop(elem,name,value);}if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook);}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);}else{if(hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}else{elem.setAttribute(name,value+"");return value;}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null){return ret;}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret;}}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem[propName]=false;}else{elem[jQuery.camelCase("default-"+name)]=elem[propName]=false;}}else{jQuery.attr(elem,name,"");}elem.removeAttribute(getSetAttribute?name:propName);}}},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val;}return value;}}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name);}else{if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name);}else{elem[jQuery.camelCase("default-"+name)]=elem[name]=true;}}return name;}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=getter(elem,name,isXML)!=null?name.toLowerCase():null;attrHandle[name]=handle;}return ret;}:function(elem,name,isXML){if(!isXML){return elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null;}};});if(!getSetInput||!getSetAttribute){jQuery.attrHooks.value={set:function(elem,value,name){if(jQuery.nodeName(elem,"input")){elem.defaultValue=value;}else{return nodeHook&&nodeHook.set(elem,value,name);}}};}if(!getSetAttribute){nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){elem.setAttributeNode((ret=elem.ownerDocument.createAttribute(name)));}ret.value=value+="";if(name==="value"||value===elem.getAttribute(name)){return value;}}};attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;if(!isXML){return(ret=elem.getAttributeNode(name))&&ret.value!==""?ret.value:null;}};jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);if(ret&&ret.specified){return ret.value;}},set:nodeHook.set};jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,value===""?false:value,name);}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value;}}};});}if(!support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined;},set:function(elem,value){return(elem.style.cssText=value+"");}};}var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1);},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name];}catch(e){}});}});jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return;}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name];}if(value!==undefined){return hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem[name]=value);}else{return hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name];}},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1;}}}});if(!support.hrefNormalized){jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4);}};});}if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex;}}return null;}};}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this;});if(!support.enctype){jQuery.propFix.enctype="encoding";}var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className));});}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while((clazz=classes[j++])){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" ";}}finalValue=jQuery.trim(cur);if(elem.className!==finalValue){elem.className=finalValue;}}}}return this;},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=arguments.length===0||typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className));});}if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while((clazz=classes[j++])){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ");}}finalValue=value?jQuery.trim(cur):"";if(elem.className!==finalValue){elem.className=finalValue;}}}}return this;},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value);}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal);});}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];while((className=classNames[i++])){if(self.hasClass(className)){self.removeClass(className);}else{self.addClass(className);}}}else{if(type===strundefined||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className);}this.className=this.className||value===false?"":jQuery._data(this,"__className__")||"";}}});},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true;}}return false;}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name);};});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);},bind:function(types,data,fn){return this.on(types,null,data,fn);},unbind:function(types,fn){return this.off(types,null,fn);},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn);},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn);}});var nonce=jQuery.now();var rquery=(/\?/);var rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse){return window.JSON.parse(data+"");}var requireNonComma,depth=null,str=jQuery.trim(data+"");return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){if(requireNonComma&&comma){depth=0;}if(depth===0){return token;}requireNonComma=open||comma;depth+=!close-!open;return"";}))?(Function("return "+str))():jQuery.error("Invalid JSON: "+data);};jQuery.parseXML=function(data){var xml,tmp;if(!data||typeof data!=="string"){return null;}try{if(window.DOMParser){tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml");}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data);}}catch(e){xml=undefined;}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data);}return xml;};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href;}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href;}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*";}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func)){while((dataType=dataTypes[i++])){if(dataType.charAt(0)==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func);}else{(structure[dataType]=structure[dataType]||[]).push(func);}}}};}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false;}else{if(seekingTransport){return !(selected=dataTypeOrTransport);}}});return selected;}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*");}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key];}}if(deep){jQuery.extend(true,target,deep);}return target;}function ajaxHandleResponses(s,jqXHR,responses){var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type");}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break;}}}if(dataTypes[0] in responses){finalDataType=dataTypes[0];}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break;}if(!firstDataType){firstDataType=type;}}finalDataType=finalDataType||firstDataType;}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType);}return responses[finalDataType];}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv];}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response;}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType);}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev;}else{if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2];}else{if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1]);}}break;}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response);}else{try{response=conv(response);}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current};}}}}}}}return{state:"success",data:response};}jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target);},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined;}options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2];}}match=responseHeaders[key.toLowerCase()];}return match==null?null:match;},getAllResponseHeaders:function(){return state===2?responseHeadersString:null;},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value;}return this;},overrideMimeType:function(type){if(!state){s.mimeType=type;}return this;},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]];}}else{jqXHR.always(map[jqXHR.status]);}}return this;},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText);}done(0,finalText);return this;}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))));}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional);}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR;}fireGlobals=s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart");}s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=(s.url+=(rquery.test(cacheURL)?"&":"?")+s.data);delete s.data;}if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++;}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL]);}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType);}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i]);}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort();}strAbort="abort";for(i in {success:1,error:1,complete:1}){jqXHR[i](s[i]);}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport");}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s]);}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout");},s.timeout);}try{state=1;transport.send(requestHeaders,done);}catch(e){if(state<2){done(-1,e);}else{throw e;}}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return;}state=2;if(timeoutTimer){clearTimeout(timeoutTimer);}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses);}response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified;}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified;}}if(status===204||s.type==="HEAD"){statusText="nocontent";}else{if(status===304){statusText="notmodified";}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error;}}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0;}}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]);}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop");}}}return jqXHR;},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json");},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script");}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined;}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback});};});jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn);};});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true});};jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i));});}if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0]);}wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild;}return elem;}).append(this);}return this;},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i));});}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html);}else{self.append(html);}});},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html);});},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes);}}).end();}});jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||(!support.reliableHiddenOffsets()&&((elem.style&&elem.style.display)||jQuery.css(elem,"display"))==="none");};jQuery.expr.filters.visible=function(elem){return !jQuery.expr.filters.hidden(elem);};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v);}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add);}});}else{if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add);}}else{add(prefix,obj);}}}jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():(value==null?"":value);s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value);};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional;}if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value);});}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add);}}return s.join("&").replace(r20,"+");};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray());},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this;}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type));}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")};}):{name:elem.name,value:val.replace(rCRLF,"\r\n")};}).get();}});jQuery.ajaxSettings.xhr=window.ActiveXObject!==undefined?function(){return !this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR();}:createStandardXHR;var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();if(window.ActiveXObject){jQuery(window).on("unload",function(){for(var key in xhrCallbacks){xhrCallbacks[key](undefined,true);}});}support.cors=!!xhrSupported&&("withCredentials" in xhrSupported);xhrSupported=support.ajax=!!xhrSupported;if(xhrSupported){jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i];}}if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType);}if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest";}for(i in headers){if(headers[i]!==undefined){xhr.setRequestHeader(i,headers[i]+"");}}xhr.send((options.hasContent&&options.data)||null);callback=function(_,isAbort){var status,statusText,responses;if(callback&&(isAbort||xhr.readyState===4)){delete xhrCallbacks[id];callback=undefined;xhr.onreadystatechange=jQuery.noop;if(isAbort){if(xhr.readyState!==4){xhr.abort();}}else{responses={};status=xhr.status;if(typeof xhr.responseText==="string"){responses.text=xhr.responseText;}try{statusText=xhr.statusText;}catch(e){statusText="";}if(!status&&options.isLocal&&!options.crossDomain){status=responses.text?200:404;}else{if(status===1223){status=204;}}}}if(responses){complete(status,statusText,responses,xhr.getAllResponseHeaders());}};if(!options.async){callback();}else{if(xhr.readyState===4){setTimeout(callback);}else{xhr.onreadystatechange=xhrCallbacks[id]=callback;}}},abort:function(){if(callback){callback(undefined,true);}}};}});}function createStandardXHR(){try{return new window.XMLHttpRequest();}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP");}catch(e){}}jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text;}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false;}if(s.crossDomain){s.type="GET";s.global=false;}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async=true;if(s.scriptCharset){script.charset=s.scriptCharset;}script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(script.parentNode){script.parentNode.removeChild(script);}script=null;if(!isAbort){callback(200,"success");}}};head.insertBefore(script,head.firstChild);},abort:function(){if(script){script.onload(undefined,true);}}};}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(nonce++));this[callback]=true;return callback;}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName);}else{if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName;}}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called");}return responseContainer[0];};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments;};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName);}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0]);}responseContainer=overwritten=undefined;});return"script";}});jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string"){return null;}if(typeof context==="boolean"){keepScripts=context;context=false;}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])];}parsed=jQuery.buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove();}return jQuery.merge([],parsed.childNodes);};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments);}var selector,response,type,self=this,off=url.indexOf(" ");if(off>=0){selector=jQuery.trim(url.slice(off,url.length));url=url.slice(0,off);}if(jQuery.isFunction(params)){callback=params;params=undefined;}else{if(params&&typeof params==="object"){type="POST";}}if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText);}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR]);});}return this;};jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem;}).length;};var docElem=window.document.documentElement;function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false;}jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative";}curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left;}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0;}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset);}if(options.top!=null){props.top=(options.top-curOffset.top)+curTop;}if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft;}if("using" in options){options.using.call(elem,props);}else{curElem.css(props);}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i);});}var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(!doc){return;}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box;}if(typeof elem.getBoundingClientRect!==strundefined){box=elem.getBoundingClientRect();}win=getWindow(doc);return{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)};},position:function(){if(!this[0]){return;}var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect();}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset();}parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true);}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)};},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent;}return offsetParent||docElem;});}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?(prop in win)?win[prop]:win.document.documentElement[method]:elem[method];}if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop());}else{elem[method]=val;}},method,val,arguments.length,null);};});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed;}});});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name];}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name]);}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra);},type,chainable?margin:undefined,chainable,null);};});});jQuery.fn.size=function(){return this.length;};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery;});}var _jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$;}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery;}return jQuery;};if(typeof noGlobal===strundefined){window.jQuery=window.$=jQuery;}return jQuery;}));
   /* Ende jquery */
   /* Start gsb_responsiveListener */
   /*!
 * --GSBDocStart
 * @module gsb_responsiveListener
 * @version 1.1.0
 * @see {@link http://semver.org|Semantic Versioning}
 * @author anuebel, pespeloe
 * 
 * @desc Ändert die Options der Plugins je Breakpoint. Über die Callbackfunction "onRefresh" kann je Auflösung eine Function ausgeführt werden
 * 
 * @example
 * base.$el.gsb_responsiveListener(base);
 *--GSBDocEnd
 * Licensed under the MIT license
 *
 * Callback function je Breakpoint
 * */
(function($){if(!$.gsb){$.gsb={};}$.gsb.responsiveListener=function(pluginBase){var base=this;this.base=base;this.pluginBase=pluginBase;this.base.breakpoints=[];this.base.breakpointSettings=[];this.base.activeBreakpoint=null;this.base.windowWidth=0;base.init=function(){base.options=pluginBase.options;base.originalOptions=base.options;this.base.options=base.options;this.base.originalOptions=base.originalOptions;base.initResponsive();base.checkResponsive();if(base.options.respondToEvents===true){base.initEvents();}};$.gsb.responsiveListener.prototype.initEvents=function(){var $window=$(window),onResize=function(){if($(window).width()!==base.windowWidth){clearTimeout(base.windowDelay);base.windowDelay=window.setTimeout(function(){base.windowWidth=$(window).width();base.checkResponsive();},100);}};$window.on("resize",onResize);$window.on("orientationchange",function(){base.checkResponsive();});};base.init();};$.gsb.responsiveListener.prototype.initResponsive=function(){var breakpoint,responsiveSettings=this.base.options.responsive||null;if(responsiveSettings&&responsiveSettings.length>-1){for(breakpoint in responsiveSettings){if(responsiveSettings.hasOwnProperty(breakpoint)){this.base.breakpoints.push(responsiveSettings[breakpoint].breakpoint);this.base.breakpointSettings[responsiveSettings[breakpoint].breakpoint]=responsiveSettings[breakpoint];}}this.base.breakpoints.sort(function(a,b){return b-a;});}};$.gsb.responsiveListener.prototype.checkResponsive=function(){var breakpoint,targetBreakpoint,respondToWidth=window.innerWidth||$(window).width();if(this.base.originalOptions.responsive&&this.base.originalOptions.responsive.length>-1&&this.base.originalOptions.responsive!==null){targetBreakpoint=null;if(this.base.activeBreakpoint!==null&&respondToWidth>=this.base.breakpoints[0]){this.base.activeBreakpoint=null;this.pluginBase.options=this.base.originalOptions;}for(breakpoint in this.base.breakpoints){if(this.base.breakpoints.hasOwnProperty(breakpoint)){if(respondToWidth<this.base.breakpoints[breakpoint]){targetBreakpoint=this.base.breakpoints[breakpoint];this.base.highestResolution=false;}}}if(this.base.highestResolution){return;}if(targetBreakpoint!==null){if(this.base.activeBreakpoint!==null){if(targetBreakpoint!==this.base.activeBreakpoint){this.base.activeBreakpoint=targetBreakpoint;this.pluginBase.options=$.extend({},this.base.originalOptions,this.base.breakpointSettings[targetBreakpoint]);this.base.triggerRefresh();}}else{this.base.activeBreakpoint=targetBreakpoint;this.pluginBase.options=$.extend({},this.base.originalOptions,this.base.breakpointSettings[targetBreakpoint]);this.base.triggerRefresh();}}else{if(this.base.activeBreakpoint!==null){this.base.activeBreakpoint=null;this.base.options=this.base.originalOptions;this.base.triggerRefresh();}else{this.base.highestResolution=true;this.base.triggerRefresh();}}}else{if(this.base.originalOptions.onRefresh&&this.base.originalOptions.onRefresh.length>-1&&this.base.originalOptions.onRefresh!==null){if(this.base.highestResolution){return;}this.base.triggerRefresh();this.base.highestResolution=true;}}};$.gsb.responsiveListener.prototype.triggerRefresh=function(){if(typeof this.pluginBase.options.onRefresh==="function"){this.pluginBase.options.onRefresh.call(this.pluginBase);}};$.fn.gsb_responsiveListener=function(pluginBase){return this.each(function(){(new $.gsb.responsiveListener(pluginBase));});};})(jQuery);
   /* Ende gsb_responsiveListener */
   /* Start gsb_ariaSupport */
   (function($){if(!$.gsb){$.gsb={};}$.gsb.ariaSupport=function(pluginBase){this.base=this;this.pluginBase=pluginBase;this.base.init=function(){this.base.options=pluginBase.options;this.base.originalOptions=this.base.options;this.base.options=this.base.options;this.base.originalOptions=this.base.originalOptions;this.base.initializeAria();};this.base.init();};$.gsb.ariaSupport.prototype.initializeAria=function(){var ariaType=this.base.options.ariaType,base=this.base,pluginBase=this.pluginBase;base.moduleOptions=$.gsb.ariaSupport.defaultOptions[ariaType.toUpperCase()];base.attributesPanel=$.gsb.ariaSupport.defaultOptions[ariaType.toUpperCase()]["panel"];base.attributesContent=$.gsb.ariaSupport.defaultOptions[ariaType.toUpperCase()]["content"];base.panelToggle=base.setToggleoptions(base.attributesPanel);base.contentToggle=base.setToggleoptions(base.attributesContent);pluginBase.controlPanel.get().forEach(function(panel,index){var firstOpen=$.gsb.ariaSupport.defaultOptions[ariaType.toUpperCase()].firstOpen;var addAural=$.gsb.ariaSupport.defaultOptions[ariaType.toUpperCase()].addAural;if(firstOpen&&index>0){firstOpen=false;}base.setAttributes(panel,base.attributesPanel,index,firstOpen);if(addAural){if(firstOpen){base.addAural(panel,true);}else{base.addAural(panel,false);}}if(pluginBase.contentPanel&&pluginBase.contentPanel.get(index)){base.setAttributes(pluginBase.contentPanel.get(index),base.attributesContent,index,firstOpen);}});};$.gsb.ariaSupport.defaultOptions={TAB:{firstOpen:true,panel:{id:function(base){return base.generateID();},role:"tab",aria_selected:["true","false"],aria_controls:function(base){return base.generateID();}},content:{role:"tabpanel",aria_hidden:["false","true"],id:function(base,index){return base.getPanelAttribute(index,"aria-controls");},aria_labelledby:function(base,index){return base.getPanelAttribute(index,"id");}}},ACCORDION:{panel:{role:"tab",aria_expanded:["true","false"],aria_selected:["true","false"],id:function(base){return base.generateID();},aria_controls:function(base){return base.generateID();}},content:{role:"tabpanel",aria_hidden:["false","true"],id:function(base,index){return base.getPanelAttribute(index,"aria-controls");},aria_labelledby:function(base,index){return base.getPanelAttribute(index,"id");}}},LIGTHBOX:{panel:{aria_haspopup:"true"}},MOBILEMENU:{panel:{aria_controls:function(base){return base.generateID();},id:function(base){return base.generateID();}},content:{aria_labelledby:function(base,index){return base.getPanelAttribute(index,"id");},id:function(base,index){return base.getPanelAttribute(index,"aria-controls");},aria_hidden:["false","true"],aria_expanded:["true","false"]}}};$.gsb.ariaSupport.prototype.generateID=function(){return"_"+Math.random().toString(36).substr(2,9);};$.gsb.ariaSupport.prototype.addAural=function(elem,open){var base=this.base;var auralSpan=document.createElement("span");auralSpan.classList.add("aural");var index=1;if(open==true){index=0;}var auralText=document.createTextNode(base.moduleOptions.auralText[index]);auralSpan.appendChild(auralText);elem.insertBefore(auralSpan,elem.firstChild);};$.gsb.ariaSupport.prototype.updateAural=function(clickedElem,open){var base=this.base;var auralSpan=clickedElem.querySelector(".aural");var index=1;if(open==true){index=0;}auralSpan.removeChild(auralSpan.firstChild);var auralText=document.createTextNode(base.moduleOptions.auralText[index]);auralSpan.appendChild(auralText);};$.gsb.ariaSupport.prototype.setAttributes=function(elem,options,index,open){var base=this.base;for(var key in options){var keyNameAsProperty=key.replace(/_/g,"-");if(typeof options[key]==="function"){elem.setAttribute(keyNameAsProperty,options[key].call(this,base,index));}else{if(Array.isArray(options[key])){if(options[key].length==2){if(open){elem.setAttribute(keyNameAsProperty,options[key][0]);}else{elem.setAttribute(keyNameAsProperty,options[key][1]);}}}else{elem.setAttribute(keyNameAsProperty,options[key]);}}}};$.gsb.ariaSupport.prototype.setToggleoptions=function(options){var obj={};for(key in options){if(Array.isArray(options[key])){obj[key]=options[key];}}return obj;};$.gsb.ariaSupport.prototype.getPanelAttribute=function(elementIndex,attribute){return this.pluginBase.controlPanel.get(elementIndex).getAttribute(attribute);};$.gsb.ariaSupport.prototype.getContentAttribute=function(elementIndex,attribute){return this.pluginBase.contentPanel.get(elementIndex).getAttribute(attribute);};$.gsb.ariaSupport.prototype.updateAria=function(clickedElem,externalOpen,singleOpen){var base=this.base;pluginBase=base.pluginBase;if(typeof externalOpen!="boolean"){externalOpen=null;}base.pluginBase.controlPanel.get().forEach(function(elem,index){var open=false;if(externalOpen){open=true;}else{if(externalOpen==null&&elem==clickedElem){open=true;}}if(singleOpen){if(elem!==clickedElem){return;}}base.setAttributes(elem,base.panelToggle,index,open);base.setAttributes(pluginBase.contentPanel.get(index),base.contentToggle,index,open);});};$.fn.gsb_ariaSupport=function(pluginBase){return(new $.gsb.ariaSupport(pluginBase));};})(jQuery);
   /* Ende gsb_ariaSupport */
   /* Start autolinker */
   /*!
 * Autolinker.js
 * 0.11.0
 *
 * Copyright(c) 2014 Gregory Jacobs <greg@greg-jacobs.com>
 * MIT Licensed. http://www.opensource.org/licenses/mit-license.php
 *
 * https://github.com/gregjacobs/Autolinker.js
 */
!function(a,b){"function"==typeof define&&define.amd?define(b):"undefined"!=typeof exports?module.exports=b():a.Autolinker=b()}(this,function(){var a=function(a){a=a||{};for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};return a.prototype={constructor:a,newWindow:!0,stripPrefix:!0,twitter:!0,email:!0,urls:!0,className:"",matcherRegex:function(){var a=/(^|[^\w])@(\w{1,15})/,b=/(?:[\-;:&=\+\$,\w\.]+@)/,c=/(?:[A-Za-z]{3,9}:(?:\/\/)?)/,d=/(?:www\.)/,e=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,f=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,g=/(?:[\-A-Za-z0-9+&@#\/%?=~_()|!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|])?/;return new RegExp(["(",a.source,")","|","(",b.source,e.source,f.source,")","|","(","(?:","(?:",c.source,e.source,")","|","(?:","(.?//)?",d.source,e.source,")","|","(?:","(.?//)?",e.source,f.source,")",")",g.source,")"].join(""),"gi")}(),protocolRelativeRegex:/(.)?\/\//,htmlRegex:function(){var a=/[0-9a-zA-Z:]+/,b=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,c=/(?:".*?"|'.*?'|[^'"=<>`\s]+)/;return new RegExp(["<(/)?","("+a.source+")","(?:","\\s+",b.source,"(?:\\s*=\\s*"+c.source+")?",")*","\\s*",">"].join(""),"g")}(),urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,link:function(a){return this.processHtml(a)},processHtml:function(a){for(var b,c,d=this.htmlRegex,e=0,f=0,g=[];null!==(b=d.exec(a));){var h=b[0],i=b[2],j=!!b[1];c=a.substring(e,b.index),e=b.index+h.length,"a"===i?j?(f=Math.max(f-1,0),0===f&&g.push(c)):(f++,g.push(this.processTextNode(c))):g.push(0===f?this.processTextNode(c):c),g.push(h)}if(e<a.length){var k=this.processTextNode(a.substring(e));g.push(k)}return g.join("")},processTextNode:function(a){var b=this,c=this.matcherRegex,d=this.twitter,e=this.email,f=this.urls;return a.replace(c,function(a,c,g,h,i,j,k,l){var m=c,n=g,o=h,p=i,q=j,r=k||l,s="",t="";if(m&&!d||p&&!e||q&&!f||q&&-1===q.indexOf(".")||q&&/^[A-Za-z]{3,9}:/.test(q)&&!/:.*?[A-Za-z]/.test(q)||r&&/^[\w]\/\//.test(r))return a;var u=a.charAt(a.length-1);if(")"===u){var v=a.match(/\(/g),w=a.match(/\)/g),x=v&&v.length||0,y=w&&w.length||0;y>x&&(a=a.substr(0,a.length-1),t=")")}var z,A=a,B=a;if(m)z="twitter",s=n,A="https://twitter.com/"+o,B="@"+o;else if(p)z="email",A="mailto:"+p,B=p;else if(z="url",r){var C=new RegExp("^"+b.protocolRelativeRegex.source),D=r.match(C)[1]||"";s=D+s,A=A.replace(C,"//"),B=B.replace(C,"")}else/^[A-Za-z]{3,9}:/i.test(A)||(A="http://"+A);var E=b.createAnchorTag(z,A,B);return s+E+t})},createAnchorTag:function(a,b,c){var d=this.createAnchorAttrsStr(a,b);return c=this.processAnchorText(c),"<a "+d+">"+c+"</a>"},createAnchorAttrsStr:function(a,b){var c=['href="'+b+'"'],d=this.createCssClass(a);return d&&c.push('class="'+d+'"'),this.newWindow&&c.push('target="_blank"'),c.join(" ")},createCssClass:function(a){var b=this.className;return b?b+" "+b+"-"+a:""},processAnchorText:function(a){return this.stripPrefix&&(a=this.stripUrlPrefix(a)),a=this.removeTrailingSlash(a),a=this.doTruncate(a)},stripUrlPrefix:function(a){return a.replace(this.urlPrefixRegex,"")},removeTrailingSlash:function(a){return"/"===a.charAt(a.length-1)&&(a=a.slice(0,-1)),a},doTruncate:function(a){var b=this.truncate;return b&&a.length>b&&(a=a.substring(0,b-2)+".."),a}},a.link=function(b,c){var d=new a(c);return d.link(b)},a});
   /* Ende autolinker */
   /* Start foundation.core */
   /******/ (function(modules) { // webpackBootstrap
/******/   // The module cache
/******/   var installedModules = {};
/******/
/******/   // The require function
/******/   function __webpack_require__(moduleId) {
/******/
/******/     // Check if module is in cache
/******/     if(installedModules[moduleId]) {
/******/       return installedModules[moduleId].exports;
/******/     }
/******/     // Create a new module (and put it into the cache)
/******/     var module = installedModules[moduleId] = {
/******/       i: moduleId,
/******/       l: false,
/******/       exports: {}
/******/     };
/******/
/******/     // Execute the module function
/******/     modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/     // Flag the module as loaded
/******/     module.l = true;
/******/
/******/     // Return the exports of the module
/******/     return module.exports;
/******/   }
/******/
/******/
/******/   // expose the modules object (__webpack_modules__)
/******/   __webpack_require__.m = modules;
/******/
/******/   // expose the module cache
/******/   __webpack_require__.c = installedModules;
/******/
/******/   // identity function for calling harmony imports with the correct context
/******/   __webpack_require__.i = function(value) { return value; };
/******/
/******/   // define getter function for harmony exports
/******/   __webpack_require__.d = function(exports, name, getter) {
/******/     if(!__webpack_require__.o(exports, name)) {
/******/       Object.defineProperty(exports, name, {
/******/         configurable: false,
/******/         enumerable: true,
/******/         get: getter
/******/       });
/******/     }
/******/   };
/******/
/******/   // getDefaultExport function for compatibility with non-harmony modules
/******/   __webpack_require__.n = function(module) {
/******/     var getter = module && module.__esModule ?
/******/       function getDefault() { return module['default']; } :
/******/       function getModuleExports() { return module; };
/******/     __webpack_require__.d(getter, 'a', getter);
/******/     return getter;
/******/   };
/******/
/******/   // Object.prototype.hasOwnProperty.call
/******/   __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/   // __webpack_public_path__
/******/   __webpack_require__.p = "";
/******/
/******/   // Load entry module and return exports
/******/   return __webpack_require__(__webpack_require__.s = 6);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),
/* 1 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return rtl; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return GetYoDigits; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return transitionend; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);




// Core Foundation Utilities, utilized in a number of places.

/**
 * Returns a boolean for RTL support
 */
function rtl() {
  return __WEBPACK_IMPORTED_MODULE_0_jquery___default()('html').attr('dir') === 'rtl';
}

/**
 * returns a random base-36 uid with namespacing
 * @function
 * @param {Number} length - number of random base-36 digits desired. Increase for more random strings.
 * @param {String} namespace - name of plugin to be incorporated in uid, optional.
 * @default {String} '' - if no plugin name is provided, nothing is appended to the uid.
 * @returns {String} - unique id
 */
function GetYoDigits(length, namespace) {
  length = length || 6;
  return Math.round(Math.pow(36, length + 1) - Math.random() * Math.pow(36, length)).toString(36).slice(1) + (namespace ? '-' + namespace : '');
}

function transitionend($elem) {
  var transitions = {
    'transition': 'transitionend',
    'WebkitTransition': 'webkitTransitionEnd',
    'MozTransition': 'transitionend',
    'OTransition': 'otransitionend'
  };
  var elem = document.createElement('div'),
      end;

  for (var t in transitions) {
    if (typeof elem.style[t] !== 'undefined') {
      end = transitions[t];
    }
  }
  if (end) {
    return end;
  } else {
    end = setTimeout(function () {
      $elem.triggerHandler('transitionend', [$elem]);
    }, 1);
    return 'transitionend';
  }
}



/***/ }),
/* 2 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_core__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__foundation_util_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__foundation_plugin__ = __webpack_require__(4);



__WEBPACK_IMPORTED_MODULE_1__foundation_core__["a" /* Foundation */].addToJquery(__WEBPACK_IMPORTED_MODULE_0_jquery___default.a);

// These are now separated out, but historically were a part of this module,
// and since this is here for backwards compatibility we include them in
// this entry.

__WEBPACK_IMPORTED_MODULE_1__foundation_core__["a" /* Foundation */].rtl = __WEBPACK_IMPORTED_MODULE_2__foundation_util_core__["a" /* rtl */];
__WEBPACK_IMPORTED_MODULE_1__foundation_core__["a" /* Foundation */].GetYoDigits = __WEBPACK_IMPORTED_MODULE_2__foundation_util_core__["b" /* GetYoDigits */];
__WEBPACK_IMPORTED_MODULE_1__foundation_core__["a" /* Foundation */].transitionend = __WEBPACK_IMPORTED_MODULE_2__foundation_util_core__["c" /* transitionend */];

// Every plugin depends on plugin now, we can include that on the core for the
// script inclusion path.


__WEBPACK_IMPORTED_MODULE_1__foundation_core__["a" /* Foundation */].Plugin = __WEBPACK_IMPORTED_MODULE_3__foundation_plugin__["a" /* Plugin */];

window.Foundation = __WEBPACK_IMPORTED_MODULE_1__foundation_core__["a" /* Foundation */];

/***/ }),
/* 3 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Foundation; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__foundation_util_mediaQuery__ = __webpack_require__(5);






var FOUNDATION_VERSION = '6.4.3';

// Global Foundation object
// This is attached to the window, or used as a module for AMD/Browserify
var Foundation = {
  version: FOUNDATION_VERSION,

  /**
   * Stores initialized plugins.
   */
  _plugins: {},

  /**
   * Stores generated unique ids for plugin instances
   */
  _uuids: [],

  /**
   * Defines a Foundation plugin, adding it to the `Foundation` namespace and the list of plugins to initialize when reflowing.
   * @param {Object} plugin - The constructor of the plugin.
   */
  plugin: function (plugin, name) {
    // Object key to use when adding to global Foundation object
    // Examples: Foundation.Reveal, Foundation.OffCanvas
    var className = name || functionName(plugin);
    // Object key to use when storing the plugin, also used to create the identifying data attribute for the plugin
    // Examples: data-reveal, data-off-canvas
    var attrName = hyphenate(className);

    // Add to the Foundation object and the plugins list (for reflowing)
    this._plugins[attrName] = this[className] = plugin;
  },
  /**
   * @function
   * Populates the _uuids array with pointers to each individual plugin instance.
   * Adds the `zfPlugin` data-attribute to programmatically created plugins to allow use of $(selector).foundation(method) calls.
   * Also fires the initialization event for each plugin, consolidating repetitive code.
   * @param {Object} plugin - an instance of a plugin, usually `this` in context.
   * @param {String} name - the name of the plugin, passed as a camelCased string.
   * @fires Plugin#init
   */
  registerPlugin: function (plugin, name) {
    var pluginName = name ? hyphenate(name) : functionName(plugin.constructor).toLowerCase();
    plugin.uuid = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__foundation_util_core__["b" /* GetYoDigits */])(6, pluginName);

    if (!plugin.$element.attr('data-' + pluginName)) {
      plugin.$element.attr('data-' + pluginName, plugin.uuid);
    }
    if (!plugin.$element.data('zfPlugin')) {
      plugin.$element.data('zfPlugin', plugin);
    }
    /**
     * Fires when the plugin has initialized.
     * @event Plugin#init
     */
    plugin.$element.trigger('init.zf.' + pluginName);

    this._uuids.push(plugin.uuid);

    return;
  },
  /**
   * @function
   * Removes the plugins uuid from the _uuids array.
   * Removes the zfPlugin data attribute, as well as the data-plugin-name attribute.
   * Also fires the destroyed event for the plugin, consolidating repetitive code.
   * @param {Object} plugin - an instance of a plugin, usually `this` in context.
   * @fires Plugin#destroyed
   */
  unregisterPlugin: function (plugin) {
    var pluginName = hyphenate(functionName(plugin.$element.data('zfPlugin').constructor));

    this._uuids.splice(this._uuids.indexOf(plugin.uuid), 1);
    plugin.$element.removeAttr('data-' + pluginName).removeData('zfPlugin')
    /**
     * Fires when the plugin has been destroyed.
     * @event Plugin#destroyed
     */
    .trigger('destroyed.zf.' + pluginName);
    for (var prop in plugin) {
      plugin[prop] = null; //clean up script to prep for garbage collection.
    }
    return;
  },

  /**
   * @function
   * Causes one or more active plugins to re-initialize, resetting event listeners, recalculating positions, etc.
   * @param {String} plugins - optional string of an individual plugin key, attained by calling `$(element).data('pluginName')`, or string of a plugin class i.e. `'dropdown'`
   * @default If no argument is passed, reflow all currently active plugins.
   */
  reInit: function (plugins) {
    var isJQ = plugins instanceof __WEBPACK_IMPORTED_MODULE_0_jquery___default.a;
    try {
      if (isJQ) {
        plugins.each(function () {
          __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).data('zfPlugin')._init();
        });
      } else {
        var type = typeof plugins,
            _this = this,
            fns = {
          'object': function (plgs) {
            plgs.forEach(function (p) {
              p = hyphenate(p);
              __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-' + p + ']').foundation('_init');
            });
          },
          'string': function () {
            plugins = hyphenate(plugins);
            __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-' + plugins + ']').foundation('_init');
          },
          'undefined': function () {
            this['object'](Object.keys(_this._plugins));
          }
        };
        fns[type](plugins);
      }
    } catch (err) {
      console.error(err);
    } finally {
      return plugins;
    }
  },

  /**
   * Initialize plugins on any elements within `elem` (and `elem` itself) that aren't already initialized.
   * @param {Object} elem - jQuery object containing the element to check inside. Also checks the element itself, unless it's the `document` object.
   * @param {String|Array} plugins - A list of plugins to initialize. Leave this out to initialize everything.
   */
  reflow: function (elem, plugins) {

    // If plugins is undefined, just grab everything
    if (typeof plugins === 'undefined') {
      plugins = Object.keys(this._plugins);
    }
    // If plugins is a string, convert it to an array with one item
    else if (typeof plugins === 'string') {
        plugins = [plugins];
      }

    var _this = this;

    // Iterate through each plugin
    __WEBPACK_IMPORTED_MODULE_0_jquery___default.a.each(plugins, function (i, name) {
      // Get the current plugin
      var plugin = _this._plugins[name];

      // Localize the search to all elements inside elem, as well as elem itself, unless elem === document
      var $elem = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(elem).find('[data-' + name + ']').addBack('[data-' + name + ']');

      // For each plugin found, initialize it
      $elem.each(function () {
        var $el = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this),
            opts = {};
        // Don't double-dip on plugins
        if ($el.data('zfPlugin')) {
          console.warn("Tried to initialize " + name + " on an element that already has a Foundation plugin.");
          return;
        }

        if ($el.attr('data-options')) {
          var thing = $el.attr('data-options').split(';').forEach(function (e, i) {
            var opt = e.split(':').map(function (el) {
              return el.trim();
            });
            if (opt[0]) opts[opt[0]] = parseValue(opt[1]);
          });
        }
        try {
          $el.data('zfPlugin', new plugin(__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this), opts));
        } catch (er) {
          console.error(er);
        } finally {
          return;
        }
      });
    });
  },
  getFnName: functionName,

  addToJquery: function ($) {
    // TODO: consider not making this a jQuery function
    // TODO: need way to reflow vs. re-initialize
    /**
     * The Foundation jQuery method.
     * @param {String|Array} method - An action to perform on the current jQuery object.
     */
    var foundation = function (method) {
      var type = typeof method,
          $noJS = $('.no-js');

      if ($noJS.length) {
        $noJS.removeClass('no-js');
      }

      if (type === 'undefined') {
        //needs to initialize the Foundation object, or an individual plugin.
        __WEBPACK_IMPORTED_MODULE_2__foundation_util_mediaQuery__["a" /* MediaQuery */]._init();
        Foundation.reflow(this);
      } else if (type === 'string') {
        //an individual method to invoke on a plugin or group of plugins
        var args = Array.prototype.slice.call(arguments, 1); //collect all the arguments, if necessary
        var plugClass = this.data('zfPlugin'); //determine the class of plugin

        if (plugClass !== undefined && plugClass[method] !== undefined) {
          //make sure both the class and method exist
          if (this.length === 1) {
            //if there's only one, call it directly.
            plugClass[method].apply(plugClass, args);
          } else {
            this.each(function (i, el) {
              //otherwise loop through the jQuery collection and invoke the method on each
              plugClass[method].apply($(el).data('zfPlugin'), args);
            });
          }
        } else {
          //error for no class or no method
          throw new ReferenceError("We're sorry, '" + method + "' is not an available method for " + (plugClass ? functionName(plugClass) : 'this element') + '.');
        }
      } else {
        //error for invalid argument type
        throw new TypeError('We\'re sorry, ' + type + ' is not a valid parameter. You must use a string representing the method you wish to invoke.');
      }
      return this;
    };
    $.fn.foundation = foundation;
    return $;
  }
};

Foundation.util = {
  /**
   * Function for applying a debounce effect to a function call.
   * @function
   * @param {Function} func - Function to be called at end of timeout.
   * @param {Number} delay - Time in ms to delay the call of `func`.
   * @returns function
   */
  throttle: function (func, delay) {
    var timer = null;

    return function () {
      var context = this,
          args = arguments;

      if (timer === null) {
        timer = setTimeout(function () {
          func.apply(context, args);
          timer = null;
        }, delay);
      }
    };
  }
};

window.Foundation = Foundation;

// Polyfill for requestAnimationFrame
(function () {
  if (!Date.now || !window.Date.now) window.Date.now = Date.now = function () {
    return new Date().getTime();
  };

  var vendors = ['webkit', 'moz'];
  for (var i = 0; i < vendors.length && !window.requestAnimationFrame; ++i) {
    var vp = vendors[i];
    window.requestAnimationFrame = window[vp + 'RequestAnimationFrame'];
    window.cancelAnimationFrame = window[vp + 'CancelAnimationFrame'] || window[vp + 'CancelRequestAnimationFrame'];
  }
  if (/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent) || !window.requestAnimationFrame || !window.cancelAnimationFrame) {
    var lastTime = 0;
    window.requestAnimationFrame = function (callback) {
      var now = Date.now();
      var nextTime = Math.max(lastTime + 16, now);
      return setTimeout(function () {
        callback(lastTime = nextTime);
      }, nextTime - now);
    };
    window.cancelAnimationFrame = clearTimeout;
  }
  /**
   * Polyfill for performance.now, required by rAF
   */
  if (!window.performance || !window.performance.now) {
    window.performance = {
      start: Date.now(),
      now: function () {
        return Date.now() - this.start;
      }
    };
  }
})();
if (!Function.prototype.bind) {
  Function.prototype.bind = function (oThis) {
    if (typeof this !== 'function') {
      // closest thing possible to the ECMAScript 5
      // internal IsCallable function
      throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');
    }

    var aArgs = Array.prototype.slice.call(arguments, 1),
        fToBind = this,
        fNOP = function () {},
        fBound = function () {
      return fToBind.apply(this instanceof fNOP ? this : oThis, aArgs.concat(Array.prototype.slice.call(arguments)));
    };

    if (this.prototype) {
      // native functions don't have a prototype
      fNOP.prototype = this.prototype;
    }
    fBound.prototype = new fNOP();

    return fBound;
  };
}
// Polyfill to get the name of a function in IE9
function functionName(fn) {
  if (Function.prototype.name === undefined) {
    var funcNameRegex = /function\s([^(]{1,})\(/;
    var results = funcNameRegex.exec(fn.toString());
    return results && results.length > 1 ? results[1].trim() : "";
  } else if (fn.prototype === undefined) {
    return fn.constructor.name;
  } else {
    return fn.prototype.constructor.name;
  }
}
function parseValue(str) {
  if ('true' === str) return true;else if ('false' === str) return false;else if (!isNaN(str * 1)) return parseFloat(str);
  return str;
}
// Convert PascalCase to kebab-case
// Thank you: http://stackoverflow.com/a/8955580
function hyphenate(str) {
  return str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
}



/***/ }),
/* 4 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Plugin; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_core__ = __webpack_require__(1);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }




// Abstract class for providing lifecycle hooks. Expect plugins to define AT LEAST
// {function} _setup (replaces previous constructor),
// {function} _destroy (replaces previous destroy)

var Plugin = function () {
  function Plugin(element, options) {
    _classCallCheck(this, Plugin);

    this._setup(element, options);
    var pluginName = getPluginName(this);
    this.uuid = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__foundation_util_core__["b" /* GetYoDigits */])(6, pluginName);

    if (!this.$element.attr('data-' + pluginName)) {
      this.$element.attr('data-' + pluginName, this.uuid);
    }
    if (!this.$element.data('zfPlugin')) {
      this.$element.data('zfPlugin', this);
    }
    /**
     * Fires when the plugin has initialized.
     * @event Plugin#init
     */
    this.$element.trigger('init.zf.' + pluginName);
  }

  _createClass(Plugin, [{
    key: 'destroy',
    value: function destroy() {
      this._destroy();
      var pluginName = getPluginName(this);
      this.$element.removeAttr('data-' + pluginName).removeData('zfPlugin')
      /**
       * Fires when the plugin has been destroyed.
       * @event Plugin#destroyed
       */
      .trigger('destroyed.zf.' + pluginName);
      for (var prop in this) {
        this[prop] = null; //clean up script to prep for garbage collection.
      }
    }
  }]);

  return Plugin;
}();

// Convert PascalCase to kebab-case
// Thank you: http://stackoverflow.com/a/8955580


function hyphenate(str) {
  return str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
}

function getPluginName(obj) {
  if (typeof obj.constructor.name !== 'undefined') {
    return hyphenate(obj.constructor.name);
  } else {
    return hyphenate(obj.className);
  }
}



/***/ }),
/* 5 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MediaQuery; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);




// Default set of media queries
var defaultQueries = {
  'default': 'only screen',
  landscape: 'only screen and (orientation: landscape)',
  portrait: 'only screen and (orientation: portrait)',
  retina: 'only screen and (-webkit-min-device-pixel-ratio: 2),' + 'only screen and (min--moz-device-pixel-ratio: 2),' + 'only screen and (-o-min-device-pixel-ratio: 2/1),' + 'only screen and (min-device-pixel-ratio: 2),' + 'only screen and (min-resolution: 192dpi),' + 'only screen and (min-resolution: 2dppx)'
};

// matchMedia() polyfill - Test a CSS media type/query in JS.
// Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas, David Knight. Dual MIT/BSD license
var matchMedia = window.matchMedia || function () {
  'use strict';

  // For browsers that support matchMedium api such as IE 9 and webkit

  var styleMedia = window.styleMedia || window.media;

  // For those that don't support matchMedium
  if (!styleMedia) {
    var style = document.createElement('style'),
        script = document.getElementsByTagName('script')[0],
        info = null;

    style.type = 'text/css';
    style.id = 'matchmediajs-test';

    script && script.parentNode && script.parentNode.insertBefore(style, script);

    // 'style.currentStyle' is used by IE <= 8 and 'window.getComputedStyle' for all other browsers
    info = 'getComputedStyle' in window && window.getComputedStyle(style, null) || style.currentStyle;

    styleMedia = {
      matchMedium: function (media) {
        var text = '@media ' + media + '{ #matchmediajs-test { width: 1px; } }';

        // 'style.styleSheet' is used by IE <= 8 and 'style.textContent' for all other browsers
        if (style.styleSheet) {
          style.styleSheet.cssText = text;
        } else {
          style.textContent = text;
        }

        // Test if media query is true or false
        return info.width === '1px';
      }
    };
  }

  return function (media) {
    return {
      matches: styleMedia.matchMedium(media || 'all'),
      media: media || 'all'
    };
  };
}();

var MediaQuery = {
  queries: [],

  current: '',

  /**
   * Initializes the media query helper, by extracting the breakpoint list from the CSS and activating the breakpoint watcher.
   * @function
   * @private
   */
  _init: function () {
    var self = this;
    var $meta = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('meta.foundation-mq');
    if (!$meta.length) {
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()('<meta class="foundation-mq">').appendTo(document.head);
    }

    var extractedStyles = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('.foundation-mq').css('font-family');
    var namedQueries;

    namedQueries = parseStyleToObject(extractedStyles);

    for (var key in namedQueries) {
      if (namedQueries.hasOwnProperty(key)) {
        self.queries.push({
          name: key,
          value: 'only screen and (min-width: ' + namedQueries[key] + ')'
        });
      }
    }

    this.current = this._getCurrentSize();

    this._watcher();
  },


  /**
   * Checks if the screen is at least as wide as a breakpoint.
   * @function
   * @param {String} size - Name of the breakpoint to check.
   * @returns {Boolean} `true` if the breakpoint matches, `false` if it's smaller.
   */
  atLeast: function (size) {
    var query = this.get(size);

    if (query) {
      return matchMedia(query).matches;
    }

    return false;
  },


  /**
   * Checks if the screen matches to a breakpoint.
   * @function
   * @param {String} size - Name of the breakpoint to check, either 'small only' or 'small'. Omitting 'only' falls back to using atLeast() method.
   * @returns {Boolean} `true` if the breakpoint matches, `false` if it does not.
   */
  is: function (size) {
    size = size.trim().split(' ');
    if (size.length > 1 && size[1] === 'only') {
      if (size[0] === this._getCurrentSize()) return true;
    } else {
      return this.atLeast(size[0]);
    }
    return false;
  },


  /**
   * Gets the media query of a breakpoint.
   * @function
   * @param {String} size - Name of the breakpoint to get.
   * @returns {String|null} - The media query of the breakpoint, or `null` if the breakpoint doesn't exist.
   */
  get: function (size) {
    for (var i in this.queries) {
      if (this.queries.hasOwnProperty(i)) {
        var query = this.queries[i];
        if (size === query.name) return query.value;
      }
    }

    return null;
  },


  /**
   * Gets the current breakpoint name by testing every breakpoint and returning the last one to match (the biggest one).
   * @function
   * @private
   * @returns {String} Name of the current breakpoint.
   */
  _getCurrentSize: function () {
    var matched;

    for (var i = 0; i < this.queries.length; i++) {
      var query = this.queries[i];

      if (matchMedia(query.value).matches) {
        matched = query;
      }
    }

    if (typeof matched === 'object') {
      return matched.name;
    } else {
      return matched;
    }
  },


  /**
   * Activates the breakpoint watcher, which fires an event on the window whenever the breakpoint changes.
   * @function
   * @private
   */
  _watcher: function () {
    var _this = this;

    __WEBPACK_IMPORTED_MODULE_0_jquery___default()(window).off('resize.zf.mediaquery').on('resize.zf.mediaquery', function () {
      var newSize = _this._getCurrentSize(),
          currentSize = _this.current;

      if (newSize !== currentSize) {
        // Change the current media query
        _this.current = newSize;

        // Broadcast the media query change on the window
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(window).trigger('changed.zf.mediaquery', [newSize, currentSize]);
      }
    });
  }
};

// Thank you: https://github.com/sindresorhus/query-string
function parseStyleToObject(str) {
  var styleObject = {};

  if (typeof str !== 'string') {
    return styleObject;
  }

  str = str.trim().slice(1, -1); // browsers re-quote string style values

  if (!str) {
    return styleObject;
  }

  styleObject = str.split('&').reduce(function (ret, param) {
    var parts = param.replace(/\+/g, ' ').split('=');
    var key = parts[0];
    var val = parts[1];
    key = decodeURIComponent(key);

    // missing `=` should be `null`:
    // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters
    val = val === undefined ? null : decodeURIComponent(val);

    if (!ret.hasOwnProperty(key)) {
      ret[key] = val;
    } else if (Array.isArray(ret[key])) {
      ret[key].push(val);
    } else {
      ret[key] = [ret[key], val];
    }
    return ret;
  }, {});

  return styleObject;
}



/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(2);


/***/ })
/******/ ]);
   /* Ende foundation.core */
   /* Start foundation.util.box */
   /******/ (function(modules) { // webpackBootstrap
/******/   // The module cache
/******/   var installedModules = {};
/******/
/******/   // The require function
/******/   function __webpack_require__(moduleId) {
/******/
/******/     // Check if module is in cache
/******/     if(installedModules[moduleId]) {
/******/       return installedModules[moduleId].exports;
/******/     }
/******/     // Create a new module (and put it into the cache)
/******/     var module = installedModules[moduleId] = {
/******/       i: moduleId,
/******/       l: false,
/******/       exports: {}
/******/     };
/******/
/******/     // Execute the module function
/******/     modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/     // Flag the module as loaded
/******/     module.l = true;
/******/
/******/     // Return the exports of the module
/******/     return module.exports;
/******/   }
/******/
/******/
/******/   // expose the modules object (__webpack_modules__)
/******/   __webpack_require__.m = modules;
/******/
/******/   // expose the module cache
/******/   __webpack_require__.c = installedModules;
/******/
/******/   // identity function for calling harmony imports with the correct context
/******/   __webpack_require__.i = function(value) { return value; };
/******/
/******/   // define getter function for harmony exports
/******/   __webpack_require__.d = function(exports, name, getter) {
/******/     if(!__webpack_require__.o(exports, name)) {
/******/       Object.defineProperty(exports, name, {
/******/         configurable: false,
/******/         enumerable: true,
/******/         get: getter
/******/       });
/******/     }
/******/   };
/******/
/******/   // getDefaultExport function for compatibility with non-harmony modules
/******/   __webpack_require__.n = function(module) {
/******/     var getter = module && module.__esModule ?
/******/       function getDefault() { return module['default']; } :
/******/       function getModuleExports() { return module; };
/******/     __webpack_require__.d(getter, 'a', getter);
/******/     return getter;
/******/   };
/******/
/******/   // Object.prototype.hasOwnProperty.call
/******/   __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/   // __webpack_public_path__
/******/   __webpack_require__.p = "";
/******/
/******/   // Load entry module and return exports
/******/   return __webpack_require__(__webpack_require__.s = 100);
/******/ })
/************************************************************************/
/******/ ({

/***/ 1:
/***/ (function(module, exports) {

module.exports = {Foundation: window.Foundation};

/***/ }),

/***/ 100:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(34);


/***/ }),

/***/ 3:
/***/ (function(module, exports) {

module.exports = {rtl: window.Foundation.rtl, GetYoDigits: window.Foundation.GetYoDigits, transitionend: window.Foundation.transitionend};

/***/ }),

/***/ 34:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__foundation_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_box__ = __webpack_require__(64);



__WEBPACK_IMPORTED_MODULE_0__foundation_core__["Foundation"].Box = __WEBPACK_IMPORTED_MODULE_1__foundation_util_box__["a" /* Box */];

/***/ }),

/***/ 64:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Box; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_util_core__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_util_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__foundation_util_core__);




var Box = {
  ImNotTouchingYou: ImNotTouchingYou,
  OverlapArea: OverlapArea,
  GetDimensions: GetDimensions,
  GetOffsets: GetOffsets,
  GetExplicitOffsets: GetExplicitOffsets

  /**
   * Compares the dimensions of an element to a container and determines collision events with container.
   * @function
   * @param {jQuery} element - jQuery object to test for collisions.
   * @param {jQuery} parent - jQuery object to use as bounding container.
   * @param {Boolean} lrOnly - set to true to check left and right values only.
   * @param {Boolean} tbOnly - set to true to check top and bottom values only.
   * @default if no parent object passed, detects collisions with `window`.
   * @returns {Boolean} - true if collision free, false if a collision in any direction.
   */
};function ImNotTouchingYou(element, parent, lrOnly, tbOnly, ignoreBottom) {
  return OverlapArea(element, parent, lrOnly, tbOnly, ignoreBottom) === 0;
};

function OverlapArea(element, parent, lrOnly, tbOnly, ignoreBottom) {
  var eleDims = GetDimensions(element),
      topOver,
      bottomOver,
      leftOver,
      rightOver;
  if (parent) {
    var parDims = GetDimensions(parent);

    bottomOver = parDims.height + parDims.offset.top - (eleDims.offset.top + eleDims.height);
    topOver = eleDims.offset.top - parDims.offset.top;
    leftOver = eleDims.offset.left - parDims.offset.left;
    rightOver = parDims.width + parDims.offset.left - (eleDims.offset.left + eleDims.width);
  } else {
    bottomOver = eleDims.windowDims.height + eleDims.windowDims.offset.top - (eleDims.offset.top + eleDims.height);
    topOver = eleDims.offset.top - eleDims.windowDims.offset.top;
    leftOver = eleDims.offset.left - eleDims.windowDims.offset.left;
    rightOver = eleDims.windowDims.width - (eleDims.offset.left + eleDims.width);
  }

  bottomOver = ignoreBottom ? 0 : Math.min(bottomOver, 0);
  topOver = Math.min(topOver, 0);
  leftOver = Math.min(leftOver, 0);
  rightOver = Math.min(rightOver, 0);

  if (lrOnly) {
    return leftOver + rightOver;
  }
  if (tbOnly) {
    return topOver + bottomOver;
  }

  // use sum of squares b/c we care about overlap area.
  return Math.sqrt(topOver * topOver + bottomOver * bottomOver + leftOver * leftOver + rightOver * rightOver);
}

/**
 * Uses native methods to return an object of dimension values.
 * @function
 * @param {jQuery || HTML} element - jQuery object or DOM element for which to get the dimensions. Can be any element other that document or window.
 * @returns {Object} - nested object of integer pixel values
 * TODO - if element is window, return only those values.
 */
function GetDimensions(elem) {
  elem = elem.length ? elem[0] : elem;

  if (elem === window || elem === document) {
    throw new Error("I'm sorry, Dave. I'm afraid I can't do that.");
  }

  var rect = elem.getBoundingClientRect(),
      parRect = elem.parentNode.getBoundingClientRect(),
      winRect = document.body.getBoundingClientRect(),
      winY = window.pageYOffset,
      winX = window.pageXOffset;

  return {
    width: rect.width,
    height: rect.height,
    offset: {
      top: rect.top + winY,
      left: rect.left + winX
    },
    parentDims: {
      width: parRect.width,
      height: parRect.height,
      offset: {
        top: parRect.top + winY,
        left: parRect.left + winX
      }
    },
    windowDims: {
      width: winRect.width,
      height: winRect.height,
      offset: {
        top: winY,
        left: winX
      }
    }
  };
}

/**
 * Returns an object of top and left integer pixel values for dynamically rendered elements,
 * such as: Tooltip, Reveal, and Dropdown. Maintained for backwards compatibility, and where
 * you don't know alignment, but generally from
 * 6.4 forward you should use GetExplicitOffsets, as GetOffsets conflates position and alignment.
 * @function
 * @param {jQuery} element - jQuery object for the element being positioned.
 * @param {jQuery} anchor - jQuery object for the element's anchor point.
 * @param {String} position - a string relating to the desired position of the element, relative to it's anchor
 * @param {Number} vOffset - integer pixel value of desired vertical separation between anchor and element.
 * @param {Number} hOffset - integer pixel value of desired horizontal separation between anchor and element.
 * @param {Boolean} isOverflow - if a collision event is detected, sets to true to default the element to full width - any desired offset.
 * TODO alter/rewrite to work with `em` values as well/instead of pixels
 */
function GetOffsets(element, anchor, position, vOffset, hOffset, isOverflow) {
  console.log("NOTE: GetOffsets is deprecated in favor of GetExplicitOffsets and will be removed in 6.5");
  switch (position) {
    case 'top':
      return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__foundation_util_core__["rtl"])() ? GetExplicitOffsets(element, anchor, 'top', 'left', vOffset, hOffset, isOverflow) : GetExplicitOffsets(element, anchor, 'top', 'right', vOffset, hOffset, isOverflow);
    case 'bottom':
      return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__foundation_util_core__["rtl"])() ? GetExplicitOffsets(element, anchor, 'bottom', 'left', vOffset, hOffset, isOverflow) : GetExplicitOffsets(element, anchor, 'bottom', 'right', vOffset, hOffset, isOverflow);
    case 'center top':
      return GetExplicitOffsets(element, anchor, 'top', 'center', vOffset, hOffset, isOverflow);
    case 'center bottom':
      return GetExplicitOffsets(element, anchor, 'bottom', 'center', vOffset, hOffset, isOverflow);
    case 'center left':
      return GetExplicitOffsets(element, anchor, 'left', 'center', vOffset, hOffset, isOverflow);
    case 'center right':
      return GetExplicitOffsets(element, anchor, 'right', 'center', vOffset, hOffset, isOverflow);
    case 'left bottom':
      return GetExplicitOffsets(element, anchor, 'bottom', 'left', vOffset, hOffset, isOverflow);
    case 'right bottom':
      return GetExplicitOffsets(element, anchor, 'bottom', 'right', vOffset, hOffset, isOverflow);
    // Backwards compatibility... this along with the reveal and reveal full
    // classes are the only ones that didn't reference anchor
    case 'center':
      return {
        left: $eleDims.windowDims.offset.left + $eleDims.windowDims.width / 2 - $eleDims.width / 2 + hOffset,
        top: $eleDims.windowDims.offset.top + $eleDims.windowDims.height / 2 - ($eleDims.height / 2 + vOffset)
      };
    case 'reveal':
      return {
        left: ($eleDims.windowDims.width - $eleDims.width) / 2 + hOffset,
        top: $eleDims.windowDims.offset.top + vOffset
      };
    case 'reveal full':
      return {
        left: $eleDims.windowDims.offset.left,
        top: $eleDims.windowDims.offset.top
      };
      break;
    default:
      return {
        left: __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__foundation_util_core__["rtl"])() ? $anchorDims.offset.left - $eleDims.width + $anchorDims.width - hOffset : $anchorDims.offset.left + hOffset,
        top: $anchorDims.offset.top + $anchorDims.height + vOffset
      };

  }
}

function GetExplicitOffsets(element, anchor, position, alignment, vOffset, hOffset, isOverflow) {
  var $eleDims = GetDimensions(element),
      $anchorDims = anchor ? GetDimensions(anchor) : null;

  var topVal, leftVal;

  // set position related attribute

  switch (position) {
    case 'top':
      topVal = $anchorDims.offset.top - ($eleDims.height + vOffset);
      break;
    case 'bottom':
      topVal = $anchorDims.offset.top + $anchorDims.height + vOffset;
      break;
    case 'left':
      leftVal = $anchorDims.offset.left - ($eleDims.width + hOffset);
      break;
    case 'right':
      leftVal = $anchorDims.offset.left + $anchorDims.width + hOffset;
      break;
  }

  // set alignment related attribute
  switch (position) {
    case 'top':
    case 'bottom':
      switch (alignment) {
        case 'left':
          leftVal = $anchorDims.offset.left + hOffset;
          break;
        case 'right':
          leftVal = $anchorDims.offset.left - $eleDims.width + $anchorDims.width - hOffset;
          break;
        case 'center':
          leftVal = isOverflow ? hOffset : $anchorDims.offset.left + $anchorDims.width / 2 - $eleDims.width / 2 + hOffset;
          break;
      }
      break;
    case 'right':
    case 'left':
      switch (alignment) {
        case 'bottom':
          topVal = $anchorDims.offset.top - vOffset + $anchorDims.height - $eleDims.height;
          break;
        case 'top':
          topVal = $anchorDims.offset.top + vOffset;
          break;
        case 'center':
          topVal = $anchorDims.offset.top + vOffset + $anchorDims.height / 2 - $eleDims.height / 2;
          break;
      }
      break;
  }
  return { top: topVal, left: leftVal };
}



/***/ })

/******/ });
   /* Ende foundation.util.box */
   /* Start foundation.util.imageLoader */
   /******/ (function(modules) { // webpackBootstrap
/******/   // The module cache
/******/   var installedModules = {};
/******/
/******/   // The require function
/******/   function __webpack_require__(moduleId) {
/******/
/******/     // Check if module is in cache
/******/     if(installedModules[moduleId]) {
/******/       return installedModules[moduleId].exports;
/******/     }
/******/     // Create a new module (and put it into the cache)
/******/     var module = installedModules[moduleId] = {
/******/       i: moduleId,
/******/       l: false,
/******/       exports: {}
/******/     };
/******/
/******/     // Execute the module function
/******/     modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/     // Flag the module as loaded
/******/     module.l = true;
/******/
/******/     // Return the exports of the module
/******/     return module.exports;
/******/   }
/******/
/******/
/******/   // expose the modules object (__webpack_modules__)
/******/   __webpack_require__.m = modules;
/******/
/******/   // expose the module cache
/******/   __webpack_require__.c = installedModules;
/******/
/******/   // identity function for calling harmony imports with the correct context
/******/   __webpack_require__.i = function(value) { return value; };
/******/
/******/   // define getter function for harmony exports
/******/   __webpack_require__.d = function(exports, name, getter) {
/******/     if(!__webpack_require__.o(exports, name)) {
/******/       Object.defineProperty(exports, name, {
/******/         configurable: false,
/******/         enumerable: true,
/******/         get: getter
/******/       });
/******/     }
/******/   };
/******/
/******/   // getDefaultExport function for compatibility with non-harmony modules
/******/   __webpack_require__.n = function(module) {
/******/     var getter = module && module.__esModule ?
/******/       function getDefault() { return module['default']; } :
/******/       function getModuleExports() { return module; };
/******/     __webpack_require__.d(getter, 'a', getter);
/******/     return getter;
/******/   };
/******/
/******/   // Object.prototype.hasOwnProperty.call
/******/   __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/   // __webpack_public_path__
/******/   __webpack_require__.p = "";
/******/
/******/   // Load entry module and return exports
/******/   return __webpack_require__(__webpack_require__.s = 101);
/******/ })
/************************************************************************/
/******/ ({

/***/ 0:
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ 1:
/***/ (function(module, exports) {

module.exports = {Foundation: window.Foundation};

/***/ }),

/***/ 101:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(35);


/***/ }),

/***/ 35:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__foundation_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_imageLoader__ = __webpack_require__(65);




__WEBPACK_IMPORTED_MODULE_0__foundation_core__["Foundation"].onImagesLoaded = __WEBPACK_IMPORTED_MODULE_1__foundation_util_imageLoader__["a" /* onImagesLoaded */];

/***/ }),

/***/ 65:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return onImagesLoaded; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);




/**
 * Runs a callback function when images are fully loaded.
 * @param {Object} images - Image(s) to check if loaded.
 * @param {Func} callback - Function to execute when image is fully loaded.
 */
function onImagesLoaded(images, callback) {
  var self = this,
      unloaded = images.length;

  if (unloaded === 0) {
    callback();
  }

  images.each(function () {
    // Check if image is loaded
    if (this.complete && this.naturalWidth !== undefined) {
      singleImageLoaded();
    } else {
      // If the above check failed, simulate loading on detached element.
      var image = new Image();
      // Still count image as loaded if it finalizes with an error.
      var events = "load.zf.images error.zf.images";
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()(image).one(events, function me(event) {
        // Unbind the event listeners. We're using 'one' but only one of the two events will have fired.
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).off(events, me);
        singleImageLoaded();
      });
      image.src = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).attr('src');
    }
  });

  function singleImageLoaded() {
    unloaded--;
    if (unloaded === 0) {
      callback();
    }
  }
}



/***/ })

/******/ });
   /* Ende foundation.util.imageLoader */
   /* Start foundation.util.mediaQuery */
   /******/ (function(modules) { // webpackBootstrap
/******/   // The module cache
/******/   var installedModules = {};
/******/
/******/   // The require function
/******/   function __webpack_require__(moduleId) {
/******/
/******/     // Check if module is in cache
/******/     if(installedModules[moduleId]) {
/******/       return installedModules[moduleId].exports;
/******/     }
/******/     // Create a new module (and put it into the cache)
/******/     var module = installedModules[moduleId] = {
/******/       i: moduleId,
/******/       l: false,
/******/       exports: {}
/******/     };
/******/
/******/     // Execute the module function
/******/     modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/     // Flag the module as loaded
/******/     module.l = true;
/******/
/******/     // Return the exports of the module
/******/     return module.exports;
/******/   }
/******/
/******/
/******/   // expose the modules object (__webpack_modules__)
/******/   __webpack_require__.m = modules;
/******/
/******/   // expose the module cache
/******/   __webpack_require__.c = installedModules;
/******/
/******/   // identity function for calling harmony imports with the correct context
/******/   __webpack_require__.i = function(value) { return value; };
/******/
/******/   // define getter function for harmony exports
/******/   __webpack_require__.d = function(exports, name, getter) {
/******/     if(!__webpack_require__.o(exports, name)) {
/******/       Object.defineProperty(exports, name, {
/******/         configurable: false,
/******/         enumerable: true,
/******/         get: getter
/******/       });
/******/     }
/******/   };
/******/
/******/   // getDefaultExport function for compatibility with non-harmony modules
/******/   __webpack_require__.n = function(module) {
/******/     var getter = module && module.__esModule ?
/******/       function getDefault() { return module['default']; } :
/******/       function getModuleExports() { return module; };
/******/     __webpack_require__.d(getter, 'a', getter);
/******/     return getter;
/******/   };
/******/
/******/   // Object.prototype.hasOwnProperty.call
/******/   __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/   // __webpack_public_path__
/******/   __webpack_require__.p = "";
/******/
/******/   // Load entry module and return exports
/******/   return __webpack_require__(__webpack_require__.s = 103);
/******/ })
/************************************************************************/
/******/ ({

/***/ 0:
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ 1:
/***/ (function(module, exports) {

module.exports = {Foundation: window.Foundation};

/***/ }),

/***/ 103:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(37);


/***/ }),

/***/ 37:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__foundation_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_mediaQuery__ = __webpack_require__(67);



__WEBPACK_IMPORTED_MODULE_0__foundation_core__["Foundation"].MediaQuery = __WEBPACK_IMPORTED_MODULE_1__foundation_util_mediaQuery__["a" /* MediaQuery */];
__WEBPACK_IMPORTED_MODULE_0__foundation_core__["Foundation"].MediaQuery._init();

/***/ }),

/***/ 67:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MediaQuery; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);




// Default set of media queries
var defaultQueries = {
  'default': 'only screen',
  landscape: 'only screen and (orientation: landscape)',
  portrait: 'only screen and (orientation: portrait)',
  retina: 'only screen and (-webkit-min-device-pixel-ratio: 2),' + 'only screen and (min--moz-device-pixel-ratio: 2),' + 'only screen and (-o-min-device-pixel-ratio: 2/1),' + 'only screen and (min-device-pixel-ratio: 2),' + 'only screen and (min-resolution: 192dpi),' + 'only screen and (min-resolution: 2dppx)'
};

// matchMedia() polyfill - Test a CSS media type/query in JS.
// Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas, David Knight. Dual MIT/BSD license
var matchMedia = window.matchMedia || function () {
  'use strict';

  // For browsers that support matchMedium api such as IE 9 and webkit

  var styleMedia = window.styleMedia || window.media;

  // For those that don't support matchMedium
  if (!styleMedia) {
    var style = document.createElement('style'),
        script = document.getElementsByTagName('script')[0],
        info = null;

    style.type = 'text/css';
    style.id = 'matchmediajs-test';

    script && script.parentNode && script.parentNode.insertBefore(style, script);

    // 'style.currentStyle' is used by IE <= 8 and 'window.getComputedStyle' for all other browsers
    info = 'getComputedStyle' in window && window.getComputedStyle(style, null) || style.currentStyle;

    styleMedia = {
      matchMedium: function (media) {
        var text = '@media ' + media + '{ #matchmediajs-test { width: 1px; } }';

        // 'style.styleSheet' is used by IE <= 8 and 'style.textContent' for all other browsers
        if (style.styleSheet) {
          style.styleSheet.cssText = text;
        } else {
          style.textContent = text;
        }

        // Test if media query is true or false
        return info.width === '1px';
      }
    };
  }

  return function (media) {
    return {
      matches: styleMedia.matchMedium(media || 'all'),
      media: media || 'all'
    };
  };
}();

var MediaQuery = {
  queries: [],

  current: '',

  /**
   * Initializes the media query helper, by extracting the breakpoint list from the CSS and activating the breakpoint watcher.
   * @function
   * @private
   */
  _init: function () {
    var self = this;
    var $meta = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('meta.foundation-mq');
    if (!$meta.length) {
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()('<meta class="foundation-mq">').appendTo(document.head);
    }

    var extractedStyles = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('.foundation-mq').css('font-family');
    var namedQueries;

    namedQueries = parseStyleToObject(extractedStyles);

    for (var key in namedQueries) {
      if (namedQueries.hasOwnProperty(key)) {
        self.queries.push({
          name: key,
          value: 'only screen and (min-width: ' + namedQueries[key] + ')'
        });
      }
    }

    this.current = this._getCurrentSize();

    this._watcher();
  },


  /**
   * Checks if the screen is at least as wide as a breakpoint.
   * @function
   * @param {String} size - Name of the breakpoint to check.
   * @returns {Boolean} `true` if the breakpoint matches, `false` if it's smaller.
   */
  atLeast: function (size) {
    var query = this.get(size);

    if (query) {
      return matchMedia(query).matches;
    }

    return false;
  },


  /**
   * Checks if the screen matches to a breakpoint.
   * @function
   * @param {String} size - Name of the breakpoint to check, either 'small only' or 'small'. Omitting 'only' falls back to using atLeast() method.
   * @returns {Boolean} `true` if the breakpoint matches, `false` if it does not.
   */
  is: function (size) {
    size = size.trim().split(' ');
    if (size.length > 1 && size[1] === 'only') {
      if (size[0] === this._getCurrentSize()) return true;
    } else {
      return this.atLeast(size[0]);
    }
    return false;
  },


  /**
   * Gets the media query of a breakpoint.
   * @function
   * @param {String} size - Name of the breakpoint to get.
   * @returns {String|null} - The media query of the breakpoint, or `null` if the breakpoint doesn't exist.
   */
  get: function (size) {
    for (var i in this.queries) {
      if (this.queries.hasOwnProperty(i)) {
        var query = this.queries[i];
        if (size === query.name) return query.value;
      }
    }

    return null;
  },


  /**
   * Gets the current breakpoint name by testing every breakpoint and returning the last one to match (the biggest one).
   * @function
   * @private
   * @returns {String} Name of the current breakpoint.
   */
  _getCurrentSize: function () {
    var matched;

    for (var i = 0; i < this.queries.length; i++) {
      var query = this.queries[i];

      if (matchMedia(query.value).matches) {
        matched = query;
      }
    }

    if (typeof matched === 'object') {
      return matched.name;
    } else {
      return matched;
    }
  },


  /**
   * Activates the breakpoint watcher, which fires an event on the window whenever the breakpoint changes.
   * @function
   * @private
   */
  _watcher: function () {
    var _this = this;

    __WEBPACK_IMPORTED_MODULE_0_jquery___default()(window).off('resize.zf.mediaquery').on('resize.zf.mediaquery', function () {
      var newSize = _this._getCurrentSize(),
          currentSize = _this.current;

      if (newSize !== currentSize) {
        // Change the current media query
        _this.current = newSize;

        // Broadcast the media query change on the window
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(window).trigger('changed.zf.mediaquery', [newSize, currentSize]);
      }
    });
  }
};

// Thank you: https://github.com/sindresorhus/query-string
function parseStyleToObject(str) {
  var styleObject = {};

  if (typeof str !== 'string') {
    return styleObject;
  }

  str = str.trim().slice(1, -1); // browsers re-quote string style values

  if (!str) {
    return styleObject;
  }

  styleObject = str.split('&').reduce(function (ret, param) {
    var parts = param.replace(/\+/g, ' ').split('=');
    var key = parts[0];
    var val = parts[1];
    key = decodeURIComponent(key);

    // missing `=` should be `null`:
    // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters
    val = val === undefined ? null : decodeURIComponent(val);

    if (!ret.hasOwnProperty(key)) {
      ret[key] = val;
    } else if (Array.isArray(ret[key])) {
      ret[key].push(val);
    } else {
      ret[key] = [ret[key], val];
    }
    return ret;
  }, {});

  return styleObject;
}



/***/ })

/******/ });
   /* Ende foundation.util.mediaQuery */
   /* Start foundation.util.triggers */
   /******/ (function(modules) { // webpackBootstrap
/******/   // The module cache
/******/   var installedModules = {};
/******/
/******/   // The require function
/******/   function __webpack_require__(moduleId) {
/******/
/******/     // Check if module is in cache
/******/     if(installedModules[moduleId]) {
/******/       return installedModules[moduleId].exports;
/******/     }
/******/     // Create a new module (and put it into the cache)
/******/     var module = installedModules[moduleId] = {
/******/       i: moduleId,
/******/       l: false,
/******/       exports: {}
/******/     };
/******/
/******/     // Execute the module function
/******/     modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/     // Flag the module as loaded
/******/     module.l = true;
/******/
/******/     // Return the exports of the module
/******/     return module.exports;
/******/   }
/******/
/******/
/******/   // expose the modules object (__webpack_modules__)
/******/   __webpack_require__.m = modules;
/******/
/******/   // expose the module cache
/******/   __webpack_require__.c = installedModules;
/******/
/******/   // identity function for calling harmony imports with the correct context
/******/   __webpack_require__.i = function(value) { return value; };
/******/
/******/   // define getter function for harmony exports
/******/   __webpack_require__.d = function(exports, name, getter) {
/******/     if(!__webpack_require__.o(exports, name)) {
/******/       Object.defineProperty(exports, name, {
/******/         configurable: false,
/******/         enumerable: true,
/******/         get: getter
/******/       });
/******/     }
/******/   };
/******/
/******/   // getDefaultExport function for compatibility with non-harmony modules
/******/   __webpack_require__.n = function(module) {
/******/     var getter = module && module.__esModule ?
/******/       function getDefault() { return module['default']; } :
/******/       function getModuleExports() { return module; };
/******/     __webpack_require__.d(getter, 'a', getter);
/******/     return getter;
/******/   };
/******/
/******/   // Object.prototype.hasOwnProperty.call
/******/   __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/   // __webpack_public_path__
/******/   __webpack_require__.p = "";
/******/
/******/   // Load entry module and return exports
/******/   return __webpack_require__(__webpack_require__.s = 108);
/******/ })
/************************************************************************/
/******/ ({

/***/ 0:
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ 1:
/***/ (function(module, exports) {

module.exports = {Foundation: window.Foundation};

/***/ }),

/***/ 108:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(42);


/***/ }),

/***/ 4:
/***/ (function(module, exports) {

module.exports = {Motion: window.Foundation.Motion, Move: window.Foundation.Move};

/***/ }),

/***/ 42:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__foundation_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__foundation_util_triggers__ = __webpack_require__(7);




__WEBPACK_IMPORTED_MODULE_2__foundation_util_triggers__["a" /* Triggers */].init(__WEBPACK_IMPORTED_MODULE_1_jquery___default.a, __WEBPACK_IMPORTED_MODULE_0__foundation_core__["Foundation"]);

/***/ }),

/***/ 7:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Triggers; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_motion__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_motion___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__foundation_util_motion__);





var MutationObserver = function () {
  var prefixes = ['WebKit', 'Moz', 'O', 'Ms', ''];
  for (var i = 0; i < prefixes.length; i++) {
    if (prefixes[i] + 'MutationObserver' in window) {
      return window[prefixes[i] + 'MutationObserver'];
    }
  }
  return false;
}();

var triggers = function (el, type) {
  el.data(type).split(' ').forEach(function (id) {
    __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#' + id)[type === 'close' ? 'trigger' : 'triggerHandler'](type + '.zf.trigger', [el]);
  });
};

var Triggers = {
  Listeners: {
    Basic: {},
    Global: {}
  },
  Initializers: {}
};

Triggers.Listeners.Basic = {
  openListener: function () {
    triggers(__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this), 'open');
  },
  closeListener: function () {
    var id = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).data('close');
    if (id) {
      triggers(__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this), 'close');
    } else {
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).trigger('close.zf.trigger');
    }
  },
  toggleListener: function () {
    var id = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).data('toggle');
    if (id) {
      triggers(__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this), 'toggle');
    } else {
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).trigger('toggle.zf.trigger');
    }
  },
  closeableListener: function (e) {
    e.stopPropagation();
    var animation = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).data('closable');

    if (animation !== '') {
      __WEBPACK_IMPORTED_MODULE_1__foundation_util_motion__["Motion"].animateOut(__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this), animation, function () {
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).trigger('closed.zf');
      });
    } else {
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).fadeOut().trigger('closed.zf');
    }
  },
  toggleFocusListener: function () {
    var id = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).data('toggle-focus');
    __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#' + id).triggerHandler('toggle.zf.trigger', [__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this)]);
  }
};

// Elements with [data-open] will reveal a plugin that supports it when clicked.
Triggers.Initializers.addOpenListener = function ($elem) {
  $elem.off('click.zf.trigger', Triggers.Listeners.Basic.openListener);
  $elem.on('click.zf.trigger', '[data-open]', Triggers.Listeners.Basic.openListener);
};

// Elements with [data-close] will close a plugin that supports it when clicked.
// If used without a value on [data-close], the event will bubble, allowing it to close a parent component.
Triggers.Initializers.addCloseListener = function ($elem) {
  $elem.off('click.zf.trigger', Triggers.Listeners.Basic.closeListener);
  $elem.on('click.zf.trigger', '[data-close]', Triggers.Listeners.Basic.closeListener);
};

// Elements with [data-toggle] will toggle a plugin that supports it when clicked.
Triggers.Initializers.addToggleListener = function ($elem) {
  $elem.off('click.zf.trigger', Triggers.Listeners.Basic.toggleListener);
  $elem.on('click.zf.trigger', '[data-toggle]', Triggers.Listeners.Basic.toggleListener);
};

// Elements with [data-closable] will respond to close.zf.trigger events.
Triggers.Initializers.addCloseableListener = function ($elem) {
  $elem.off('close.zf.trigger', Triggers.Listeners.Basic.closeableListener);
  $elem.on('close.zf.trigger', '[data-closeable], [data-closable]', Triggers.Listeners.Basic.closeableListener);
};

// Elements with [data-toggle-focus] will respond to coming in and out of focus
Triggers.Initializers.addToggleFocusListener = function ($elem) {
  $elem.off('focus.zf.trigger blur.zf.trigger', Triggers.Listeners.Basic.toggleFocusListener);
  $elem.on('focus.zf.trigger blur.zf.trigger', '[data-toggle-focus]', Triggers.Listeners.Basic.toggleFocusListener);
};

// More Global/complex listeners and triggers
Triggers.Listeners.Global = {
  resizeListener: function ($nodes) {
    if (!MutationObserver) {
      //fallback for IE 9
      $nodes.each(function () {
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).triggerHandler('resizeme.zf.trigger');
      });
    }
    //trigger all listening elements and signal a resize event
    $nodes.attr('data-events', "resize");
  },
  scrollListener: function ($nodes) {
    if (!MutationObserver) {
      //fallback for IE 9
      $nodes.each(function () {
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).triggerHandler('scrollme.zf.trigger');
      });
    }
    //trigger all listening elements and signal a scroll event
    $nodes.attr('data-events', "scroll");
  },
  closeMeListener: function (e, pluginId) {
    var plugin = e.namespace.split('.')[0];
    var plugins = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-' + plugin + ']').not('[data-yeti-box="' + pluginId + '"]');

    plugins.each(function () {
      var _this = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this);
      _this.triggerHandler('close.zf.trigger', [_this]);
    });
  }

  // Global, parses whole document.
};Triggers.Initializers.addClosemeListener = function (pluginName) {
  var yetiBoxes = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-yeti-box]'),
      plugNames = ['dropdown', 'tooltip', 'reveal'];

  if (pluginName) {
    if (typeof pluginName === 'string') {
      plugNames.push(pluginName);
    } else if (typeof pluginName === 'object' && typeof pluginName[0] === 'string') {
      plugNames.concat(pluginName);
    } else {
      console.error('Plugin names must be strings');
    }
  }
  if (yetiBoxes.length) {
    var listeners = plugNames.map(function (name) {
      return 'closeme.zf.' + name;
    }).join(' ');

    __WEBPACK_IMPORTED_MODULE_0_jquery___default()(window).off(listeners).on(listeners, Triggers.Listeners.Global.closeMeListener);
  }
};

function debounceGlobalListener(debounce, trigger, listener) {
  var timer = void 0,
      args = Array.prototype.slice.call(arguments, 3);
  __WEBPACK_IMPORTED_MODULE_0_jquery___default()(window).off(trigger).on(trigger, function (e) {
    if (timer) {
      clearTimeout(timer);
    }
    timer = setTimeout(function () {
      listener.apply(null, args);
    }, debounce || 10); //default time to emit scroll event
  });
}

Triggers.Initializers.addResizeListener = function (debounce) {
  var $nodes = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-resize]');
  if ($nodes.length) {
    debounceGlobalListener(debounce, 'resize.zf.trigger', Triggers.Listeners.Global.resizeListener, $nodes);
  }
};

Triggers.Initializers.addScrollListener = function (debounce) {
  var $nodes = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-scroll]');
  if ($nodes.length) {
    debounceGlobalListener(debounce, 'scroll.zf.trigger', Triggers.Listeners.Global.scrollListener, $nodes);
  }
};

Triggers.Initializers.addMutationEventsListener = function ($elem) {
  if (!MutationObserver) {
    return false;
  }
  var $nodes = $elem.find('[data-resize], [data-scroll], [data-mutate]');

  //element callback
  var listeningElementsMutation = function (mutationRecordsList) {
    var $target = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(mutationRecordsList[0].target);

    //trigger the event handler for the element depending on type
    switch (mutationRecordsList[0].type) {
      case "attributes":
        if ($target.attr("data-events") === "scroll" && mutationRecordsList[0].attributeName === "data-events") {
          $target.triggerHandler('scrollme.zf.trigger', [$target, window.pageYOffset]);
        }
        if ($target.attr("data-events") === "resize" && mutationRecordsList[0].attributeName === "data-events") {
          $target.triggerHandler('resizeme.zf.trigger', [$target]);
        }
        if (mutationRecordsList[0].attributeName === "style") {
          $target.closest("[data-mutate]").attr("data-events", "mutate");
          $target.closest("[data-mutate]").triggerHandler('mutateme.zf.trigger', [$target.closest("[data-mutate]")]);
        }
        break;

      case "childList":
        $target.closest("[data-mutate]").attr("data-events", "mutate");
        $target.closest("[data-mutate]").triggerHandler('mutateme.zf.trigger', [$target.closest("[data-mutate]")]);
        break;

      default:
        return false;
      //nothing
    }
  };

  if ($nodes.length) {
    //for each element that needs to listen for resizing, scrolling, or mutation add a single observer
    for (var i = 0; i <= $nodes.length - 1; i++) {
      var elementObserver = new MutationObserver(listeningElementsMutation);
      elementObserver.observe($nodes[i], { attributes: true, childList: true, characterData: false, subtree: true, attributeFilter: ["data-events", "style"] });
    }
  }
};

Triggers.Initializers.addSimpleListeners = function () {
  var $document = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(document);

  Triggers.Initializers.addOpenListener($document);
  Triggers.Initializers.addCloseListener($document);
  Triggers.Initializers.addToggleListener($document);
  Triggers.Initializers.addCloseableListener($document);
  Triggers.Initializers.addToggleFocusListener($document);
};

Triggers.Initializers.addGlobalListeners = function () {
  var $document = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(document);
  Triggers.Initializers.addMutationEventsListener($document);
  Triggers.Initializers.addResizeListener();
  Triggers.Initializers.addScrollListener();
  Triggers.Initializers.addClosemeListener();
};

Triggers.init = function ($, Foundation) {
  if (typeof $.triggersInitialized === 'undefined') {
    var $document = $(document);

    if (document.readyState === "complete") {
      Triggers.Initializers.addSimpleListeners();
      Triggers.Initializers.addGlobalListeners();
    } else {
      $(window).on('load', function () {
        Triggers.Initializers.addSimpleListeners();
        Triggers.Initializers.addGlobalListeners();
      });
    }

    $.triggersInitialized = true;
  }

  if (Foundation) {
    Foundation.Triggers = Triggers;
    // Legacy included to be backwards compatible for now.
    Foundation.IHearYou = Triggers.Initializers.addGlobalListeners;
  }
};



/***/ })

/******/ });
   /* Ende foundation.util.triggers */
   /* Start foundation.tooltip */
   /******/ (function(modules) { // webpackBootstrap
/******/   // The module cache
/******/   var installedModules = {};
/******/
/******/   // The require function
/******/   function __webpack_require__(moduleId) {
/******/
/******/     // Check if module is in cache
/******/     if(installedModules[moduleId]) {
/******/       return installedModules[moduleId].exports;
/******/     }
/******/     // Create a new module (and put it into the cache)
/******/     var module = installedModules[moduleId] = {
/******/       i: moduleId,
/******/       l: false,
/******/       exports: {}
/******/     };
/******/
/******/     // Execute the module function
/******/     modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/     // Flag the module as loaded
/******/     module.l = true;
/******/
/******/     // Return the exports of the module
/******/     return module.exports;
/******/   }
/******/
/******/
/******/   // expose the modules object (__webpack_modules__)
/******/   __webpack_require__.m = modules;
/******/
/******/   // expose the module cache
/******/   __webpack_require__.c = installedModules;
/******/
/******/   // identity function for calling harmony imports with the correct context
/******/   __webpack_require__.i = function(value) { return value; };
/******/
/******/   // define getter function for harmony exports
/******/   __webpack_require__.d = function(exports, name, getter) {
/******/     if(!__webpack_require__.o(exports, name)) {
/******/       Object.defineProperty(exports, name, {
/******/         configurable: false,
/******/         enumerable: true,
/******/         get: getter
/******/       });
/******/     }
/******/   };
/******/
/******/   // getDefaultExport function for compatibility with non-harmony modules
/******/   __webpack_require__.n = function(module) {
/******/     var getter = module && module.__esModule ?
/******/       function getDefault() { return module['default']; } :
/******/       function getModuleExports() { return module; };
/******/     __webpack_require__.d(getter, 'a', getter);
/******/     return getter;
/******/   };
/******/
/******/   // Object.prototype.hasOwnProperty.call
/******/   __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/   // __webpack_public_path__
/******/   __webpack_require__.p = "";
/******/
/******/   // Load entry module and return exports
/******/   return __webpack_require__(__webpack_require__.s = 99);
/******/ })
/************************************************************************/
/******/ ({

/***/ 0:
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ 1:
/***/ (function(module, exports) {

module.exports = {Foundation: window.Foundation};

/***/ }),

/***/ 11:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Positionable; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_util_box__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_util_box___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__foundation_util_box__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_plugin__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_plugin___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__foundation_plugin__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__foundation_util_core__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__foundation_util_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__foundation_util_core__);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }





var POSITIONS = ['left', 'right', 'top', 'bottom'];
var VERTICAL_ALIGNMENTS = ['top', 'bottom', 'center'];
var HORIZONTAL_ALIGNMENTS = ['left', 'right', 'center'];

var ALIGNMENTS = {
  'left': VERTICAL_ALIGNMENTS,
  'right': VERTICAL_ALIGNMENTS,
  'top': HORIZONTAL_ALIGNMENTS,
  'bottom': HORIZONTAL_ALIGNMENTS
};

function nextItem(item, array) {
  var currentIdx = array.indexOf(item);
  if (currentIdx === array.length - 1) {
    return array[0];
  } else {
    return array[currentIdx + 1];
  }
}

var Positionable = function (_Plugin) {
  _inherits(Positionable, _Plugin);

  function Positionable() {
    _classCallCheck(this, Positionable);

    return _possibleConstructorReturn(this, (Positionable.__proto__ || Object.getPrototypeOf(Positionable)).apply(this, arguments));
  }

  _createClass(Positionable, [{
    key: '_init',

    /**
     * Abstract class encapsulating the tether-like explicit positioning logic
     * including repositioning based on overlap.
     * Expects classes to define defaults for vOffset, hOffset, position,
     * alignment, allowOverlap, and allowBottomOverlap. They can do this by
     * extending the defaults, or (for now recommended due to the way docs are
     * generated) by explicitly declaring them.
     *
     **/

    value: function _init() {
      this.triedPositions = {};
      this.position = this.options.position === 'auto' ? this._getDefaultPosition() : this.options.position;
      this.alignment = this.options.alignment === 'auto' ? this._getDefaultAlignment() : this.options.alignment;
    }
  }, {
    key: '_getDefaultPosition',
    value: function _getDefaultPosition() {
      return 'bottom';
    }
  }, {
    key: '_getDefaultAlignment',
    value: function _getDefaultAlignment() {
      switch (this.position) {
        case 'bottom':
        case 'top':
          return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2__foundation_util_core__["rtl"])() ? 'right' : 'left';
        case 'left':
        case 'right':
          return 'bottom';
      }
    }

    /**
     * Adjusts the positionable possible positions by iterating through alignments
     * and positions.
     * @function
     * @private
     */

  }, {
    key: '_reposition',
    value: function _reposition() {
      if (this._alignmentsExhausted(this.position)) {
        this.position = nextItem(this.position, POSITIONS);
        this.alignment = ALIGNMENTS[this.position][0];
      } else {
        this._realign();
      }
    }

    /**
     * Adjusts the dropdown pane possible positions by iterating through alignments
     * on the current position.
     * @function
     * @private
     */

  }, {
    key: '_realign',
    value: function _realign() {
      this._addTriedPosition(this.position, this.alignment);
      this.alignment = nextItem(this.alignment, ALIGNMENTS[this.position]);
    }
  }, {
    key: '_addTriedPosition',
    value: function _addTriedPosition(position, alignment) {
      this.triedPositions[position] = this.triedPositions[position] || [];
      this.triedPositions[position].push(alignment);
    }
  }, {
    key: '_positionsExhausted',
    value: function _positionsExhausted() {
      var isExhausted = true;
      for (var i = 0; i < POSITIONS.length; i++) {
        isExhausted = isExhausted && this._alignmentsExhausted(POSITIONS[i]);
      }
      return isExhausted;
    }
  }, {
    key: '_alignmentsExhausted',
    value: function _alignmentsExhausted(position) {
      return this.triedPositions[position] && this.triedPositions[position].length == ALIGNMENTS[position].length;
    }

    // When we're trying to center, we don't want to apply offset that's going to
    // take us just off center, so wrap around to return 0 for the appropriate
    // offset in those alignments.  TODO: Figure out if we want to make this
    // configurable behavior... it feels more intuitive, especially for tooltips, but
    // it's possible someone might actually want to start from center and then nudge
    // slightly off.

  }, {
    key: '_getVOffset',
    value: function _getVOffset() {
      return this.options.vOffset;
    }
  }, {
    key: '_getHOffset',
    value: function _getHOffset() {
      return this.options.hOffset;
    }
  }, {
    key: '_setPosition',
    value: function _setPosition($anchor, $element, $parent) {
      if ($anchor.attr('aria-expanded') === 'false') {
        return false;
      }
      var $eleDims = __WEBPACK_IMPORTED_MODULE_0__foundation_util_box__["Box"].GetDimensions($element),
          $anchorDims = __WEBPACK_IMPORTED_MODULE_0__foundation_util_box__["Box"].GetDimensions($anchor);

      $element.offset(__WEBPACK_IMPORTED_MODULE_0__foundation_util_box__["Box"].GetExplicitOffsets($element, $anchor, this.position, this.alignment, this._getVOffset(), this._getHOffset()));

      if (!this.options.allowOverlap) {
        var overlaps = {};
        var minOverlap = 100000000;
        // default coordinates to how we start, in case we can't figure out better
        var minCoordinates = { position: this.position, alignment: this.alignment };
        while (!this._positionsExhausted()) {
          var overlap = __WEBPACK_IMPORTED_MODULE_0__foundation_util_box__["Box"].OverlapArea($element, $parent, false, false, this.options.allowBottomOverlap);
          if (overlap === 0) {
            return;
          }

          if (overlap < minOverlap) {
            minOverlap = overlap;
            minCoordinates = { position: this.position, alignment: this.alignment };
          }

          this._reposition();

          $element.offset(__WEBPACK_IMPORTED_MODULE_0__foundation_util_box__["Box"].GetExplicitOffsets($element, $anchor, this.position, this.alignment, this._getVOffset(), this._getHOffset()));
        }
        // If we get through the entire loop, there was no non-overlapping
        // position available. Pick the version with least overlap.
        this.position = minCoordinates.position;
        this.alignment = minCoordinates.alignment;
        $element.offset(__WEBPACK_IMPORTED_MODULE_0__foundation_util_box__["Box"].GetExplicitOffsets($element, $anchor, this.position, this.alignment, this._getVOffset(), this._getHOffset()));
      }
    }
  }]);

  return Positionable;
}(__WEBPACK_IMPORTED_MODULE_1__foundation_plugin__["Plugin"]);

Positionable.defaults = {
  /**
   * Position of positionable relative to anchor. Can be left, right, bottom, top, or auto.
   * @option
   * @type {string}
   * @default 'auto'
   */
  position: 'auto',
  /**
   * Alignment of positionable relative to anchor. Can be left, right, bottom, top, center, or auto.
   * @option
   * @type {string}
   * @default 'auto'
   */
  alignment: 'auto',
  /**
   * Allow overlap of container/window. If false, dropdown positionable first
   * try to position as defined by data-position and data-alignment, but
   * reposition if it would cause an overflow.
   * @option
   * @type {boolean}
   * @default false
   */
  allowOverlap: false,
  /**
   * Allow overlap of only the bottom of the container. This is the most common
   * behavior for dropdowns, allowing the dropdown to extend the bottom of the
   * screen but not otherwise influence or break out of the container.
   * @option
   * @type {boolean}
   * @default true
   */
  allowBottomOverlap: true,
  /**
   * Number of pixels the positionable should be separated vertically from anchor
   * @option
   * @type {number}
   * @default 0
   */
  vOffset: 0,
  /**
   * Number of pixels the positionable should be separated horizontally from anchor
   * @option
   * @type {number}
   * @default 0
   */
  hOffset: 0
};



/***/ }),

/***/ 2:
/***/ (function(module, exports) {

module.exports = {Plugin: window.Foundation.Plugin};

/***/ }),

/***/ 3:
/***/ (function(module, exports) {

module.exports = {rtl: window.Foundation.rtl, GetYoDigits: window.Foundation.GetYoDigits, transitionend: window.Foundation.transitionend};

/***/ }),

/***/ 33:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__foundation_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__foundation_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_tooltip__ = __webpack_require__(63);



__WEBPACK_IMPORTED_MODULE_0__foundation_core__["Foundation"].plugin(__WEBPACK_IMPORTED_MODULE_1__foundation_tooltip__["a" /* Tooltip */], 'Tooltip');

/***/ }),

/***/ 4:
/***/ (function(module, exports) {

module.exports = {Motion: window.Foundation.Motion, Move: window.Foundation.Move};

/***/ }),

/***/ 6:
/***/ (function(module, exports) {

module.exports = {MediaQuery: window.Foundation.MediaQuery};

/***/ }),

/***/ 63:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Tooltip; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_core__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__foundation_util_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__foundation_util_mediaQuery__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__foundation_util_mediaQuery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__foundation_util_mediaQuery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__foundation_util_triggers__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__foundation_positionable__ = __webpack_require__(11);


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }








/**
 * Tooltip module.
 * @module foundation.tooltip
 * @requires foundation.util.box
 * @requires foundation.util.mediaQuery
 * @requires foundation.util.triggers
 */

var Tooltip = function (_Positionable) {
  _inherits(Tooltip, _Positionable);

  function Tooltip() {
    _classCallCheck(this, Tooltip);

    return _possibleConstructorReturn(this, (Tooltip.__proto__ || Object.getPrototypeOf(Tooltip)).apply(this, arguments));
  }

  _createClass(Tooltip, [{
    key: '_setup',

    /**
     * Creates a new instance of a Tooltip.
     * @class
     * @name Tooltip
     * @fires Tooltip#init
     * @param {jQuery} element - jQuery object to attach a tooltip to.
     * @param {Object} options - object to extend the default configuration.
     */
    value: function _setup(element, options) {
      this.$element = element;
      this.options = __WEBPACK_IMPORTED_MODULE_0_jquery___default.a.extend({}, Tooltip.defaults, this.$element.data(), options);
      this.className = 'Tooltip'; // ie9 back compat

      this.isActive = false;
      this.isClick = false;

      // Triggers init is idempotent, just need to make sure it is initialized
      __WEBPACK_IMPORTED_MODULE_3__foundation_util_triggers__["a" /* Triggers */].init(__WEBPACK_IMPORTED_MODULE_0_jquery___default.a);

      this._init();
    }

    /**
     * Initializes the tooltip by setting the creating the tip element, adding it's text, setting private variables and setting attributes on the anchor.
     * @private
     */

  }, {
    key: '_init',
    value: function _init() {
      __WEBPACK_IMPORTED_MODULE_2__foundation_util_mediaQuery__["MediaQuery"]._init();
      var elemId = this.$element.attr('aria-describedby') || __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__foundation_util_core__["GetYoDigits"])(6, 'tooltip');

      this.options.tipText = this.options.tipText || this.$element.attr('title');
      this.template = this.options.template ? __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this.options.template) : this._buildTemplate(elemId);

      if (this.options.allowHtml) {
        this.template.appendTo(document.body).html(this.options.tipText).hide();
      } else {
        this.template.appendTo(document.body).text(this.options.tipText).hide();
      }

      this.$element.attr({
        'title': '',
        'aria-describedby': elemId,
        'data-yeti-box': elemId,
        'data-toggle': elemId,
        'data-resize': elemId
      }).addClass(this.options.triggerClass);

      _get(Tooltip.prototype.__proto__ || Object.getPrototypeOf(Tooltip.prototype), '_init', this).call(this);
      this._events();
    }
  }, {
    key: '_getDefaultPosition',
    value: function _getDefaultPosition() {
      // handle legacy classnames
      var position = this.$element[0].className.match(/\b(top|left|right|bottom)\b/g);
      return position ? position[0] : 'top';
    }
  }, {
    key: '_getDefaultAlignment',
    value: function _getDefaultAlignment() {
      return 'center';
    }
  }, {
    key: '_getHOffset',
    value: function _getHOffset() {
      if (this.position === 'left' || this.position === 'right') {
        return this.options.hOffset + this.options.tooltipWidth;
      } else {
        return this.options.hOffset;
      }
    }
  }, {
    key: '_getVOffset',
    value: function _getVOffset() {
      if (this.position === 'top' || this.position === 'bottom') {
        return this.options.vOffset + this.options.tooltipHeight;
      } else {
        return this.options.vOffset;
      }
    }

    /**
     * builds the tooltip element, adds attributes, and returns the template.
     * @private
     */

  }, {
    key: '_buildTemplate',
    value: function _buildTemplate(id) {
      var templateClasses = (this.options.tooltipClass + ' ' + this.options.positionClass + ' ' + this.options.templateClasses).trim();
      var $template = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('<div></div>').addClass(templateClasses).attr({
        'role': 'tooltip',
        'aria-hidden': true,
        'data-is-active': false,
        'data-is-focus': false,
        'id': id
      });
      return $template;
    }

    /**
     * sets the position class of an element and recursively calls itself until there are no more possible positions to attempt, or the tooltip element is no longer colliding.
     * if the tooltip is larger than the screen width, default to full width - any user selected margin
     * @private
     */

  }, {
    key: '_setPosition',
    value: function _setPosition() {
      _get(Tooltip.prototype.__proto__ || Object.getPrototypeOf(Tooltip.prototype), '_setPosition', this).call(this, this.$element, this.template);
    }

    /**
     * reveals the tooltip, and fires an event to close any other open tooltips on the page
     * @fires Tooltip#closeme
     * @fires Tooltip#show
     * @function
     */

  }, {
    key: 'show',
    value: function show() {
      if (this.options.showOn !== 'all' && !__WEBPACK_IMPORTED_MODULE_2__foundation_util_mediaQuery__["MediaQuery"].is(this.options.showOn)) {
        // console.error('The screen is too small to display this tooltip');
        return false;
      }

      var _this = this;
      this.template.css('visibility', 'hidden').show();
      this._setPosition();
      this.template.removeClass('top bottom left right').addClass(this.position);
      this.template.removeClass('align-top align-bottom align-left align-right align-center').addClass('align-' + this.alignment);

      /**
       * Fires to close all other open tooltips on the page
       * @event Closeme#tooltip
       */
      this.$element.trigger('closeme.zf.tooltip', this.template.attr('id'));

      this.template.attr({
        'data-is-active': true,
        'aria-hidden': false
      });
      _this.isActive = true;
      // console.log(this.template);
      this.template.stop().hide().css('visibility', '').fadeIn(this.options.fadeInDuration, function () {
        //maybe do stuff?
      });
      /**
       * Fires when the tooltip is shown
       * @event Tooltip#show
       */
      this.$element.trigger('show.zf.tooltip');
    }

    /**
     * Hides the current tooltip, and resets the positioning class if it was changed due to collision
     * @fires Tooltip#hide
     * @function
     */

  }, {
    key: 'hide',
    value: function hide() {
      // console.log('hiding', this.$element.data('yeti-box'));
      var _this = this;
      this.template.stop().attr({
        'aria-hidden': true,
        'data-is-active': false
      }).fadeOut(this.options.fadeOutDuration, function () {
        _this.isActive = false;
        _this.isClick = false;
      });
      /**
       * fires when the tooltip is hidden
       * @event Tooltip#hide
       */
      this.$element.trigger('hide.zf.tooltip');
    }

    /**
     * adds event listeners for the tooltip and its anchor
     * TODO combine some of the listeners like focus and mouseenter, etc.
     * @private
     */

  }, {
    key: '_events',
    value: function _events() {
      var _this = this;
      var $template = this.template;
      var isFocus = false;

      if (!this.options.disableHover) {

        this.$element.on('mouseenter.zf.tooltip', function (e) {
          if (!_this.isActive) {
            _this.timeout = setTimeout(function () {
              _this.show();
            }, _this.options.hoverDelay);
          }
        }).on('mouseleave.zf.tooltip', function (e) {
          clearTimeout(_this.timeout);
          if (!isFocus || _this.isClick && !_this.options.clickOpen) {
            _this.hide();
          }
        });
      }

      if (this.options.clickOpen) {
        this.$element.on('mousedown.zf.tooltip', function (e) {
          e.stopImmediatePropagation();
          if (_this.isClick) {
            //_this.hide();
            // _this.isClick = false;
          } else {
            _this.isClick = true;
            if ((_this.options.disableHover || !_this.$element.attr('tabindex')) && !_this.isActive) {
              _this.show();
            }
          }
        });
      } else {
        this.$element.on('mousedown.zf.tooltip', function (e) {
          e.stopImmediatePropagation();
          _this.isClick = true;
        });
      }

      if (!this.options.disableForTouch) {
        this.$element.on('tap.zf.tooltip touchend.zf.tooltip', function (e) {
          _this.isActive ? _this.hide() : _this.show();
        });
      }

      this.$element.on({
        // 'toggle.zf.trigger': this.toggle.bind(this),
        // 'close.zf.trigger': this.hide.bind(this)
        'close.zf.trigger': this.hide.bind(this)
      });

      this.$element.on('focus.zf.tooltip', function (e) {
        isFocus = true;
        if (_this.isClick) {
          // If we're not showing open on clicks, we need to pretend a click-launched focus isn't
          // a real focus, otherwise on hover and come back we get bad behavior
          if (!_this.options.clickOpen) {
            isFocus = false;
          }
          return false;
        } else {
          _this.show();
        }
      }).on('focusout.zf.tooltip', function (e) {
        isFocus = false;
        _this.isClick = false;
        _this.hide();
      }).on('resizeme.zf.trigger', function () {
        if (_this.isActive) {
          _this._setPosition();
        }
      });
    }

    /**
     * adds a toggle method, in addition to the static show() & hide() functions
     * @function
     */

  }, {
    key: 'toggle',
    value: function toggle() {
      if (this.isActive) {
        this.hide();
      } else {
        this.show();
      }
    }

    /**
     * Destroys an instance of tooltip, removes template element from the view.
     * @function
     */

  }, {
    key: '_destroy',
    value: function _destroy() {
      this.$element.attr('title', this.template.text()).off('.zf.trigger .zf.tooltip').removeClass('has-tip top right left').removeAttr('aria-describedby aria-haspopup data-disable-hover data-resize data-toggle data-tooltip data-yeti-box');

      this.template.remove();
    }
  }]);

  return Tooltip;
}(__WEBPACK_IMPORTED_MODULE_4__foundation_positionable__["a" /* Positionable */]);

Tooltip.defaults = {
  disableForTouch: false,
  /**
   * Time, in ms, before a tooltip should open on hover.
   * @option
   * @type {number}
   * @default 200
   */
  hoverDelay: 200,
  /**
   * Time, in ms, a tooltip should take to fade into view.
   * @option
   * @type {number}
   * @default 150
   */
  fadeInDuration: 150,
  /**
   * Time, in ms, a tooltip should take to fade out of view.
   * @option
   * @type {number}
   * @default 150
   */
  fadeOutDuration: 150,
  /**
   * Disables hover events from opening the tooltip if set to true
   * @option
   * @type {boolean}
   * @default false
   */
  disableHover: false,
  /**
   * Optional addtional classes to apply to the tooltip template on init.
   * @option
   * @type {string}
   * @default ''
   */
  templateClasses: '',
  /**
   * Non-optional class added to tooltip templates. Foundation default is 'tooltip'.
   * @option
   * @type {string}
   * @default 'tooltip'
   */
  tooltipClass: 'tooltip',
  /**
   * Class applied to the tooltip anchor element.
   * @option
   * @type {string}
   * @default 'has-tip'
   */
  triggerClass: 'has-tip',
  /**
   * Minimum breakpoint size at which to open the tooltip.
   * @option
   * @type {string}
   * @default 'small'
   */
  showOn: 'small',
  /**
   * Custom template to be used to generate markup for tooltip.
   * @option
   * @type {string}
   * @default ''
   */
  template: '',
  /**
   * Text displayed in the tooltip template on open.
   * @option
   * @type {string}
   * @default ''
   */
  tipText: '',
  touchCloseText: 'Tap to close.',
  /**
   * Allows the tooltip to remain open if triggered with a click or touch event.
   * @option
   * @type {boolean}
   * @default true
   */
  clickOpen: true,
  /**
   * DEPRECATED Additional positioning classes, set by the JS
   * @option
   * @type {string}
   * @default ''
   */
  positionClass: '',
  /**
   * Position of tooltip. Can be left, right, bottom, top, or auto.
   * @option
   * @type {string}
   * @default 'auto'
   */
  position: 'auto',
  /**
   * Alignment of tooltip relative to anchor. Can be left, right, bottom, top, center, or auto.
   * @option
   * @type {string}
   * @default 'auto'
   */
  alignment: 'auto',
  /**
   * Allow overlap of container/window. If false, tooltip will first try to
   * position as defined by data-position and data-alignment, but reposition if
   * it would cause an overflow.  @option
   * @type {boolean}
   * @default false
   */
  allowOverlap: false,
  /**
   * Allow overlap of only the bottom of the container. This is the most common
   * behavior for dropdowns, allowing the dropdown to extend the bottom of the
   * screen but not otherwise influence or break out of the container.
   * Less common for tooltips.
   * @option
   * @type {boolean}
   * @default false
   */
  allowBottomOverlap: false,
  /**
   * Distance, in pixels, the template should push away from the anchor on the Y axis.
   * @option
   * @type {number}
   * @default 0
   */
  vOffset: 0,
  /**
   * Distance, in pixels, the template should push away from the anchor on the X axis
   * @option
   * @type {number}
   * @default 0
   */
  hOffset: 0,
  /**
   * Distance, in pixels, the template spacing auto-adjust for a vertical tooltip
   * @option
   * @type {number}
   * @default 14
   */
  tooltipHeight: 14,
  /**
   * Distance, in pixels, the template spacing auto-adjust for a horizontal tooltip
   * @option
   * @type {number}
   * @default 12
   */
  tooltipWidth: 12,
  /**
  * Allow HTML in tooltip. Warning: If you are loading user-generated content into tooltips,
  * allowing HTML may open yourself up to XSS attacks.
  * @option
  * @type {boolean}
  * @default false
  */
  allowHtml: false
};

/**
 * TODO utilize resize event trigger
 */



/***/ }),

/***/ 7:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Triggers; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_motion__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__foundation_util_motion___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__foundation_util_motion__);





var MutationObserver = function () {
  var prefixes = ['WebKit', 'Moz', 'O', 'Ms', ''];
  for (var i = 0; i < prefixes.length; i++) {
    if (prefixes[i] + 'MutationObserver' in window) {
      return window[prefixes[i] + 'MutationObserver'];
    }
  }
  return false;
}();

var triggers = function (el, type) {
  el.data(type).split(' ').forEach(function (id) {
    __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#' + id)[type === 'close' ? 'trigger' : 'triggerHandler'](type + '.zf.trigger', [el]);
  });
};

var Triggers = {
  Listeners: {
    Basic: {},
    Global: {}
  },
  Initializers: {}
};

Triggers.Listeners.Basic = {
  openListener: function () {
    triggers(__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this), 'open');
  },
  closeListener: function () {
    var id = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).data('close');
    if (id) {
      triggers(__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this), 'close');
    } else {
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).trigger('close.zf.trigger');
    }
  },
  toggleListener: function () {
    var id = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).data('toggle');
    if (id) {
      triggers(__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this), 'toggle');
    } else {
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).trigger('toggle.zf.trigger');
    }
  },
  closeableListener: function (e) {
    e.stopPropagation();
    var animation = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).data('closable');

    if (animation !== '') {
      __WEBPACK_IMPORTED_MODULE_1__foundation_util_motion__["Motion"].animateOut(__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this), animation, function () {
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).trigger('closed.zf');
      });
    } else {
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).fadeOut().trigger('closed.zf');
    }
  },
  toggleFocusListener: function () {
    var id = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).data('toggle-focus');
    __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#' + id).triggerHandler('toggle.zf.trigger', [__WEBPACK_IMPORTED_MODULE_0_jquery___default()(this)]);
  }
};

// Elements with [data-open] will reveal a plugin that supports it when clicked.
Triggers.Initializers.addOpenListener = function ($elem) {
  $elem.off('click.zf.trigger', Triggers.Listeners.Basic.openListener);
  $elem.on('click.zf.trigger', '[data-open]', Triggers.Listeners.Basic.openListener);
};

// Elements with [data-close] will close a plugin that supports it when clicked.
// If used without a value on [data-close], the event will bubble, allowing it to close a parent component.
Triggers.Initializers.addCloseListener = function ($elem) {
  $elem.off('click.zf.trigger', Triggers.Listeners.Basic.closeListener);
  $elem.on('click.zf.trigger', '[data-close]', Triggers.Listeners.Basic.closeListener);
};

// Elements with [data-toggle] will toggle a plugin that supports it when clicked.
Triggers.Initializers.addToggleListener = function ($elem) {
  $elem.off('click.zf.trigger', Triggers.Listeners.Basic.toggleListener);
  $elem.on('click.zf.trigger', '[data-toggle]', Triggers.Listeners.Basic.toggleListener);
};

// Elements with [data-closable] will respond to close.zf.trigger events.
Triggers.Initializers.addCloseableListener = function ($elem) {
  $elem.off('close.zf.trigger', Triggers.Listeners.Basic.closeableListener);
  $elem.on('close.zf.trigger', '[data-closeable], [data-closable]', Triggers.Listeners.Basic.closeableListener);
};

// Elements with [data-toggle-focus] will respond to coming in and out of focus
Triggers.Initializers.addToggleFocusListener = function ($elem) {
  $elem.off('focus.zf.trigger blur.zf.trigger', Triggers.Listeners.Basic.toggleFocusListener);
  $elem.on('focus.zf.trigger blur.zf.trigger', '[data-toggle-focus]', Triggers.Listeners.Basic.toggleFocusListener);
};

// More Global/complex listeners and triggers
Triggers.Listeners.Global = {
  resizeListener: function ($nodes) {
    if (!MutationObserver) {
      //fallback for IE 9
      $nodes.each(function () {
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).triggerHandler('resizeme.zf.trigger');
      });
    }
    //trigger all listening elements and signal a resize event
    $nodes.attr('data-events', "resize");
  },
  scrollListener: function ($nodes) {
    if (!MutationObserver) {
      //fallback for IE 9
      $nodes.each(function () {
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this).triggerHandler('scrollme.zf.trigger');
      });
    }
    //trigger all listening elements and signal a scroll event
    $nodes.attr('data-events', "scroll");
  },
  closeMeListener: function (e, pluginId) {
    var plugin = e.namespace.split('.')[0];
    var plugins = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-' + plugin + ']').not('[data-yeti-box="' + pluginId + '"]');

    plugins.each(function () {
      var _this = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this);
      _this.triggerHandler('close.zf.trigger', [_this]);
    });
  }

  // Global, parses whole document.
};Triggers.Initializers.addClosemeListener = function (pluginName) {
  var yetiBoxes = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-yeti-box]'),
      plugNames = ['dropdown', 'tooltip', 'reveal'];

  if (pluginName) {
    if (typeof pluginName === 'string') {
      plugNames.push(pluginName);
    } else if (typeof pluginName === 'object' && typeof pluginName[0] === 'string') {
      plugNames.concat(pluginName);
    } else {
      console.error('Plugin names must be strings');
    }
  }
  if (yetiBoxes.length) {
    var listeners = plugNames.map(function (name) {
      return 'closeme.zf.' + name;
    }).join(' ');

    __WEBPACK_IMPORTED_MODULE_0_jquery___default()(window).off(listeners).on(listeners, Triggers.Listeners.Global.closeMeListener);
  }
};

function debounceGlobalListener(debounce, trigger, listener) {
  var timer = void 0,
      args = Array.prototype.slice.call(arguments, 3);
  __WEBPACK_IMPORTED_MODULE_0_jquery___default()(window).off(trigger).on(trigger, function (e) {
    if (timer) {
      clearTimeout(timer);
    }
    timer = setTimeout(function () {
      listener.apply(null, args);
    }, debounce || 10); //default time to emit scroll event
  });
}

Triggers.Initializers.addResizeListener = function (debounce) {
  var $nodes = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-resize]');
  if ($nodes.length) {
    debounceGlobalListener(debounce, 'resize.zf.trigger', Triggers.Listeners.Global.resizeListener, $nodes);
  }
};

Triggers.Initializers.addScrollListener = function (debounce) {
  var $nodes = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('[data-scroll]');
  if ($nodes.length) {
    debounceGlobalListener(debounce, 'scroll.zf.trigger', Triggers.Listeners.Global.scrollListener, $nodes);
  }
};

Triggers.Initializers.addMutationEventsListener = function ($elem) {
  if (!MutationObserver) {
    return false;
  }
  var $nodes = $elem.find('[data-resize], [data-scroll], [data-mutate]');

  //element callback
  var listeningElementsMutation = function (mutationRecordsList) {
    var $target = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(mutationRecordsList[0].target);

    //trigger the event handler for the element depending on type
    switch (mutationRecordsList[0].type) {
      case "attributes":
        if ($target.attr("data-events") === "scroll" && mutationRecordsList[0].attributeName === "data-events") {
          $target.triggerHandler('scrollme.zf.trigger', [$target, window.pageYOffset]);
        }
        if ($target.attr("data-events") === "resize" && mutationRecordsList[0].attributeName === "data-events") {
          $target.triggerHandler('resizeme.zf.trigger', [$target]);
        }
        if (mutationRecordsList[0].attributeName === "style") {
          $target.closest("[data-mutate]").attr("data-events", "mutate");
          $target.closest("[data-mutate]").triggerHandler('mutateme.zf.trigger', [$target.closest("[data-mutate]")]);
        }
        break;

      case "childList":
        $target.closest("[data-mutate]").attr("data-events", "mutate");
        $target.closest("[data-mutate]").triggerHandler('mutateme.zf.trigger', [$target.closest("[data-mutate]")]);
        break;

      default:
        return false;
      //nothing
    }
  };

  if ($nodes.length) {
    //for each element that needs to listen for resizing, scrolling, or mutation add a single observer
    for (var i = 0; i <= $nodes.length - 1; i++) {
      var elementObserver = new MutationObserver(listeningElementsMutation);
      elementObserver.observe($nodes[i], { attributes: true, childList: true, characterData: false, subtree: true, attributeFilter: ["data-events", "style"] });
    }
  }
};

Triggers.Initializers.addSimpleListeners = function () {
  var $document = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(document);

  Triggers.Initializers.addOpenListener($document);
  Triggers.Initializers.addCloseListener($document);
  Triggers.Initializers.addToggleListener($document);
  Triggers.Initializers.addCloseableListener($document);
  Triggers.Initializers.addToggleFocusListener($document);
};

Triggers.Initializers.addGlobalListeners = function () {
  var $document = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(document);
  Triggers.Initializers.addMutationEventsListener($document);
  Triggers.Initializers.addResizeListener();
  Triggers.Initializers.addScrollListener();
  Triggers.Initializers.addClosemeListener();
};

Triggers.init = function ($, Foundation) {
  if (typeof $.triggersInitialized === 'undefined') {
    var $document = $(document);

    if (document.readyState === "complete") {
      Triggers.Initializers.addSimpleListeners();
      Triggers.Initializers.addGlobalListeners();
    } else {
      $(window).on('load', function () {
        Triggers.Initializers.addSimpleListeners();
        Triggers.Initializers.addGlobalListeners();
      });
    }

    $.triggersInitialized = true;
  }

  if (Foundation) {
    Foundation.Triggers = Triggers;
    // Legacy included to be backwards compatible for now.
    Foundation.IHearYou = Triggers.Initializers.addGlobalListeners;
  }
};



/***/ }),

/***/ 8:
/***/ (function(module, exports) {

module.exports = {Box: window.Foundation.Box};

/***/ }),

/***/ 99:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(33);


/***/ })

/******/ });
   /* Ende foundation.tooltip */
   /* Start hammer */
   /*! Hammer.JS - v2.0.2 - 2014-07-28  * http://hammerjs.github.io/  *  * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;  * Licensed under the MIT license 
* --GSBDocStart
 * @module HammerJS 
 * @version 2.0.2 
 * @see {@link http://hammerjs.github.io}
 * @author Jorik Tangelder, 2014
 * @license MIT license
 *
 * @desc Unterstüzt single- und multi-touch Gesten.
 * Implementiert ist: tap, doubletap, pan, swipe, press, pinch, rotate
 *--GSBDocEnd
*/
!function(a,b,c,d){function e(a,b,c){return setTimeout(k(a,c),b);}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1;}function g(a,b,c){var e,f;if(a){if(a.forEach){a.forEach(b,c);}else{if(a.length!==d){for(e=0,f=a.length;f>e;e++){b.call(c,a[e],e,a);}}else{for(e in a){a.hasOwnProperty(e)&&b.call(c,a[e],e,a);}}}}}function h(a,b,c){for(var e=Object.keys(b),f=0,g=e.length;g>f;f++){(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]);}return a;}function i(a,b){return h(a,b,!0);}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c);}function k(a,b){return function(){return a.apply(b,arguments);};}function l(a,b){return typeof a==hb?a.apply(b?b[0]||d:d,b):a;}function m(a,b){return a===d?b:a;}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1);});}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1);});}function p(a,b){for(;a;){if(a==b){return !0;}a=a.parentNode;}return !1;}function q(a,b){return a.indexOf(b)>-1;}function r(a){return a.trim().split(/\s+/g);}function s(a,b,c){if(a.indexOf&&!c){return a.indexOf(b);}for(var d=0,e=a.length;e>d;d++){if(c&&a[d][c]==b||!c&&a[d]===b){return d;}}return -1;}function t(a){return Array.prototype.slice.call(a,0);}function u(a,b,c){for(var d=[],e=[],f=0,g=a.length;g>f;f++){var h=b?a[f][b]:a[f];s(e,h)<0&&d.push(a[f]),e[f]=h;}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b];}):d.sort()),d;}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0,h=fb.length;h>g;g++){if(c=fb[g],e=c?c+f:b,e in a){return e;}}return d;}function w(){return lb++;}function x(b,c){var d=this;this.manager=b,this.callback=c,this.element=b.element,this.target=b.options.inputTarget,this.domHandler=function(a){l(b.options.enable,[b])&&d.handler(a);},this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(a,this.evWin,this.domHandler);}function y(a){var b;return new (b=ob?M:pb?N:nb?P:L)(a,z);}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&vb&&d-e===0,g=b&(xb|yb)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,A(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c;}function A(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),e>1&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=kb(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),B(c,b),b.offsetDirection=G(b.deltaX,b.deltaY),b.scale=g?K(g.pointers,d):1,b.rotation=g?J(g.pointers,d):0,C(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j;}function B(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===vb||f.eventType===xb)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y);}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=yb&&(i>ub||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=jb(l.x)>jb(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b;}else{c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;}b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g;}function D(a){for(var b=[],c=0;c<a.pointers.length;c++){b[c]={clientX:ib(a.pointers[c].clientX),clientY:ib(a.pointers[c].clientY)};}return{timeStamp:kb(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY};}function E(a){var b=a.length;if(1===b){return{x:ib(a[0].clientX),y:ib(a[0].clientY)};}for(var c=0,d=0,e=0;b>e;e++){c+=a[e].clientX,d+=a[e].clientY;}return{x:ib(c/b),y:ib(d/b)};}function F(a,b,c){return{x:b/a||0,y:c/a||0};}function G(a,b){return a===b?zb:jb(a)>=jb(b)?a>0?Ab:Bb:b>0?Cb:Db;}function H(a,b,c){c||(c=Hb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e);}function I(a,b,c){c||(c=Hb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI;}function J(a,b){return I(b[1],b[0],Ib)-I(a[1],a[0],Ib);}function K(a,b){return H(b[0],b[1],Ib)/H(a[0],a[1],Ib);}function L(){this.evEl=Kb,this.evWin=Lb,this.allow=!0,this.pressed=!1,x.apply(this,arguments);}function M(){this.evEl=Ob,this.evWin=Pb,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[];}function N(){this.evTarget=Rb,this.targetIds={},x.apply(this,arguments);}function O(a,b){var c=t(a.touches),d=this.targetIds;if(b&(vb|wb)&&1===c.length){return d[c[0].identifier]=!0,[c,c];}var e,f,g=t(a.targetTouches),h=t(a.changedTouches),i=[];if(b===vb){for(e=0,f=g.length;f>e;e++){d[g[e].identifier]=!0;}}for(e=0,f=h.length;f>e;e++){d[h[e].identifier]&&i.push(h[e]),b&(xb|yb)&&delete d[h[e].identifier];}return i.length?[u(g.concat(i),"identifier",!0),i]:void 0;}function P(){x.apply(this,arguments);var a=k(this.handler,this);this.touch=new N(this.manager,a),this.mouse=new L(this.manager,a);}function Q(a,b){this.manager=a,this.set(b);}function R(a){if(q(a,Xb)){return Xb;}var b=q(a,Yb),c=q(a,Zb);return b&&c?Yb+" "+Zb:b||c?b?Yb:Zb:q(a,Wb)?Wb:Vb;}function S(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=$b,this.simultaneous={},this.requireFail=[];}function T(a){return a&dc?"cancel":a&bc?"end":a&ac?"move":a&_b?"start":"";}function U(a){return a==Db?"down":a==Cb?"up":a==Ab?"left":a==Bb?"right":"";}function V(a,b){var c=b.manager;return c?c.get(a):a;}function W(){S.apply(this,arguments);}function X(){W.apply(this,arguments),this.pX=null,this.pY=null;}function Y(){W.apply(this,arguments);}function Z(){S.apply(this,arguments),this._timer=null,this._input=null;}function $(){W.apply(this,arguments);}function _(){W.apply(this,arguments);}function ab(){S.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0;}function bb(a,b){return b=b||{},b.recognizers=m(b.recognizers,bb.defaults.preset),new cb(a,b);}function cb(a,b){b=b||{},this.options=i(b,bb.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=y(this),this.touchAction=new Q(this,this.options.touchAction),db(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[2]);},this);}function db(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:"";});}function eb(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d);}var fb=["","webkit","moz","MS","ms","o"],gb=b.createElement("div"),hb="function",ib=Math.round,jb=Math.abs,kb=Date.now,lb=1,mb=/mobile|tablet|ip(ad|hone|od)|android/i,nb="ontouchstart" in a,ob=v(a,"PointerEvent")!==d,pb=nb&&mb.test(navigator.userAgent),qb="touch",rb="pen",sb="mouse",tb="kinect",ub=25,vb=1,wb=2,xb=4,yb=8,zb=1,Ab=2,Bb=4,Cb=8,Db=16,Eb=Ab|Bb,Fb=Cb|Db,Gb=Eb|Fb,Hb=["x","y"],Ib=["clientX","clientY"];x.prototype={handler:function(){},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(a,this.evWin,this.domHandler);}};var Jb={mousedown:vb,mousemove:wb,mouseup:xb},Kb="mousedown",Lb="mousemove mouseup";j(L,x,{handler:function(a){var b=Jb[a.type];b&vb&&0===a.button&&(this.pressed=!0),b&wb&&1!==a.which&&(b=xb),this.pressed&&this.allow&&(b&xb&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:sb,srcEvent:a}));}});var Mb={pointerdown:vb,pointermove:wb,pointerup:xb,pointercancel:yb,pointerout:yb},Nb={2:qb,3:rb,4:sb,5:tb},Ob="pointerdown",Pb="pointermove pointerup pointercancel";a.MSPointerEvent&&(Ob="MSPointerDown",Pb="MSPointerMove MSPointerUp MSPointerCancel"),j(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Mb[d],f=Nb[a.pointerType]||a.pointerType,g=f==qb;e&vb&&(0===a.button||g)?b.push(a):e&(xb|yb)&&(c=!0);var h=s(b,a.pointerId,"pointerId");0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1));}});var Qb={touchstart:vb,touchmove:wb,touchend:xb,touchcancel:yb},Rb="touchstart touchmove touchend touchcancel";j(N,x,{handler:function(a){var b=Qb[a.type],c=O.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:qb,srcEvent:a});}}),j(P,x,{handler:function(a,b,c){var d=c.pointerType==qb,e=c.pointerType==sb;if(d){this.mouse.allow=!1;}else{if(e&&!this.mouse.allow){return;}}b&(xb|yb)&&(this.mouse.allow=!0),this.callback(a,b,c);},destroy:function(){this.touch.destroy(),this.mouse.destroy();}});var Sb=v(gb.style,"touchAction"),Tb=Sb!==d,Ub="compute",Vb="auto",Wb="manipulation",Xb="none",Yb="pan-x",Zb="pan-y";Q.prototype={set:function(a){a==Ub&&(a=this.compute()),Tb&&(this.manager.element.style[Sb]=a),this.actions=a.toLowerCase().trim();},update:function(){this.set(this.manager.options.touchAction);},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()));}),R(a.join(" "));},preventDefaults:function(a){if(!Tb){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented){return void b.preventDefault();}var d=this.actions,e=q(d,Xb),f=q(d,Zb),g=q(d,Yb);return e||f&&g||f&&c&Eb||g&&c&Fb?this.preventSrc(b):void 0;}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault();}};var $b=1,_b=2,ac=4,bc=8,cc=bc,dc=16,ec=32;S.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this;},recognizeWith:function(a){if(f(a,"recognizeWith",this)){return this;}var b=this.simultaneous;return a=V(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this;},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=V(a,this),delete this.simultaneous[a.id],this);},requireFailure:function(a){if(f(a,"requireFailure",this)){return this;}var b=this.requireFail;return a=V(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this;},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this)){return this;}a=V(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this;},hasRequireFailures:function(){return this.requireFail.length>0;},canRecognizeWith:function(a){return !!this.simultaneous[a.id];},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?T(d):""),a);}var c=this,d=this.state;bc>d&&b(!0),b(),d>=bc&&b(!0);},tryEmit:function(a){return this.canEmit()?this.emit(a):void (this.state=ec);},canEmit:function(){for(var a=0;a<this.requireFail.length;a++){if(!(this.requireFail[a].state&(ec|$b))){return !1;}}return !0;},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(cc|dc|ec)&&(this.state=$b),this.state=this.process(b),void (this.state&(_b|ac|bc|dc)&&this.tryEmit(b))):(this.reset(),void (this.state=ec));},process:function(){},getTouchAction:function(){},reset:function(){}},j(W,S,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b;},process:function(a){var b=this.state,c=a.eventType,d=b&(_b|ac),e=this.attrTest(a);return d&&(c&yb||!e)?b|dc:d||e?c&xb?b|bc:b&_b?b|ac:_b:ec;}}),j(X,W,{defaults:{event:"pan",threshold:10,pointers:1,direction:Gb},getTouchAction:function(){var a=this.options.direction;if(a===Gb){return[Xb];}var b=[];return a&Eb&&b.push(Zb),a&Fb&&b.push(Yb),b;},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Eb?(e=0===f?zb:0>f?Ab:Bb,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?zb:0>g?Cb:Db,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction;},attrTest:function(a){return W.prototype.attrTest.call(this,a)&&(this.state&_b||!(this.state&_b)&&this.directionTest(a));},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=U(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a);}}),j(Y,W,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Xb];},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&_b);},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a);}}}),j(Z,S,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[Vb];},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(xb|yb)&&!f){this.reset();}else{if(a.eventType&vb){this.reset(),this._timer=e(function(){this.state=cc,this.tryEmit();},b.time,this);}else{if(a.eventType&xb){return cc;}}}return ec;},reset:function(){clearTimeout(this._timer);},emit:function(a){this.state===cc&&(a&&a.eventType&xb?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=kb(),this.manager.emit(this.options.event,this._input)));}}),j($,W,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Xb];},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&_b);}}),j(_,W,{defaults:{event:"swipe",threshold:10,velocity:0.65,direction:Eb|Fb,pointers:1},getTouchAction:function(){return X.prototype.getTouchAction.call(this);},attrTest:function(a){var b,c=this.options.direction;return c&(Eb|Fb)?b=a.velocity:c&Eb?b=a.velocityX:c&Fb&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&jb(b)>this.options.velocity&&a.eventType&xb;},emit:function(a){var b=U(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a);}}),j(ab,S,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[Wb];},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&vb&&0===this.count){return this.failTimeout();}if(d&&f&&c){if(a.eventType!=xb){return this.failTimeout();}var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i){return this.hasRequireFailures()?(this._timer=e(function(){this.state=cc,this.tryEmit();},b.interval,this),_b):cc;}}return ec;},failTimeout:function(){return this._timer=e(function(){this.state=ec;},this.options.interval,this),ec;},reset:function(){clearTimeout(this._timer);},emit:function(){this.state==cc&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input));}}),bb.VERSION="2.0.2",bb.defaults={domEvents:!1,touchAction:Ub,inputTarget:null,enable:!0,preset:[[$,{enable:!1}],[Y,{enable:!1},["rotate"]],[_,{direction:Eb}],[X,{direction:Eb},["swipe"]],[ab],[ab,{event:"doubletap",taps:2},["tap"]],[Z]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var fc=1,gc=2;cb.prototype={set:function(a){return h(this.options,a),this;},stop:function(a){this.session.stopped=a?gc:fc;},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&cc)&&(e=b.curRecognizer=null);for(var f=0,g=d.length;g>f;f++){c=d[f],b.stopped===gc||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(_b|ac|bc)&&(e=b.curRecognizer=c);}}},get:function(a){if(a instanceof S){return a;}for(var b=this.recognizers,c=0;c<b.length;c++){if(b[c].options.event==a){return b[c];}}return null;},add:function(a){if(f(a,"add",this)){return this;}var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a;},remove:function(a){if(f(a,"remove",this)){return this;}var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this;},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b);}),this;},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a];}),this;},emit:function(a,b){this.options.domEvents&&eb(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault();};for(var d=0,e=c.length;e>d;d++){c[d](b);}}},destroy:function(){this.element&&db(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null;}},h(bb,{INPUT_START:vb,INPUT_MOVE:wb,INPUT_END:xb,INPUT_CANCEL:yb,STATE_POSSIBLE:$b,STATE_BEGAN:_b,STATE_CHANGED:ac,STATE_ENDED:bc,STATE_RECOGNIZED:cc,STATE_CANCELLED:dc,STATE_FAILED:ec,DIRECTION_NONE:zb,DIRECTION_LEFT:Ab,DIRECTION_RIGHT:Bb,DIRECTION_UP:Cb,DIRECTION_DOWN:Db,DIRECTION_HORIZONTAL:Eb,DIRECTION_VERTICAL:Fb,DIRECTION_ALL:Gb,Manager:cb,Input:x,TouchAction:Q,Recognizer:S,AttrRecognizer:W,Tap:ab,Pan:X,Swipe:_,Pinch:Y,Rotate:$,Press:Z,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),typeof define==hb&&define.amd?define(function(){return bb;}):"undefined"!=typeof module&&module.exports?module.exports=bb:a[c]=bb;}(window,document,"Hammer");
   /* Ende hammer */
   /* Start jquery.hammer */
   (function($,Hammer,dataAttr){function hammerify(el,options){var $el=$(el);if(!$el.data(dataAttr)){$el.data(dataAttr,new Hammer($el[0],options));}}$.fn.hammer=function(options){return this.each(function(){hammerify(this,options);});};Hammer.Manager.prototype.emit=(function(originalEmit){return function(type,data){originalEmit.call(this,type,data);jQuery(this.element).triggerHandler({type:type,gesture:data});};})(Hammer.Manager.prototype.emit);})(jQuery,Hammer,"hammer");
   /* Ende jquery.hammer */
   /* Start moment */
   //! moment.js
//! version : 2.7.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

(function (undefined) {

    /************************************
        Constants
    ************************************/

    var moment,
        VERSION = "2.7.0",
        // the global-scope this is NOT the global object in Node.js
        globalScope = typeof global !== 'undefined' ? global : this,
        oldGlobalMoment,
        round = Math.round,
        i,

        YEAR = 0,
        MONTH = 1,
        DATE = 2,
        HOUR = 3,
        MINUTE = 4,
        SECOND = 5,
        MILLISECOND = 6,

        // internal storage for language config files
        languages = {},

        // moment internal properties
        momentProperties = {
            _isAMomentObject: null,
            _i : null,
            _f : null,
            _l : null,
            _strict : null,
            _tzm : null,
            _isUTC : null,
            _offset : null,  // optional. Combine with _isUTC
            _pf : null,
            _lang : null  // optional
        },

        // check for nodeJS
        hasModule = (typeof module !== 'undefined' && module.exports),

        // ASP.NET json date format regex
        aspNetJsonRegex = /^\/?Date\((\-?\d+)/i,
        aspNetTimeSpanJsonRegex = /(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,

        // from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html
        // somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere
        isoDurationRegex = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,

        // format tokens
        formattingTokens = /(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,
        localFormattingTokens = /(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,

        // parsing token regexes
        parseTokenOneOrTwoDigits = /\d\d?/, // 0 - 99
        parseTokenOneToThreeDigits = /\d{1,3}/, // 0 - 999
        parseTokenOneToFourDigits = /\d{1,4}/, // 0 - 9999
        parseTokenOneToSixDigits = /[+\-]?\d{1,6}/, // -999,999 - 999,999
        parseTokenDigits = /\d+/, // nonzero number of digits
        parseTokenWord = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i, // any word (or two) characters or numbers including two/three word month in arabic.
        parseTokenTimezone = /Z|[\+\-]\d\d:?\d\d/gi, // +00:00 -00:00 +0000 -0000 or Z
        parseTokenT = /T/i, // T (ISO separator)
        parseTokenTimestampMs = /[\+\-]?\d+(\.\d{1,3})?/, // 123456789 123456789.123
        parseTokenOrdinal = /\d{1,2}/,

        //strict parsing regexes
        parseTokenOneDigit = /\d/, // 0 - 9
        parseTokenTwoDigits = /\d\d/, // 00 - 99
        parseTokenThreeDigits = /\d{3}/, // 000 - 999
        parseTokenFourDigits = /\d{4}/, // 0000 - 9999
        parseTokenSixDigits = /[+-]?\d{6}/, // -999,999 - 999,999
        parseTokenSignedNumber = /[+-]?\d+/, // -inf - inf

        // iso 8601 regex
        // 0000-00-00 0000-W00 or 0000-W00-0 + T + 00 or 00:00 or 00:00:00 or 00:00:00.000 + +00:00 or +0000 or +00)
        isoRegex = /^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,

        isoFormat = 'YYYY-MM-DDTHH:mm:ssZ',

        isoDates = [
            ['YYYYYY-MM-DD', /[+-]\d{6}-\d{2}-\d{2}/],
            ['YYYY-MM-DD', /\d{4}-\d{2}-\d{2}/],
            ['GGGG-[W]WW-E', /\d{4}-W\d{2}-\d/],
            ['GGGG-[W]WW', /\d{4}-W\d{2}/],
            ['YYYY-DDD', /\d{4}-\d{3}/]
        ],

        // iso time formats and regexes
        isoTimes = [
            ['HH:mm:ss.SSSS', /(T| )\d\d:\d\d:\d\d\.\d+/],
            ['HH:mm:ss', /(T| )\d\d:\d\d:\d\d/],
            ['HH:mm', /(T| )\d\d:\d\d/],
            ['HH', /(T| )\d\d/]
        ],

        // timezone chunker "+10:00" > ["10", "00"] or "-1530" > ["-15", "30"]
        parseTimezoneChunker = /([\+\-]|\d\d)/gi,

        // getter and setter names
        proxyGettersAndSetters = 'Date|Hours|Minutes|Seconds|Milliseconds'.split('|'),
        unitMillisecondFactors = {
            'Milliseconds' : 1,
            'Seconds' : 1e3,
            'Minutes' : 6e4,
            'Hours' : 36e5,
            'Days' : 864e5,
            'Months' : 2592e6,
            'Years' : 31536e6
        },

        unitAliases = {
            ms : 'millisecond',
            s : 'second',
            m : 'minute',
            h : 'hour',
            d : 'day',
            D : 'date',
            w : 'week',
            W : 'isoWeek',
            M : 'month',
            Q : 'quarter',
            y : 'year',
            DDD : 'dayOfYear',
            e : 'weekday',
            E : 'isoWeekday',
            gg: 'weekYear',
            GG: 'isoWeekYear'
        },

        camelFunctions = {
            dayofyear : 'dayOfYear',
            isoweekday : 'isoWeekday',
            isoweek : 'isoWeek',
            weekyear : 'weekYear',
            isoweekyear : 'isoWeekYear'
        },

        // format function strings
        formatFunctions = {},

        // default relative time thresholds
        relativeTimeThresholds = {
          s: 45,   //seconds to minutes
          m: 45,   //minutes to hours
          h: 22,   //hours to days
          dd: 25,  //days to month (month == 1)
          dm: 45,  //days to months (months > 1)
          dy: 345  //days to year
        },

        // tokens to ordinalize and pad
        ordinalizeTokens = 'DDD w W M D d'.split(' '),
        paddedTokens = 'M D H h m s w W'.split(' '),

        formatTokenFunctions = {
            M    : function () {
                return this.month() + 1;
            },
            MMM  : function (format) {
                return this.lang().monthsShort(this, format);
            },
            MMMM : function (format) {
                return this.lang().months(this, format);
            },
            D    : function () {
                return this.date();
            },
            DDD  : function () {
                return this.dayOfYear();
            },
            d    : function () {
                return this.day();
            },
            dd   : function (format) {
                return this.lang().weekdaysMin(this, format);
            },
            ddd  : function (format) {
                return this.lang().weekdaysShort(this, format);
            },
            dddd : function (format) {
                return this.lang().weekdays(this, format);
            },
            w    : function () {
                return this.week();
            },
            W    : function () {
                return this.isoWeek();
            },
            YY   : function () {
                return leftZeroFill(this.year() % 100, 2);
            },
            YYYY : function () {
                return leftZeroFill(this.year(), 4);
            },
            YYYYY : function () {
                return leftZeroFill(this.year(), 5);
            },
            YYYYYY : function () {
                var y = this.year(), sign = y >= 0 ? '+' : '-';
                return sign + leftZeroFill(Math.abs(y), 6);
            },
            gg   : function () {
                return leftZeroFill(this.weekYear() % 100, 2);
            },
            gggg : function () {
                return leftZeroFill(this.weekYear(), 4);
            },
            ggggg : function () {
                return leftZeroFill(this.weekYear(), 5);
            },
            GG   : function () {
                return leftZeroFill(this.isoWeekYear() % 100, 2);
            },
            GGGG : function () {
                return leftZeroFill(this.isoWeekYear(), 4);
            },
            GGGGG : function () {
                return leftZeroFill(this.isoWeekYear(), 5);
            },
            e : function () {
                return this.weekday();
            },
            E : function () {
                return this.isoWeekday();
            },
            a    : function () {
                return this.lang().meridiem(this.hours(), this.minutes(), true);
            },
            A    : function () {
                return this.lang().meridiem(this.hours(), this.minutes(), false);
            },
            H    : function () {
                return this.hours();
            },
            h    : function () {
                return this.hours() % 12 || 12;
            },
            m    : function () {
                return this.minutes();
            },
            s    : function () {
                return this.seconds();
            },
            S    : function () {
                return toInt(this.milliseconds() / 100);
            },
            SS   : function () {
                return leftZeroFill(toInt(this.milliseconds() / 10), 2);
            },
            SSS  : function () {
                return leftZeroFill(this.milliseconds(), 3);
            },
            SSSS : function () {
                return leftZeroFill(this.milliseconds(), 3);
            },
            Z    : function () {
                var a = -this.zone(),
                    b = "+";
                if (a < 0) {
                    a = -a;
                    b = "-";
                }
                return b + leftZeroFill(toInt(a / 60), 2) + ":" + leftZeroFill(toInt(a) % 60, 2);
            },
            ZZ   : function () {
                var a = -this.zone(),
                    b = "+";
                if (a < 0) {
                    a = -a;
                    b = "-";
                }
                return b + leftZeroFill(toInt(a / 60), 2) + leftZeroFill(toInt(a) % 60, 2);
            },
            z : function () {
                return this.zoneAbbr();
            },
            zz : function () {
                return this.zoneName();
            },
            X    : function () {
                return this.unix();
            },
            Q : function () {
                return this.quarter();
            }
        },

        lists = ['months', 'monthsShort', 'weekdays', 'weekdaysShort', 'weekdaysMin'];

    // Pick the first defined of two or three arguments. dfl comes from
    // default.
    function dfl(a, b, c) {
        switch (arguments.length) {
            case 2: return a != null ? a : b;
            case 3: return a != null ? a : b != null ? b : c;
            default: throw new Error("Implement me");
        }
    }

    function defaultParsingFlags() {
        // We need to deep clone this object, and es5 standard is not very
        // helpful.
        return {
            empty : false,
            unusedTokens : [],
            unusedInput : [],
            overflow : -2,
            charsLeftOver : 0,
            nullInput : false,
            invalidMonth : null,
            invalidFormat : false,
            userInvalidated : false,
            iso: false
        };
    }

    function deprecate(msg, fn) {
        var firstTime = true;
        function printMsg() {
            if (moment.suppressDeprecationWarnings === false &&
                    typeof console !== 'undefined' && console.warn) {
                console.warn("Deprecation warning: " + msg);
            }
        }
        return extend(function () {
            if (firstTime) {
                printMsg();
                firstTime = false;
            }
            return fn.apply(this, arguments);
        }, fn);
    }

    function padToken(func, count) {
        return function (a) {
            return leftZeroFill(func.call(this, a), count);
        };
    }
    function ordinalizeToken(func, period) {
        return function (a) {
            return this.lang().ordinal(func.call(this, a), period);
        };
    }

    while (ordinalizeTokens.length) {
        i = ordinalizeTokens.pop();
        formatTokenFunctions[i + 'o'] = ordinalizeToken(formatTokenFunctions[i], i);
    }
    while (paddedTokens.length) {
        i = paddedTokens.pop();
        formatTokenFunctions[i + i] = padToken(formatTokenFunctions[i], 2);
    }
    formatTokenFunctions.DDDD = padToken(formatTokenFunctions.DDD, 3);

    /************************************
        Constructors
    ************************************/

    function Language() {

    }

    // Moment prototype object
    function Moment(config) {
        checkOverflow(config);
        extend(this, config);
    }

    // Duration Constructor
    function Duration(duration) {
        var normalizedInput = normalizeObjectUnits(duration),
            years = normalizedInput.year || 0,
            quarters = normalizedInput.quarter || 0,
            months = normalizedInput.month || 0,
            weeks = normalizedInput.week || 0,
            days = normalizedInput.day || 0,
            hours = normalizedInput.hour || 0,
            minutes = normalizedInput.minute || 0,
            seconds = normalizedInput.second || 0,
            milliseconds = normalizedInput.millisecond || 0;

        // representation for dateAddRemove
        this._milliseconds = +milliseconds +
            seconds * 1e3 + // 1000
            minutes * 6e4 + // 1000 * 60
            hours * 36e5; // 1000 * 60 * 60
        // Because of dateAddRemove treats 24 hours as different from a
        // day when working around DST, we need to store them separately
        this._days = +days +
            weeks * 7;
        // It is impossible translate months into days without knowing
        // which months you are are talking about, so we have to store
        // it separately.
        this._months = +months +
            quarters * 3 +
            years * 12;

        this._data = {};

        this._bubble();
    }

    /************************************
        Helpers
    ************************************/

    function extend(a, b) {
        for (var i in b) {
            if (b.hasOwnProperty(i)) {
                a[i] = b[i];
            }
        }

        if (b.hasOwnProperty("toString")) {
            a.toString = b.toString;
        }

        if (b.hasOwnProperty("valueOf")) {
            a.valueOf = b.valueOf;
        }

        return a;
    }

    function cloneMoment(m) {
        var result = {}, i;
        for (i in m) {
            if (m.hasOwnProperty(i) && momentProperties.hasOwnProperty(i)) {
                result[i] = m[i];
            }
        }

        return result;
    }

    function absRound(number) {
        if (number < 0) {
            return Math.ceil(number);
        } else {
            return Math.floor(number);
        }
    }

    // left zero fill a number
    // see http://jsperf.com/left-zero-filling for performance comparison
    function leftZeroFill(number, targetLength, forceSign) {
        var output = '' + Math.abs(number),
            sign = number >= 0;

        while (output.length < targetLength) {
            output = '0' + output;
        }
        return (sign ? (forceSign ? '+' : '') : '-') + output;
    }

    // helper function for _.addTime and _.subtractTime
    function addOrSubtractDurationFromMoment(mom, duration, isAdding, updateOffset) {
        var milliseconds = duration._milliseconds,
            days = duration._days,
            months = duration._months;
        updateOffset = updateOffset == null ? true : updateOffset;

        if (milliseconds) {
            mom._d.setTime(+mom._d + milliseconds * isAdding);
        }
        if (days) {
            rawSetter(mom, 'Date', rawGetter(mom, 'Date') + days * isAdding);
        }
        if (months) {
            rawMonthSetter(mom, rawGetter(mom, 'Month') + months * isAdding);
        }
        if (updateOffset) {
            moment.updateOffset(mom, days || months);
        }
    }

    // check if is an array
    function isArray(input) {
        return Object.prototype.toString.call(input) === '[object Array]';
    }

    function isDate(input) {
        return  Object.prototype.toString.call(input) === '[object Date]' ||
                input instanceof Date;
    }

    // compare two arrays, return the number of differences
    function compareArrays(array1, array2, dontConvert) {
        var len = Math.min(array1.length, array2.length),
            lengthDiff = Math.abs(array1.length - array2.length),
            diffs = 0,
            i;
        for (i = 0; i < len; i++) {
            if ((dontConvert && array1[i] !== array2[i]) ||
                (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {
                diffs++;
            }
        }
        return diffs + lengthDiff;
    }

    function normalizeUnits(units) {
        if (units) {
            var lowered = units.toLowerCase().replace(/(.)s$/, '$1');
            units = unitAliases[units] || camelFunctions[lowered] || lowered;
        }
        return units;
    }

    function normalizeObjectUnits(inputObject) {
        var normalizedInput = {},
            normalizedProp,
            prop;

        for (prop in inputObject) {
            if (inputObject.hasOwnProperty(prop)) {
                normalizedProp = normalizeUnits(prop);
                if (normalizedProp) {
                    normalizedInput[normalizedProp] = inputObject[prop];
                }
            }
        }

        return normalizedInput;
    }

    function makeList(field) {
        var count, setter;

        if (field.indexOf('week') === 0) {
            count = 7;
            setter = 'day';
        }
        else if (field.indexOf('month') === 0) {
            count = 12;
            setter = 'month';
        }
        else {
            return;
        }

        moment[field] = function (format, index) {
            var i, getter,
                method = moment.fn._lang[field],
                results = [];

            if (typeof format === 'number') {
                index = format;
                format = undefined;
            }

            getter = function (i) {
                var m = moment().utc().set(setter, i);
                return method.call(moment.fn._lang, m, format || '');
            };

            if (index != null) {
                return getter(index);
            }
            else {
                for (i = 0; i < count; i++) {
                    results.push(getter(i));
                }
                return results;
            }
        };
    }

    function toInt(argumentForCoercion) {
        var coercedNumber = +argumentForCoercion,
            value = 0;

        if (coercedNumber !== 0 && isFinite(coercedNumber)) {
            if (coercedNumber >= 0) {
                value = Math.floor(coercedNumber);
            } else {
                value = Math.ceil(coercedNumber);
            }
        }

        return value;
    }

    function daysInMonth(year, month) {
        return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();
    }

    function weeksInYear(year, dow, doy) {
        return weekOfYear(moment([year, 11, 31 + dow - doy]), dow, doy).week;
    }

    function daysInYear(year) {
        return isLeapYear(year) ? 366 : 365;
    }

    function isLeapYear(year) {
        return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;
    }

    function checkOverflow(m) {
        var overflow;
        if (m._a && m._pf.overflow === -2) {
            overflow =
                m._a[MONTH] < 0 || m._a[MONTH] > 11 ? MONTH :
                m._a[DATE] < 1 || m._a[DATE] > daysInMonth(m._a[YEAR], m._a[MONTH]) ? DATE :
                m._a[HOUR] < 0 || m._a[HOUR] > 23 ? HOUR :
                m._a[MINUTE] < 0 || m._a[MINUTE] > 59 ? MINUTE :
                m._a[SECOND] < 0 || m._a[SECOND] > 59 ? SECOND :
                m._a[MILLISECOND] < 0 || m._a[MILLISECOND] > 999 ? MILLISECOND :
                -1;

            if (m._pf._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {
                overflow = DATE;
            }

            m._pf.overflow = overflow;
        }
    }

    function isValid(m) {
        if (m._isValid == null) {
            m._isValid = !isNaN(m._d.getTime()) &&
                m._pf.overflow < 0 &&
                !m._pf.empty &&
                !m._pf.invalidMonth &&
                !m._pf.nullInput &&
                !m._pf.invalidFormat &&
                !m._pf.userInvalidated;

            if (m._strict) {
                m._isValid = m._isValid &&
                    m._pf.charsLeftOver === 0 &&
                    m._pf.unusedTokens.length === 0;
            }
        }
        return m._isValid;
    }

    function normalizeLanguage(key) {
        return key ? key.toLowerCase().replace('_', '-') : key;
    }

    // Return a moment from input, that is local/utc/zone equivalent to model.
    function makeAs(input, model) {
        return model._isUTC ? moment(input).zone(model._offset || 0) :
            moment(input).local();
    }

    /************************************
        Languages
    ************************************/

    extend(Language.prototype, {

        set : function (config) {
            var prop, i;
            for (i in config) {
                prop = config[i];
                if (typeof prop === 'function') {
                    this[i] = prop;
                } else {
                    this['_' + i] = prop;
                }
            }
        },

        _months : "January_February_March_April_May_June_July_August_September_October_November_December".split("_"),
        months : function (m) {
            return this._months[m.month()];
        },

        _monthsShort : "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),
        monthsShort : function (m) {
            return this._monthsShort[m.month()];
        },

        monthsParse : function (monthName) {
            var i, mom, regex;

            if (!this._monthsParse) {
                this._monthsParse = [];
            }

            for (i = 0; i < 12; i++) {
                // make the regex if we don't have it already
                if (!this._monthsParse[i]) {
                    mom = moment.utc([2000, i]);
                    regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');
                    this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');
                }
                // test the regex
                if (this._monthsParse[i].test(monthName)) {
                    return i;
                }
            }
        },

        _weekdays : "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),
        weekdays : function (m) {
            return this._weekdays[m.day()];
        },

        _weekdaysShort : "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),
        weekdaysShort : function (m) {
            return this._weekdaysShort[m.day()];
        },

        _weekdaysMin : "Su_Mo_Tu_We_Th_Fr_Sa".split("_"),
        weekdaysMin : function (m) {
            return this._weekdaysMin[m.day()];
        },

        weekdaysParse : function (weekdayName) {
            var i, mom, regex;

            if (!this._weekdaysParse) {
                this._weekdaysParse = [];
            }

            for (i = 0; i < 7; i++) {
                // make the regex if we don't have it already
                if (!this._weekdaysParse[i]) {
                    mom = moment([2000, 1]).day(i);
                    regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');
                    this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');
                }
                // test the regex
                if (this._weekdaysParse[i].test(weekdayName)) {
                    return i;
                }
            }
        },

        _longDateFormat : {
            LT : "h:mm A",
            L : "MM/DD/YYYY",
            LL : "MMMM D YYYY",
            LLL : "MMMM D YYYY LT",
            LLLL : "dddd, MMMM D YYYY LT"
        },
        longDateFormat : function (key) {
            var output = this._longDateFormat[key];
            if (!output && this._longDateFormat[key.toUpperCase()]) {
                output = this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function (val) {
                    return val.slice(1);
                });
                this._longDateFormat[key] = output;
            }
            return output;
        },

        isPM : function (input) {
            // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays
            // Using charAt should be more compatible.
            return ((input + '').toLowerCase().charAt(0) === 'p');
        },

        _meridiemParse : /[ap]\.?m?\.?/i,
        meridiem : function (hours, minutes, isLower) {
            if (hours > 11) {
                return isLower ? 'pm' : 'PM';
            } else {
                return isLower ? 'am' : 'AM';
            }
        },

        _calendar : {
            sameDay : '[Today at] LT',
            nextDay : '[Tomorrow at] LT',
            nextWeek : 'dddd [at] LT',
            lastDay : '[Yesterday at] LT',
            lastWeek : '[Last] dddd [at] LT',
            sameElse : 'L'
        },
        calendar : function (key, mom) {
            var output = this._calendar[key];
            return typeof output === 'function' ? output.apply(mom) : output;
        },

        _relativeTime : {
            future : "in %s",
            past : "%s ago",
            s : "a few seconds",
            m : "a minute",
            mm : "%d minutes",
            h : "an hour",
            hh : "%d hours",
            d : "a day",
            dd : "%d days",
            M : "a month",
            MM : "%d months",
            y : "a year",
            yy : "%d years"
        },
        relativeTime : function (number, withoutSuffix, string, isFuture) {
            var output = this._relativeTime[string];
            return (typeof output === 'function') ?
                output(number, withoutSuffix, string, isFuture) :
                output.replace(/%d/i, number);
        },
        pastFuture : function (diff, output) {
            var format = this._relativeTime[diff > 0 ? 'future' : 'past'];
            return typeof format === 'function' ? format(output) : format.replace(/%s/i, output);
        },

        ordinal : function (number) {
            return this._ordinal.replace("%d", number);
        },
        _ordinal : "%d",

        preparse : function (string) {
            return string;
        },

        postformat : function (string) {
            return string;
        },

        week : function (mom) {
            return weekOfYear(mom, this._week.dow, this._week.doy).week;
        },

        _week : {
            dow : 0, // Sunday is the first day of the week.
            doy : 6  // The week that contains Jan 1st is the first week of the year.
        },

        _invalidDate: 'Invalid date',
        invalidDate: function () {
            return this._invalidDate;
        }
    });

    // Loads a language definition into the `languages` cache.  The function
    // takes a key and optionally values.  If not in the browser and no values
    // are provided, it will load the language file module.  As a convenience,
    // this function also returns the language values.
    function loadLang(key, values) {
        values.abbr = key;
        if (!languages[key]) {
            languages[key] = new Language();
        }
        languages[key].set(values);
        return languages[key];
    }

    // Remove a language from the `languages` cache. Mostly useful in tests.
    function unloadLang(key) {
        delete languages[key];
    }

    // Determines which language definition to use and returns it.
    //
    // With no parameters, it will return the global language.  If you
    // pass in a language key, such as 'en', it will return the
    // definition for 'en', so long as 'en' has already been loaded using
    // moment.lang.
    function getLangDefinition(key) {
        var i = 0, j, lang, next, split,
            get = function (k) {
                if (!languages[k] && hasModule) {
                    try {
                        require('./lang/' + k);
                    } catch (e) { }
                }
                return languages[k];
            };

        if (!key) {
            return moment.fn._lang;
        }

        if (!isArray(key)) {
            //short-circuit everything else
            lang = get(key);
            if (lang) {
                return lang;
            }
            key = [key];
        }

        //pick the language from the array
        //try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each
        //substring from most specific to least, but move to the next array item if it's a more specific variant than the current root
        while (i < key.length) {
            split = normalizeLanguage(key[i]).split('-');
            j = split.length;
            next = normalizeLanguage(key[i + 1]);
            next = next ? next.split('-') : null;
            while (j > 0) {
                lang = get(split.slice(0, j).join('-'));
                if (lang) {
                    return lang;
                }
                if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {
                    //the next array item is better than a shallower substring of this one
                    break;
                }
                j--;
            }
            i++;
        }
        return moment.fn._lang;
    }

    /************************************
        Formatting
    ************************************/

    function removeFormattingTokens(input) {
        if (input.match(/\[[\s\S]/)) {
            return input.replace(/^\[|\]$/g, "");
        }
        return input.replace(/\\/g, "");
    }

    function makeFormatFunction(format) {
        var array = format.match(formattingTokens), i, length;

        for (i = 0, length = array.length; i < length; i++) {
            if (formatTokenFunctions[array[i]]) {
                array[i] = formatTokenFunctions[array[i]];
            } else {
                array[i] = removeFormattingTokens(array[i]);
            }
        }

        return function (mom) {
            var output = "";
            for (i = 0; i < length; i++) {
                output += array[i] instanceof Function ? array[i].call(mom, format) : array[i];
            }
            return output;
        };
    }

    // format date using native date object
    function formatMoment(m, format) {

        if (!m.isValid()) {
            return m.lang().invalidDate();
        }

        format = expandFormat(format, m.lang());

        if (!formatFunctions[format]) {
            formatFunctions[format] = makeFormatFunction(format);
        }

        return formatFunctions[format](m);
    }

    function expandFormat(format, lang) {
        var i = 5;

        function replaceLongDateFormatTokens(input) {
            return lang.longDateFormat(input) || input;
        }

        localFormattingTokens.lastIndex = 0;
        while (i >= 0 && localFormattingTokens.test(format)) {
            format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);
            localFormattingTokens.lastIndex = 0;
            i -= 1;
        }

        return format;
    }

    /************************************
        Parsing
    ************************************/

    // get the regex to find the next token
    function getParseRegexForToken(token, config) {
        var a, strict = config._strict;
        switch (token) {
        case 'Q':
            return parseTokenOneDigit;
        case 'DDDD':
            return parseTokenThreeDigits;
        case 'YYYY':
        case 'GGGG':
        case 'gggg':
            return strict ? parseTokenFourDigits : parseTokenOneToFourDigits;
        case 'Y':
        case 'G':
        case 'g':
            return parseTokenSignedNumber;
        case 'YYYYYY':
        case 'YYYYY':
        case 'GGGGG':
        case 'ggggg':
            return strict ? parseTokenSixDigits : parseTokenOneToSixDigits;
        case 'S':
            if (strict) { return parseTokenOneDigit; }
            /* falls through */
        case 'SS':
            if (strict) { return parseTokenTwoDigits; }
            /* falls through */
        case 'SSS':
            if (strict) { return parseTokenThreeDigits; }
            /* falls through */
        case 'DDD':
            return parseTokenOneToThreeDigits;
        case 'MMM':
        case 'MMMM':
        case 'dd':
        case 'ddd':
        case 'dddd':
            return parseTokenWord;
        case 'a':
        case 'A':
            return getLangDefinition(config._l)._meridiemParse;
        case 'X':
            return parseTokenTimestampMs;
        case 'Z':
        case 'ZZ':
            return parseTokenTimezone;
        case 'T':
            return parseTokenT;
        case 'SSSS':
            return parseTokenDigits;
        case 'MM':
        case 'DD':
        case 'YY':
        case 'GG':
        case 'gg':
        case 'HH':
        case 'hh':
        case 'mm':
        case 'ss':
        case 'ww':
        case 'WW':
            return strict ? parseTokenTwoDigits : parseTokenOneOrTwoDigits;
        case 'M':
        case 'D':
        case 'd':
        case 'H':
        case 'h':
        case 'm':
        case 's':
        case 'w':
        case 'W':
        case 'e':
        case 'E':
            return parseTokenOneOrTwoDigits;
        case 'Do':
            return parseTokenOrdinal;
        default :
            a = new RegExp(regexpEscape(unescapeFormat(token.replace('\\', '')), "i"));
            return a;
        }
    }

    function timezoneMinutesFromString(string) {
        string = string || "";
        var possibleTzMatches = (string.match(parseTokenTimezone) || []),
            tzChunk = possibleTzMatches[possibleTzMatches.length - 1] || [],
            parts = (tzChunk + '').match(parseTimezoneChunker) || ['-', 0, 0],
            minutes = +(parts[1] * 60) + toInt(parts[2]);

        return parts[0] === '+' ? -minutes : minutes;
    }

    // function to convert string input to date
    function addTimeToArrayFromToken(token, input, config) {
        var a, datePartArray = config._a;

        switch (token) {
        // QUARTER
        case 'Q':
            if (input != null) {
                datePartArray[MONTH] = (toInt(input) - 1) * 3;
            }
            break;
        // MONTH
        case 'M' : // fall through to MM
        case 'MM' :
            if (input != null) {
                datePartArray[MONTH] = toInt(input) - 1;
            }
            break;
        case 'MMM' : // fall through to MMMM
        case 'MMMM' :
            a = getLangDefinition(config._l).monthsParse(input);
            // if we didn't find a month name, mark the date as invalid.
            if (a != null) {
                datePartArray[MONTH] = a;
            } else {
                config._pf.invalidMonth = input;
            }
            break;
        // DAY OF MONTH
        case 'D' : // fall through to DD
        case 'DD' :
            if (input != null) {
                datePartArray[DATE] = toInt(input);
            }
            break;
        case 'Do' :
            if (input != null) {
                datePartArray[DATE] = toInt(parseInt(input, 10));
            }
            break;
        // DAY OF YEAR
        case 'DDD' : // fall through to DDDD
        case 'DDDD' :
            if (input != null) {
                config._dayOfYear = toInt(input);
            }

            break;
        // YEAR
        case 'YY' :
            datePartArray[YEAR] = moment.parseTwoDigitYear(input);
            break;
        case 'YYYY' :
        case 'YYYYY' :
        case 'YYYYYY' :
            datePartArray[YEAR] = toInt(input);
            break;
        // AM / PM
        case 'a' : // fall through to A
        case 'A' :
            config._isPm = getLangDefinition(config._l).isPM(input);
            break;
        // 24 HOUR
        case 'H' : // fall through to hh
        case 'HH' : // fall through to hh
        case 'h' : // fall through to hh
        case 'hh' :
            datePartArray[HOUR] = toInt(input);
            break;
        // MINUTE
        case 'm' : // fall through to mm
        case 'mm' :
            datePartArray[MINUTE] = toInt(input);
            break;
        // SECOND
        case 's' : // fall through to ss
        case 'ss' :
            datePartArray[SECOND] = toInt(input);
            break;
        // MILLISECOND
        case 'S' :
        case 'SS' :
        case 'SSS' :
        case 'SSSS' :
            datePartArray[MILLISECOND] = toInt(('0.' + input) * 1000);
            break;
        // UNIX TIMESTAMP WITH MS
        case 'X':
            config._d = new Date(parseFloat(input) * 1000);
            break;
        // TIMEZONE
        case 'Z' : // fall through to ZZ
        case 'ZZ' :
            config._useUTC = true;
            config._tzm = timezoneMinutesFromString(input);
            break;
        // WEEKDAY - human
        case 'dd':
        case 'ddd':
        case 'dddd':
            a = getLangDefinition(config._l).weekdaysParse(input);
            // if we didn't get a weekday name, mark the date as invalid
            if (a != null) {
                config._w = config._w || {};
                config._w['d'] = a;
            } else {
                config._pf.invalidWeekday = input;
            }
            break;
        // WEEK, WEEK DAY - numeric
        case 'w':
        case 'ww':
        case 'W':
        case 'WW':
        case 'd':
        case 'e':
        case 'E':
            token = token.substr(0, 1);
            /* falls through */
        case 'gggg':
        case 'GGGG':
        case 'GGGGG':
            token = token.substr(0, 2);
            if (input) {
                config._w = config._w || {};
                config._w[token] = toInt(input);
            }
            break;
        case 'gg':
        case 'GG':
            config._w = config._w || {};
            config._w[token] = moment.parseTwoDigitYear(input);
        }
    }

    function dayOfYearFromWeekInfo(config) {
        var w, weekYear, week, weekday, dow, doy, temp, lang;

        w = config._w;
        if (w.GG != null || w.W != null || w.E != null) {
            dow = 1;
            doy = 4;

            // TODO: We need to take the current isoWeekYear, but that depends on
            // how we interpret now (local, utc, fixed offset). So create
            // a now version of current config (take local/utc/offset flags, and
            // create now).
            weekYear = dfl(w.GG, config._a[YEAR], weekOfYear(moment(), 1, 4).year);
            week = dfl(w.W, 1);
            weekday = dfl(w.E, 1);
        } else {
            lang = getLangDefinition(config._l);
            dow = lang._week.dow;
            doy = lang._week.doy;

            weekYear = dfl(w.gg, config._a[YEAR], weekOfYear(moment(), dow, doy).year);
            week = dfl(w.w, 1);

            if (w.d != null) {
                // weekday -- low day numbers are considered next week
                weekday = w.d;
                if (weekday < dow) {
                    ++week;
                }
            } else if (w.e != null) {
                // local weekday -- counting starts from begining of week
                weekday = w.e + dow;
            } else {
                // default to begining of week
                weekday = dow;
            }
        }
        temp = dayOfYearFromWeeks(weekYear, week, weekday, doy, dow);

        config._a[YEAR] = temp.year;
        config._dayOfYear = temp.dayOfYear;
    }

    // convert an array to a date.
    // the array should mirror the parameters below
    // note: all values past the year are optional and will default to the lowest possible value.
    // [year, month, day , hour, minute, second, millisecond]
    function dateFromConfig(config) {
        var i, date, input = [], currentDate, yearToUse;

        if (config._d) {
            return;
        }

        currentDate = currentDateArray(config);

        //compute day of the year from weeks and weekdays
        if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {
            dayOfYearFromWeekInfo(config);
        }

        //if the day of the year is set, figure out what it is
        if (config._dayOfYear) {
            yearToUse = dfl(config._a[YEAR], currentDate[YEAR]);

            if (config._dayOfYear > daysInYear(yearToUse)) {
                config._pf._overflowDayOfYear = true;
            }

            date = makeUTCDate(yearToUse, 0, config._dayOfYear);
            config._a[MONTH] = date.getUTCMonth();
            config._a[DATE] = date.getUTCDate();
        }

        // Default to current date.
        // * if no year, month, day of month are given, default to today
        // * if day of month is given, default month and year
        // * if month is given, default only year
        // * if year is given, don't default anything
        for (i = 0; i < 3 && config._a[i] == null; ++i) {
            config._a[i] = input[i] = currentDate[i];
        }

        // Zero out whatever was not defaulted, including time
        for (; i < 7; i++) {
            config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];
        }

        config._d = (config._useUTC ? makeUTCDate : makeDate).apply(null, input);
        // Apply timezone offset from input. The actual zone can be changed
        // with parseZone.
        if (config._tzm != null) {
            config._d.setUTCMinutes(config._d.getUTCMinutes() + config._tzm);
        }
    }

    function dateFromObject(config) {
        var normalizedInput;

        if (config._d) {
            return;
        }

        normalizedInput = normalizeObjectUnits(config._i);
        config._a = [
            normalizedInput.year,
            normalizedInput.month,
            normalizedInput.day,
            normalizedInput.hour,
            normalizedInput.minute,
            normalizedInput.second,
            normalizedInput.millisecond
        ];

        dateFromConfig(config);
    }

    function currentDateArray(config) {
        var now = new Date();
        if (config._useUTC) {
            return [
                now.getUTCFullYear(),
                now.getUTCMonth(),
                now.getUTCDate()
            ];
        } else {
            return [now.getFullYear(), now.getMonth(), now.getDate()];
        }
    }

    // date from string and format string
    function makeDateFromStringAndFormat(config) {

        if (config._f === moment.ISO_8601) {
            parseISO(config);
            return;
        }

        config._a = [];
        config._pf.empty = true;

        // This array is used to make a Date, either with `new Date` or `Date.UTC`
        var lang = getLangDefinition(config._l),
            string = '' + config._i,
            i, parsedInput, tokens, token, skipped,
            stringLength = string.length,
            totalParsedInputLength = 0;

        tokens = expandFormat(config._f, lang).match(formattingTokens) || [];

        for (i = 0; i < tokens.length; i++) {
            token = tokens[i];
            parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];
            if (parsedInput) {
                skipped = string.substr(0, string.indexOf(parsedInput));
                if (skipped.length > 0) {
                    config._pf.unusedInput.push(skipped);
                }
                string = string.slice(string.indexOf(parsedInput) + parsedInput.length);
                totalParsedInputLength += parsedInput.length;
            }
            // don't parse if it's not a known token
            if (formatTokenFunctions[token]) {
                if (parsedInput) {
                    config._pf.empty = false;
                }
                else {
                    config._pf.unusedTokens.push(token);
                }
                addTimeToArrayFromToken(token, parsedInput, config);
            }
            else if (config._strict && !parsedInput) {
                config._pf.unusedTokens.push(token);
            }
        }

        // add remaining unparsed input length to the string
        config._pf.charsLeftOver = stringLength - totalParsedInputLength;
        if (string.length > 0) {
            config._pf.unusedInput.push(string);
        }

        // handle am pm
        if (config._isPm && config._a[HOUR] < 12) {
            config._a[HOUR] += 12;
        }
        // if is 12 am, change hours to 0
        if (config._isPm === false && config._a[HOUR] === 12) {
            config._a[HOUR] = 0;
        }

        dateFromConfig(config);
        checkOverflow(config);
    }

    function unescapeFormat(s) {
        return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (matched, p1, p2, p3, p4) {
            return p1 || p2 || p3 || p4;
        });
    }

    // Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript
    function regexpEscape(s) {
        return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
    }

    // date from string and array of format strings
    function makeDateFromStringAndArray(config) {
        var tempConfig,
            bestMoment,

            scoreToBeat,
            i,
            currentScore;

        if (config._f.length === 0) {
            config._pf.invalidFormat = true;
            config._d = new Date(NaN);
            return;
        }

        for (i = 0; i < config._f.length; i++) {
            currentScore = 0;
            tempConfig = extend({}, config);
            tempConfig._pf = defaultParsingFlags();
            tempConfig._f = config._f[i];
            makeDateFromStringAndFormat(tempConfig);

            if (!isValid(tempConfig)) {
                continue;
            }

            // if there is any input that was not parsed add a penalty for that format
            currentScore += tempConfig._pf.charsLeftOver;

            //or tokens
            currentScore += tempConfig._pf.unusedTokens.length * 10;

            tempConfig._pf.score = currentScore;

            if (scoreToBeat == null || currentScore < scoreToBeat) {
                scoreToBeat = currentScore;
                bestMoment = tempConfig;
            }
        }

        extend(config, bestMoment || tempConfig);
    }

    // date from iso format
    function parseISO(config) {
        var i, l,
            string = config._i,
            match = isoRegex.exec(string);

        if (match) {
            config._pf.iso = true;
            for (i = 0, l = isoDates.length; i < l; i++) {
                if (isoDates[i][1].exec(string)) {
                    // match[5] should be "T" or undefined
                    config._f = isoDates[i][0] + (match[6] || " ");
                    break;
                }
            }
            for (i = 0, l = isoTimes.length; i < l; i++) {
                if (isoTimes[i][1].exec(string)) {
                    config._f += isoTimes[i][0];
                    break;
                }
            }
            if (string.match(parseTokenTimezone)) {
                config._f += "Z";
            }
            makeDateFromStringAndFormat(config);
        } else {
            config._isValid = false;
        }
    }

    // date from iso format or fallback
    function makeDateFromString(config) {
        parseISO(config);
        if (config._isValid === false) {
            delete config._isValid;
            moment.createFromInputFallback(config);
        }
    }

    function makeDateFromInput(config) {
        var input = config._i,
            matched = aspNetJsonRegex.exec(input);

        if (input === undefined) {
            config._d = new Date();
        } else if (matched) {
            config._d = new Date(+matched[1]);
        } else if (typeof input === 'string') {
            makeDateFromString(config);
        } else if (isArray(input)) {
            config._a = input.slice(0);
            dateFromConfig(config);
        } else if (isDate(input)) {
            config._d = new Date(+input);
        } else if (typeof(input) === 'object') {
            dateFromObject(config);
        } else if (typeof(input) === 'number') {
            // from milliseconds
            config._d = new Date(input);
        } else {
            moment.createFromInputFallback(config);
        }
    }

    function makeDate(y, m, d, h, M, s, ms) {
        //can't just apply() to create a date:
        //http://stackoverflow.com/questions/181348/instantiating-a-javascript-object-by-calling-prototype-constructor-apply
        var date = new Date(y, m, d, h, M, s, ms);

        //the date constructor doesn't accept years < 1970
        if (y < 1970) {
            date.setFullYear(y);
        }
        return date;
    }

    function makeUTCDate(y) {
        var date = new Date(Date.UTC.apply(null, arguments));
        if (y < 1970) {
            date.setUTCFullYear(y);
        }
        return date;
    }

    function parseWeekday(input, language) {
        if (typeof input === 'string') {
            if (!isNaN(input)) {
                input = parseInt(input, 10);
            }
            else {
                input = language.weekdaysParse(input);
                if (typeof input !== 'number') {
                    return null;
                }
            }
        }
        return input;
    }

    /************************************
        Relative Time
    ************************************/

    // helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize
    function substituteTimeAgo(string, number, withoutSuffix, isFuture, lang) {
        return lang.relativeTime(number || 1, !!withoutSuffix, string, isFuture);
    }

    function relativeTime(milliseconds, withoutSuffix, lang) {
        var seconds = round(Math.abs(milliseconds) / 1000),
            minutes = round(seconds / 60),
            hours = round(minutes / 60),
            days = round(hours / 24),
            years = round(days / 365),
            args = seconds < relativeTimeThresholds.s  && ['s', seconds] ||
                minutes === 1 && ['m'] ||
                minutes < relativeTimeThresholds.m && ['mm', minutes] ||
                hours === 1 && ['h'] ||
                hours < relativeTimeThresholds.h && ['hh', hours] ||
                days === 1 && ['d'] ||
                days <= relativeTimeThresholds.dd && ['dd', days] ||
                days <= relativeTimeThresholds.dm && ['M'] ||
                days < relativeTimeThresholds.dy && ['MM', round(days / 30)] ||
                years === 1 && ['y'] || ['yy', years];
        args[2] = withoutSuffix;
        args[3] = milliseconds > 0;
        args[4] = lang;
        return substituteTimeAgo.apply({}, args);
    }

    /************************************
        Week of Year
    ************************************/

    // firstDayOfWeek       0 = sun, 6 = sat
    //                      the day of the week that starts the week
    //                      (usually sunday or monday)
    // firstDayOfWeekOfYear 0 = sun, 6 = sat
    //                      the first week is the week that contains the first
    //                      of this day of the week
    //                      (eg. ISO weeks use thursday (4))
    function weekOfYear(mom, firstDayOfWeek, firstDayOfWeekOfYear) {
        var end = firstDayOfWeekOfYear - firstDayOfWeek,
            daysToDayOfWeek = firstDayOfWeekOfYear - mom.day(),
            adjustedMoment;

        if (daysToDayOfWeek > end) {
            daysToDayOfWeek -= 7;
        }

        if (daysToDayOfWeek < end - 7) {
            daysToDayOfWeek += 7;
        }

        adjustedMoment = moment(mom).add('d', daysToDayOfWeek);
        return {
            week: Math.ceil(adjustedMoment.dayOfYear() / 7),
            year: adjustedMoment.year()
        };
    }

    //http://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday
    function dayOfYearFromWeeks(year, week, weekday, firstDayOfWeekOfYear, firstDayOfWeek) {
        var d = makeUTCDate(year, 0, 1).getUTCDay(), daysToAdd, dayOfYear;

        d = d === 0 ? 7 : d;
        weekday = weekday != null ? weekday : firstDayOfWeek;
        daysToAdd = firstDayOfWeek - d + (d > firstDayOfWeekOfYear ? 7 : 0) - (d < firstDayOfWeek ? 7 : 0);
        dayOfYear = 7 * (week - 1) + (weekday - firstDayOfWeek) + daysToAdd + 1;

        return {
            year: dayOfYear > 0 ? year : year - 1,
            dayOfYear: dayOfYear > 0 ?  dayOfYear : daysInYear(year - 1) + dayOfYear
        };
    }

    /************************************
        Top Level Functions
    ************************************/

    function makeMoment(config) {
        var input = config._i,
            format = config._f;

        if (input === null || (format === undefined && input === '')) {
            return moment.invalid({nullInput: true});
        }

        if (typeof input === 'string') {
            config._i = input = getLangDefinition().preparse(input);
        }

        if (moment.isMoment(input)) {
            config = cloneMoment(input);

            config._d = new Date(+input._d);
        } else if (format) {
            if (isArray(format)) {
                makeDateFromStringAndArray(config);
            } else {
                makeDateFromStringAndFormat(config);
            }
        } else {
            makeDateFromInput(config);
        }

        return new Moment(config);
    }

    moment = function (input, format, lang, strict) {
        var c;

        if (typeof(lang) === "boolean") {
            strict = lang;
            lang = undefined;
        }
        // object construction must be done this way.
        // https://github.com/moment/moment/issues/1423
        c = {};
        c._isAMomentObject = true;
        c._i = input;
        c._f = format;
        c._l = lang;
        c._strict = strict;
        c._isUTC = false;
        c._pf = defaultParsingFlags();

        return makeMoment(c);
    };

    moment.suppressDeprecationWarnings = false;

    moment.createFromInputFallback = deprecate(
            "moment construction falls back to js Date. This is " +
            "discouraged and will be removed in upcoming major " +
            "release. Please refer to " +
            "https://github.com/moment/moment/issues/1407 for more info.",
            function (config) {
        config._d = new Date(config._i);
    });

    // Pick a moment m from moments so that m[fn](other) is true for all
    // other. This relies on the function fn to be transitive.
    //
    // moments should either be an array of moment objects or an array, whose
    // first element is an array of moment objects.
    function pickBy(fn, moments) {
        var res, i;
        if (moments.length === 1 && isArray(moments[0])) {
            moments = moments[0];
        }
        if (!moments.length) {
            return moment();
        }
        res = moments[0];
        for (i = 1; i < moments.length; ++i) {
            if (moments[i][fn](res)) {
                res = moments[i];
            }
        }
        return res;
    }

    moment.min = function () {
        var args = [].slice.call(arguments, 0);

        return pickBy('isBefore', args);
    };

    moment.max = function () {
        var args = [].slice.call(arguments, 0);

        return pickBy('isAfter', args);
    };

    // creating with utc
    moment.utc = function (input, format, lang, strict) {
        var c;

        if (typeof(lang) === "boolean") {
            strict = lang;
            lang = undefined;
        }
        // object construction must be done this way.
        // https://github.com/moment/moment/issues/1423
        c = {};
        c._isAMomentObject = true;
        c._useUTC = true;
        c._isUTC = true;
        c._l = lang;
        c._i = input;
        c._f = format;
        c._strict = strict;
        c._pf = defaultParsingFlags();

        return makeMoment(c).utc();
    };

    // creating with unix timestamp (in seconds)
    moment.unix = function (input) {
        return moment(input * 1000);
    };

    // duration
    moment.duration = function (input, key) {
        var duration = input,
            // matching against regexp is expensive, do it on demand
            match = null,
            sign,
            ret,
            parseIso;

        if (moment.isDuration(input)) {
            duration = {
                ms: input._milliseconds,
                d: input._days,
                M: input._months
            };
        } else if (typeof input === 'number') {
            duration = {};
            if (key) {
                duration[key] = input;
            } else {
                duration.milliseconds = input;
            }
        } else if (!!(match = aspNetTimeSpanJsonRegex.exec(input))) {
            sign = (match[1] === "-") ? -1 : 1;
            duration = {
                y: 0,
                d: toInt(match[DATE]) * sign,
                h: toInt(match[HOUR]) * sign,
                m: toInt(match[MINUTE]) * sign,
                s: toInt(match[SECOND]) * sign,
                ms: toInt(match[MILLISECOND]) * sign
            };
        } else if (!!(match = isoDurationRegex.exec(input))) {
            sign = (match[1] === "-") ? -1 : 1;
            parseIso = function (inp) {
                // We'd normally use ~~inp for this, but unfortunately it also
                // converts floats to ints.
                // inp may be undefined, so careful calling replace on it.
                var res = inp && parseFloat(inp.replace(',', '.'));
                // apply sign while we're at it
                return (isNaN(res) ? 0 : res) * sign;
            };
            duration = {
                y: parseIso(match[2]),
                M: parseIso(match[3]),
                d: parseIso(match[4]),
                h: parseIso(match[5]),
                m: parseIso(match[6]),
                s: parseIso(match[7]),
                w: parseIso(match[8])
            };
        }

        ret = new Duration(duration);

        if (moment.isDuration(input) && input.hasOwnProperty('_lang')) {
            ret._lang = input._lang;
        }

        return ret;
    };

    // version number
    moment.version = VERSION;

    // default format
    moment.defaultFormat = isoFormat;

    // constant that refers to the ISO standard
    moment.ISO_8601 = function () {};

    // Plugins that add properties should also add the key here (null value),
    // so we can properly clone ourselves.
    moment.momentProperties = momentProperties;

    // This function will be called whenever a moment is mutated.
    // It is intended to keep the offset in sync with the timezone.
    moment.updateOffset = function () {};

    // This function allows you to set a threshold for relative time strings
    moment.relativeTimeThreshold = function(threshold, limit) {
      if (relativeTimeThresholds[threshold] === undefined) {
        return false;
      }
      relativeTimeThresholds[threshold] = limit;
      return true;
    };

    // This function will load languages and then set the global language.  If
    // no arguments are passed in, it will simply return the current global
    // language key.
    moment.lang = function (key, values) {
        var r;
        if (!key) {
            return moment.fn._lang._abbr;
        }
        if (values) {
            loadLang(normalizeLanguage(key), values);
        } else if (values === null) {
            unloadLang(key);
            key = 'en';
        } else if (!languages[key]) {
            getLangDefinition(key);
        }
        r = moment.duration.fn._lang = moment.fn._lang = getLangDefinition(key);
        return r._abbr;
    };

    // returns language data
    moment.langData = function (key) {
        if (key && key._lang && key._lang._abbr) {
            key = key._lang._abbr;
        }
        return getLangDefinition(key);
    };

    // compare moment object
    moment.isMoment = function (obj) {
        return obj instanceof Moment ||
            (obj != null &&  obj.hasOwnProperty('_isAMomentObject'));
    };

    // for typechecking Duration objects
    moment.isDuration = function (obj) {
        return obj instanceof Duration;
    };

    for (i = lists.length - 1; i >= 0; --i) {
        makeList(lists[i]);
    }

    moment.normalizeUnits = function (units) {
        return normalizeUnits(units);
    };

    moment.invalid = function (flags) {
        var m = moment.utc(NaN);
        if (flags != null) {
            extend(m._pf, flags);
        }
        else {
            m._pf.userInvalidated = true;
        }

        return m;
    };

    moment.parseZone = function () {
        return moment.apply(null, arguments).parseZone();
    };

    moment.parseTwoDigitYear = function (input) {
        return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);
    };

    /************************************
        Moment Prototype
    ************************************/

    extend(moment.fn = Moment.prototype, {

        clone : function () {
            return moment(this);
        },

        valueOf : function () {
            return +this._d + ((this._offset || 0) * 60000);
        },

        unix : function () {
            return Math.floor(+this / 1000);
        },

        toString : function () {
            return this.clone().lang('en').format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ");
        },

        toDate : function () {
            return this._offset ? new Date(+this) : this._d;
        },

        toISOString : function () {
            var m = moment(this).utc();
            if (0 < m.year() && m.year() <= 9999) {
                return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
            } else {
                return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
            }
        },

        toArray : function () {
            var m = this;
            return [
                m.year(),
                m.month(),
                m.date(),
                m.hours(),
                m.minutes(),
                m.seconds(),
                m.milliseconds()
            ];
        },

        isValid : function () {
            return isValid(this);
        },

        isDSTShifted : function () {

            if (this._a) {
                return this.isValid() && compareArrays(this._a, (this._isUTC ? moment.utc(this._a) : moment(this._a)).toArray()) > 0;
            }

            return false;
        },

        parsingFlags : function () {
            return extend({}, this._pf);
        },

        invalidAt: function () {
            return this._pf.overflow;
        },

        utc : function () {
            return this.zone(0);
        },

        local : function () {
            this.zone(0);
            this._isUTC = false;
            return this;
        },

        format : function (inputString) {
            var output = formatMoment(this, inputString || moment.defaultFormat);
            return this.lang().postformat(output);
        },

        add : function (input, val) {
            var dur;
            // switch args to support add('s', 1) and add(1, 's')
            if (typeof input === 'string' && typeof val === 'string') {
                dur = moment.duration(isNaN(+val) ? +input : +val, isNaN(+val) ? val : input);
            } else if (typeof input === 'string') {
                dur = moment.duration(+val, input);
            } else {
                dur = moment.duration(input, val);
            }
            addOrSubtractDurationFromMoment(this, dur, 1);
            return this;
        },

        subtract : function (input, val) {
            var dur;
            // switch args to support subtract('s', 1) and subtract(1, 's')
            if (typeof input === 'string' && typeof val === 'string') {
                dur = moment.duration(isNaN(+val) ? +input : +val, isNaN(+val) ? val : input);
            } else if (typeof input === 'string') {
                dur = moment.duration(+val, input);
            } else {
                dur = moment.duration(input, val);
            }
            addOrSubtractDurationFromMoment(this, dur, -1);
            return this;
        },

        diff : function (input, units, asFloat) {
            var that = makeAs(input, this),
                zoneDiff = (this.zone() - that.zone()) * 6e4,
                diff, output;

            units = normalizeUnits(units);

            if (units === 'year' || units === 'month') {
                // average number of days in the months in the given dates
                diff = (this.daysInMonth() + that.daysInMonth()) * 432e5; // 24 * 60 * 60 * 1000 / 2
                // difference in months
                output = ((this.year() - that.year()) * 12) + (this.month() - that.month());
                // adjust by taking difference in days, average number of days
                // and dst in the given months.
                output += ((this - moment(this).startOf('month')) -
                        (that - moment(that).startOf('month'))) / diff;
                // same as above but with zones, to negate all dst
                output -= ((this.zone() - moment(this).startOf('month').zone()) -
                        (that.zone() - moment(that).startOf('month').zone())) * 6e4 / diff;
                if (units === 'year') {
                    output = output / 12;
                }
            } else {
                diff = (this - that);
                output = units === 'second' ? diff / 1e3 : // 1000
                    units === 'minute' ? diff / 6e4 : // 1000 * 60
                    units === 'hour' ? diff / 36e5 : // 1000 * 60 * 60
                    units === 'day' ? (diff - zoneDiff) / 864e5 : // 1000 * 60 * 60 * 24, negate dst
                    units === 'week' ? (diff - zoneDiff) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst
                    diff;
            }
            return asFloat ? output : absRound(output);
        },

        from : function (time, withoutSuffix) {
            return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix);
        },

        fromNow : function (withoutSuffix) {
            return this.from(moment(), withoutSuffix);
        },

        calendar : function (time) {
            // We want to compare the start of today, vs this.
            // Getting start-of-today depends on whether we're zone'd or not.
            var now = time || moment(),
                sod = makeAs(now, this).startOf('day'),
                diff = this.diff(sod, 'days', true),
                format = diff < -6 ? 'sameElse' :
                    diff < -1 ? 'lastWeek' :
                    diff < 0 ? 'lastDay' :
                    diff < 1 ? 'sameDay' :
                    diff < 2 ? 'nextDay' :
                    diff < 7 ? 'nextWeek' : 'sameElse';
            return this.format(this.lang().calendar(format, this));
        },

        isLeapYear : function () {
            return isLeapYear(this.year());
        },

        isDST : function () {
            return (this.zone() < this.clone().month(0).zone() ||
                this.zone() < this.clone().month(5).zone());
        },

        day : function (input) {
            var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
            if (input != null) {
                input = parseWeekday(input, this.lang());
                return this.add({ d : input - day });
            } else {
                return day;
            }
        },

        month : makeAccessor('Month', true),

        startOf: function (units) {
            units = normalizeUnits(units);
            // the following switch intentionally omits break keywords
            // to utilize falling through the cases.
            switch (units) {
            case 'year':
                this.month(0);
                /* falls through */
            case 'quarter':
            case 'month':
                this.date(1);
                /* falls through */
            case 'week':
            case 'isoWeek':
            case 'day':
                this.hours(0);
                /* falls through */
            case 'hour':
                this.minutes(0);
                /* falls through */
            case 'minute':
                this.seconds(0);
                /* falls through */
            case 'second':
                this.milliseconds(0);
                /* falls through */
            }

            // weeks are a special case
            if (units === 'week') {
                this.weekday(0);
            } else if (units === 'isoWeek') {
                this.isoWeekday(1);
            }

            // quarters are also special
            if (units === 'quarter') {
                this.month(Math.floor(this.month() / 3) * 3);
            }

            return this;
        },

        endOf: function (units) {
            units = normalizeUnits(units);
            return this.startOf(units).add((units === 'isoWeek' ? 'week' : units), 1).subtract('ms', 1);
        },

        isAfter: function (input, units) {
            units = typeof units !== 'undefined' ? units : 'millisecond';
            return +this.clone().startOf(units) > +moment(input).startOf(units);
        },

        isBefore: function (input, units) {
            units = typeof units !== 'undefined' ? units : 'millisecond';
            return +this.clone().startOf(units) < +moment(input).startOf(units);
        },

        isSame: function (input, units) {
            units = units || 'ms';
            return +this.clone().startOf(units) === +makeAs(input, this).startOf(units);
        },

        min: deprecate(
                 "moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",
                 function (other) {
                     other = moment.apply(null, arguments);
                     return other < this ? this : other;
                 }
         ),

        max: deprecate(
                "moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",
                function (other) {
                    other = moment.apply(null, arguments);
                    return other > this ? this : other;
                }
        ),

        // keepTime = true means only change the timezone, without affecting
        // the local hour. So 5:31:26 +0300 --[zone(2, true)]--> 5:31:26 +0200
        // It is possible that 5:31:26 doesn't exist int zone +0200, so we
        // adjust the time as needed, to be valid.
        //
        // Keeping the time actually adds/subtracts (one hour)
        // from the actual represented time. That is why we call updateOffset
        // a second time. In case it wants us to change the offset again
        // _changeInProgress == true case, then we have to adjust, because
        // there is no such time in the given timezone.
        zone : function (input, keepTime) {
            var offset = this._offset || 0;
            if (input != null) {
                if (typeof input === "string") {
                    input = timezoneMinutesFromString(input);
                }
                if (Math.abs(input) < 16) {
                    input = input * 60;
                }
                this._offset = input;
                this._isUTC = true;
                if (offset !== input) {
                    if (!keepTime || this._changeInProgress) {
                        addOrSubtractDurationFromMoment(this,
                                moment.duration(offset - input, 'm'), 1, false);
                    } else if (!this._changeInProgress) {
                        this._changeInProgress = true;
                        moment.updateOffset(this, true);
                        this._changeInProgress = null;
                    }
                }
            } else {
                return this._isUTC ? offset : this._d.getTimezoneOffset();
            }
            return this;
        },

        zoneAbbr : function () {
            return this._isUTC ? "UTC" : "";
        },

        zoneName : function () {
            return this._isUTC ? "Coordinated Universal Time" : "";
        },

        parseZone : function () {
            if (this._tzm) {
                this.zone(this._tzm);
            } else if (typeof this._i === 'string') {
                this.zone(this._i);
            }
            return this;
        },

        hasAlignedHourOffset : function (input) {
            if (!input) {
                input = 0;
            }
            else {
                input = moment(input).zone();
            }

            return (this.zone() - input) % 60 === 0;
        },

        daysInMonth : function () {
            return daysInMonth(this.year(), this.month());
        },

        dayOfYear : function (input) {
            var dayOfYear = round((moment(this).startOf('day') - moment(this).startOf('year')) / 864e5) + 1;
            return input == null ? dayOfYear : this.add("d", (input - dayOfYear));
        },

        quarter : function (input) {
            return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);
        },

        weekYear : function (input) {
            var year = weekOfYear(this, this.lang()._week.dow, this.lang()._week.doy).year;
            return input == null ? year : this.add("y", (input - year));
        },

        isoWeekYear : function (input) {
            var year = weekOfYear(this, 1, 4).year;
            return input == null ? year : this.add("y", (input - year));
        },

        week : function (input) {
            var week = this.lang().week(this);
            return input == null ? week : this.add("d", (input - week) * 7);
        },

        isoWeek : function (input) {
            var week = weekOfYear(this, 1, 4).week;
            return input == null ? week : this.add("d", (input - week) * 7);
        },

        weekday : function (input) {
            var weekday = (this.day() + 7 - this.lang()._week.dow) % 7;
            return input == null ? weekday : this.add("d", input - weekday);
        },

        isoWeekday : function (input) {
            // behaves the same as moment#day except
            // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)
            // as a setter, sunday should belong to the previous week.
            return input == null ? this.day() || 7 : this.day(this.day() % 7 ? input : input - 7);
        },

        isoWeeksInYear : function () {
            return weeksInYear(this.year(), 1, 4);
        },

        weeksInYear : function () {
            var weekInfo = this._lang._week;
            return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);
        },

        get : function (units) {
            units = normalizeUnits(units);
            return this[units]();
        },

        set : function (units, value) {
            units = normalizeUnits(units);
            if (typeof this[units] === 'function') {
                this[units](value);
            }
            return this;
        },

        // If passed a language key, it will set the language for this
        // instance.  Otherwise, it will return the language configuration
        // variables for this instance.
        lang : function (key) {
            if (key === undefined) {
                return this._lang;
            } else {
                this._lang = getLangDefinition(key);
                return this;
            }
        }
    });

    function rawMonthSetter(mom, value) {
        var dayOfMonth;

        // TODO: Move this out of here!
        if (typeof value === 'string') {
            value = mom.lang().monthsParse(value);
            // TODO: Another silent failure?
            if (typeof value !== 'number') {
                return mom;
            }
        }

        dayOfMonth = Math.min(mom.date(),
                daysInMonth(mom.year(), value));
        mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);
        return mom;
    }

    function rawGetter(mom, unit) {
        return mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]();
    }

    function rawSetter(mom, unit, value) {
        if (unit === 'Month') {
            return rawMonthSetter(mom, value);
        } else {
            return mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);
        }
    }

    function makeAccessor(unit, keepTime) {
        return function (value) {
            if (value != null) {
                rawSetter(this, unit, value);
                moment.updateOffset(this, keepTime);
                return this;
            } else {
                return rawGetter(this, unit);
            }
        };
    }

    moment.fn.millisecond = moment.fn.milliseconds = makeAccessor('Milliseconds', false);
    moment.fn.second = moment.fn.seconds = makeAccessor('Seconds', false);
    moment.fn.minute = moment.fn.minutes = makeAccessor('Minutes', false);
    // Setting the hour should keep the time, because the user explicitly
    // specified which hour he wants. So trying to maintain the same hour (in
    // a new timezone) makes sense. Adding/subtracting hours does not follow
    // this rule.
    moment.fn.hour = moment.fn.hours = makeAccessor('Hours', true);
    // moment.fn.month is defined separately
    moment.fn.date = makeAccessor('Date', true);
    moment.fn.dates = deprecate("dates accessor is deprecated. Use date instead.", makeAccessor('Date', true));
    moment.fn.year = makeAccessor('FullYear', true);
    moment.fn.years = deprecate("years accessor is deprecated. Use year instead.", makeAccessor('FullYear', true));

    // add plural methods
    moment.fn.days = moment.fn.day;
    moment.fn.months = moment.fn.month;
    moment.fn.weeks = moment.fn.week;
    moment.fn.isoWeeks = moment.fn.isoWeek;
    moment.fn.quarters = moment.fn.quarter;

    // add aliased format methods
    moment.fn.toJSON = moment.fn.toISOString;

    /************************************
        Duration Prototype
    ************************************/

    extend(moment.duration.fn = Duration.prototype, {

        _bubble : function () {
            var milliseconds = this._milliseconds,
                days = this._days,
                months = this._months,
                data = this._data,
                seconds, minutes, hours, years;

            // The following code bubbles up values, see the tests for
            // examples of what that means.
            data.milliseconds = milliseconds % 1000;

            seconds = absRound(milliseconds / 1000);
            data.seconds = seconds % 60;

            minutes = absRound(seconds / 60);
            data.minutes = minutes % 60;

            hours = absRound(minutes / 60);
            data.hours = hours % 24;

            days += absRound(hours / 24);
            data.days = days % 30;

            months += absRound(days / 30);
            data.months = months % 12;

            years = absRound(months / 12);
            data.years = years;
        },

        weeks : function () {
            return absRound(this.days() / 7);
        },

        valueOf : function () {
            return this._milliseconds +
              this._days * 864e5 +
              (this._months % 12) * 2592e6 +
              toInt(this._months / 12) * 31536e6;
        },

        humanize : function (withSuffix) {
            var difference = +this,
                output = relativeTime(difference, !withSuffix, this.lang());

            if (withSuffix) {
                output = this.lang().pastFuture(difference, output);
            }

            return this.lang().postformat(output);
        },

        add : function (input, val) {
            // supports only 2.0-style add(1, 's') or add(moment)
            var dur = moment.duration(input, val);

            this._milliseconds += dur._milliseconds;
            this._days += dur._days;
            this._months += dur._months;

            this._bubble();

            return this;
        },

        subtract : function (input, val) {
            var dur = moment.duration(input, val);

            this._milliseconds -= dur._milliseconds;
            this._days -= dur._days;
            this._months -= dur._months;

            this._bubble();

            return this;
        },

        get : function (units) {
            units = normalizeUnits(units);
            return this[units.toLowerCase() + 's']();
        },

        as : function (units) {
            units = normalizeUnits(units);
            return this['as' + units.charAt(0).toUpperCase() + units.slice(1) + 's']();
        },

        lang : moment.fn.lang,

        toIsoString : function () {
            // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js
            var years = Math.abs(this.years()),
                months = Math.abs(this.months()),
                days = Math.abs(this.days()),
                hours = Math.abs(this.hours()),
                minutes = Math.abs(this.minutes()),
                seconds = Math.abs(this.seconds() + this.milliseconds() / 1000);

            if (!this.asSeconds()) {
                // this is the same as C#'s (Noda) and python (isodate)...
                // but not other JS (goog.date)
                return 'P0D';
            }

            return (this.asSeconds() < 0 ? '-' : '') +
                'P' +
                (years ? years + 'Y' : '') +
                (months ? months + 'M' : '') +
                (days ? days + 'D' : '') +
                ((hours || minutes || seconds) ? 'T' : '') +
                (hours ? hours + 'H' : '') +
                (minutes ? minutes + 'M' : '') +
                (seconds ? seconds + 'S' : '');
        }
    });

    function makeDurationGetter(name) {
        moment.duration.fn[name] = function () {
            return this._data[name];
        };
    }

    function makeDurationAsGetter(name, factor) {
        moment.duration.fn['as' + name] = function () {
            return +this / factor;
        };
    }

    for (i in unitMillisecondFactors) {
        if (unitMillisecondFactors.hasOwnProperty(i)) {
            makeDurationAsGetter(i, unitMillisecondFactors[i]);
            makeDurationGetter(i.toLowerCase());
        }
    }

    makeDurationAsGetter('Weeks', 6048e5);
    moment.duration.fn.asMonths = function () {
        return (+this - this.years() * 31536e6) / 2592e6 + this.years() * 12;
    };

    /************************************
        Default Lang
    ************************************/

    // Set default language, other languages will inherit from English.
    moment.lang('en', {
        ordinal : function (number) {
            var b = number % 10,
                output = (toInt(number % 100 / 10) === 1) ? 'th' :
                (b === 1) ? 'st' :
                (b === 2) ? 'nd' :
                (b === 3) ? 'rd' : 'th';
            return number + output;
        }
    });
// moment.js language configuration
// language : german (de)
// author : lluchs : https://github.com/lluchs
// author: Menelion Elensúle: https://github.com/Oire

(function (factory) {
    factory(moment);
}(function (moment) {
    function processRelativeTime(number, withoutSuffix, key, isFuture) {
        var format = {
            'm': ['eine Minute', 'einer Minute'],
            'h': ['eine Stunde', 'einer Stunde'],
            'd': ['ein Tag', 'einem Tag'],
            'dd': [number + ' Tage', number + ' Tagen'],
            'M': ['ein Monat', 'einem Monat'],
            'MM': [number + ' Monate', number + ' Monaten'],
            'y': ['ein Jahr', 'einem Jahr'],
            'yy': [number + ' Jahre', number + ' Jahren']
        };
        return withoutSuffix ? format[key][0] : format[key][1];
    }

    return moment.lang('de', {
        months : "Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),
        monthsShort : "Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),
        weekdays : "Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),
        weekdaysShort : "So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),
        weekdaysMin : "So_Mo_Di_Mi_Do_Fr_Sa".split("_"),
        longDateFormat : {
            LT: "HH:mm [Uhr]",
            L : "DD.MM.YYYY",
            LL : "D. MMMM YYYY",
            LLL : "D. MMMM YYYY LT",
            LLLL : "dddd, D. MMMM YYYY LT"
        },
        calendar : {
            sameDay: "[Heute um] LT",
            sameElse: "L",
            nextDay: '[Morgen um] LT',
            nextWeek: 'dddd [um] LT',
            lastDay: '[Gestern um] LT',
            lastWeek: '[letzten] dddd [um] LT'
        },
        relativeTime : {
            future : "in %s",
            past : "vor %s",
            s : "ein paar Sekunden",
            m : processRelativeTime,
            mm : "%d Minuten",
            h : processRelativeTime,
            hh : "%d Stunden",
            d : processRelativeTime,
            dd : processRelativeTime,
            M : processRelativeTime,
            MM : processRelativeTime,
            y : processRelativeTime,
            yy : processRelativeTime
        },
        ordinal : '%d.',
        week : {
            dow : 1, // Monday is the first day of the week.
            doy : 4  // The week that contains Jan 4th is the first week of the year.
        }
    });
}));

    moment.lang('de');

    /************************************
        Exposing Moment
    ************************************/

    function makeGlobal(shouldDeprecate) {
        /*global ender:false */
        if (typeof ender !== 'undefined') {
            return;
        }
        oldGlobalMoment = globalScope.moment;
        if (shouldDeprecate) {
            globalScope.moment = deprecate(
                    "Accessing Moment through the global scope is " +
                    "deprecated, and will be removed in an upcoming " +
                    "release.",
                    moment);
        } else {
            globalScope.moment = moment;
        }
    }

    // CommonJS module is defined
    if (hasModule) {
        module.exports = moment;
    } else if (typeof define === "function" && define.amd) {
        define("moment", function (require, exports, module) {
            if (module.config && module.config() && module.config().noGlobal === true) {
                // release the global variable
                globalScope.moment = oldGlobalMoment;
            }

            return moment;
        });
        makeGlobal(true);
    } else {
        makeGlobal();
    }
}).call(this);
   /* Ende moment */
   /* Start mustache */
   /*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

/*global define: false*/

(function (root, factory) {
  if (typeof exports === "object" && exports) {
    factory(exports); // CommonJS
  } else {
    var mustache = {};
    factory(mustache);
    if (typeof define === "function" && define.amd) {
      define(mustache); // AMD
    } else {
      root.Mustache = mustache; // <script>
    }
  }
}(this, function (mustache) {

  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577
  // See https://github.com/janl/mustache.js/issues/189
  var RegExp_test = RegExp.prototype.test;
  function testRegExp(re, string) {
    return RegExp_test.call(re, string);
  }

  var nonSpaceRe = /\S/;
  function isWhitespace(string) {
    return !testRegExp(nonSpaceRe, string);
  }

  var Object_toString = Object.prototype.toString;
  var isArray = Array.isArray || function (object) {
    return Object_toString.call(object) === '[object Array]';
  };

  function isFunction(object) {
    return typeof object === 'function';
  }

  function escapeRegExp(string) {
    return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&");
  }

  var entityMap = {
    "&": "&amp;",
    "<": "&lt;",
    ">": "&gt;",
    '"': '&quot;',
    "'": '&#39;',
    "/": '&#x2F;'
  };

  function escapeHtml(string) {
    return String(string).replace(/[&<>"'\/]/g, function (s) {
      return entityMap[s];
    });
  }

  function escapeTags(tags) {
    if (!isArray(tags) || tags.length !== 2) {
      throw new Error('Invalid tags: ' + tags);
    }

    return [
      new RegExp(escapeRegExp(tags[0]) + "\\s*"),
      new RegExp("\\s*" + escapeRegExp(tags[1]))
    ];
  }

  var whiteRe = /\s*/;
  var spaceRe = /\s+/;
  var equalsRe = /\s*=/;
  var curlyRe = /\s*\}/;
  var tagRe = /#|\^|\/|>|\{|&|=|!/;

  /**
   * Breaks up the given `template` string into a tree of tokens. If the `tags`
   * argument is given here it must be an array with two string values: the
   * opening and closing tags used in the template (e.g. [ "<%", "%>" ]). Of
   * course, the default is to use mustaches (i.e. mustache.tags).
   *
   * A token is an array with at least 4 elements. The first element is the
   * mustache symbol that was used inside the tag, e.g. "#" or "&". If the tag
   * did not contain a symbol (i.e. {{myValue}}) this element is "name". For
   * all text that appears outside a symbol this element is "text".
   *
   * The second element of a token is its "value". For mustache tags this is
   * whatever else was inside the tag besides the opening symbol. For text tokens
   * this is the text itself.
   *
   * The third and fourth elements of the token are the start and end indices,
   * respectively, of the token in the original template.
   *
   * Tokens that are the root node of a subtree contain two more elements: 1) an
   * array of tokens in the subtree and 2) the index in the original template at
   * which the closing tag for that section begins.
   */
  function parseTemplate(template, tags) {
    tags = tags || mustache.tags;
    template = template || '';

    if (typeof tags === 'string') {
      tags = tags.split(spaceRe);
    }

    var tagRes = escapeTags(tags);
    var scanner = new Scanner(template);

    var sections = [];     // Stack to hold section tokens
    var tokens = [];       // Buffer to hold the tokens
    var spaces = [];       // Indices of whitespace tokens on the current line
    var hasTag = false;    // Is there a {{tag}} on the current line?
    var nonSpace = false;  // Is there a non-space char on the current line?

    // Strips all whitespace tokens array for the current line
    // if there was a {{#tag}} on it and otherwise only space.
    function stripSpace() {
      if (hasTag && !nonSpace) {
        while (spaces.length) {
          delete tokens[spaces.pop()];
        }
      } else {
        spaces = [];
      }

      hasTag = false;
      nonSpace = false;
    }

    var start, type, value, chr, token, openSection;
    while (!scanner.eos()) {
      start = scanner.pos;

      // Match any text between tags.
      value = scanner.scanUntil(tagRes[0]);
      if (value) {
        for (var i = 0, len = value.length; i < len; ++i) {
          chr = value.charAt(i);

          if (isWhitespace(chr)) {
            spaces.push(tokens.length);
          } else {
            nonSpace = true;
          }

          tokens.push(['text', chr, start, start + 1]);
          start += 1;

          // Check for whitespace on the current line.
          if (chr === '\n') {
            stripSpace();
          }
        }
      }

      // Match the opening tag.
      if (!scanner.scan(tagRes[0])) break;
      hasTag = true;

      // Get the tag type.
      type = scanner.scan(tagRe) || 'name';
      scanner.scan(whiteRe);

      // Get the tag value.
      if (type === '=') {
        value = scanner.scanUntil(equalsRe);
        scanner.scan(equalsRe);
        scanner.scanUntil(tagRes[1]);
      } else if (type === '{') {
        value = scanner.scanUntil(new RegExp('\\s*' + escapeRegExp('}' + tags[1])));
        scanner.scan(curlyRe);
        scanner.scanUntil(tagRes[1]);
        type = '&';
      } else {
        value = scanner.scanUntil(tagRes[1]);
      }

      // Match the closing tag.
      if (!scanner.scan(tagRes[1])) {
        throw new Error('Unclosed tag at ' + scanner.pos);
      }

      token = [ type, value, start, scanner.pos ];
      tokens.push(token);

      if (type === '#' || type === '^') {
        sections.push(token);
      } else if (type === '/') {
        // Check section nesting.
        openSection = sections.pop();

        if (!openSection) {
          throw new Error('Unopened section "' + value + '" at ' + start);
        }
        if (openSection[1] !== value) {
          throw new Error('Unclosed section "' + openSection[1] + '" at ' + start);
        }
      } else if (type === 'name' || type === '{' || type === '&') {
        nonSpace = true;
      } else if (type === '=') {
        // Set the tags for the next time around.
        tagRes = escapeTags(tags = value.split(spaceRe));
      }
    }

    // Make sure there are no open sections when we're done.
    openSection = sections.pop();
    if (openSection) {
      throw new Error('Unclosed section "' + openSection[1] + '" at ' + scanner.pos);
    }

    return nestTokens(squashTokens(tokens));
  }

  /**
   * Combines the values of consecutive text tokens in the given `tokens` array
   * to a single token.
   */
  function squashTokens(tokens) {
    var squashedTokens = [];

    var token, lastToken;
    for (var i = 0, len = tokens.length; i < len; ++i) {
      token = tokens[i];

      if (token) {
        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {
          lastToken[1] += token[1];
          lastToken[3] = token[3];
        } else {
          squashedTokens.push(token);
          lastToken = token;
        }
      }
    }

    return squashedTokens;
  }

  /**
   * Forms the given array of `tokens` into a nested tree structure where
   * tokens that represent a section have two additional items: 1) an array of
   * all tokens that appear in that section and 2) the index in the original
   * template that represents the end of that section.
   */
  function nestTokens(tokens) {
    var nestedTokens = [];
    var collector = nestedTokens;
    var sections = [];

    var token, section;
    for (var i = 0, len = tokens.length; i < len; ++i) {
      token = tokens[i];

      switch (token[0]) {
      case '#':
      case '^':
        collector.push(token);
        sections.push(token);
        collector = token[4] = [];
        break;
      case '/':
        section = sections.pop();
        section[5] = token[2];
        collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;
        break;
      default:
        collector.push(token);
      }
    }

    return nestedTokens;
  }

  /**
   * A simple string scanner that is used by the template parser to find
   * tokens in template strings.
   */
  function Scanner(string) {
    this.string = string;
    this.tail = string;
    this.pos = 0;
  }

  /**
   * Returns `true` if the tail is empty (end of string).
   */
  Scanner.prototype.eos = function () {
    return this.tail === "";
  };

  /**
   * Tries to match the given regular expression at the current position.
   * Returns the matched text if it can match, the empty string otherwise.
   */
  Scanner.prototype.scan = function (re) {
    var match = this.tail.match(re);

    if (match && match.index === 0) {
      var string = match[0];
      this.tail = this.tail.substring(string.length);
      this.pos += string.length;
      return string;
    }

    return "";
  };

  /**
   * Skips all text until the given regular expression can be matched. Returns
   * the skipped string, which is the entire tail if no match can be made.
   */
  Scanner.prototype.scanUntil = function (re) {
    var index = this.tail.search(re), match;

    switch (index) {
    case -1:
      match = this.tail;
      this.tail = "";
      break;
    case 0:
      match = "";
      break;
    default:
      match = this.tail.substring(0, index);
      this.tail = this.tail.substring(index);
    }

    this.pos += match.length;

    return match;
  };

  /**
   * Represents a rendering context by wrapping a view object and
   * maintaining a reference to the parent context.
   */
  function Context(view, parentContext) {
    this.view = view == null ? {} : view;
    this.cache = { '.': this.view };
    this.parent = parentContext;
  }

  /**
   * Creates a new context using the given view with this context
   * as the parent.
   */
  Context.prototype.push = function (view) {
    return new Context(view, this);
  };

  /**
   * Returns the value of the given name in this context, traversing
   * up the context hierarchy if the value is absent in this context's view.
   */
  Context.prototype.lookup = function (name) {
    var value;
    if (name in this.cache) {
      value = this.cache[name];
    } else {
      var context = this;

      while (context) {
        if (name.indexOf('.') > 0) {
          value = context.view;

          var names = name.split('.'), i = 0;
          while (value != null && i < names.length) {
            value = value[names[i++]];
          }
        } else {
          value = context.view[name];
        }

        if (value != null) break;

        context = context.parent;
      }

      this.cache[name] = value;
    }

    if (isFunction(value)) {
      value = value.call(this.view);
    }

    return value;
  };

  /**
   * A Writer knows how to take a stream of tokens and render them to a
   * string, given a context. It also maintains a cache of templates to
   * avoid the need to parse the same template twice.
   */
  function Writer() {
    this.cache = {};
  }

  /**
   * Clears all cached templates in this writer.
   */
  Writer.prototype.clearCache = function () {
    this.cache = {};
  };

  /**
   * Parses and caches the given `template` and returns the array of tokens
   * that is generated from the parse.
   */
  Writer.prototype.parse = function (template, tags) {
    var cache = this.cache;
    var tokens = cache[template];

    if (tokens == null) {
      tokens = cache[template] = parseTemplate(template, tags);
    }

    return tokens;
  };

  /**
   * High-level method that is used to render the given `template` with
   * the given `view`.
   *
   * The optional `partials` argument may be an object that contains the
   * names and templates of partials that are used in the template. It may
   * also be a function that is used to load partial templates on the fly
   * that takes a single argument: the name of the partial.
   */
  Writer.prototype.render = function (template, view, partials) {
    var tokens = this.parse(template);
    var context = (view instanceof Context) ? view : new Context(view);
    return this.renderTokens(tokens, context, partials, template);
  };

  /**
   * Low-level method that renders the given array of `tokens` using
   * the given `context` and `partials`.
   *
   * Note: The `originalTemplate` is only ever used to extract the portion
   * of the original template that was contained in a higher-order section.
   * If the template doesn't use higher-order sections, this argument may
   * be omitted.
   */
  Writer.prototype.renderTokens = function (tokens, context, partials, originalTemplate) {
    var buffer = '';

    // This function is used to render an arbitrary template
    // in the current context by higher-order sections.
    var self = this;
    function subRender(template) {
      return self.render(template, context, partials);
    }

    var token, value;
    for (var i = 0, len = tokens.length; i < len; ++i) {
      token = tokens[i];

      switch (token[0]) {
      case '#':
        value = context.lookup(token[1]);
        if (!value) continue;

        if (isArray(value)) {
          for (var j = 0, jlen = value.length; j < jlen; ++j) {
            buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);
          }
        } else if (typeof value === 'object' || typeof value === 'string') {
          buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);
        } else if (isFunction(value)) {
          if (typeof originalTemplate !== 'string') {
            throw new Error('Cannot use higher-order sections without the original template');
          }

          // Extract the portion of the original template that the section contains.
          value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);

          if (value != null) buffer += value;
        } else {
          buffer += this.renderTokens(token[4], context, partials, originalTemplate);
        }

        break;
      case '^':
        value = context.lookup(token[1]);

        // Use JavaScript's definition of falsy. Include empty arrays.
        // See https://github.com/janl/mustache.js/issues/186
        if (!value || (isArray(value) && value.length === 0)) {
          buffer += this.renderTokens(token[4], context, partials, originalTemplate);
        }

        break;
      case '>':
        if (!partials) continue;
        value = isFunction(partials) ? partials(token[1]) : partials[token[1]];
        if (value != null) buffer += this.renderTokens(this.parse(value), context, partials, value);
        break;
      case '&':
        value = context.lookup(token[1]);
        if (value != null) buffer += value;
        break;
      case 'name':
        value = context.lookup(token[1]);
        if (value != null) buffer += mustache.escape(value);
        break;
      case 'text':
        buffer += token[1];
        break;
      }
    }

    return buffer;
  };

  mustache.name = "mustache.js";
  mustache.version = "0.8.1";
  mustache.tags = [ "{{", "}}" ];

  // All high-level mustache.* functions use this writer.
  var defaultWriter = new Writer();

  /**
   * Clears all cached templates in the default writer.
   */
  mustache.clearCache = function () {
    return defaultWriter.clearCache();
  };

  /**
   * Parses and caches the given template in the default writer and returns the
   * array of tokens it contains. Doing this ahead of time avoids the need to
   * parse templates on the fly as they are rendered.
   */
  mustache.parse = function (template, tags) {
    return defaultWriter.parse(template, tags);
  };

  /**
   * Renders the `template` with the given `view` and `partials` using the
   * default writer.
   */
  mustache.render = function (template, view, partials) {
    return defaultWriter.render(template, view, partials);
  };

  // This is here for backwards compatibility with 0.4.x.
  mustache.to_html = function (template, view, partials, send) {
    var result = mustache.render(template, view, partials);

    if (isFunction(send)) {
      send(result);
    } else {
      return result;
    }
  };

  // Export the escaping function so that the user may override it.
  // See https://github.com/janl/mustache.js/issues/244
  mustache.escape = escapeHtml;

  // Export these mainly for testing, but also for advanced usage.
  mustache.Scanner = Scanner;
  mustache.Context = Context;
  mustache.Writer = Writer;

}));
   /* Ende mustache */
   /* Start custom.modernizr */
   /*! Modernizr 2.6.2 (Custom Build) | MIT & BSD
 * Build: http://modernizr.com/download/#-inlinesvg-svg-svgclippaths-touch-shiv-mq-cssclasses-teststyles-prefixes-ie8compat-load
 * --GSBDocStart
 * @module Modernizr (Custom Build)
 * @version 2.6.2
 * @see {@link http://modernizr.com/download/#-inlinesvg-svg-svgclippaths-touch-shiv-mq-cssclasses-teststyles-prefixes-ie8compat-load}
 * @author Faruk Ateş
 * @license MIT & MIT-BSD license
 * 
 * @desc Informiert darüber, welche HTML, CSS und Javascripts Features der Benutzer sieht.  
 *--GSBDocEnd
 */
window.Modernizr=function(a,b,c){function y(a){j.cssText=a;}function z(a,b){return y(m.join(a+";")+(b||""));}function A(a,b){return typeof a===b;}function B(a,b){return !!~(""+a).indexOf(b);}function C(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c){return d===!1?a[e]:A(f,"function")?f.bind(d||b):f;}}return !1;}var d="2.6.2",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k,l={}.toString,m=" -webkit- -moz- -o- -ms- ".split(" "),n={svg:"http://www.w3.org/2000/svg"},o={},p={},q={},r=[],s=r.slice,t,u=function(a,c,d,e){var f,i,j,k,l=b.createElement("div"),m=b.body,n=m||b.createElement("body");if(parseInt(d,10)){while(d--){j=b.createElement("div"),j.id=e?e[d]:h+(d+1),l.appendChild(j);}}return f=["&#173;",'<style id="s',h,'">',a,"</style>"].join(""),l.id=h,(m?l:n).innerHTML+=f,n.appendChild(l),m||(n.style.background="",n.style.overflow="hidden",k=g.style.overflow,g.style.overflow="hidden",g.appendChild(n)),i=c(l,a),m?l.parentNode.removeChild(l):(n.parentNode.removeChild(n),g.style.overflow=k),!!i;},v=function(b){var c=a.matchMedia||a.msMatchMedia;if(c){return c(b).matches;}var d;return u("@media "+b+" { #"+h+" { position: absolute; } }",function(b){d=(a.getComputedStyle?getComputedStyle(b,null):b.currentStyle)["position"]=="absolute";}),d;},w={}.hasOwnProperty,x;!A(w,"undefined")&&!A(w.call,"undefined")?x=function(a,b){return w.call(a,b);}:x=function(a,b){return b in a&&A(a.constructor.prototype[b],"undefined");},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function"){throw new TypeError;}var d=s.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(s.call(arguments)));return Object(g)===g?g:f;}return c.apply(b,d.concat(s.call(arguments)));};return e;}),o.touch=function(){var c;return"ontouchstart" in a||a.DocumentTouch&&b instanceof DocumentTouch?c=!0:u(["@media (",m.join("touch-enabled),("),h,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(a){c=a.offsetTop===9;}),c;},o.svg=function(){return !!b.createElementNS&&!!b.createElementNS(n.svg,"svg").createSVGRect;},o.inlinesvg=function(){var a=b.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==n.svg;},o.svgclippaths=function(){return !!b.createElementNS&&/SVGClipPath/.test(l.call(b.createElementNS(n.svg,"clipPath")));};for(var D in o){x(o,D)&&(t=D.toLowerCase(),e[t]=o[D](),r.push((e[t]?"":"no-")+t));}return e.addTest=function(a,b){if(typeof a=="object"){for(var d in a){x(a,d)&&e.addTest(d,a[d]);}}else{a=a.toLowerCase();if(e[a]!==c){return e;}b=typeof b=="function"?b():b,typeof f!="undefined"&&f&&(g.className+=" "+(b?"":"no-")+a),e[a]=b;}return e;},y(""),i=k=null,function(a,b){function k(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild);}function l(){var a=r.elements;return typeof a=="string"?a.split(" "):a;}function m(a){var b=i[a[g]];return b||(b={},h++,a[g]=h,i[h]=b),b;}function n(a,c,f){c||(c=b);if(j){return c.createElement(a);}f||(f=m(c));var g;return f.cache[a]?g=f.cache[a].cloneNode():e.test(a)?g=(f.cache[a]=f.createElem(a)).cloneNode():g=f.createElem(a),g.canHaveChildren&&!d.test(a)?f.frag.appendChild(g):g;}function o(a,c){a||(a=b);if(j){return a.createDocumentFragment();}c=c||m(a);var d=c.frag.cloneNode(),e=0,f=l(),g=f.length;for(;e<g;e++){d.createElement(f[e]);}return d;}function p(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return r.shivMethods?n(c,a,b):b.createElem(c);},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+l().join().replace(/\w+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")';})+");return n}")(r,b.frag);}function q(a){a||(a=b);var c=m(a);return r.shivCSS&&!f&&!c.hasCSS&&(c.hasCSS=!!k(a,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),j||p(a,c),a;}var c=a.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,e=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f,g="_html5shiv",h=0,i={},j;(function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",f="hidden" in a,j=a.childNodes.length==1||function(){b.createElement("a");var a=b.createDocumentFragment();return typeof a.cloneNode=="undefined"||typeof a.createDocumentFragment=="undefined"||typeof a.createElement=="undefined";}();}catch(c){f=!0,j=!0;}})();var r={elements:c.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:c.shivCSS!==!1,supportsUnknownElements:j,shivMethods:c.shivMethods!==!1,type:"default",shivDocument:q,createElement:n,createDocumentFragment:o};a.html5=r,q(b);}(this,b),e._version=d,e._prefixes=m,e.mq=v,e.testStyles=u,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+r.join(" "):""),e;}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==o.call(a);}function e(a){return"string"==typeof a;}function f(){}function g(a){return !a||"loaded"==a||"complete"==a||"uninitialized"==a;}function h(){var a=p.shift();q=1,a?a.t?m(function(){("c"==a.t?B.injectCss:B.injectJs)(a.s,0,a.a,a.x,a.e,1);},0):(a(),h()):q=0;}function i(a,c,d,e,f,i,j){function k(b){if(!o&&g(l.readyState)&&(u.r=o=1,!q&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&m(function(){t.removeChild(l);},50);for(var d in y[c]){y[c].hasOwnProperty(d)&&y[c][d].onload();}}}var j=j||B.errorTimeout,l=b.createElement(a),o=0,r=0,u={t:d,s:c,e:f,a:i,x:j};1===y[c]&&(r=1,y[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,r);},p.splice(e,0,u),"img"!=a&&(r||2===y[c]?(t.insertBefore(l,s?null:n),m(k,j)):y[c].push(l));}function j(a,b,c,d,f){return q=0,b=b||"j",e(a)?i("c"==b?v:u,a,b,this.i++,c,d,f):(p.splice(this.i++,0,a),1==p.length&&h()),this;}function k(){var a=B;return a.loader={load:j,i:0},a;}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance" in l.style,s=r&&!!b.createRange().compareNode,t=s?l:n.parentNode,l=a.opera&&"[object Opera]"==o.call(a.opera),l=!!b.attachEvent&&!l,u=r?"object":l?"script":"img",v=l?"script":u,w=Array.isArray||function(a){return"[object Array]"==o.call(a);},x=[],y={},z={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a;}},A,B;B=function(a){function b(a){var a=a.split("!"),b=x.length,c=a.pop(),d=a.length,c={url:c,origUrl:c,prefixes:a},e,f,g;for(f=0;f<d;f++){g=a[f].split("="),(e=z[g.shift()])&&(c=e(c,g));}for(f=0;f<b;f++){c=x[f](c);}return c;}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(y[i.url]?i.noexec=!0:y[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),y[i.url]=2;})));}function h(a,b){function c(a,c){if(a){if(e(a)){c||(j=function(){var a=[].slice.call(arguments);k.apply(this,a),l();}),g(a,j,b,0,h);}else{if(Object(a)===a){for(n in m=function(){var b=0,c;for(c in a){a.hasOwnProperty(c)&&b++;}return b;}(),a){a.hasOwnProperty(n)&&(!c&&!--m&&(d(j)?j=function(){var a=[].slice.call(arguments);k.apply(this,a),l();}:j[n]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),l();};}(k[n])),g(a[n],j,b,n,h));}}}}else{!c&&l();}}var h=!!a.test,i=a.load||a.both,j=a.callback||f,k=j,l=a.complete||f,m,n;c(h?a.yep:a.nope,!!i),i&&c(i);}var i,j,l=this.yepnope.loader;if(e(a)){g(a,0,l,0);}else{if(w(a)){for(i=0;i<a.length;i++){j=a[i],e(j)?g(j,0,l,0):w(j)?B(j):Object(j)===j&&h(j,l);}}else{Object(a)===a&&h(a,l);}}},B.addPrefix=function(a,b){z[a]=b;},B.addFilter=function(a){x.push(a);},B.errorTimeout=10000,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",A=function(){b.removeEventListener("DOMContentLoaded",A,0),b.readyState="complete";},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k=b.createElement("script"),l,o,e=e||B.errorTimeout;k.src=a;for(o in d){k.setAttribute(o,d[o]);}c=j?h:c||f,k.onreadystatechange=k.onload=function(){!l&&g(k.readyState)&&(l=1,c(),k.onload=k.onreadystatechange=null);},m(function(){l||(l=1,c(1));},e),i?k.onload():n.parentNode.insertBefore(k,n);},a.yepnope.injectCss=function(a,c,d,e,g,i){var e=b.createElement("link"),j,c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d){e.setAttribute(j,d[j]);}g||(n.parentNode.insertBefore(e,n),m(c,0));};}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0));},Modernizr.addTest("ie8compat",function(){return !window.addEventListener&&document.documentMode&&document.documentMode===7;});
   /* Ende custom.modernizr */
   /* Start jquery.mmenu */
   (function($){var _PLUGIN_="mmenu",_VERSION_="5.5.3";if($[_PLUGIN_]&&$[_PLUGIN_].version>_VERSION_){return;}$[_PLUGIN_]=function($menu,opts,conf){this.$menu=$menu;this._api=["bind","init","update","setSelected","getInstance","openPanel","closePanel","closeAllPanels"];this.opts=opts;this.conf=conf;this.vars={};this.cbck={};if(typeof this.___deprecated=="function"){this.___deprecated();}this._initMenu();this._initAnchors();var $pnls=this.$pnls.children();this._initAddons();this.init($pnls);if(typeof this.___debug=="function"){this.___debug();}return this;};$[_PLUGIN_].version=_VERSION_;$[_PLUGIN_].addons={};$[_PLUGIN_].uniqueId=0;$[_PLUGIN_].defaults={extensions:[],navbar:{add:true,title:"Menu",titleLink:"panel"},onClick:{setSelected:true},slidingSubmenus:true};$[_PLUGIN_].configuration={classNames:{divider:"Divider",inset:"Inset",panel:"Panel",selected:"Selected",spacer:"Spacer",vertical:"Vertical"},clone:false,openingInterval:25,panelNodetype:"ul, ol, div",transitionDuration:400};$[_PLUGIN_].prototype={init:function($panels){$panels=$panels.not("."+_c.nopanel);$panels=this._initPanels($panels);this.trigger("init",$panels);this.trigger("update");},update:function(){this.trigger("update");},setSelected:function($li){this.$menu.find("."+_c.listview).children().removeClass(_c.selected);$li.addClass(_c.selected);this.trigger("setSelected",$li);},openPanel:function($panel){var $l=$panel.parent();if($l.hasClass(_c.vertical)){var $sub=$l.parents("."+_c.subopened);if($sub.length){return this.openPanel($sub.first());}$l.addClass(_c.opened);}else{if($panel.hasClass(_c.current)){return;}var $panels=this.$pnls.children("."+_c.panel),$current=$panels.filter("."+_c.current);$panels.removeClass(_c.highest).removeClass(_c.current).not($panel).not($current).not("."+_c.vertical).addClass(_c.hidden);if(!$[_PLUGIN_].support.csstransitions){$current.addClass(_c.hidden);}if($panel.hasClass(_c.opened)){$panel.nextAll("."+_c.opened).addClass(_c.highest).removeClass(_c.opened).removeClass(_c.subopened);}else{$panel.addClass(_c.highest);$current.addClass(_c.subopened);}$panel.removeClass(_c.hidden).addClass(_c.current);setTimeout(function(){$panel.removeClass(_c.subopened).addClass(_c.opened);},this.conf.openingInterval);}this.trigger("openPanel",$panel);},closePanel:function($panel){var $l=$panel.parent();if($l.hasClass(_c.vertical)){$l.removeClass(_c.opened);this.trigger("closePanel",$panel);}},closeAllPanels:function(){this.$menu.find("."+_c.listview).children().removeClass(_c.selected).filter("."+_c.vertical).removeClass(_c.opened);var $pnls=this.$pnls.children("."+_c.panel),$frst=$pnls.first();this.$pnls.children("."+_c.panel).not($frst).removeClass(_c.subopened).removeClass(_c.opened).removeClass(_c.current).removeClass(_c.highest).addClass(_c.hidden);this.openPanel($frst);},togglePanel:function($panel){var $l=$panel.parent();if($l.hasClass(_c.vertical)){this[$l.hasClass(_c.opened)?"closePanel":"openPanel"]($panel);}},getInstance:function(){return this;},bind:function(event,fn){this.cbck[event]=this.cbck[event]||[];this.cbck[event].push(fn);},trigger:function(){var that=this,args=Array.prototype.slice.call(arguments),evnt=args.shift();if(this.cbck[evnt]){for(var e=0,l=this.cbck[evnt].length;e<l;e++){this.cbck[evnt][e].apply(that,args);}}},_initMenu:function(){var that=this;if(this.opts.offCanvas&&this.conf.clone){this.$menu=this.$menu.clone(true);this.$menu.add(this.$menu.find("[id]")).filter("[id]").each(function(){$(this).attr("id",_c.mm($(this).attr("id")));});}this.$menu.contents().each(function(){if($(this)[0].nodeType==3){$(this).remove();}});this.$pnls=$('<div class="'+_c.panels+'" />').append(this.$menu.children(this.conf.panelNodetype)).prependTo(this.$menu);this.$menu.parent().addClass(_c.wrapper);var clsn=[_c.menu];if(!this.opts.slidingSubmenus){clsn.push(_c.vertical);}this.opts.extensions=(this.opts.extensions.length)?"mm-"+this.opts.extensions.join(" mm-"):"";if(this.opts.extensions){clsn.push(this.opts.extensions);}this.$menu.addClass(clsn.join(" "));},_initPanels:function($panels){var that=this;var $lists=this.__findAddBack($panels,"ul, ol");this.__refactorClass($lists,this.conf.classNames.inset,"inset").addClass(_c.nolistview+" "+_c.nopanel);$lists.not("."+_c.nolistview).addClass(_c.listview);var $lis=this.__findAddBack($panels,"."+_c.listview).children();this.__refactorClass($lis,this.conf.classNames.selected,"selected");this.__refactorClass($lis,this.conf.classNames.divider,"divider");this.__refactorClass($lis,this.conf.classNames.spacer,"spacer");this.__refactorClass(this.__findAddBack($panels,"."+this.conf.classNames.panel),this.conf.classNames.panel,"panel");var $curpanels=$(),$oldpanels=$panels.add($panels.find("."+_c.panel)).add(this.__findAddBack($panels,"."+_c.listview).children().children(this.conf.panelNodetype)).not("."+_c.nopanel);this.__refactorClass($oldpanels,this.conf.classNames.vertical,"vertical");if(!this.opts.slidingSubmenus){$oldpanels.addClass(_c.vertical);}$oldpanels.each(function(){var $t=$(this),$p=$t;if($t.is("ul, ol")){$t.wrap('<div class="'+_c.panel+'" />');$p=$t.parent();}else{$p.addClass(_c.panel);}var id=$t.attr("id");$t.removeAttr("id");$p.attr("id",id||that.__getUniqueId());if($t.hasClass(_c.vertical)){$t.removeClass(that.conf.classNames.vertical);$p.add($p.parent()).addClass(_c.vertical);}$curpanels=$curpanels.add($p);});var $allpanels=$("."+_c.panel,this.$menu);$curpanels.each(function(i){var $t=$(this),$p=$t.parent(),$a=$p.children("a, span").first();if(!$p.is("."+_c.panels)){$p.data(_d.sub,$t);$t.data(_d.parent,$p);}if(!$p.children("."+_c.next).length){if($p.parent().is("."+_c.listview)){var id=$t.attr("id"),$b=$('<a class="'+_c.next+'" href="#'+id+'" data-target="#'+id+'" />').insertBefore($a);if($a.is("span")){$b.addClass(_c.fullsubopen);}}}if(!$t.children("."+_c.navbar).length){if(!$p.hasClass(_c.vertical)){if($p.parent().is("."+_c.listview)){var $p=$p.closest("."+_c.panel);}else{var $a=$p.closest("."+_c.panel).find('a[href="#'+$t.attr("id")+'"]').first(),$p=$a.closest("."+_c.panel);}var $navbar=$('<div class="'+_c.navbar+'" />');if($p.length){var id=$p.attr("id");switch(that.opts.navbar.titleLink){case"anchor":_url=$a.attr("href");break;case"panel":case"parent":_url="#"+id;break;case"none":default:_url=false;break;}$navbar.append('<a class="'+_c.btn+" "+_c.prev+'" href="#'+id+'" data-target="#'+id+'" />').append($('<a class="'+_c.title+'"'+(_url?' href="'+_url+'"':"")+" />").text($a.text())).prependTo($t);if(that.opts.navbar.add){$t.addClass(_c.hasnavbar);}}else{if(that.opts.navbar.title){$navbar.append('<a class="'+_c.title+'">'+that.opts.navbar.title+"</a>").prependTo($t);if(that.opts.navbar.add){$t.addClass(_c.hasnavbar);}}}}}});var $s=this.__findAddBack($panels,"."+_c.listview).children("."+_c.selected).removeClass(_c.selected).last().addClass(_c.selected);$s.add($s.parentsUntil("."+_c.menu,"li")).filter("."+_c.vertical).addClass(_c.opened).end().not("."+_c.vertical).each(function(){$(this).parentsUntil("."+_c.menu,"."+_c.panel).not("."+_c.vertical).first().addClass(_c.opened).parentsUntil("."+_c.menu,"."+_c.panel).not("."+_c.vertical).first().addClass(_c.opened).addClass(_c.subopened);});$s.children("."+_c.panel).not("."+_c.vertical).addClass(_c.opened).parentsUntil("."+_c.menu,"."+_c.panel).not("."+_c.vertical).first().addClass(_c.opened).addClass(_c.subopened);var $current=$allpanels.filter("."+_c.opened);if(!$current.length){$current=$curpanels.first();}$current.addClass(_c.opened).last().addClass(_c.current);$curpanels.not("."+_c.vertical).not($current.last()).addClass(_c.hidden).end().appendTo(this.$pnls);return $curpanels;},_initAnchors:function(){var that=this;glbl.$body.on(_e.click+"-oncanvas","a[href]",function(e){var $t=$(this),fired=false,inMenu=that.$menu.find($t).length;for(var a in $[_PLUGIN_].addons){if(fired=$[_PLUGIN_].addons[a].clickAnchor.call(that,$t,inMenu)){break;}}if(!fired&&inMenu){var _h=$t.attr("href");if(_h.length>1&&_h.slice(0,1)=="#"){try{var $h=$(_h,that.$menu);if($h.is("."+_c.panel)){fired=true;that[$t.parent().hasClass(_c.vertical)?"togglePanel":"openPanel"]($h);}}catch(err){}}}if(fired){e.preventDefault();}if(!fired&&inMenu){if($t.is("."+_c.listview+" > li > a")&&!$t.is('[rel="external"]')&&!$t.is('[target="_blank"]')){if(that.__valueOrFn(that.opts.onClick.setSelected,$t)){that.setSelected($(e.target).parent());}var preventDefault=that.__valueOrFn(that.opts.onClick.preventDefault,$t,_h.slice(0,1)=="#");if(preventDefault){e.preventDefault();}if(that.__valueOrFn(that.opts.onClick.close,$t,preventDefault)){that.close();}}}});},_initAddons:function(){for(var a in $[_PLUGIN_].addons){$[_PLUGIN_].addons[a].add.call(this);$[_PLUGIN_].addons[a].add=function(){};}for(var a in $[_PLUGIN_].addons){$[_PLUGIN_].addons[a].setup.call(this);}},__api:function(){var that=this,api={};$.each(this._api,function(i){var fn=this;api[fn]=function(){var re=that[fn].apply(that,arguments);return(typeof re=="undefined")?api:re;};});return api;},__valueOrFn:function(o,$e,d){if(typeof o=="function"){return o.call($e[0]);}if(typeof o=="undefined"&&typeof d!="undefined"){return d;}return o;},__refactorClass:function($e,o,c){return $e.filter("."+o).removeClass(o).addClass(_c[c]);},__findAddBack:function($e,s){return $e.find(s).add($e.filter(s));},__filterListItems:function($i){return $i.not("."+_c.divider).not("."+_c.hidden);},__transitionend:function($e,fn,duration){var _ended=false,_fn=function(){if(!_ended){fn.call($e[0]);}_ended=true;};$e.one(_e.transitionend,_fn);$e.one(_e.webkitTransitionEnd,_fn);setTimeout(_fn,duration*1.1);},__getUniqueId:function(){return _c.mm($[_PLUGIN_].uniqueId++);}};$.fn[_PLUGIN_]=function(opts,conf){initPlugin();opts=$.extend(true,{},$[_PLUGIN_].defaults,opts);conf=$.extend(true,{},$[_PLUGIN_].configuration,conf);return this.each(function(){var $menu=$(this);if($menu.data(_PLUGIN_)){return;}var _menu=new $[_PLUGIN_]($menu,opts,conf);$menu.data(_PLUGIN_,_menu.__api());});};$[_PLUGIN_].support={touch:"ontouchstart" in window||navigator.msMaxTouchPoints,csstransitions:(function(){if(typeof Modernizr!=="undefined"&&typeof Modernizr.csstransitions!=="undefined"){return Modernizr.csstransitions;}var b=document.body||document.documentElement,s=b.style,p="transition";if(typeof s[p]=="string"){return true;}var v=["Moz","webkit","Webkit","Khtml","O","ms"];p=p.charAt(0).toUpperCase()+p.substr(1);for(var i=0;i<v.length;i++){if(typeof s[v[i]+p]=="string"){return true;}}return false;})()};var _c,_d,_e,glbl;function initPlugin(){if($[_PLUGIN_].glbl){return;}glbl={$wndw:$(window),$html:$("html"),$body:$("body")};_c={};_d={};_e={};$.each([_c,_d,_e],function(i,o){o.add=function(a){a=a.split(" ");for(var b=0,l=a.length;b<l;b++){o[a[b]]=o.mm(a[b]);}};});_c.mm=function(c){return"mm-"+c;};_c.add("wrapper menu panels panel nopanel current highest opened subopened navbar hasnavbar title btn prev next listview nolistview inset vertical selected divider spacer hidden fullsubopen");_c.umm=function(c){if(c.slice(0,3)=="mm-"){c=c.slice(3);}return c;};_d.mm=function(d){return"mm-"+d;};_d.add("parent sub");_e.mm=function(e){return e+".mm";};_e.add("transitionend webkitTransitionEnd mousedown mouseup touchstart touchmove touchend click keydown");$[_PLUGIN_]._c=_c;$[_PLUGIN_]._d=_d;$[_PLUGIN_]._e=_e;$[_PLUGIN_].glbl=glbl;}})(jQuery);(function($){var _PLUGIN_="mmenu",_ADDON_="offCanvas";$[_PLUGIN_].addons[_ADDON_]={setup:function(){if(!this.opts[_ADDON_]){return;}var that=this,opts=this.opts[_ADDON_],conf=this.conf[_ADDON_];glbl=$[_PLUGIN_].glbl;this._api=$.merge(this._api,["open","close","setPage"]);if(opts.position=="top"||opts.position=="bottom"){opts.zposition="front";}if(typeof conf.pageSelector!="string"){conf.pageSelector="> "+conf.pageNodetype;}glbl.$allMenus=(glbl.$allMenus||$()).add(this.$menu);this.vars.opened=false;var clsn=[_c.offcanvas];if(opts.position!="left"){clsn.push(_c.mm(opts.position));}if(opts.zposition!="back"){clsn.push(_c.mm(opts.zposition));}this.$menu.addClass(clsn.join(" ")).parent().removeClass(_c.wrapper);this.setPage(glbl.$page);this._initBlocker();this["_initWindow_"+_ADDON_]();this.$menu[conf.menuInjectMethod+"To"](conf.menuWrapperSelector);},add:function(){_c=$[_PLUGIN_]._c;_d=$[_PLUGIN_]._d;_e=$[_PLUGIN_]._e;_c.add("offcanvas slideout blocking modal background opening blocker page");_d.add("style");_e.add("resize");},clickAnchor:function($a,inMenu){if(!this.opts[_ADDON_]){return false;}var id=this.$menu.attr("id");if(id&&id.length){if(this.conf.clone){id=_c.umm(id);}if($a.is('[href="#'+id+'"]')){this.open();return true;}}if(!glbl.$page){return;}var id=glbl.$page.first().attr("id");if(id&&id.length){if($a.is('[href="#'+id+'"]')){this.close();return true;}}return false;}};$[_PLUGIN_].defaults[_ADDON_]={position:"left",zposition:"back",blockUI:true,moveBackground:true};$[_PLUGIN_].configuration[_ADDON_]={pageNodetype:"div",pageSelector:null,noPageSelector:[],wrapPageIfNeeded:true,menuWrapperSelector:"body",menuInjectMethod:"prepend"};$[_PLUGIN_].prototype.open=function(){if(this.vars.opened){return;}var that=this;this._openSetup();setTimeout(function(){that._openFinish();},this.conf.openingInterval);this.trigger("open");};$[_PLUGIN_].prototype._openSetup=function(){var that=this,opts=this.opts[_ADDON_];this.closeAllOthers();glbl.$page.each(function(){$(this).data(_d.style,$(this).attr("style")||"");});glbl.$wndw.trigger(_e.resize+"-"+_ADDON_,[true]);var clsn=[_c.opened];if(opts.blockUI){clsn.push(_c.blocking);}if(opts.blockUI=="modal"){clsn.push(_c.modal);}if(opts.moveBackground){clsn.push(_c.background);}if(opts.position!="left"){clsn.push(_c.mm(this.opts[_ADDON_].position));}if(opts.zposition!="back"){clsn.push(_c.mm(this.opts[_ADDON_].zposition));}if(this.opts.extensions){clsn.push(this.opts.extensions);}glbl.$html.addClass(clsn.join(" "));setTimeout(function(){that.vars.opened=true;},this.conf.openingInterval);this.$menu.addClass(_c.current+" "+_c.opened);};$[_PLUGIN_].prototype._openFinish=function(){var that=this;this.__transitionend(glbl.$page.first(),function(){that.trigger("opened");},this.conf.transitionDuration);glbl.$html.addClass(_c.opening);this.trigger("opening");};$[_PLUGIN_].prototype.close=function(){if(!this.vars.opened){return;}var that=this;this.__transitionend(glbl.$page.first(),function(){that.$menu.removeClass(_c.current).removeClass(_c.opened);glbl.$html.removeClass(_c.opened).removeClass(_c.blocking).removeClass(_c.modal).removeClass(_c.background).removeClass(_c.mm(that.opts[_ADDON_].position)).removeClass(_c.mm(that.opts[_ADDON_].zposition));if(that.opts.extensions){glbl.$html.removeClass(that.opts.extensions);}glbl.$page.each(function(){$(this).attr("style",$(this).data(_d.style));});that.vars.opened=false;that.trigger("closed");},this.conf.transitionDuration);glbl.$html.removeClass(_c.opening);this.trigger("close");this.trigger("closing");};$[_PLUGIN_].prototype.closeAllOthers=function(){glbl.$allMenus.not(this.$menu).each(function(){var api=$(this).data(_PLUGIN_);if(api&&api.close){api.close();}});};$[_PLUGIN_].prototype.setPage=function($page){var that=this,conf=this.conf[_ADDON_];if(!$page||!$page.length){$page=glbl.$body.find(conf.pageSelector);if(conf.noPageSelector.length){$page=$page.not(conf.noPageSelector.join(", "));}if($page.length>1&&conf.wrapPageIfNeeded){$page=$page.wrapAll("<"+this.conf[_ADDON_].pageNodetype+" />").parent();}}$page.each(function(){$(this).attr("id",$(this).attr("id")||that.__getUniqueId());});$page.addClass(_c.page+" "+_c.slideout);glbl.$page=$page;this.trigger("setPage",$page);};$[_PLUGIN_].prototype["_initWindow_"+_ADDON_]=function(){glbl.$wndw.off(_e.keydown+"-"+_ADDON_).on(_e.keydown+"-"+_ADDON_,function(e){if(glbl.$html.hasClass(_c.opened)){if(e.keyCode==9){e.preventDefault();return false;}}});var _h=0;glbl.$wndw.off(_e.resize+"-"+_ADDON_).on(_e.resize+"-"+_ADDON_,function(e,force){if(glbl.$page.length==1){if(force||glbl.$html.hasClass(_c.opened)){var nh=glbl.$wndw.height();if(force||nh!=_h){_h=nh;glbl.$page.css("minHeight",nh);}}}});};$[_PLUGIN_].prototype._initBlocker=function(){var that=this;if(!this.opts[_ADDON_].blockUI){return;}if(!glbl.$blck){glbl.$blck=$('<div id="'+_c.blocker+'" class="'+_c.slideout+'" />');}glbl.$blck.appendTo(glbl.$body).off(_e.touchstart+"-"+_ADDON_+" "+_e.touchmove+"-"+_ADDON_).on(_e.touchstart+"-"+_ADDON_+" "+_e.touchmove+"-"+_ADDON_,function(e){e.preventDefault();e.stopPropagation();glbl.$blck.trigger(_e.mousedown+"-"+_ADDON_);}).off(_e.mousedown+"-"+_ADDON_).on(_e.mousedown+"-"+_ADDON_,function(e){e.preventDefault();if(!glbl.$html.hasClass(_c.modal)){that.closeAllOthers();that.close();}});};var _c,_d,_e,glbl;})(jQuery);
   /* Ende jquery.mmenu */
   /* Start jquery.mmenu.debugger */
   /*  
 * Debugger for jQuery mmenu
 * Include this file after including the jquery.mmenu plugin to debug your menu.
 */


(function( $ ) {

  var _PLUGIN_ = 'mmenu';
  
  if ( typeof console == 'undefined' )
  {
    return false;
  }

  var _log   = document[ _PLUGIN_ + '_debug_log' ]   || console.log,
    _warn  = document[ _PLUGIN_ + '_debug_warn' ]   || console.warn;

  var glbl = $[ _PLUGIN_ ].glbl,
    _c = $[ _PLUGIN_ ]._c,
    _d = $[ _PLUGIN_ ]._d,
    _e = $[ _PLUGIN_ ]._e;


  function debug( msg )
  {
    _log( 'MMENU: ' + msg );
  };
  function deprecated( depr, repl, vers )
  {
    var msg = 'MMENU: ' + depr + ' is deprecated';

    if ( vers )
    {
      msg += ' as of version ' + vers;
    }
    if ( repl )
    {
      msg += ', use ' + repl + ' instead';
    }
    msg += '.';

    _warn( msg );
  };


  $[ _PLUGIN_ ].prototype.___deprecated = function()
  {
    var extensions = this.opts.extensions.join( ' ' );

    //  Options 5.5
    if ( this.opts.offCanvas )
    {
      if ( typeof this.opts.offCanvas.modal != 'undefined' )
      {
        deprecated( 'The option "offCanvas.modal"', '"offCanvas.blockUI"', '5.5' );
      }
    }
    if ( typeof this.opts.onClick.blockUI != 'undefined' )
    {
      deprecated( 'The option "onClick.blockUI"', null, '5.5' );
    }

    var arr = {
      'menu'     : [ 'zoom', 'slide', 'fade' ],
      'panels'  : [ 'zoom', 'slide' ],
      'listitems'  : [ 'slide' ]
    };
    for ( var a in arr )
    {
      for ( var b in arr[ a ] )
      {
        var _o = 'effect-' + arr[ a ][ b ] + '-' + a,
          _n = 'effect-' + a + '-' + arr[ a ][ b ];

        if ( extensions.indexOf( _o ) > -1 )
        {
          deprecated( 'The "' + _o + '" extension', '"' + _n + '"', '5.5' );  
        }
      }
    }

    //  Options 5.2
    if ( typeof this.opts.searchfield != 'undefined' )
    {
      if ( typeof this.opts.searchfield.addTo == 'menu' )
      {
        deprecated( 'The value "menu" for the "searchfield.addTo" option', 'the "navbars" add-on', '5.2' );
      }
    }

    //  Options 5.1
    if ( typeof this.opts.header != 'undefined' )
    {
      deprecated( 'The "header" add-on', 'the "navbars" add-on', '5.1' );
    }
    if ( typeof this.opts.footer != 'undefined' )
    {
      deprecated( 'The "footer" add-on', 'the "navbars" add-on', '5.1' );
    }
    if ( extensions.indexOf( 'effect-slide' ) > -1 &&
       extensions.indexOf( 'effect-menu-slide' ) == -1
    ) {
      deprecated( 'The "effect-slide" extension', '"effect-menu-slide"', '5.1' );  
    }

    //  Configuration 5.1
    if ( typeof this.conf.classNames.header != 'undefined' )
    {
      deprecated( 'The "header" add-on', 'the "navbars" add-on', '5.1' );
    }
    if ( typeof this.conf.classNames.footer != 'undefined' )
    {
      deprecated( 'The "footer" add-on', 'the "navbars" add-on', '5.1' );
    }
    if ( typeof this.conf.classNames.buttonbars != 'undefined' )
    {
      deprecated( 'The "buttonbars" add-on', false, '5.1' );
    }

    //  HTML 5.1
    if ( this.$menu.find( '.Buttonbar' ).length )
    {
      deprecated( 'The buttonbars add-on', false, '5.1' );
    }


    //  Options 5.0
    if ( typeof this.opts.labels != 'undefined' )
    {
      deprecated( 'The "labels" add-on', '"dividers"', '5.0' );
    }
    if ( typeof this.opts.classes != 'undefined' )
    {
      deprecated( 'The option "classes"', '"extensions"', '5.0' );
    }
    if ( typeof this.opts.searchfield != 'undefined' )
    {
      if ( typeof this.opts.searchfield.showLinksOnly != 'undefined' )
      {
        deprecated( 'The option "searchfield.showLinksOnly"', '"!searchfield.showTextItems"', '5.0' );
      }
    }
    
    //  Configuration 5.0
    if ( typeof this.conf.classNames.label != 'undefined' )
    {
      deprecated( 'The configuration option "classNames.labels"', '"classNames.dividers"', '5.0' );
    }
    
    //  HTML 5.0
    if ( this.$menu.find( '.Label' ).length )
    {
      deprecated( 'The classname "Label"', '"Divider"', '5.0' );
    }
    if ( $( '.FixedTop' ).length )
    {
      deprecated( 'The classname "FixedTop"', '"Fixed"', '5.0' );
    }
    if ( $( '.FixedBottom' ).length )
    {
      deprecated( 'The classname "FixedBottom"', '"Fixed"', '5.0' );
    }

    //  Custom events 5.0
    this.$menu.on(
      'setPage setPage.mm setSelected setSelected.mm open open.mm opening opening.mm opened opened.mm close close.mm closing closing.mm closed closed.mm toggle toggle.mm',
      function( e )
      {
        deprecated( 'The custom event "' + e.type + '"', 'the API', '5.0' );
      }
    )


    //  Vendors 4.4
    if ( typeof 'Hammer' == 'function' && Hammer.VERSION < 2 )
    {
      deprecated( 'Older version of the Hammer library', 'version 2 or newer', '4.4' );
      return;
    }


    //  Options 4.3
    for ( var a = [ 'position', 'zposition', 'modal', 'moveBackground' ], b = 0, l = a.length; b < l; b++ )
    {
      if ( typeof this.opts[ a[ b ] ] != 'undefined' )
      {
        deprecated( 'The option "' + a[ b ] + '"', 'offCanvas.' + a[ b ], '4.3' );
      }
    }

    //  Configuration 4.3
    for ( var a = [ 'panel', 'list', 'selected', 'label', 'spacer' ], b = 0, l = a.length; b < l; b++ )
    {
      if ( typeof this.conf[ a[ b ] + 'Class' ] != 'undefined' )
      {
        deprecated( 'The configuration option "' + a[ b ] + 'Class"', 'classNames.' + a[ b ], '4.3' );
      }
    }
    if ( typeof this.conf.counterClass != 'undefined' )
    {
      deprecated( 'The configuration option "counterClass"', 'classNames.counters.counter', '4.3' );
    }
    if ( typeof this.conf.collapsedClass != 'undefined' )
    {
      deprecated( 'The configuration option "collapsedClass"', 'classNames.labels.collapsed', '4,3' );
    }
    if ( typeof this.conf.header != 'undefined' )
    {
      for ( var a = [ 'panelHeader', 'panelNext', 'panelPrev' ], b = 0, l = a.length; b < l; b++ )
      {
        if ( typeof this.conf.header[ a[ b ] + 'Class' ] != 'undefined' )
        {
          deprecated( 'The configuration option "header.' + a[ b ] + 'Class"', 'classNames.header.' + a[ b ], '4.3' );
        }
      }
    }
    for ( var a = [ 'pageNodetype', 'pageSelector', 'menuWrapperSelector', 'menuInjectMethod' ], b = 0, l = a.length; b < l; b++ )
    {
      if ( typeof this.conf[ a[ b ] ] != 'undefined' )
      {
        deprecated( 'The configuration option "' + a[ b ] + '"', 'offCanvas.' + a[ b ], '4.3' );
      }
    }


    //  Options 4.2
    if ( this.opts.offCanvas )
    {
      if ( this.opts.offCanvas.position == 'top' || this.opts.offCanvas.position == 'bottom' )
      {
        if ( this.opts.offCanvas.zposition == 'back' || this.opts.offCanvas.zposition == 'next' )
        {
          deprecated( 'Using offCanvas.position "' + this.opts.offCanvas.position + '" in combination with offCanvas.zposition "' + this.opts.offCanvas.zposition + '"', 'offCanvas.zposition "front"', '4.2' );
        }
      }
    }


    //  Options 4.1
    if ( this.opts.onClick && typeof this.opts.onClick.setLocationHref != 'undefined' )
    {
      deprecated( 'The option "onClick.setLocationHref"', '!onClick.preventDefault', '4.1' );
    }

    //  Configuration 4.1
    if ( typeof this.conf.panelNodeType != 'undefined' )
    {
      deprecated( 'The configuration option "panelNodeType"', 'panelNodetype', '4.1' );
    }
  };



  $[ _PLUGIN_ ].prototype.___debug = function()
  {
    var extensions = this.opts.extensions;

    //  non-available add-ons
    for ( var a = [ 'autoHeight', 'backButton', 'counters', 'dividers', 'dragOpen', 'navbars', 'offCanvas', 'searchfield', 'sectionIndexer', 'toggles' ], b = 0, l = a.length; b < l; b++ )
    {
      if ( typeof this.opts[ a[ b ] ] != 'undefined' )
      {
        if ( typeof $[ _PLUGIN_ ].addons[ a[ b ] ] == 'undefined' )
        {
          debug( 'The "' + a[ b ] + '" add-on is not available.' );
        }
      }
    }
    if ( typeof $[ _PLUGIN_ ].addons.searchfield == 'undefined' )
    {
      if ( typeof this.opts.navbars != 'undefined' )
      {
        if ( this.opts.navbars instanceof Array )
        {
          for( var n = 0; n < this.opts.navbars.length; n++ )
          {
            if ( this.opts.navbars[ n ].content instanceof Array )
            {
              for ( var c = 0; c < this.opts.navbars[ n ].content.length; c++ )
              {
                if ( this.opts.navbars[ n ].content[ c ] == 'searchfield' )
                {
                  debug( 'The "searchfield" add-on is not available.' );
                }
              }
            }
          }
        }
      }
    }

    var position  = false,
      zposition  = false;

    if ( this.opts.offCanvas )
    {
      position  = this.opts.offCanvas.position;
      zposition  = this.opts.offCanvas.zposition;
    }

    //  background color
    if ( zposition == 'back' )
    {
      var bg = $('body').css( 'background-color' );
      if ( typeof bg == 'undefined' || bg  == '' || bg == 'transparent' )
      {
        debug( 'Set a background-color for the <BODY />.' );
      }
    }

    if ( position == 'left' || position == 'right' )
    {
      if ( this.opts.autoHeight && this.opts.autoHeight.height != 'default' )
      {
        debug( 'Don\'t use the "autoHeight" option with the "offCanvas.position" option set to "' + position + '".' );
      }
    }

    //  incompattible with iconbar
    var fxSlide   = ( extensions.indexOf( 'mm-effect-menu-slide' )   > -1 ),
      fxZoom    = ( extensions.indexOf( 'mm-effect-menu-zoom' )   > -1 ),
      fxZoomPnls  = ( extensions.indexOf( 'mm-effect-panels-zoom' ) > -1 ),
      iconbar    = ( $[ _PLUGIN_ ].glbl.$page && parseInt( $[ _PLUGIN_ ].glbl.$page.css( 'padding-right' ) ) > 0 );

    if ( iconbar )
    {
      //  iconbar + effects
      if ( fxSlide || fxZoom )
      {
        debug( 'Don\'t use the "iconbar" extension in combination with the "' + ( fxSlide ? 'menu-slide' : 'menu-zoom' ) + '" effect.' );
      }
      
      //  iconbar + (z)position
      if ( this.opts.offCanvas )
      {
        if ( position != 'left' )
        {
          debug( 'Don\'t use the "iconbar" extension in combination with the "offCanvas.position" option set to "' + position + '".' );
        }
        if ( zposition != 'back' )
        {
          debug( 'Don\'t use the "iconbar" extension in combination with the "offCanvas.zposition" option set to "' + zposition + '".' );
        }
      }
    }

    //  effects + vertical submenus
    if ( fxZoomPnls && !this.opts.slidingSubmenus )
    {
      debug( 'Don\'t use the "panels-zoom" effect in combination with the "slidingSubmenus" option set to "false".' );
    }

    //  effects +  onCanvas / (z)position
    if ( fxSlide || fxZoom )
    {
      if ( this.opts.offCanvas )
      {
        if ( position == 'top' || position == 'bottom' )
        {
          debug( 'Don\'t use the "' + ( fxSlide ? 'menu-slide' : 'menu-zoom' ) + '" effect in combination with the "offCanvas.position" option set to "' + position + '".' );
        }
        if ( zposition != 'back' )
        {
          debug( 'Don\'t use the "' + ( fxSlide ? 'menu-slide' : 'menu-zoom' ) + '" effect in combination with the "offCanvas.zposition" option set to "' + zposition + '".' );
        }
      }
      else
      {
        debug( 'Don\'t use the "' + ( fxSlide ? 'menu-slide' : 'menu-zoom' ) + '" effect in combination with the "offCanvas" option set to "false".' );
      }
    }
  };


})( jQuery );
   /* Ende jquery.mmenu.debugger */
   /* Start jquery.mmenu.navbars.min */
   /*  
 * jQuery mmenu navbar addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
!function(n){var a="mmenu",t="navbars";n[a].addons[t]={setup:function(){var r=this,s=this.opts[t],c=this.conf[t];if(i=n[a].glbl,"undefined"!=typeof s){s instanceof Array||(s=[s]);var d={};n.each(s,function(i){var o=s[i];"boolean"==typeof o&&o&&(o={}),"object"!=typeof o&&(o={}),"undefined"==typeof o.content&&(o.content=["prev","title"]),o.content instanceof Array||(o.content=[o.content]),o=n.extend(!0,{},r.opts.navbar,o);var l=o.position,h=o.height;"number"!=typeof h&&(h=1),h=Math.min(4,Math.max(1,h)),"bottom"!=l&&(l="top"),d[l]||(d[l]=0),d[l]++;var f=n("<div />").addClass(e.navbar+" "+e.navbar+"-"+l+" "+e.navbar+"-"+l+"-"+d[l]+" "+e.navbar+"-size-"+h);d[l]+=h-1;for(var v=0,p=o.content.length;p>v;v++){var u=n[a].addons[t][o.content[v]]||!1;u?u.call(r,f,o,c):(u=o.content[v],u instanceof n||(u=n(o.content[v])),u.each(function(){f.append(n(this))}))}var b=Math.ceil(f.children().not("."+e.btn).length/h);b>1&&f.addClass(e.navbar+"-content-"+b),f.children("."+e.btn).length&&f.addClass(e.hasbtns),f.prependTo(r.$menu)});for(var o in d)r.$menu.addClass(e.hasnavbar+"-"+o+"-"+d[o])}},add:function(){e=n[a]._c,r=n[a]._d,s=n[a]._e,e.add("close hasbtns")},clickAnchor:function(){}},n[a].configuration[t]={breadcrumbSeparator:"/"},n[a].configuration.classNames[t]={panelTitle:"Title",panelNext:"Next",panelPrev:"Prev"};var e,r,s,i}(jQuery),/*  
 * jQuery mmenu navbar addon breadcrumbs content
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
function(n){var a="mmenu",t="navbars",e="breadcrumbs";n[a].addons[t][e]=function(t,e,r){var s=n[a]._c,i=n[a]._d;s.add("breadcrumbs separator"),t.append('<span class="'+s.breadcrumbs+'"></span>'),this.bind("init",function(a){a.removeClass(s.hasnavbar).each(function(){for(var a=[],t=n(this),e=n('<span class="'+s.breadcrumbs+'"></span>'),c=n(this).children().first(),d=!0;c&&c.length;){c.is("."+s.panel)||(c=c.closest("."+s.panel));var o=c.children("."+s.navbar).children("."+s.title).text();a.unshift(d?"<span>"+o+"</span>":'<a href="#'+c.attr("id")+'">'+o+"</a>"),d=!1,c=c.data(i.parent)}e.append(a.join('<span class="'+s.separator+'">'+r.breadcrumbSeparator+"</span>")).appendTo(t.children("."+s.navbar))})});var c=function(){var n=this.$pnls.children("."+s.current),a=t.find("."+s.breadcrumbs),e=n.children("."+s.navbar).children("."+s.breadcrumbs);a.html(e.html())};this.bind("openPanel",c),this.bind("init",c)}}(jQuery),/*  
 * jQuery mmenu navbar addon close content
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
function(n){var a="mmenu",t="navbars",e="close";n[a].addons[t][e]=function(t){var e=n[a]._c,r=n[a].glbl;t.append('<a class="'+e.close+" "+e.btn+'" href="#"></a>');var s=function(n){t.find("."+e.close).attr("href","#"+n.attr("id"))};s.call(this,r.$page),this.bind("setPage",s)}}(jQuery),/*  
 * jQuery mmenu navbar addon next content
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
function(n){var a="mmenu",t="navbars",e="next";n[a].addons[t][e]=function(e){var r=n[a]._c;e.append('<a class="'+r.next+" "+r.btn+'" href="#"></a>');var s=function(n){n=n||this.$pnls.children("."+r.current);var a=e.find("."+r.next),s=n.find("."+this.conf.classNames[t].panelNext),i=s.attr("href"),c=s.html();a[i?"attr":"removeAttr"]("href",i),a[i||c?"removeClass":"addClass"](r.hidden),a.html(c)};this.bind("openPanel",s),this.bind("init",function(){s.call(this)})}}(jQuery),/*  
 * jQuery mmenu navbar addon prev content
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
function(n){var a="mmenu",t="navbars",e="prev";n[a].addons[t][e]=function(e){var r=n[a]._c;e.append('<a class="'+r.prev+" "+r.btn+'" href="#"></a>'),this.bind("init",function(n){n.removeClass(r.hasnavbar)});var s=function(){var n=this.$pnls.children("."+r.current),a=e.find("."+r.prev),s=n.find("."+this.conf.classNames[t].panelPrev);s.length||(s=n.children("."+r.navbar).children("."+r.prev));var i=s.attr("href"),c=s.html();a[i?"attr":"removeAttr"]("href",i),a[i||c?"removeClass":"addClass"](r.hidden),a.html(c)};this.bind("openPanel",s),this.bind("init",s)}}(jQuery),/*  
 * jQuery mmenu navbar addon searchfield content
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
function(n){var a="mmenu",t="navbars",e="searchfield";n[a].addons[t][e]=function(t){var e=n[a]._c,r=n('<div class="'+e.search+'" />').appendTo(t);"object"!=typeof this.opts.searchfield&&(this.opts.searchfield={}),this.opts.searchfield.add=!0,this.opts.searchfield.addTo=r}}(jQuery),/*  
 * jQuery mmenu navbar addon title content
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
function(n){var a="mmenu",t="navbars",e="title";n[a].addons[t][e]=function(e,r){var s=n[a]._c;e.append('<a class="'+s.title+'"></a>');var i=function(n){n=n||this.$pnls.children("."+s.current);var a=e.find("."+s.title),i=n.find("."+this.conf.classNames[t].panelTitle);i.length||(i=n.children("."+s.navbar).children("."+s.title));var c=i.attr("href"),d=i.html()||r.title;a[c?"attr":"removeAttr"]("href",c),a[c||d?"removeClass":"addClass"](s.hidden),a.html(d)};this.bind("openPanel",i),this.bind("init",function(){i.call(this)})}}(jQuery);
   /* Ende jquery.mmenu.navbars.min */
   /* Start jquery.mmenu.searchfield */
   /*  
 * jQuery mmenu searchfield addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */

(function( $ ) {

  var _PLUGIN_ = 'mmenu',
    _ADDON_  = 'searchfield';


  $[ _PLUGIN_ ].addons[ _ADDON_ ] = {

    //  setup: fired once per menu
    setup: function()
    {
      var that = this,
        opts = this.opts[ _ADDON_ ],
        conf = this.conf[ _ADDON_ ];

      glbl = $[ _PLUGIN_ ].glbl;


      //  Extend shortcut options
      if ( typeof opts == 'boolean' )
      {
        opts = {
          add: opts
        };
      }
      if ( typeof opts != 'object' )
      {
        opts = {};
      }
      opts = this.opts[ _ADDON_ ] = $.extend( true, {}, $[ _PLUGIN_ ].defaults[ _ADDON_ ], opts );

      this.bind(
        'close',
        function()
        {
          this.$menu
            .find( '.' + _c.search )
            .find( 'input' )
            .blur();
        }
      );


      //  Bind functions to update
      this.bind( 'init',
        function( $panels )
        {
          //  Add the searchfield(s)
          if ( opts.add )
          {
            switch( opts.addTo )
            {
              case 'panels':
                var $wrapper = $panels;
                break;

              default:
                var $wrapper = $(opts.addTo, this.$menu);
                break;
            }

            $wrapper
              .each(
              function()
              {
                //  Add the searchfield
                var $panl = $(this);
                if ( $panl.is( '.' + _c.panel ) && $panl.is( '.' + _c.vertical ) )
                {
                  return;
                }

                if ( !$panl.children( '.' + _c.search ).length )
                {
                  var _srch = ( conf.form )
                    ? 'form'
                    : 'div';

                  var $srch = $( '<' + _srch + ' class="' + _c.search + '" />' );

                  if ( conf.form && typeof conf.form == 'object' )
                  {
                    for ( var f in conf.form )
                    {
                      $srch.attr( f, conf.form[ f ] );
                    }
                  }
                  $srch.append( '<input placeholder="' + opts.placeholder + '" type="text" autocomplete="off" />' );

                  if ( $panl.hasClass( _c.search ) )
                  {
                    $panl.replaceWith( $srch );
                  }
                  else
                  {
                    $panl
                      .prepend( $srch )
                      .addClass( _c.hassearch );
                  }
                }

                if ( opts.noResults )
                {
                  var inPanel = $panl.closest( '.' + _c.panel ).length;

                  //  Not in a panel
                  if ( !inPanel )
                  {
                    $panl = that.$pnls.children( '.' + _c.panel ).first();
                  }

                  //  Add no-results message
                  if ( !$panl.children( '.' + _c.noresultsmsg ).length )
                  {
                    var $lst = $panl.children( '.' + _c.listview ).first();

                    $( '<div class="' + _c.noresultsmsg + '" />' )
                      .append( opts.noResults )
                      [ $lst.length ? 'insertAfter' : 'prependTo' ]( $lst.length ? $lst : $panl );
                  }
                }
              }
            );


            //  Search through list items
            if ( opts.search )
            {
              $('.' + _c.search, this.$menu)
                .each(
                function()
                {
                  var $srch   = $(this),
                    inPanel = $srch.closest( '.' + _c.panel ).length;

                  //  In a panel
                  if ( inPanel )
                  {
                    var $pnls = $srch.closest( '.' + _c.panel ),
                      $panl = $pnls;
                  }

                  //  Not in a panel
                  else
                  {
                    var $pnls = $('.' + _c.panel, that.$menu),
                      $panl = that.$menu;
                  }

                  var $inpt = $srch.children( 'input' ),
                    $itms = that.__findAddBack( $pnls, '.' + _c.listview ).children( 'li' ),
                    $dvdr = $itms.filter( '.' + _c.divider ),
                    $rslt = that.__filterListItems( $itms );

                  var _anchor = '> a',
                    _both = _anchor + ', > span';

                  var search = function()
                  {

                    var query = $inpt.val().toLowerCase();

                    //  Scroll to top
                    $pnls.scrollTop( 0 );

                    //  Search through items
                    $rslt
                      .add( $dvdr )
                      .addClass( _c.hidden )
                      .find( '.' + _c.fullsubopensearch )
                      .removeClass( _c.fullsubopen )
                      .removeClass( _c.fullsubopensearch );

                    $rslt
                      .each(
                      function()
                      {
                        var $item = $(this),
                          _search = _anchor;

                        if ( opts.showTextItems || ( opts.showSubPanels && $item.find( '.' + _c.next ) ) )
                        {
                          _search = _both;
                        }

                        if ( $(_search, $item).text().toLowerCase().indexOf( query ) > -1 )
                        {
                          $item.add( $item.prevAll( '.' + _c.divider ).first() ).removeClass( _c.hidden );
                        }
                      }
                    );

                    //  Update sub items
                    if ( opts.showSubPanels )
                    {
                      $pnls.each(
                        function( i )
                        {
                          var $panl = $(this);
                          that.__filterListItems( $panl.find( '.' + _c.listview ).children() )
                            .each(
                            function()
                            {
                              var $li = $(this),
                                $su = $li.data( _d.sub );

                              $li.removeClass( _c.nosubresults );
                              if ( $su )
                              {
                                $su.find( '.' + _c.listview ).children().removeClass( _c.hidden );
                              }
                            }
                          );
                        }
                      );
                    }

                    //  Update parent for submenus
                    $( $pnls.get().reverse() )
                      .each(
                      function( i )
                      {
                        var $panl = $(this),
                          $prnt = $panl.data( _d.parent );

                        if ( $prnt )
                        {
                          if ( that.__filterListItems( $panl.find( '.' + _c.listview ).children() ).length )
                          {
                            if ( $prnt.hasClass( _c.hidden ) )
                            {
                              $prnt.children( '.' + _c.next )
                                .not( '.' + _c.fullsubopen )
                                .addClass( _c.fullsubopen )
                                .addClass( _c.fullsubopensearch );
                            }
                            $prnt
                              .removeClass( _c.hidden )
                              .removeClass( _c.nosubresults )
                              .prevAll( '.' + _c.divider )
                              .first()
                              .removeClass( _c.hidden );
                          }
                          else if ( !inPanel )
                          {
                            if ( $panl.hasClass( _c.opened ) )
                            {
                              //  Compensate the timeout for the opening animation
                              setTimeout(
                                function()
                                {
                                  that.openPanel( $prnt.closest( '.' + _c.panel ) );
                                }, ( i + 1 ) * ( that.conf.openingInterval * 1.5 )
                              );
                            }
                            $prnt.addClass( _c.nosubresults );
                          }
                        }
                      }
                    );

                    //  Show/hide no results message
                    $panl[ $rslt.not( '.' + _c.hidden ).length ? 'removeClass' : 'addClass' ]( _c.noresults );

                    //  Update for other addons
                    this.update();
                  }


                  $inpt
                    .off( _e.keyup + '-searchfield ' + _e.change + '-searchfield' )
                    .on( _e.keyup + '-searchfield',
                    function( e )
                    {
                      if ( !preventKeypressSearch( e.keyCode ) )
                      {
                        search.call( that );
                      }
                    }
                  )
                    .on( _e.change + '-searchfield',
                    function( e )
                    {
                      search.call( that );
                    }
                  );
                }
              );
            }
          }
        }
      );
    },

    //  add: fired once per page load
    add: function()
    {
      _c = $[ _PLUGIN_ ]._c;
      _d = $[ _PLUGIN_ ]._d;
      _e = $[ _PLUGIN_ ]._e;

      _c.add( 'search hassearch noresultsmsg noresults nosubresults fullsubopensearch' );
      _e.add( 'change keyup' );
    },

    //  clickAnchor: prevents default behavior when clicking an anchor
    clickAnchor: function( $a, inMenu ) {}
  };


  //  Default options and configuration
  $[ _PLUGIN_ ].defaults[ _ADDON_ ] = {
    add       : false,
    addTo      : 'panels',
    search      : true,
    placeholder    : 'Search',
    noResults    : 'No results found.',
    showTextItems  : false,
    showSubPanels  : true
  };
  $[ _PLUGIN_ ].configuration[ _ADDON_ ] = {
    form      : false
  };


  var _c, _d, _e, glbl;


  function preventKeypressSearch( c )
  {
    switch( c )
    {
      case 9:    //  tab
      case 16:  //  shift
      case 17:  //  control
      case 18:  //  alt
      case 37:  //  left
      case 38:  //  top
      case 39:  //  right
      case 40:  //  bottom
        return true;
    }
    return false;
  }

})( jQuery );
   /* Ende jquery.mmenu.searchfield */
   /* Start mediaelement */
   /*!
 * --GSBDocStart
 * @module medialement.js 
 * @version 2.23.5
 * @see {@link http://mediaelementjs.com/}
 * @author John Dyer (http://j.hn), 2010-2014
 * @license MIT license
 * 
 * @desc mediaelements mit manuellen GSB-Anpassungen
 * Creates a JavaScript object that mimics HTML5 MediaElement API
 * for browsers that don't understand HTML5 or can't play the provided codec
 * Can play MP4 (H.264), Ogg, WebM, FLV, WMV, WMA, ACC, and MP3
 *--GSBDocEnd
 * MediaElement.js
 * HTML5 <video> and <audio> shim and player
 * http://mediaelementjs.com/
 *
 * Creates a JavaScript object that mimics HTML5 MediaElement API
 * for browsers that don't understand HTML5 or can't play the provided codec
 * Can play MP4 (H.264), Ogg, WebM, FLV, WMV, WMA, ACC, and MP3
 *
 * Copyright 2010-2014, John Dyer (http://j.hn)
 * License: MIT
 *
 */
var mejs=mejs||{};mejs.version="2.23.5";mejs.meIndex=0;mejs.plugins={silverlight:[{version:[3,0],types:["video/mp4","video/m4v","video/mov","video/wmv","audio/wma","audio/m4a","audio/mp3","audio/wav","audio/mpeg"]}],flash:[{version:[9,0,124],types:["video/mp4","video/m4v","video/mov","video/flv","video/rtmp","video/x-flv","audio/flv","audio/x-flv","audio/mp3","audio/m4a","audio/mp4","audio/mpeg","video/dailymotion","video/x-dailymotion","application/x-mpegURL","audio/ogg"]}],youtube:[{version:null,types:["video/youtube","video/x-youtube","audio/youtube","audio/x-youtube"]}],vimeo:[{version:null,types:["video/vimeo","video/x-vimeo"]}]};mejs.Utility={encodeUrl:function(url){return encodeURIComponent(url);},escapeHTML:function(s){return s.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;");},absolutizeUrl:function(url){var el=document.createElement("div");el.innerHTML='<a href="'+this.escapeHTML(url)+'">x</a>';return el.firstChild.href;},getScriptPath:function(scriptNames){var i=0,j,codePath="",testname="",slashPos,filenamePos,scriptUrl,scriptPath,scriptFilename,scripts=document.getElementsByTagName("script"),il=scripts.length,jl=scriptNames.length;for(;i<il;i++){scriptUrl=scripts[i].src;slashPos=scriptUrl.lastIndexOf("/");if(slashPos>-1){scriptFilename=scriptUrl.substring(slashPos+1);scriptPath=scriptUrl.substring(0,slashPos+1);}else{scriptFilename=scriptUrl;scriptPath="";}for(j=0;j<jl;j++){testname=scriptNames[j];filenamePos=scriptFilename.indexOf(testname);if(filenamePos>-1){codePath=scriptPath;break;}}if(codePath!==""){break;}}return codePath;},calculateTimeFormat:function(time,options,fps){if(time<0){time=0;}if(typeof fps=="undefined"){fps=25;}var format=options.timeFormat,firstChar=format[0],firstTwoPlaces=(format[1]==format[0]),separatorIndex=firstTwoPlaces?2:1,separator=":",hours=Math.floor(time/3600)%24,minutes=Math.floor(time/60)%60,seconds=Math.floor(time%60),frames=Math.floor(((time%1)*fps).toFixed(3)),lis=[[frames,"f"],[seconds,"s"],[minutes,"m"],[hours,"h"]];if(format.length<separatorIndex){separator=format[separatorIndex];}var required=false;for(var i=0,len=lis.length;i<len;i++){if(format.indexOf(lis[i][1])!==-1){required=true;}else{if(required){var hasNextValue=false;for(var j=i;j<len;j++){if(lis[j][0]>0){hasNextValue=true;break;}}if(!hasNextValue){break;}if(!firstTwoPlaces){format=firstChar+format;}format=lis[i][1]+separator+format;if(firstTwoPlaces){format=lis[i][1]+format;}firstChar=lis[i][1];}}}options.currentTimeFormat=format;},twoDigitsString:function(n){if(n<10){return"0"+n;}return String(n);},secondsToTimeCode:function(time,options){if(time<0){time=0;}if(typeof options!=="object"){var format="m:ss";format=arguments[1]?"hh:mm:ss":format;format=arguments[2]?format+":ff":format;options={currentTimeFormat:format,framesPerSecond:arguments[3]||25};}var fps=options.framesPerSecond;if(typeof fps==="undefined"){fps=25;}var format=options.currentTimeFormat,hours=Math.floor(time/3600)%24,minutes=Math.floor(time/60)%60,seconds=Math.floor(time%60),frames=Math.floor(((time%1)*fps).toFixed(3));lis=[[frames,"f"],[seconds,"s"],[minutes,"m"],[hours,"h"]];var res=format;for(i=0,len=lis.length;i<len;i++){res=res.replace(lis[i][1]+lis[i][1],this.twoDigitsString(lis[i][0]));res=res.replace(lis[i][1],lis[i][0]);}return res;},timeCodeToSeconds:function(hh_mm_ss_ff,forceHours,showFrameCount,fps){if(typeof showFrameCount=="undefined"){showFrameCount=false;}else{if(typeof fps=="undefined"){fps=25;}}var tc_array=hh_mm_ss_ff.split(":"),tc_hh=parseInt(tc_array[0],10),tc_mm=parseInt(tc_array[1],10),tc_ss=parseInt(tc_array[2],10),tc_ff=0,tc_in_seconds=0;if(showFrameCount){tc_ff=parseInt(tc_array[3])/fps;}tc_in_seconds=(tc_hh*3600)+(tc_mm*60)+tc_ss+tc_ff;return tc_in_seconds;},convertSMPTEtoSeconds:function(SMPTE){if(typeof SMPTE!="string"){return false;}SMPTE=SMPTE.replace(",",".");var secs=0,decimalLen=(SMPTE.indexOf(".")!=-1)?SMPTE.split(".")[1].length:0,multiplier=1;SMPTE=SMPTE.split(":").reverse();for(var i=0;i<SMPTE.length;i++){multiplier=1;if(i>0){multiplier=Math.pow(60,i);}secs+=Number(SMPTE[i])*multiplier;}return Number(secs.toFixed(decimalLen));},removeSwf:function(id){var obj=document.getElementById(id);if(obj&&/object|embed/i.test(obj.nodeName)){if(mejs.MediaFeatures.isIE){obj.style.display="none";(function(){if(obj.readyState==4){mejs.Utility.removeObjectInIE(id);}else{setTimeout(arguments.callee,10);}})();}else{obj.parentNode.removeChild(obj);}}},removeObjectInIE:function(id){var obj=document.getElementById(id);if(obj){for(var i in obj){if(typeof obj[i]=="function"){obj[i]=null;}}obj.parentNode.removeChild(obj);}},determineScheme:function(url){if(url&&url.indexOf("://")!=-1){return url.substr(0,url.indexOf("://")+3);}return"//";},debounce:function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate){func.apply(context,args);}};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow){func.apply(context,args);}};},isNodeAfter:function(sourceNode,targetNode){return !!(sourceNode&&targetNode&&typeof sourceNode.compareDocumentPosition==="function"&&sourceNode.compareDocumentPosition(targetNode)&Node.DOCUMENT_POSITION_PRECEDING);}};mejs.PluginDetector={hasPluginVersion:function(plugin,v){var pv=this.plugins[plugin];v[1]=v[1]||0;v[2]=v[2]||0;return(pv[0]>v[0]||(pv[0]==v[0]&&pv[1]>v[1])||(pv[0]==v[0]&&pv[1]==v[1]&&pv[2]>=v[2]))?true:false;},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(p,pluginName,mimeType,activeX,axDetect){this.plugins[p]=this.detectPlugin(pluginName,mimeType,activeX,axDetect);},detectPlugin:function(pluginName,mimeType,activeX,axDetect){var version=[0,0,0],description,i,ax;if(typeof(this.nav.plugins)!="undefined"&&typeof this.nav.plugins[pluginName]=="object"){description=this.nav.plugins[pluginName].description;if(description&&!(typeof this.nav.mimeTypes!="undefined"&&this.nav.mimeTypes[mimeType]&&!this.nav.mimeTypes[mimeType].enabledPlugin)){version=description.replace(pluginName,"").replace(/^\s+/,"").replace(/\sr/gi,".").split(".");for(i=0;i<version.length;i++){version[i]=parseInt(version[i].match(/\d+/),10);}}}else{if(typeof(window.ActiveXObject)!="undefined"){try{ax=new ActiveXObject(activeX);if(ax){version=axDetect(ax);}}catch(e){}}}return version;}};mejs.PluginDetector.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(ax){var version=[],d=ax.GetVariable("$version");if(d){d=d.split(" ")[1].split(",");version=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)];}return version;});mejs.PluginDetector.addPlugin("silverlight","Silverlight Plug-In","application/x-silverlight-2","AgControl.AgControl",function(ax){var v=[0,0,0,0],loopMatch=function(ax,v,i,n){while(ax.isVersionSupported(v[0]+"."+v[1]+"."+v[2]+"."+v[3])){v[i]+=n;}v[i]-=n;};loopMatch(ax,v,0,1);loopMatch(ax,v,1,1);loopMatch(ax,v,2,10000);loopMatch(ax,v,2,1000);loopMatch(ax,v,2,100);loopMatch(ax,v,2,10);loopMatch(ax,v,2,1);loopMatch(ax,v,3,1);return v;});mejs.MediaFeatures={init:function(){var t=this,d=document,nav=mejs.PluginDetector.nav,ua=mejs.PluginDetector.ua.toLowerCase(),i,v,html5Elements=["source","track","audio","video"];t.isiPad=(ua.match(/ipad/i)!==null);t.isiPhone=(ua.match(/iphone/i)!==null);t.isiOS=t.isiPhone||t.isiPad;t.isAndroid=(ua.match(/android/i)!==null);t.isBustedAndroid=(ua.match(/android 2\.[12]/)!==null);t.isBustedNativeHTTPS=(location.protocol==="https:"&&(ua.match(/android [12]\./)!==null||ua.match(/macintosh.* version.* safari/)!==null));t.isIE=(nav.appName.toLowerCase().indexOf("microsoft")!=-1||nav.appName.toLowerCase().match(/trident/gi)!==null);t.isChrome=(ua.match(/chrome/gi)!==null);t.isChromium=(ua.match(/chromium/gi)!==null);t.isFirefox=(ua.match(/firefox/gi)!==null);t.isWebkit=(ua.match(/webkit/gi)!==null);t.isGecko=(ua.match(/gecko/gi)!==null)&&!t.isWebkit&&!t.isIE;t.isOpera=(ua.match(/opera/gi)!==null);t.hasTouch=("ontouchstart" in window);t.svgAsImg=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1");for(i=0;i<html5Elements.length;i++){v=document.createElement(html5Elements[i]);}t.supportsMediaTag=(typeof v.canPlayType!=="undefined"||t.isBustedAndroid);try{v.canPlayType("video/mp4");}catch(e){t.supportsMediaTag=false;}t.supportsPointerEvents=(function(){var element=document.createElement("x"),documentElement=document.documentElement,getComputedStyle=window.getComputedStyle,supports;if(!("pointerEvents" in element.style)){return false;}element.style.pointerEvents="auto";element.style.pointerEvents="x";documentElement.appendChild(element);supports=getComputedStyle&&getComputedStyle(element,"").pointerEvents==="auto";documentElement.removeChild(element);return !!supports;})();t.hasFirefoxPluginMovingProblem=false;t.hasiOSFullScreen=(typeof v.webkitEnterFullscreen!=="undefined");t.hasNativeFullscreen=(typeof v.requestFullscreen!=="undefined");t.hasWebkitNativeFullScreen=(typeof v.webkitRequestFullScreen!=="undefined");t.hasMozNativeFullScreen=(typeof v.mozRequestFullScreen!=="undefined");t.hasMsNativeFullScreen=(typeof v.msRequestFullscreen!=="undefined");t.hasTrueNativeFullScreen=(t.hasWebkitNativeFullScreen||t.hasMozNativeFullScreen||t.hasMsNativeFullScreen);t.nativeFullScreenEnabled=t.hasTrueNativeFullScreen;if(t.hasMozNativeFullScreen){t.nativeFullScreenEnabled=document.mozFullScreenEnabled;}else{if(t.hasMsNativeFullScreen){t.nativeFullScreenEnabled=document.msFullscreenEnabled;}}if(t.isChrome){t.hasiOSFullScreen=false;}if(t.hasTrueNativeFullScreen){t.fullScreenEventName="";if(t.hasWebkitNativeFullScreen){t.fullScreenEventName="webkitfullscreenchange";}else{if(t.hasMozNativeFullScreen){t.fullScreenEventName="mozfullscreenchange";}else{if(t.hasMsNativeFullScreen){t.fullScreenEventName="MSFullscreenChange";}}}t.isFullScreen=function(){if(t.hasMozNativeFullScreen){return d.mozFullScreen;}else{if(t.hasWebkitNativeFullScreen){return d.webkitIsFullScreen;}else{if(t.hasMsNativeFullScreen){return d.msFullscreenElement!==null;}}}};t.requestFullScreen=function(el){if(t.hasWebkitNativeFullScreen){el.webkitRequestFullScreen();}else{if(t.hasMozNativeFullScreen){el.mozRequestFullScreen();}else{if(t.hasMsNativeFullScreen){el.msRequestFullscreen();}}}};t.cancelFullScreen=function(){if(t.hasWebkitNativeFullScreen){document.webkitCancelFullScreen();}else{if(t.hasMozNativeFullScreen){document.mozCancelFullScreen();}else{if(t.hasMsNativeFullScreen){document.msExitFullscreen();}}}};}if(t.hasiOSFullScreen&&ua.match(/mac os x 10_5/i)){t.hasNativeFullScreen=false;t.hasiOSFullScreen=false;}}};mejs.MediaFeatures.init();mejs.HtmlMediaElement={pluginType:"native",isFullScreen:false,setCurrentTime:function(time){this.currentTime=time;},setMuted:function(muted){this.muted=muted;},setVolume:function(volume){this.volume=volume;},stop:function(){this.pause();},setSrc:function(url){var existingSources=this.getElementsByTagName("source");while(existingSources.length>0){this.removeChild(existingSources[0]);}if(typeof url=="string"){this.src=url;}else{var i,media;for(i=0;i<url.length;i++){media=url[i];if(this.canPlayType(media.type)){this.src=media.src;break;}}}},setVideoSize:function(width,height){this.width=width;this.height=height;}};mejs.PluginMediaElement=function(pluginid,pluginType,mediaUrl){this.id=pluginid;this.pluginType=pluginType;this.src=mediaUrl;this.events={};this.attributes={};};mejs.PluginMediaElement.prototype={pluginElement:null,pluginType:"",isFullScreen:false,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:true,ended:false,seeking:false,duration:0,error:null,tagName:"",muted:false,volume:1,currentTime:0,play:function(){if(this.pluginApi!=null){if(this.pluginType=="youtube"||this.pluginType=="vimeo"){this.pluginApi.playVideo();}else{this.pluginApi.playMedia();}this.paused=false;}},load:function(){if(this.pluginApi!=null){if(this.pluginType=="youtube"||this.pluginType=="vimeo"){}else{this.pluginApi.loadMedia();}this.paused=false;}},pause:function(){if(this.pluginApi!=null){if(this.pluginType=="youtube"||this.pluginType=="vimeo"){if(this.pluginApi.getPlayerState()==1){this.pluginApi.pauseVideo();}}else{this.pluginApi.pauseMedia();}this.paused=true;}},stop:function(){if(this.pluginApi!=null){if(this.pluginType=="youtube"||this.pluginType=="vimeo"){this.pluginApi.stopVideo();}else{this.pluginApi.stopMedia();}this.paused=true;}},canPlayType:function(type){var i,j,pluginInfo,pluginVersions=mejs.plugins[this.pluginType];for(i=0;i<pluginVersions.length;i++){pluginInfo=pluginVersions[i];if(mejs.PluginDetector.hasPluginVersion(this.pluginType,pluginInfo.version)){for(j=0;j<pluginInfo.types.length;j++){if(type==pluginInfo.types[j]){return"probably";}}}}return"";},positionFullscreenButton:function(x,y,visibleAndAbove){if(this.pluginApi!=null&&this.pluginApi.positionFullscreenButton){this.pluginApi.positionFullscreenButton(Math.floor(x),Math.floor(y),visibleAndAbove);}},hideFullscreenButton:function(){if(this.pluginApi!=null&&this.pluginApi.hideFullscreenButton){this.pluginApi.hideFullscreenButton();}},setSrc:function(url){if(typeof url=="string"){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(url));this.src=mejs.Utility.absolutizeUrl(url);}else{var i,media;for(i=0;i<url.length;i++){media=url[i];if(this.canPlayType(media.type)){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(media.src));this.src=mejs.Utility.absolutizeUrl(media.src);break;}}}},setCurrentTime:function(time){if(this.pluginApi!=null){if(this.pluginType=="youtube"||this.pluginType=="vimeo"){this.pluginApi.seekTo(time);}else{this.pluginApi.setCurrentTime(time);}this.currentTime=time;}},setVolume:function(volume){if(this.pluginApi!=null){if(this.pluginType=="youtube"){this.pluginApi.setVolume(volume*100);}else{this.pluginApi.setVolume(volume);}this.volume=volume;}},setMuted:function(muted){if(this.pluginApi!=null){if(this.pluginType=="youtube"){if(muted){this.pluginApi.mute();}else{this.pluginApi.unMute();}this.muted=muted;this.dispatchEvent({type:"volumechange"});}else{this.pluginApi.setMuted(muted);}this.muted=muted;}},setVideoSize:function(width,height){if(this.pluginElement&&this.pluginElement.style){this.pluginElement.style.width=width+"px";this.pluginElement.style.height=height+"px";}if(this.pluginApi!=null&&this.pluginApi.setVideoSize){this.pluginApi.setVideoSize(width,height);}},setFullscreen:function(fullscreen){if(this.pluginApi!=null&&this.pluginApi.setFullscreen){this.pluginApi.setFullscreen(fullscreen);}},enterFullScreen:function(){if(this.pluginApi!=null&&this.pluginApi.setFullscreen){this.setFullscreen(true);}},exitFullScreen:function(){if(this.pluginApi!=null&&this.pluginApi.setFullscreen){this.setFullscreen(false);}},addEventListener:function(eventName,callback,bubble){this.events[eventName]=this.events[eventName]||[];this.events[eventName].push(callback);},removeEventListener:function(eventName,callback){if(!eventName){this.events={};return true;}var callbacks=this.events[eventName];if(!callbacks){return true;}if(!callback){this.events[eventName]=[];return true;}for(var i=0;i<callbacks.length;i++){if(callbacks[i]===callback){this.events[eventName].splice(i,1);return true;}}return false;},dispatchEvent:function(event){var i,args,callbacks=this.events[event.type];if(callbacks){for(i=0;i<callbacks.length;i++){callbacks[i].apply(this,[event]);}}},hasAttribute:function(name){return(name in this.attributes);},removeAttribute:function(name){delete this.attributes[name];},getAttribute:function(name){if(this.hasAttribute(name)){return this.attributes[name];}return null;},setAttribute:function(name,value){this.attributes[name]=value;},remove:function(){mejs.Utility.removeSwf(this.pluginElement.id);}};mejs.MediaElementDefaults={mode:"auto",plugins:["flash","silverlight","youtube","vimeo"],enablePluginDebug:false,httpsBasicAuthSite:false,type:"",pluginPath:mejs.Utility.getScriptPath(["mediaelement.js","mediaelement.min.js","mediaelement-and-player.js","mediaelement-and-player.min.js"]),flashName:"flashmediaelement.swf",flashStreamer:"",flashScriptAccess:"sameDomain",enablePluginSmoothing:false,enablePseudoStreaming:false,pseudoStreamingStartQueryParam:"start",silverlightName:"silverlightmediaelement.xap",defaultVideoWidth:480,defaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,pluginVars:[],timerRate:250,startVolume:0.8,customError:"",success:function(){},error:function(){}};mejs.MediaElement=function(el,o){return mejs.HtmlMediaElementShim.create(el,o);};mejs.HtmlMediaElementShim={create:function(el,o){var options={},htmlMediaElement=(typeof(el)=="string")?document.getElementById(el):el,tagName=htmlMediaElement.tagName.toLowerCase(),isMediaTag=(tagName==="audio"||tagName==="video"),src=(isMediaTag)?htmlMediaElement.getAttribute("src"):htmlMediaElement.getAttribute("href"),poster=htmlMediaElement.getAttribute("poster"),autoplay=htmlMediaElement.getAttribute("autoplay"),preload=htmlMediaElement.getAttribute("preload"),controls=htmlMediaElement.getAttribute("controls"),playback,prop;for(prop in mejs.MediaElementDefaults){options[prop]=mejs.MediaElementDefaults[prop];}for(prop in o){options[prop]=o[prop];}src=(typeof src=="undefined"||src===null||src=="")?null:src;poster=(typeof poster=="undefined"||poster===null)?"":poster;preload=(typeof preload=="undefined"||preload===null||preload==="false")?"none":preload;autoplay=!(typeof autoplay=="undefined"||autoplay===null||autoplay==="false");controls=!(typeof controls=="undefined"||controls===null||controls==="false");playback=this.determinePlayback(htmlMediaElement,options,mejs.MediaFeatures.supportsMediaTag,isMediaTag,src);playback.url=(playback.url!==null)?mejs.Utility.absolutizeUrl(playback.url):"";playback.scheme=mejs.Utility.determineScheme(playback.url);if(playback.method=="native"){if(mejs.MediaFeatures.isBustedAndroid){htmlMediaElement.src=playback.url;htmlMediaElement.addEventListener("click",function(){htmlMediaElement.play();},false);}return this.updateNative(playback,options,autoplay,preload);}else{if(playback.method!==""){return this.createPlugin(playback,options,poster,autoplay,preload,controls);}else{this.createErrorMessage(playback,options,poster);return this;}}},determinePlayback:function(htmlMediaElement,options,supportsMediaTag,isMediaTag,src){var mediaFiles=[],i,j,k,l,n,type,result={method:"",url:"",htmlMediaElement:htmlMediaElement,isVideo:(htmlMediaElement.tagName.toLowerCase()!=="audio"),scheme:""},pluginName,pluginVersions,pluginInfo,dummy,media;if(typeof options.type!="undefined"&&options.type!==""){if(typeof options.type=="string"){mediaFiles.push({type:options.type,url:src});}else{for(i=0;i<options.type.length;i++){mediaFiles.push({type:options.type[i],url:src});}}}else{if(src!==null){type=this.formatType(src,htmlMediaElement.getAttribute("type"));mediaFiles.push({type:type,url:src});}else{for(i=0;i<htmlMediaElement.childNodes.length;i++){n=htmlMediaElement.childNodes[i];if(n.nodeType==1&&n.tagName.toLowerCase()=="source"){src=n.getAttribute("src");type=this.formatType(src,n.getAttribute("type"));media=n.getAttribute("media");if(!media||!window.matchMedia||(window.matchMedia&&window.matchMedia(media).matches)){mediaFiles.push({type:type,url:src});}}}}}if(!isMediaTag&&mediaFiles.length>0&&mediaFiles[0].url!==null&&this.getTypeFromFile(mediaFiles[0].url).indexOf("audio")>-1){result.isVideo=false;}if(result.isVideo&&mejs.MediaFeatures.isBustedAndroid){htmlMediaElement.canPlayType=function(type){return(type.match(/video\/(mp4|m4v)/gi)!==null)?"maybe":"";};}if(result.isVideo&&mejs.MediaFeatures.isChromium){htmlMediaElement.canPlayType=function(type){return(type.match(/video\/(webm|ogv|ogg)/gi)!==null)?"maybe":"";};}if(supportsMediaTag&&(options.mode==="auto"||options.mode==="auto_plugin"||options.mode==="native")&&!(mejs.MediaFeatures.isBustedNativeHTTPS&&options.httpsBasicAuthSite===true)){if(!isMediaTag){dummy=document.createElement(result.isVideo?"video":"audio");htmlMediaElement.parentNode.insertBefore(dummy,htmlMediaElement);htmlMediaElement.style.display="none";result.htmlMediaElement=htmlMediaElement=dummy;}for(i=0;i<mediaFiles.length;i++){if(mediaFiles[i].type=="video/m3u8"||htmlMediaElement.canPlayType(mediaFiles[i].type).replace(/no/,"")!==""||htmlMediaElement.canPlayType(mediaFiles[i].type.replace(/mp3/,"mpeg")).replace(/no/,"")!==""||htmlMediaElement.canPlayType(mediaFiles[i].type.replace(/m4a/,"mp4")).replace(/no/,"")!==""){result.method="native";result.url=mediaFiles[i].url;break;}}if(result.method==="native"){if(result.url!==null){htmlMediaElement.src=result.url;}if(options.mode!=="auto_plugin"){return result;}}}if(options.mode==="auto"||options.mode==="auto_plugin"||options.mode==="shim"){for(i=0;i<mediaFiles.length;i++){type=mediaFiles[i].type;for(j=0;j<options.plugins.length;j++){pluginName=options.plugins[j];pluginVersions=mejs.plugins[pluginName];for(k=0;k<pluginVersions.length;k++){pluginInfo=pluginVersions[k];if(pluginInfo.version==null||mejs.PluginDetector.hasPluginVersion(pluginName,pluginInfo.version)){for(l=0;l<pluginInfo.types.length;l++){if(type.toLowerCase()==pluginInfo.types[l].toLowerCase()){result.method=pluginName;result.url=mediaFiles[i].url;return result;}}}}}}}if(options.mode==="auto_plugin"&&result.method==="native"){return result;}if(result.method===""&&mediaFiles.length>0){result.url=mediaFiles[0].url;}return result;},formatType:function(url,type){if(url&&!type){return this.getTypeFromFile(url);}else{if(type&&~type.indexOf(";")){return type.substr(0,type.indexOf(";"));}else{return type;}}},getTypeFromFile:function(url){url=url.split("?")[0];var ext=url.substring(url.lastIndexOf(".")+1).toLowerCase(),av=/(mp4|m4v|ogg|ogv|m3u8|webm|webmv|flv|wmv|mpeg|mov)/gi.test(ext)?"video/":"audio/";return this.getTypeFromExtension(ext,av);},getTypeFromExtension:function(ext,av){av=av||"";switch(ext){case"mp4":case"m4v":case"m4a":case"f4v":case"f4a":return av+"mp4";case"flv":return av+"x-flv";case"webm":case"webma":case"webmv":return av+"webm";case"ogg":case"oga":case"ogv":return av+"ogg";case"m3u8":return"application/x-mpegurl";case"ts":return av+"mp2t";default:return av+ext;}},createErrorMessage:function(playback,options,poster){var htmlMediaElement=playback.htmlMediaElement,errorContainer=document.createElement("div"),errorContent=options.customError;errorContainer.className="me-cannotplay";try{errorContainer.style.width=htmlMediaElement.width+"px";errorContainer.style.height=htmlMediaElement.height+"px";}catch(e){}if(!errorContent){errorContent='<a href="'+playback.url+'">';if(poster!==""){errorContent+='<img src="'+poster+'" width="100%" height="100%" alt="" />';}errorContent+="<span>"+mejs.i18n.t("mejs.download-file")+"</span></a>";}errorContainer.innerHTML=errorContent;htmlMediaElement.parentNode.insertBefore(errorContainer,htmlMediaElement);htmlMediaElement.style.display="none";options.error(htmlMediaElement);},createPlugin:function(playback,options,poster,autoplay,preload,controls){var htmlMediaElement=playback.htmlMediaElement,width=1,height=1,pluginid="me_"+playback.method+"_"+(mejs.meIndex++),pluginMediaElement=new mejs.PluginMediaElement(pluginid,playback.method,playback.url),container=document.createElement("div"),specialIEContainer,node,initVars;pluginMediaElement.tagName=htmlMediaElement.tagName;for(var i=0;i<htmlMediaElement.attributes.length;i++){var attribute=htmlMediaElement.attributes[i];if(attribute.specified){pluginMediaElement.setAttribute(attribute.name,attribute.value);}}node=htmlMediaElement.parentNode;while(node!==null&&node.tagName!=null&&node.tagName.toLowerCase()!=="body"&&node.parentNode!=null&&node.parentNode.tagName!=null&&node.parentNode.constructor!=null&&node.parentNode.constructor.name==="ShadowRoot"){if(node.parentNode.tagName.toLowerCase()==="p"){node.parentNode.parentNode.insertBefore(node,node.parentNode);break;}node=node.parentNode;}if(playback.isVideo){width=(options.pluginWidth>0)?options.pluginWidth:(options.videoWidth>0)?options.videoWidth:(htmlMediaElement.getAttribute("width")!==null)?htmlMediaElement.getAttribute("width"):options.defaultVideoWidth;height=(options.pluginHeight>0)?options.pluginHeight:(options.videoHeight>0)?options.videoHeight:(htmlMediaElement.getAttribute("height")!==null)?htmlMediaElement.getAttribute("height"):options.defaultVideoHeight;width=mejs.Utility.encodeUrl(width);height=mejs.Utility.encodeUrl(height);}else{if(options.enablePluginDebug){width=320;height=240;}}pluginMediaElement.success=options.success;container.className="me-plugin";container.id=pluginid+"_container";if(playback.isVideo){htmlMediaElement.parentNode.insertBefore(container,htmlMediaElement);}else{document.body.insertBefore(container,document.body.childNodes[0]);}if(playback.method==="flash"||playback.method==="silverlight"){var canPlayVideo=htmlMediaElement.getAttribute("type")==="audio/mp4",childrenSources=htmlMediaElement.getElementsByTagName("source");if(childrenSources&&!canPlayVideo){for(var i=0,total=childrenSources.length;i<total;i++){if(childrenSources[i].getAttribute("type")==="audio/mp4"){canPlayVideo=true;}}}initVars=["id="+pluginid,"isvideo="+((playback.isVideo||canPlayVideo)?"true":"false"),"autoplay="+((autoplay)?"true":"false"),"preload="+preload,"width="+width,"startvolume="+options.startVolume,"timerrate="+options.timerRate,"flashstreamer="+options.flashStreamer,"height="+height,"pseudostreamstart="+options.pseudoStreamingStartQueryParam];if(playback.url!==null){if(playback.method=="flash"){initVars.push("file="+mejs.Utility.encodeUrl(playback.url));}else{initVars.push("file="+playback.url);}}if(options.enablePluginDebug){initVars.push("debug=true");}if(options.enablePluginSmoothing){initVars.push("smoothing=true");}if(options.enablePseudoStreaming){initVars.push("pseudostreaming=true");}if(controls){initVars.push("controls=true");}if(options.pluginVars){initVars=initVars.concat(options.pluginVars);}window[pluginid+"_init"]=function(){switch(pluginMediaElement.pluginType){case"flash":pluginMediaElement.pluginElement=pluginMediaElement.pluginApi=document.getElementById(pluginid);break;case"silverlight":pluginMediaElement.pluginElement=document.getElementById(pluginMediaElement.id);pluginMediaElement.pluginApi=pluginMediaElement.pluginElement.Content.MediaElementJS;break;}if(pluginMediaElement.pluginApi!=null&&pluginMediaElement.success){pluginMediaElement.success(pluginMediaElement,htmlMediaElement);}};window[pluginid+"_event"]=function(eventName,values){var e,i,bufferedTime;e={type:eventName,target:pluginMediaElement};for(i in values){pluginMediaElement[i]=values[i];e[i]=values[i];}bufferedTime=values.bufferedTime||0;e.target.buffered=e.buffered={start:function(index){return 0;},end:function(index){return bufferedTime;},length:1};pluginMediaElement.dispatchEvent(e);};}switch(playback.method){case"silverlight":container.innerHTML='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="'+pluginid+'" name="'+pluginid+'" width="'+width+'" height="'+height+'" class="mejs-shim">'+'<param name="initParams" value="'+initVars.join(",")+'" />'+'<param name="windowless" value="true" />'+'<param name="background" value="black" />'+'<param name="minRuntimeVersion" value="3.0.0.0" />'+'<param name="autoUpgrade" value="true" />'+'<param name="source" value="'+options.pluginPath+options.silverlightName+'" />'+"</object>";break;case"flash":if(mejs.MediaFeatures.isIE){specialIEContainer=document.createElement("div");container.appendChild(specialIEContainer);specialIEContainer.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" '+'id="'+pluginid+'" width="'+width+'" height="'+height+'" class="mejs-shim">'+'<param name="movie" value="'+options.pluginPath+options.flashName+"?"+(new Date().getTime())+'" />'+'<param name="flashvars" value="'+initVars.join("&amp;")+'" />'+'<param name="quality" value="high" />'+'<param name="bgcolor" value="#000000" />'+'<param name="wmode" value="transparent" />'+'<param name="allowScriptAccess" value="'+options.flashScriptAccess+'" />'+'<param name="allowFullScreen" value="true" />'+'<param name="scale" value="default" />'+"</object>";}else{container.innerHTML='<embed id="'+pluginid+'" name="'+pluginid+'" '+'play="true" '+'loop="false" '+'quality="high" '+'bgcolor="#000000" '+'wmode="transparent" '+'allowScriptAccess="'+options.flashScriptAccess+'" '+'allowFullScreen="true" '+'type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" '+'src="'+options.pluginPath+options.flashName+'" '+'flashvars="'+initVars.join("&")+'" '+'width="'+width+'" '+'height="'+height+'" '+'scale="default"'+'class="mejs-shim"></embed>';}break;case"youtube":var videoId;if(playback.url.lastIndexOf("youtu.be")!=-1){videoId=playback.url.substr(playback.url.lastIndexOf("/")+1);if(videoId.indexOf("?")!=-1){videoId=videoId.substr(0,videoId.indexOf("?"));}}else{var videoIdMatch=playback.url.match(/[?&]v=([^&#]+)|&|#|$/);if(videoIdMatch){videoId=videoIdMatch[1];}}youtubeSettings={container:container,containerId:container.id,pluginMediaElement:pluginMediaElement,pluginId:pluginid,videoId:videoId,height:height,width:width,scheme:playback.scheme,variables:options.youtubeIframeVars};if(window.postMessage){mejs.YouTubeApi.enqueueIframe(youtubeSettings);}else{if(mejs.PluginDetector.hasPluginVersion("flash",[10,0,0])){mejs.YouTubeApi.createFlash(youtubeSettings,options);}}break;case"vimeo":var player_id=pluginid+"_player";pluginMediaElement.vimeoid=playback.url.substr(playback.url.lastIndexOf("/")+1);container.innerHTML='<iframe src="'+playback.scheme+"player.vimeo.com/video/"+pluginMediaElement.vimeoid+"?api=1&portrait=0&byline=0&title=0&player_id="+player_id+'" width="'+width+'" height="'+height+'" frameborder="0" class="mejs-shim" id="'+player_id+'" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>';if(typeof($f)=="function"){var player=$f(container.childNodes[0]),playerState=-1;player.addEvent("ready",function(){player.playVideo=function(){player.api("play");};player.stopVideo=function(){player.api("unload");};player.pauseVideo=function(){player.api("pause");};player.seekTo=function(seconds){player.api("seekTo",seconds);};player.setVolume=function(volume){player.api("setVolume",volume);};player.setMuted=function(muted){if(muted){player.lastVolume=player.api("getVolume");player.api("setVolume",0);}else{player.api("setVolume",player.lastVolume);delete player.lastVolume;}};player.getPlayerState=function(){return playerState;};function createEvent(player,pluginMediaElement,eventName,e){var event={type:eventName,target:pluginMediaElement};if(eventName=="timeupdate"){pluginMediaElement.currentTime=event.currentTime=e.seconds;pluginMediaElement.duration=event.duration=e.duration;}pluginMediaElement.dispatchEvent(event);}player.addEvent("play",function(){playerState=1;createEvent(player,pluginMediaElement,"play");createEvent(player,pluginMediaElement,"playing");});player.addEvent("pause",function(){playerState=2;createEvent(player,pluginMediaElement,"pause");});player.addEvent("finish",function(){playerState=0;createEvent(player,pluginMediaElement,"ended");});player.addEvent("playProgress",function(e){createEvent(player,pluginMediaElement,"timeupdate",e);});player.addEvent("seek",function(e){playerState=3;createEvent(player,pluginMediaElement,"seeked",e);});player.addEvent("loadProgress",function(e){playerState=3;createEvent(player,pluginMediaElement,"progress",e);});pluginMediaElement.pluginElement=container;pluginMediaElement.pluginApi=player;pluginMediaElement.success(pluginMediaElement,pluginMediaElement.pluginElement);});}else{console.warn("You need to include froogaloop for vimeo to work");}break;}htmlMediaElement.style.display="none";htmlMediaElement.removeAttribute("autoplay");return pluginMediaElement;},updateNative:function(playback,options,autoplay,preload){var htmlMediaElement=playback.htmlMediaElement,m;for(m in mejs.HtmlMediaElement){htmlMediaElement[m]=mejs.HtmlMediaElement[m];}options.success(htmlMediaElement,htmlMediaElement);return htmlMediaElement;}};mejs.YouTubeApi={isIframeStarted:false,isIframeLoaded:false,loadIframeApi:function(yt){if(!this.isIframeStarted){var tag=document.createElement("script");tag.src=yt.scheme+"www.youtube.com/player_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);this.isIframeStarted=true;}},iframeQueue:[],enqueueIframe:function(yt){if(this.isLoaded){this.createIframe(yt);}else{this.loadIframeApi(yt);this.iframeQueue.push(yt);}},createIframe:function(settings){var pluginMediaElement=settings.pluginMediaElement,defaultVars={controls:0,wmode:"transparent",rel:0,showinfo:0},player=new YT.Player(settings.containerId,{height:settings.height,width:settings.width,videoId:settings.videoId,playerVars:mejs.$.extend({},defaultVars,settings.variables),events:{"onReady":function(e){player.setVideoSize=function(width,height){player.setSize(width,height);};settings.pluginMediaElement.pluginApi=player;settings.pluginMediaElement.pluginElement=document.getElementById(settings.containerId);pluginMediaElement.success(pluginMediaElement,pluginMediaElement.pluginElement);mejs.YouTubeApi.createEvent(player,pluginMediaElement,"canplay");setInterval(function(){mejs.YouTubeApi.createEvent(player,pluginMediaElement,"timeupdate");},250);if(typeof pluginMediaElement.attributes.autoplay!=="undefined"){player.playVideo();}},"onStateChange":function(e){mejs.YouTubeApi.handleStateChange(e.data,player,pluginMediaElement);}}});},createEvent:function(player,pluginMediaElement,eventName){var event={type:eventName,target:pluginMediaElement};if(player&&player.getDuration){pluginMediaElement.currentTime=event.currentTime=player.getCurrentTime();pluginMediaElement.duration=event.duration=player.getDuration();event.paused=pluginMediaElement.paused;event.ended=pluginMediaElement.ended;event.muted=player.isMuted();event.volume=player.getVolume()/100;event.bytesTotal=player.getVideoBytesTotal();event.bufferedBytes=player.getVideoBytesLoaded();var bufferedTime=event.bufferedBytes/event.bytesTotal*event.duration;event.target.buffered=event.buffered={start:function(index){return 0;},end:function(index){return bufferedTime;},length:1};}pluginMediaElement.dispatchEvent(event);},iFrameReady:function(){this.isLoaded=true;this.isIframeLoaded=true;while(this.iframeQueue.length>0){var settings=this.iframeQueue.pop();this.createIframe(settings);}},flashPlayers:{},createFlash:function(settings){this.flashPlayers[settings.pluginId]=settings;var specialIEContainer,youtubeUrl=settings.scheme+"www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid="+settings.pluginId+"&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0";if(mejs.MediaFeatures.isIE){specialIEContainer=document.createElement("div");settings.container.appendChild(specialIEContainer);specialIEContainer.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+settings.scheme+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" '+'id="'+settings.pluginId+'" width="'+settings.width+'" height="'+settings.height+'" class="mejs-shim">'+'<param name="movie" value="'+youtubeUrl+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowScriptAccess" value="'+options.flashScriptAccess+'" />'+'<param name="allowFullScreen" value="true" />'+"</object>";}else{settings.container.innerHTML='<object type="application/x-shockwave-flash" id="'+settings.pluginId+'" data="'+youtubeUrl+'" '+'width="'+settings.width+'" height="'+settings.height+'" style="visibility: visible; " class="mejs-shim">'+'<param name="allowScriptAccess" value="'+options.flashScriptAccess+'">'+'<param name="wmode" value="transparent">'+"</object>";}},flashReady:function(id){var settings=this.flashPlayers[id],player=document.getElementById(id),pluginMediaElement=settings.pluginMediaElement;pluginMediaElement.pluginApi=pluginMediaElement.pluginElement=player;settings.success(pluginMediaElement,pluginMediaElement.pluginElement);player.cueVideoById(settings.videoId);var callbackName=settings.containerId+"_callback";window[callbackName]=function(e){mejs.YouTubeApi.handleStateChange(e,player,pluginMediaElement);};player.addEventListener("onStateChange",callbackName);setInterval(function(){mejs.YouTubeApi.createEvent(player,pluginMediaElement,"timeupdate");},250);mejs.YouTubeApi.createEvent(player,pluginMediaElement,"canplay");},handleStateChange:function(youTubeState,player,pluginMediaElement){switch(youTubeState){case -1:pluginMediaElement.paused=true;pluginMediaElement.ended=true;mejs.YouTubeApi.createEvent(player,pluginMediaElement,"loadedmetadata");break;case 0:pluginMediaElement.paused=false;pluginMediaElement.ended=true;mejs.YouTubeApi.createEvent(player,pluginMediaElement,"ended");break;case 1:pluginMediaElement.paused=false;pluginMediaElement.ended=false;mejs.YouTubeApi.createEvent(player,pluginMediaElement,"play");mejs.YouTubeApi.createEvent(player,pluginMediaElement,"playing");break;case 2:pluginMediaElement.paused=true;pluginMediaElement.ended=false;mejs.YouTubeApi.createEvent(player,pluginMediaElement,"pause");break;case 3:mejs.YouTubeApi.createEvent(player,pluginMediaElement,"progress");break;case 5:break;}}};window.onYouTubePlayerAPIReady=function(){mejs.YouTubeApi.iFrameReady();};window.onYouTubePlayerReady=function(id){mejs.YouTubeApi.flashReady(id);};window.mejs=mejs;window.MediaElement=mejs.MediaElement;(function(doc,win,mejs,undefined){var i18n={"default":"en",locale:{language:(mejs.i18n&&mejs.i18n.locale.language)||"",strings:(mejs.i18n&&mejs.i18n.locale.strings)||{}},pluralForms:[function(){return arguments[1];},function(){var args=arguments;if(args[0]===1){return args[1];}else{return args[2];}},function(){var args=arguments;if([0,1].indexOf(args[0])>-1){return args[1];}else{return args[2];}},function(){var args=arguments;if(args[0]%10===1&&args[0]%100!==11){return args[1];}else{if(args[0]!==0){return args[2];}else{return args[3];}}},function(){var args=arguments;if(args[0]===1||args[0]===11){return args[1];}else{if(args[0]===2||args[0]===12){return args[2];}else{if(args[0]>2&&args[0]<20){return args[3];}else{return args[4];}}}},function(){if(args[0]===1){return args[1];}else{if(args[0]===0||(args[0]%100>0&&args[0]%100<20)){return args[2];}else{return args[3];}}},function(){var args=arguments;if(args[0]%10===1&&args[0]%100!==11){return args[1];}else{if(args[0]%10>=2&&(args[0]%100<10||args[0]%100>=20)){return args[2];}else{return[3];}}},function(){var args=arguments;if(args[0]%10===1&&args[0]%100!==11){return args[1];}else{if(args[0]%10>=2&&args[0]%10<=4&&(args[0]%100<10||args[0]%100>=20)){return args[2];}else{return args[3];}}},function(){var args=arguments;if(args[0]===1){return args[1];}else{if(args[0]>=2&&args[0]<=4){return args[2];}else{return args[3];}}},function(){var args=arguments;if(args[0]===1){return args[1];}else{if(args[0]%10>=2&&args[0]%10<=4&&(args[0]%100<10||args[0]%100>=20)){return args[2];}else{return args[3];}}},function(){var args=arguments;if(args[0]%100===1){return args[2];}else{if(args[0]%100===2){return args[3];}else{if(args[0]%100===3||args[0]%100===4){return args[4];}else{return args[1];}}}},function(){var args=arguments;if(args[0]===1){return args[1];}else{if(args[0]===2){return args[2];}else{if(args[0]>2&&args[0]<7){return args[3];}else{if(args[0]>6&&args[0]<11){return args[4];}else{return args[5];}}}}},function(){var args=arguments;if(args[0]===0){return args[1];}else{if(args[0]===1){return args[2];}else{if(args[0]===2){return args[3];}else{if(args[0]%100>=3&&args[0]%100<=10){return args[4];}else{if(args[0]%100>=11){return args[5];}else{return args[6];}}}}}},function(){var args=arguments;if(args[0]===1){return args[1];}else{if(args[0]===0||(args[0]%100>1&&args[0]%100<11)){return args[2];}else{if(args[0]%100>10&&args[0]%100<20){return args[3];}else{return args[4];}}}},function(){var args=arguments;if(args[0]%10===1){return args[1];}else{if(args[0]%10===2){return args[2];}else{return args[3];}}},function(){var args=arguments;if(args[0]!==11&&args[0]%10===1){return args[1];}else{return args[2];}},function(){var args=arguments;if(args[0]===1){return args[1];}else{if(args[0]%10>=2&&args[0]%10<=4&&(args[0]%100<10||args[0]%100>=20)){return args[2];}else{return args[3];}}},function(){var args=arguments;if(args[0]===1){return args[1];}else{if(args[0]===2){return args[2];}else{if(args[0]!==8&&args[0]!==11){return args[3];}else{return args[4];}}}},function(){var args=arguments;if(args[0]===0){return args[1];}else{return args[2];}},function(){var args=arguments;if(args[0]===1){return args[1];}else{if(args[0]===2){return args[2];}else{if(args[0]===3){return args[3];}else{return args[4];}}}},function(){var args=arguments;if(args[0]===0){return args[1];}else{if(args[0]===1){return args[2];}else{return args[3];}}}],getLanguage:function(){var language=i18n.locale.language||i18n["default"];return/^(x\-)?[a-z]{2,}(\-\w{2,})?(\-\w{2,})?$/.exec(language)?language:i18n["default"];},t:function(message,pluralParam){if(typeof message==="string"&&message.length){var language=i18n.getLanguage(),str,pluralForm,plural=function(input,number,form){if(typeof input!=="object"||typeof number!=="number"||typeof form!=="number"){return input;}if(typeof input==="string"){return input;}return i18n.pluralForms[form].apply(null,[number].concat(input));},escapeHTML=function(input){var map={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return input.replace(/[&<>"]/g,function(c){return map[c];});};if(i18n.locale.strings&&i18n.locale.strings[language]){str=i18n.locale.strings[language][message];if(typeof pluralParam==="number"){pluralForm=i18n.locale.strings[language]["mejs.plural-form"];str=plural.apply(null,[str,pluralParam,pluralForm]);}}if(!str&&i18n.locale.strings&&i18n.locale.strings[i18n["default"]]){str=i18n.locale.strings[i18n["default"]][message];if(typeof pluralParam==="number"){pluralForm=i18n.locale.strings[i18n["default"]]["mejs.plural-form"];str=plural.apply(null,[str,pluralParam,pluralForm]);}}str=str||message;if(typeof pluralParam==="number"){str=str.replace("%1",pluralParam);}return escapeHTML(str);}return message;}};if(typeof mejsL10n!=="undefined"){i18n.locale.language=mejsL10n.language;}mejs.i18n=i18n;}(document,window,mejs));(function(mejs,undefined){if(typeof mejsL10n!=="undefined"){mejs[mejsL10n.language]=mejsL10n.strings;}}(mejs.i18n.locale.strings));
/*!
 * This is a i18n.locale language object.
 *
 * English; This can serve as a template for other languages to translate
 *
 * @author
 *   TBD
 *   Sascha Greuel (Twitter: @SoftCreatR)
 *
 * @see
 *   me-i18n.js
 *
 * @params
 *  - exports - CommonJS, window ..
 */
(function(exports){if(exports.en===undefined){exports.en={"mejs.plural-form":1,"mejs.download-file":"Download File","mejs.fullscreen-off":"Turn off Fullscreen","mejs.fullscreen-on":"Go Fullscreen","mejs.download-video":"Download Video","mejs.fullscreen":"Fullscreen","mejs.time-jump-forward":["Jump forward 1 second","Jump forward %1 seconds"],"mejs.play":"Play","mejs.pause":"Pause","mejs.close":"Close","mejs.time-slider":"Time Slider","mejs.time-help-text":"Use Left/Right Arrow keys to advance one second, Up/Down arrows to advance ten seconds.","mejs.time-skip-back":["Skip back 1 second","Skip back %1 seconds"],"mejs.captions-subtitles":"Captions/Subtitles","mejs.none":"None","mejs.mute-toggle":"Mute Toggle","mejs.volume-help-text":"Use Up/Down Arrow keys to increase or decrease volume.","mejs.unmute":"Unmute","mejs.mute":"Mute","mejs.volume-slider":"Volume Slider","mejs.video-player":"Video Player","mejs.audio-player":"Audio Player","mejs.ad-skip":"Skip ad","mejs.ad-skip-info":["Skip in 1 second","Skip in %1 seconds"],"mejs.source-chooser":"Source Chooser"};}}(mejs.i18n.locale.strings));
   /* Ende mediaelement */
   /* Start mediaelement_i18n_de */
   /*!
 * --GSBDocStart
 * @module medialement.js 
 * @version 2.23.5
 * @see {@link http://me-i18n.js}
 * @author Jalios (Twitter: @Jalios)
 *   Sascha Greuel (Twitter: @SoftCreatR)
 * @license MIT license
 * 
 * @desc Addon zur Ausgabe von deutschen Labels
 *--GSBDocEnd
 * This is a i18n.locale language object.
 *
 * German
 *
 * @see
 *   me-i18n.js
 *
 * @params
 *  - exports - CommonJS, window ..
 */
(function(exports){if(exports.de===undefined){exports.de={"mejs.plural-form":1,"mejs.download-file":"Datei herunterladen","mejs.fullscreen-off":"Vollbildmodus beenden","mejs.fullscreen-on":"Vollbild","mejs.download-video":"Video herunterladen","mejs.fullscreen":"Vollbild","mejs.time-jump-forward":["1 Sekunde vorspulen","%1 Sekunden vorspulen"],"mejs.play":"Abspielen","mejs.pause":"Pause","mejs.close":"Schließen","mejs.time-slider":"Zeitschieberegler","mejs.time-help-text":"Verwende die Pfeiltaste nach links/rechts, um eine Sekunde zu spulen, hoch/runter um zehn Sekunden zu spulen.","mejs.time-skip-back":["1 Sekunde zurückspulen","%1 Sekunden zurückspulen"],"mejs.captions-subtitles":"Überschriften/Untertitel","mejs.none":"Keine","mejs.mute-toggle":"Stummschaltung umschalten","mejs.volume-help-text":"Verwende die Pfeiltaste nach oben/nach unten um die Lautstärke zu erhöhen oder zu verringern.","mejs.unmute":"Stummschaltung aufheben","mejs.mute":"Stummschalten","mejs.volume-slider":"Lautstärkeregler","mejs.video-player":"Video-Player","mejs.audio-player":"Audio-Player","mejs.ad-skip":"Werbung überspringen","mejs.ad-skip-info":["Überspringen in 1 Sekunde","Überspringen in %1 Sekunden"],"mejs.source-chooser":"Quellenauswahl"};}}(mejs.i18n.locale.strings));
   /* Ende mediaelement_i18n_de */
   /* Start mediaelementplayer */
   /*!
 * --GSBDocStart
 * @module MediaElementPlayer
 * @version 2.23.5
 * @see {@link http://mediaelementjs.com/}
 * @author John Dyer (http://j.hn/), 2010-2013
 * @license MIT license
 *
 * @desc Creates a controller bar for HTML5 &ltvideo> add &ltaudio> tags
 * using jQuery and MediaElement.js (HTML5 Flash/Silverlight wrapper)
 *--GSBDocEnd
 * Copyright 2010-2013, John Dyer (http://j.hn/)
 * License: MIT
 *
 */
;if(typeof jQuery!="undefined"){mejs.$=jQuery;}else{if(typeof Zepto!="undefined"){mejs.$=Zepto;Zepto.fn.outerWidth=function(includeMargin){var width=$(this).width();if(includeMargin){width+=parseInt($(this).css("margin-right"),10);width+=parseInt($(this).css("margin-left"),10);}return width;};}else{if(typeof ender!="undefined"){mejs.$=ender;}}}(function($){mejs.MepDefaults={poster:"",showPosterWhenEnded:false,defaultVideoWidth:480,defaultVideoHeight:270,videoWidth:-1,videoHeight:-1,defaultAudioWidth:400,defaultAudioHeight:30,defaultSeekBackwardInterval:function(media){return(media.duration*0.05);},defaultSeekForwardInterval:function(media){return(media.duration*0.05);},setDimensions:true,audioWidth:-1,audioHeight:-1,startVolume:0.8,loop:false,autoRewind:true,enableAutosize:true,timeFormat:"",alwaysShowHours:false,showTimecodeFrameCount:false,framesPerSecond:25,autosizeProgress:true,alwaysShowControls:false,hideVideoControlsOnLoad:false,clickToPlayPause:true,controlsTimeoutDefault:1500,controlsTimeoutMouseEnter:2500,controlsTimeoutMouseLeave:1000,iPadUseNativeControls:false,iPhoneUseNativeControls:false,AndroidUseNativeControls:false,features:["playpause","current","progress","duration","tracks","volume","fullscreen"],isVideo:true,stretching:"auto",enableKeyboard:true,pauseOtherPlayers:true,keyActions:[{keys:[32,179],action:function(player,media,key,event){if(!mejs.MediaFeatures.isFirefox){if(media.paused||media.ended){media.play();}else{media.pause();}}}},{keys:[38],action:function(player,media,key,event){player.container.find(".mejs-volume-slider").css("display","block");if(player.isVideo){player.showControls();player.startControlsTimer();}var newVolume=Math.min(media.volume+0.1,1);media.setVolume(newVolume);}},{keys:[40],action:function(player,media,key,event){player.container.find(".mejs-volume-slider").css("display","block");if(player.isVideo){player.showControls();player.startControlsTimer();}var newVolume=Math.max(media.volume-0.1,0);media.setVolume(newVolume);}},{keys:[37,227],action:function(player,media,key,event){if(!isNaN(media.duration)&&media.duration>0){if(player.isVideo){player.showControls();player.startControlsTimer();}var newTime=Math.max(media.currentTime-player.options.defaultSeekBackwardInterval(media),0);media.setCurrentTime(newTime);}}},{keys:[39,228],action:function(player,media,key,event){if(!isNaN(media.duration)&&media.duration>0){if(player.isVideo){player.showControls();player.startControlsTimer();}var newTime=Math.min(media.currentTime+player.options.defaultSeekForwardInterval(media),media.duration);media.setCurrentTime(newTime);}}},{keys:[70],action:function(player,media,key,event){if(typeof player.enterFullScreen!="undefined"){if(player.isFullScreen){player.exitFullScreen();}else{player.enterFullScreen();}}}},{keys:[77],action:function(player,media,key,event){player.container.find(".mejs-volume-slider").css("display","block");if(player.isVideo){player.showControls();player.startControlsTimer();}if(player.media.muted){player.setMuted(false);}else{player.setMuted(true);}}}]};mejs.mepIndex=0;mejs.players={};mejs.MediaElementPlayer=function(node,o){if(!(this instanceof mejs.MediaElementPlayer)){return new mejs.MediaElementPlayer(node,o);}var t=this;t.$media=t.$node=$(node);t.node=t.media=t.$media[0];if(!t.node){return;}if(typeof t.node.player!="undefined"){return t.node.player;}if(typeof o=="undefined"){o=t.$node.data("mejsoptions");}t.options=$.extend({},mejs.MepDefaults,o);if(!t.options.timeFormat){t.options.timeFormat="mm:ss";if(t.options.alwaysShowHours){t.options.timeFormat="hh:mm:ss";}if(t.options.showTimecodeFrameCount){t.options.timeFormat+=":ff";}}mejs.Utility.calculateTimeFormat(0,t.options,t.options.framesPerSecond||25);t.id="mep_"+mejs.mepIndex++;mejs.players[t.id]=t;t.init();return t;};mejs.MediaElementPlayer.prototype={hasFocus:false,controlsAreVisible:true,init:function(){var t=this,mf=mejs.MediaFeatures,meOptions=$.extend(true,{},t.options,{success:function(media,domNode){t.meReady(media,domNode);},error:function(e){t.handleError(e);}}),tagName=t.media.tagName.toLowerCase();t.isDynamic=(tagName!=="audio"&&tagName!=="video");if(t.isDynamic){t.isVideo=t.options.isVideo;}else{t.isVideo=(tagName!=="audio"&&t.options.isVideo);}if((mf.isiPad&&t.options.iPadUseNativeControls)||(mf.isiPhone&&t.options.iPhoneUseNativeControls)){t.$media.attr("controls","controls");if(mf.isiPad&&t.media.getAttribute("autoplay")!==null){t.play();}}else{if(mf.isAndroid&&t.options.AndroidUseNativeControls){}else{if(t.isVideo||(!t.isVideo&&t.options.features.length)){t.$media.removeAttr("controls");var videoPlayerTitle=t.isVideo?mejs.i18n.t("mejs.video-player"):mejs.i18n.t("mejs.audio-player");$('<span class="mejs-offscreen">'+videoPlayerTitle+"</span>").insertBefore(t.$media);t.container=$('<div id="'+t.id+'" class="mejs-container '+(mejs.MediaFeatures.svgAsImg?"svg":"no-svg")+'" tabindex="0" role="application" aria-label="'+videoPlayerTitle+'">'+'<div class="mejs-inner">'+'<div class="mejs-mediaelement"></div>'+'<div class="mejs-layers"></div>'+'<div class="mejs-controls"></div>'+'<div class="mejs-clear"></div>'+"</div>"+"</div>").addClass(t.$media[0].className).insertBefore(t.$media).focus(function(e){if(!t.controlsAreVisible&&!t.hasFocus&&t.controlsEnabled){t.showControls(true);if(!t.hasMsNativeFullScreen){var btnSelector=".mejs-playpause-button > button";if(mejs.Utility.isNodeAfter(e.relatedTarget,t.container[0])){btnSelector=".mejs-controls .mejs-button:last-child > button";}var button=t.container.find(btnSelector);button.focus();}}});if(!t.options.features.length){t.container.css("background","transparent").find(".mejs-controls").hide();}if(t.isVideo&&t.options.stretching==="fill"&&!t.container.parent("mejs-fill-container").length){t.outerContainer=t.$media.parent();t.container.wrap('<div class="mejs-fill-container"/>');}t.container.addClass((mf.isAndroid?"mejs-android ":"")+(mf.isiOS?"mejs-ios ":"")+(mf.isiPad?"mejs-ipad ":"")+(mf.isiPhone?"mejs-iphone ":"")+(t.isVideo?"mejs-video ":"mejs-audio "));t.container.find(".mejs-mediaelement").append(t.$media);t.node.player=t;t.controls=t.container.find(".mejs-controls");t.layers=t.container.find(".mejs-layers");var tagType=(t.isVideo?"video":"audio"),capsTagName=tagType.substring(0,1).toUpperCase()+tagType.substring(1);if(t.options[tagType+"Width"]>0||t.options[tagType+"Width"].toString().indexOf("%")>-1){t.width=t.options[tagType+"Width"];}else{if(t.media.style.width!==""&&t.media.style.width!==null){t.width=t.media.style.width;}else{if(t.media.getAttribute("width")!==null){t.width=t.$media.attr("width");}else{t.width=t.options["default"+capsTagName+"Width"];}}}if(t.options[tagType+"Height"]>0||t.options[tagType+"Height"].toString().indexOf("%")>-1){t.height=t.options[tagType+"Height"];}else{if(t.media.style.height!==""&&t.media.style.height!==null){t.height=t.media.style.height;}else{if(t.$media[0].getAttribute("height")!==null){t.height=t.$media.attr("height");}else{t.height=t.options["default"+capsTagName+"Height"];}}}t.setPlayerSize(t.width,t.height);meOptions.pluginWidth=t.width;meOptions.pluginHeight=t.height;}else{if(!t.isVideo&&!t.options.features.length){t.$media.hide();}}}}mejs.MediaElement(t.$media[0],meOptions);if(typeof(t.container)!=="undefined"&&t.options.features.length&&t.controlsAreVisible){t.container.trigger("controlsshown");}},showControls:function(doAnimation){var t=this;doAnimation=typeof doAnimation=="undefined"||doAnimation;if(t.controlsAreVisible){return;}if(doAnimation){t.controls.removeClass("mejs-offscreen").stop(true,true).fadeIn(200,function(){t.controlsAreVisible=true;t.container.trigger("controlsshown");});t.container.find(".mejs-control").removeClass("mejs-offscreen").stop(true,true).fadeIn(200,function(){t.controlsAreVisible=true;});}else{t.controls.removeClass("mejs-offscreen").css("display","block");t.container.find(".mejs-control").removeClass("mejs-offscreen").css("display","block");t.controlsAreVisible=true;t.container.trigger("controlsshown");}t.setControlsSize();},hideControls:function(doAnimation){var t=this;doAnimation=typeof doAnimation=="undefined"||doAnimation;if(!t.controlsAreVisible||t.options.alwaysShowControls||t.keyboardAction||t.media.paused||t.media.ended){return;}if(doAnimation){t.controls.stop(true,true).fadeOut(200,function(){$(this).addClass("mejs-offscreen").css("display","block");t.controlsAreVisible=false;t.container.trigger("controlshidden");});t.container.find(".mejs-control").stop(true,true).fadeOut(200,function(){$(this).addClass("mejs-offscreen").css("display","block");});}else{t.controls.addClass("mejs-offscreen").css("display","block");t.container.find(".mejs-control").addClass("mejs-offscreen").css("display","block");t.controlsAreVisible=false;t.container.trigger("controlshidden");}},controlsTimer:null,startControlsTimer:function(timeout){var t=this;timeout=typeof timeout!="undefined"?timeout:t.options.controlsTimeoutDefault;t.killControlsTimer("start");t.controlsTimer=setTimeout(function(){t.hideControls();t.killControlsTimer("hide");},timeout);},killControlsTimer:function(src){var t=this;if(t.controlsTimer!==null){clearTimeout(t.controlsTimer);delete t.controlsTimer;t.controlsTimer=null;}},controlsEnabled:true,disableControls:function(){var t=this;t.killControlsTimer();t.hideControls(false);this.controlsEnabled=false;},enableControls:function(){var t=this;t.showControls(false);t.controlsEnabled=true;},meReady:function(media,domNode){var t=this,mf=mejs.MediaFeatures,autoplayAttr=domNode.getAttribute("autoplay"),autoplay=!(typeof autoplayAttr=="undefined"||autoplayAttr===null||autoplayAttr==="false"),featureIndex,feature;if(t.created){return;}else{t.created=true;}t.media=media;t.domNode=domNode;if(!(mf.isAndroid&&t.options.AndroidUseNativeControls)&&!(mf.isiPad&&t.options.iPadUseNativeControls)&&!(mf.isiPhone&&t.options.iPhoneUseNativeControls)){if(!t.isVideo&&!t.options.features.length){if(autoplay&&media.pluginType=="native"){t.play();}if(t.options.success){if(typeof t.options.success=="string"){window[t.options.success](t.media,t.domNode,t);}else{t.options.success(t.media,t.domNode,t);}}return;}t.buildposter(t,t.controls,t.layers,t.media);t.buildkeyboard(t,t.controls,t.layers,t.media);t.buildoverlays(t,t.controls,t.layers,t.media);t.findTracks();for(featureIndex in t.options.features){feature=t.options.features[featureIndex];if(t["build"+feature]){try{t["build"+feature](t,t.controls,t.layers,t.media);}catch(e){}}}t.container.trigger("controlsready");t.setPlayerSize(t.width,t.height);t.setControlsSize();if(t.isVideo){if(mejs.MediaFeatures.hasTouch&&!t.options.alwaysShowControls){t.$media.bind("touchstart",function(){if(t.controlsAreVisible){t.hideControls(false);}else{if(t.controlsEnabled){t.showControls(false);}}});}else{t.clickToPlayPauseCallback=function(){if(t.options.clickToPlayPause){if(t.media.paused){t.play();}else{t.pause();}var button=t.$media.closest(".mejs-container").find(".mejs-overlay-button"),pressed=button.attr("aria-pressed");button.attr("aria-pressed",!pressed);}};t.media.addEventListener("click",t.clickToPlayPauseCallback,false);t.container.bind("mouseenter",function(){if(t.controlsEnabled){if(!t.options.alwaysShowControls){t.killControlsTimer("enter");t.showControls();t.startControlsTimer(t.options.controlsTimeoutMouseEnter);}}}).bind("mousemove",function(){if(t.controlsEnabled){if(!t.controlsAreVisible){t.showControls();}if(!t.options.alwaysShowControls){t.startControlsTimer(t.options.controlsTimeoutMouseEnter);}}}).bind("mouseleave",function(){if(t.controlsEnabled){if(!t.media.paused&&!t.options.alwaysShowControls){t.startControlsTimer(t.options.controlsTimeoutMouseLeave);}}});}if(t.options.hideVideoControlsOnLoad){t.hideControls(false);}if(autoplay&&!t.options.alwaysShowControls){t.hideControls();}if(t.options.enableAutosize){t.media.addEventListener("loadedmetadata",function(e){if(t.options.videoHeight<=0&&t.domNode.getAttribute("height")===null&&!isNaN(e.target.videoHeight)){t.setPlayerSize(e.target.videoWidth,e.target.videoHeight);t.setControlsSize();t.media.setVideoSize(e.target.videoWidth,e.target.videoHeight);}},false);}}t.media.addEventListener("play",function(){var playerIndex;for(playerIndex in mejs.players){var p=mejs.players[playerIndex];if(p.id!=t.id&&t.options.pauseOtherPlayers&&!p.paused&&!p.ended){p.pause();}p.hasFocus=false;}t.hasFocus=true;},false);t.media.addEventListener("ended",function(e){if(t.options.autoRewind){try{t.media.setCurrentTime(0);window.setTimeout(function(){$(t.container).find(".mejs-overlay-loading").parent().hide();},20);}catch(exp){}}if(t.media.pluginType==="youtube"){t.media.stop();}else{t.media.pause();}if(t.setProgressRail){t.setProgressRail();}if(t.setCurrentRail){t.setCurrentRail();}if(t.options.loop){t.play();}else{if(!t.options.alwaysShowControls&&t.controlsEnabled){t.showControls();}}},false);t.media.addEventListener("loadedmetadata",function(){mejs.Utility.calculateTimeFormat(t.duration,t.options,t.options.framesPerSecond||25);if(t.updateDuration){t.updateDuration();}if(t.updateCurrent){t.updateCurrent();}if(!t.isFullScreen){t.setPlayerSize(t.width,t.height);t.setControlsSize();}},false);var duration=null;t.media.addEventListener("timeupdate",function(){if(duration!==this.duration){duration=this.duration;mejs.Utility.calculateTimeFormat(duration,t.options,t.options.framesPerSecond||25);if(t.updateDuration){t.updateDuration();}if(t.updateCurrent){t.updateCurrent();}t.setControlsSize();}},false);t.container.focusout(function(e){if(e.relatedTarget){var $target=$(e.relatedTarget);if(t.keyboardAction&&$target.parents(".mejs-container").length===0){t.keyboardAction=false;if(t.isVideo&&!t.options.alwaysShowControls){t.hideControls(true);}}}});setTimeout(function(){t.setPlayerSize(t.width,t.height);t.setControlsSize();},50);t.globalBind("resize",function(){if(!(t.isFullScreen||(mejs.MediaFeatures.hasTrueNativeFullScreen&&document.webkitIsFullScreen))){t.setPlayerSize(t.width,t.height);}t.setControlsSize();});if(t.media.pluginType=="youtube"&&(mf.isiOS||mf.isAndroid)){t.container.find(".mejs-overlay-play").hide();t.container.find(".mejs-poster").hide();}}if(autoplay&&media.pluginType=="native"){t.play();}if(t.options.success){if(typeof t.options.success=="string"){window[t.options.success](t.media,t.domNode,t);}else{t.options.success(t.media,t.domNode,t);}}},handleError:function(e){var t=this;if(t.controls){t.controls.hide();}if(t.options.error){t.options.error(e);}},setPlayerSize:function(width,height){var t=this;if(!t.options.setDimensions){return false;}if(typeof width!="undefined"){t.width=width;}if(typeof height!="undefined"){t.height=height;}switch(t.options.stretching){case"fill":if(t.isVideo){this.setFillMode();}else{this.setDimensions(t.width,t.height);}break;case"responsive":this.setResponsiveMode();break;case"none":this.setDimensions(t.width,t.height);break;default:if(this.hasFluidMode()===true){this.setResponsiveMode();}else{this.setDimensions(t.width,t.height);}break;}},hasFluidMode:function(){var t=this;return(t.height.toString().indexOf("%")>0||(t.$node.css("max-width")!=="none"&&t.$node.css("max-width")!=="t.width")||(t.$node[0].currentStyle&&t.$node[0].currentStyle.maxWidth==="100%"));},setResponsiveMode:function(){var t=this;var nativeWidth=(function(){if(t.isVideo){if(t.media.videoWidth&&t.media.videoWidth>0){return t.media.videoWidth;}else{if(t.media.getAttribute("width")!==null){return t.media.getAttribute("width");}else{return t.options.defaultVideoWidth;}}}else{return t.options.defaultAudioWidth;}})();var nativeHeight=(function(){if(t.isVideo){if(t.media.videoHeight&&t.media.videoHeight>0){return t.media.videoHeight;}else{if(t.media.getAttribute("height")!==null){return t.media.getAttribute("height");}else{return t.options.defaultVideoHeight;}}}else{return t.options.defaultAudioHeight;}})();var parentWidth=t.container.parent().closest(":visible").width(),parentHeight=t.container.parent().closest(":visible").height(),newHeight=t.isVideo||!t.options.autosizeProgress?parseInt(parentWidth*nativeHeight/nativeWidth,10):nativeHeight;if(isNaN(newHeight)||(parentHeight!==0&&newHeight>parentHeight&&parentHeight>nativeHeight)){newHeight=parentHeight;}if(t.container.parent().length>0&&t.container.parent()[0].tagName.toLowerCase()==="body"){parentWidth=$(window).width();newHeight=$(window).height();}if(newHeight&&parentWidth){t.container.width(parentWidth).height(newHeight);t.$media.add(t.container.find(".mejs-shim")).width("100%").height("100%");if(t.isVideo){if(t.media.setVideoSize){t.media.setVideoSize(parentWidth,newHeight);}}t.layers.children(".mejs-layer").width("100%").height("100%");}},setFillMode:function(){var t=this,parent=t.outerContainer;if(!parent.width()){parent.height(t.$media.width());}if(!parent.height()){parent.height(t.$media.height());}var parentWidth=parent.width(),parentHeight=parent.height();t.setDimensions("100%","100%");t.container.find(".mejs-poster img").css("display","block");targetElement=t.container.find("object, embed, iframe, video");var initHeight=t.height,initWidth=t.width,scaleX1=parentWidth,scaleY1=(initHeight*parentWidth)/initWidth,scaleX2=(initWidth*parentHeight)/initHeight,scaleY2=parentHeight,bScaleOnWidth=!(scaleX2>parentWidth),finalWidth=bScaleOnWidth?Math.floor(scaleX1):Math.floor(scaleX2),finalHeight=bScaleOnWidth?Math.floor(scaleY1):Math.floor(scaleY2);if(bScaleOnWidth){targetElement.height(finalHeight).width(parentWidth);if(t.media.setVideoSize){t.media.setVideoSize(parentWidth,finalHeight);}}else{targetElement.height(parentHeight).width(finalWidth);if(t.media.setVideoSize){t.media.setVideoSize(finalWidth,parentHeight);}}targetElement.css({"margin-left":Math.floor((parentWidth-finalWidth)/2),"margin-top":0});},setDimensions:function(width,height){var t=this;t.container.width(width).height(height);t.layers.children(".mejs-layer").width(width).height(height);},setControlsSize:function(){var t=this,usedWidth=0,railWidth=0,rail=t.controls.find(".mejs-time-rail"),total=t.controls.find(".mejs-time-total"),others=rail.siblings(),lastControl=others.last(),lastControlPosition=null,avoidAutosizeProgress=t.options&&!t.options.autosizeProgress;if(!t.container.is(":visible")||!rail.length||!rail.is(":visible")){return;}if(avoidAutosizeProgress){railWidth=parseInt(rail.css("width"),10);}if(railWidth===0||!railWidth){others.each(function(){var $this=$(this);if($this.css("position")!="absolute"&&$this.is(":visible")){usedWidth+=$(this).outerWidth(true);}});railWidth=t.controls.width()-usedWidth-(rail.outerWidth(true)-rail.width());}do{if(!avoidAutosizeProgress){rail.width(railWidth);}total.width(railWidth-(total.outerWidth(true)-total.width()));if(lastControl.css("position")!="absolute"){lastControlPosition=lastControl.length?lastControl.position():null;railWidth--;}}while(lastControlPosition!==null&&lastControlPosition.top.toFixed(2)>0&&railWidth>0);t.container.trigger("controlsresize");},buildposter:function(player,controls,layers,media){var t=this,poster=$('<div class="mejs-poster mejs-layer">'+"</div>").appendTo(layers),posterUrl=player.$media.attr("poster");if(player.options.poster!==""){posterUrl=player.options.poster;}if(posterUrl){t.setPoster(posterUrl);}else{poster.hide();}media.addEventListener("play",function(){poster.hide();},false);if(player.options.showPosterWhenEnded&&player.options.autoRewind){media.addEventListener("ended",function(){poster.show();},false);}},setPoster:function(url){var t=this,posterDiv=t.container.find(".mejs-poster"),posterImg=posterDiv.find("img");if(posterImg.length===0){posterImg=$('<img width="100%" height="100%" alt="" />').appendTo(posterDiv);}posterImg.attr("src",url);posterDiv.css({"background-image":"url("+url+")"});},buildoverlays:function(player,controls,layers,media){var t=this;if(!player.isVideo){return;}var loading=$('<div class="mejs-overlay mejs-layer">'+'<div class="mejs-overlay-loading"><span></span></div>'+"</div>").hide().appendTo(layers),error=$('<div class="mejs-overlay mejs-layer">'+'<div class="mejs-overlay-error"></div>'+"</div>").hide().appendTo(layers),bigPlay=$('<div class="mejs-overlay mejs-layer mejs-overlay-play">'+'<div class="mejs-overlay-button" role="button" aria-label="'+mejs.i18n.t("mejs.play")+'" aria-pressed="false"></div>'+"</div>").appendTo(layers).bind("click",function(){if(t.options.clickToPlayPause){if(media.paused){media.play();}var button=$(this).find(".mejs-overlay-button"),pressed=button.attr("aria-pressed");button.attr("aria-pressed",!!pressed);}});media.addEventListener("play",function(){bigPlay.hide();loading.hide();controls.find(".mejs-time-buffering").hide();error.hide();},false);media.addEventListener("playing",function(){bigPlay.hide();loading.hide();controls.find(".mejs-time-buffering").hide();error.hide();},false);media.addEventListener("seeking",function(){loading.show();controls.find(".mejs-time-buffering").show();},false);media.addEventListener("seeked",function(){loading.hide();controls.find(".mejs-time-buffering").hide();},false);media.addEventListener("pause",function(){if(!mejs.MediaFeatures.isiPhone){bigPlay.show();}},false);media.addEventListener("waiting",function(){loading.show();controls.find(".mejs-time-buffering").show();},false);media.addEventListener("loadeddata",function(){loading.show();controls.find(".mejs-time-buffering").show();if(mejs.MediaFeatures.isAndroid){media.canplayTimeout=window.setTimeout(function(){if(document.createEvent){var evt=document.createEvent("HTMLEvents");evt.initEvent("canplay",true,true);return media.dispatchEvent(evt);}},300);}},false);media.addEventListener("canplay",function(){loading.hide();controls.find(".mejs-time-buffering").hide();clearTimeout(media.canplayTimeout);},false);media.addEventListener("error",function(e){t.handleError(e);loading.hide();bigPlay.hide();error.show();error.find(".mejs-overlay-error").html("Error loading this resource");},false);media.addEventListener("keydown",function(e){t.onkeydown(player,media,e);},false);},buildkeyboard:function(player,controls,layers,media){var t=this;t.container.keydown(function(){t.keyboardAction=true;});t.globalBind("keydown",function(event){player.hasFocus=$(event.target).closest(".mejs-container").length!==0&&$(event.target).closest(".mejs-container").attr("id")===player.$media.closest(".mejs-container").attr("id");return t.onkeydown(player,media,event);});t.globalBind("click",function(event){player.hasFocus=$(event.target).closest(".mejs-container").length!==0;});},onkeydown:function(player,media,e){if(player.hasFocus&&player.options.enableKeyboard){for(var i=0,il=player.options.keyActions.length;i<il;i++){var keyAction=player.options.keyActions[i];for(var j=0,jl=keyAction.keys.length;j<jl;j++){if(e.keyCode==keyAction.keys[j]){if(typeof(e.preventDefault)=="function"){e.preventDefault();}keyAction.action(player,media,e.keyCode,e);return false;}}}}return true;},findTracks:function(){var t=this,tracktags=t.$media.find("track");t.tracks=[];tracktags.each(function(index,track){track=$(track);t.tracks.push({srclang:(track.attr("srclang"))?track.attr("srclang").toLowerCase():"",src:track.attr("src"),kind:track.attr("kind"),label:track.attr("label")||"",entries:[],isLoaded:false});});},changeSkin:function(className){this.container[0].className="mejs-container "+className;this.setPlayerSize(this.width,this.height);this.setControlsSize();},play:function(){this.load();this.media.play();},pause:function(){try{this.media.pause();}catch(e){}},load:function(){if(!this.isLoaded){this.media.load();}this.isLoaded=true;},setMuted:function(muted){this.media.setMuted(muted);},setCurrentTime:function(time){this.media.setCurrentTime(time);},getCurrentTime:function(){return this.media.currentTime;},setVolume:function(volume){this.media.setVolume(volume);},getVolume:function(){return this.media.volume;},setSrc:function(src){var t=this;if(t.media.pluginType==="youtube"){var videoId;if(typeof src!=="string"){var i,media;for(i=0;i<src.length;i++){media=src[i];if(this.canPlayType(media.type)){src=media.src;break;}}}if(src.lastIndexOf("youtu.be")!==-1){videoId=src.substr(src.lastIndexOf("/")+1);if(videoId.indexOf("?")!==-1){videoId=videoId.substr(0,videoId.indexOf("?"));}}else{var videoIdMatch=src.match(/[?&]v=([^&#]+)|&|#|$/);if(videoIdMatch){videoId=videoIdMatch[1];}}if(t.media.getAttribute("autoplay")!==null){t.media.pluginApi.loadVideoById(videoId);}else{t.media.pluginApi.cueVideoById(videoId);}}else{t.media.setSrc(src);}},remove:function(){var t=this,featureIndex,feature;t.container.prev(".mejs-offscreen").remove();for(featureIndex in t.options.features){feature=t.options.features[featureIndex];if(t["clean"+feature]){try{t["clean"+feature](t);}catch(e){}}}if(!t.isDynamic){t.$media.prop("controls",true);t.$node.clone().insertBefore(t.container).show();t.$node.remove();}else{t.$node.insertBefore(t.container);}if(t.media.pluginType!=="native"){t.media.remove();}delete mejs.players[t.id];if(typeof t.container=="object"){t.container.remove();}t.globalUnbind();delete t.node.player;},rebuildtracks:function(){var t=this;t.findTracks();t.buildtracks(t,t.controls,t.layers,t.media);},resetSize:function(){var t=this;setTimeout(function(){t.setPlayerSize(t.width,t.height);t.setControlsSize();},50);}};(function(){var rwindow=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;function splitEvents(events,id){var ret={d:[],w:[]};$.each((events||"").split(" "),function(k,v){var eventname=v+"."+id;if(eventname.indexOf(".")===0){ret.d.push(eventname);ret.w.push(eventname);}else{ret[rwindow.test(v)?"w":"d"].push(eventname);}});ret.d=ret.d.join(" ");ret.w=ret.w.join(" ");return ret;}mejs.MediaElementPlayer.prototype.globalBind=function(events,data,callback){var t=this;var doc=t.node?t.node.ownerDocument:document;events=splitEvents(events,t.id);if(events.d){$(doc).bind(events.d,data,callback);}if(events.w){$(window).bind(events.w,data,callback);}};mejs.MediaElementPlayer.prototype.globalUnbind=function(events,callback){var t=this;var doc=t.node?t.node.ownerDocument:document;events=splitEvents(events,t.id);if(events.d){$(doc).unbind(events.d,callback);}if(events.w){$(window).unbind(events.w,callback);}};})();if(typeof $!="undefined"){$.fn.mediaelementplayer=function(options){if(options===false){this.each(function(){var player=$(this).data("mediaelementplayer");if(player){player.remove();}$(this).removeData("mediaelementplayer");});}else{this.each(function(){$(this).data("mediaelementplayer",new mejs.MediaElementPlayer(this,options));});}return this;};$(document).ready(function(){$(".mejs-player").mediaelementplayer();});}window.MediaElementPlayer=mejs.MediaElementPlayer;})(mejs.$);(function($){$.extend(mejs.MepDefaults,{playText:"",pauseText:""});$.extend(MediaElementPlayer.prototype,{buildplaypause:function(player,controls,layers,media){var t=this,op=t.options,playTitle=op.playText?op.playText:mejs.i18n.t("mejs.play"),pauseTitle=op.pauseText?op.pauseText:mejs.i18n.t("mejs.pause"),play=$('<div class="mejs-button mejs-playpause-button mejs-play" >'+'<button type="button" aria-controls="'+t.id+'" title="'+playTitle+'" aria-label="'+pauseTitle+'"></button>'+"</div>").appendTo(controls).click(function(e){e.preventDefault();if(media.paused){media.play();}else{media.pause();}return false;}),play_btn=play.find("button");function togglePlayPause(which){if("play"===which){play.removeClass("mejs-play").addClass("mejs-pause");play_btn.attr({"title":pauseTitle,"aria-label":pauseTitle});}else{play.removeClass("mejs-pause").addClass("mejs-play");play_btn.attr({"title":playTitle,"aria-label":playTitle});}}togglePlayPause("pse");media.addEventListener("play",function(){togglePlayPause("play");},false);media.addEventListener("playing",function(){togglePlayPause("play");},false);media.addEventListener("pause",function(){togglePlayPause("pse");},false);media.addEventListener("paused",function(){togglePlayPause("pse");},false);}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{stopText:"Stop"});$.extend(MediaElementPlayer.prototype,{buildstop:function(player,controls,layers,media){var t=this;$('<div class="mejs-button mejs-stop-button mejs-stop">'+'<button type="button" aria-controls="'+t.id+'" title="'+t.options.stopText+'" aria-label="'+t.options.stopText+'"></button>'+"</div>").appendTo(controls).click(function(){if(!media.paused){media.pause();}if(media.currentTime>0){media.setCurrentTime(0);media.pause();controls.find(".mejs-time-current").width("0px");controls.find(".mejs-time-handle").css("left","0px");controls.find(".mejs-time-float-current").html(mejs.Utility.secondsToTimeCode(0,player.options));controls.find(".mejs-currenttime").html(mejs.Utility.secondsToTimeCode(0,player.options));layers.find(".mejs-poster").show();}});}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{enableProgressTooltip:true,progressHelpText:""});$.extend(MediaElementPlayer.prototype,{buildprogress:function(player,controls,layers,media){var t=this,mouseIsDown=false,mouseIsOver=false,lastKeyPressTime=0,startedPaused=false,autoRewindInitial=player.options.autoRewind,progressTitle=t.options.progressHelpText?t.options.progressHelpText:mejs.i18n.t("mejs.time-help-text"),tooltip=player.options.enableProgressTooltip?'<span class="mejs-time-float">'+'<span class="mejs-time-float-current">00:00</span>'+'<span class="mejs-time-float-corner"></span>'+"</span>":"";$('<div class="mejs-time-rail">'+'<span  class="mejs-time-total mejs-time-slider">'+'<span class="mejs-time-buffering"></span>'+'<span class="mejs-time-loaded"></span>'+'<span class="mejs-time-current"></span>'+'<span class="mejs-time-handle"></span>'+tooltip+"</span>"+"</div>").appendTo(controls);controls.find(".mejs-time-buffering").hide();t.total=controls.find(".mejs-time-total");t.loaded=controls.find(".mejs-time-loaded");t.current=controls.find(".mejs-time-current");t.handle=controls.find(".mejs-time-handle");t.timefloat=controls.find(".mejs-time-float");t.timefloatcurrent=controls.find(".mejs-time-float-current");t.slider=controls.find(".mejs-time-slider");var handleMouseMove=function(e){var offset=t.total.offset(),width=t.total.width(),percentage=0,newTime=0,pos=0,x;if(e.originalEvent&&e.originalEvent.changedTouches){x=e.originalEvent.changedTouches[0].pageX;}else{if(e.changedTouches){x=e.changedTouches[0].pageX;}else{x=e.pageX;}}if(media.duration){if(x<offset.left){x=offset.left;}else{if(x>width+offset.left){x=width+offset.left;}}pos=x-offset.left;percentage=(pos/width);newTime=(percentage<=0.02)?0:percentage*media.duration;if(mouseIsDown&&newTime!==media.currentTime){media.setCurrentTime(newTime);}if(!mejs.MediaFeatures.hasTouch){t.timefloat.css("left",pos);t.timefloatcurrent.html(mejs.Utility.secondsToTimeCode(newTime,player.options));t.timefloat.show();}}},updateSlider=function(e){var seconds=media.currentTime,timeSliderText=mejs.i18n.t("mejs.time-slider"),time=mejs.Utility.secondsToTimeCode(seconds,player.options),duration=media.duration;t.slider.attr({"aria-label":timeSliderText,"aria-valuemin":0,"aria-valuemax":duration,"aria-valuenow":seconds,"aria-valuetext":time,"role":"slider","tabindex":0});},restartPlayer=function(){var now=new Date();if(now-lastKeyPressTime>=1000){media.play();}};t.slider.bind("focus",function(e){player.options.autoRewind=false;});t.slider.bind("blur",function(e){player.options.autoRewind=autoRewindInitial;});t.slider.bind("keydown",function(e){if((new Date()-lastKeyPressTime)>=1000){startedPaused=media.paused;}var keyCode=e.keyCode,duration=media.duration,seekTime=media.currentTime,seekForward=player.options.defaultSeekForwardInterval(media),seekBackward=player.options.defaultSeekBackwardInterval(media);switch(keyCode){case 37:case 40:seekTime-=seekBackward;break;case 39:case 38:seekTime+=seekForward;break;case 36:seekTime=0;break;case 35:seekTime=duration;break;case 32:case 13:media.paused?media.play():media.pause();return;default:return;}seekTime=seekTime<0?0:(seekTime>=duration?duration:Math.floor(seekTime));lastKeyPressTime=new Date();if(!startedPaused){media.pause();}if(seekTime<media.duration&&!startedPaused){setTimeout(restartPlayer,1100);}media.setCurrentTime(seekTime);e.preventDefault();e.stopPropagation();return false;});t.total.bind("mousedown touchstart",function(e){if(e.which===1||e.which===0){mouseIsDown=true;handleMouseMove(e);t.globalBind("mousemove.dur touchmove.dur",function(e){handleMouseMove(e);});t.globalBind("mouseup.dur touchend.dur",function(e){mouseIsDown=false;if(typeof t.timefloat!=="undefined"){t.timefloat.hide();}t.globalUnbind(".dur");});}}).bind("mouseenter",function(e){mouseIsOver=true;t.globalBind("mousemove.dur",function(e){handleMouseMove(e);});if(typeof t.timefloat!=="undefined"&&!mejs.MediaFeatures.hasTouch){t.timefloat.show();}}).bind("mouseleave",function(e){mouseIsOver=false;if(!mouseIsDown){t.globalUnbind(".dur");if(typeof t.timefloat!=="undefined"){t.timefloat.hide();}}});media.addEventListener("progress",function(e){player.setProgressRail(e);player.setCurrentRail(e);},false);media.addEventListener("timeupdate",function(e){player.setProgressRail(e);player.setCurrentRail(e);updateSlider(e);},false);t.container.on("controlsresize",function(e){player.setProgressRail(e);player.setCurrentRail(e);});},setProgressRail:function(e){var t=this,target=(e!==undefined)?e.target:t.media,percent=null;if(target&&target.buffered&&target.buffered.length>0&&target.buffered.end&&target.duration){percent=target.buffered.end(target.buffered.length-1)/target.duration;}else{if(target&&target.bytesTotal!==undefined&&target.bytesTotal>0&&target.bufferedBytes!==undefined){percent=target.bufferedBytes/target.bytesTotal;}else{if(e&&e.lengthComputable&&e.total!==0){percent=e.loaded/e.total;}}}if(percent!==null){percent=Math.min(1,Math.max(0,percent));if(t.loaded&&t.total){t.loaded.width(t.total.width()*percent);}}},setCurrentRail:function(){var t=this;if(t.media.currentTime!==undefined&&t.media.duration){if(t.total&&t.handle){var newWidth=Math.round(t.total.width()*t.media.currentTime/t.media.duration),handlePos=newWidth-Math.round(t.handle.outerWidth(true)/2);t.current.width(newWidth);t.handle.css("left",handlePos);}}}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{duration:-1,timeAndDurationSeparator:"<span> | </span>"});$.extend(MediaElementPlayer.prototype,{buildcurrent:function(player,controls,layers,media){var t=this;$('<div class="mejs-time" role="timer" aria-live="off">'+'<span class="mejs-currenttime">'+mejs.Utility.secondsToTimeCode(0,player.options)+"</span>"+"</div>").appendTo(controls);t.currenttime=t.controls.find(".mejs-currenttime");media.addEventListener("timeupdate",function(){if(t.controlsAreVisible){player.updateCurrent();}},false);},buildduration:function(player,controls,layers,media){var t=this;if(controls.children().last().find(".mejs-currenttime").length>0){$(t.options.timeAndDurationSeparator+'<span class="mejs-duration">'+mejs.Utility.secondsToTimeCode(t.options.duration,t.options)+"</span>").appendTo(controls.find(".mejs-time"));}else{controls.find(".mejs-currenttime").parent().addClass("mejs-currenttime-container");$('<div class="mejs-time mejs-duration-container">'+'<span class="mejs-duration">'+mejs.Utility.secondsToTimeCode(t.options.duration,t.options)+"</span>"+"</div>").appendTo(controls);}t.durationD=t.controls.find(".mejs-duration");media.addEventListener("timeupdate",function(){if(t.controlsAreVisible){player.updateDuration();}},false);},updateCurrent:function(){var t=this;var currentTime=t.media.currentTime;if(isNaN(currentTime)){currentTime=0;}if(t.currenttime){t.currenttime.html(mejs.Utility.secondsToTimeCode(currentTime,t.options));}},updateDuration:function(){var t=this;var duration=t.media.duration;if(t.options.duration>0){duration=t.options.duration;}if(isNaN(duration)){duration=0;}t.container.toggleClass("mejs-long-video",duration>3600);if(t.durationD&&duration>0){t.durationD.html(mejs.Utility.secondsToTimeCode(duration,t.options));}}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{muteText:mejs.i18n.t("mejs.mute-toggle"),allyVolumeControlText:mejs.i18n.t("mejs.volume-help-text"),hideVolumeOnTouchDevices:true,audioVolume:"vertical",videoVolume:"vertical"});$.extend(MediaElementPlayer.prototype,{buildvolume:function(player,controls,layers,media){if((mejs.MediaFeatures.isAndroid||mejs.MediaFeatures.isiOS)&&this.options.hideVolumeOnTouchDevices){return;}var t=this,mode=(t.isVideo)?t.options.videoVolume:t.options.audioVolume,mute=(mode=="horizontal")?$('<div class="mejs-button mejs-volume-button mejs-mute">'+'<button type="button" aria-controls="'+t.id+'" title="'+t.options.muteText+'" aria-label="'+t.options.muteText+'"></button>'+"</div>"+'<a href="javascript:void(0);" class="mejs-horizontal-volume-slider" tabindex="-1">'+'<span class="mejs-offscreen">'+t.options.allyVolumeControlText+"</span>"+'<div class="mejs-horizontal-volume-total"></div>'+'<div class="mejs-horizontal-volume-current"></div>'+'<div class="mejs-horizontal-volume-handle"></div>'+"</a>").appendTo(controls):$('<div class="mejs-button mejs-volume-button mejs-mute">'+'<button type="button" aria-controls="'+t.id+'" title="'+t.options.muteText+'" aria-label="'+t.options.muteText+'"></button>'+'<a href="javascript:void(0);" class="mejs-volume-slider" tabindex="-1">'+'<span class="mejs-offscreen">'+t.options.allyVolumeControlText+"</span>"+'<div class="mejs-volume-total"></div>'+'<div class="mejs-volume-current"></div>'+'<div class="mejs-volume-handle"></div>'+"</a>"+"</div>").appendTo(controls),volumeSlider=t.container.find(".mejs-volume-slider, .mejs-horizontal-volume-slider"),volumeTotal=t.container.find(".mejs-volume-total, .mejs-horizontal-volume-total"),volumeCurrent=t.container.find(".mejs-volume-current, .mejs-horizontal-volume-current"),volumeHandle=t.container.find(".mejs-volume-handle, .mejs-horizontal-volume-handle"),positionVolumeHandle=function(volume,secondTry){if(!volumeSlider.is(":visible")&&typeof secondTry=="undefined"){volumeSlider.show();positionVolumeHandle(volume,true);volumeSlider.hide();return;}volume=Math.max(0,volume);volume=Math.min(volume,1);if(volume===0){mute.removeClass("mejs-mute").addClass("mejs-unmute");mute.children("button").attr("title",mejs.i18n.t("mejs.unmute")).attr("aria-label",mejs.i18n.t("mejs.unmute"));}else{mute.removeClass("mejs-unmute").addClass("mejs-mute");mute.children("button").attr("title",mejs.i18n.t("mejs.mute")).attr("aria-label",mejs.i18n.t("mejs.mute"));}var totalPosition=volumeTotal.position();if(mode=="vertical"){var totalHeight=volumeTotal.height(),newTop=totalHeight-(totalHeight*volume);volumeHandle.css("top",Math.round(totalPosition.top+newTop-(volumeHandle.height()/2)));volumeCurrent.height(totalHeight-newTop);volumeCurrent.css("top",totalPosition.top+newTop);}else{var totalWidth=volumeTotal.width(),newLeft=totalWidth*volume;volumeHandle.css("left",Math.round(totalPosition.left+newLeft-(volumeHandle.width()/2)));volumeCurrent.width(Math.round(newLeft));}},handleVolumeMove=function(e){var volume=null,totalOffset=volumeTotal.offset();if(mode==="vertical"){var railHeight=volumeTotal.height(),newY=e.pageY-totalOffset.top;volume=(railHeight-newY)/railHeight;if(totalOffset.top===0||totalOffset.left===0){return;}}else{var railWidth=volumeTotal.width(),newX=e.pageX-totalOffset.left;volume=newX/railWidth;}volume=Math.max(0,volume);volume=Math.min(volume,1);positionVolumeHandle(volume);if(volume===0){media.setMuted(true);}else{media.setMuted(false);}media.setVolume(volume);},mouseIsDown=false,mouseIsOver=false;mute.on("mouseenter focusin",function(){volumeSlider.show();mouseIsOver=true;}).on("mouseleave focusout",function(){mouseIsOver=false;if(!mouseIsDown&&mode==="vertical"){volumeSlider.hide();}});var updateVolumeSlider=function(e){var volume=Math.floor(media.volume*100);volumeSlider.attr({"aria-label":mejs.i18n.t("mejs.volume-slider"),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":volume,"aria-valuetext":volume+"%","role":"slider","tabindex":-1});};volumeSlider.bind("mouseover",function(){mouseIsOver=true;}).bind("mousedown",function(e){handleVolumeMove(e);t.globalBind("mousemove.vol",function(e){handleVolumeMove(e);});t.globalBind("mouseup.vol",function(){mouseIsDown=false;t.globalUnbind(".vol");if(!mouseIsOver&&mode=="vertical"){volumeSlider.hide();}});mouseIsDown=true;return false;}).bind("keydown",function(e){var keyCode=e.keyCode;var volume=media.volume;switch(keyCode){case 38:volume=Math.min(volume+0.1,1);break;case 40:volume=Math.max(0,volume-0.1);break;default:return true;}mouseIsDown=false;positionVolumeHandle(volume);media.setVolume(volume);return false;});mute.find("button").click(function(){media.setMuted(!media.muted);});mute.find("button").bind("focus",function(){volumeSlider.show();});media.addEventListener("volumechange",function(e){if(!mouseIsDown){if(media.muted){positionVolumeHandle(0);mute.removeClass("mejs-mute").addClass("mejs-unmute");}else{positionVolumeHandle(media.volume);mute.removeClass("mejs-unmute").addClass("mejs-mute");}}updateVolumeSlider(e);},false);if(player.options.startVolume===0){media.setMuted(true);}if(media.pluginType==="native"){media.setVolume(player.options.startVolume);}t.container.on("controlsresize",function(){if(media.muted){positionVolumeHandle(0);mute.removeClass("mejs-mute").addClass("mejs-unmute");}else{positionVolumeHandle(media.volume);mute.removeClass("mejs-unmute").addClass("mejs-mute");}});}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{usePluginFullScreen:true,newWindowCallback:function(){return"";},fullscreenText:""});$.extend(MediaElementPlayer.prototype,{isFullScreen:false,isNativeFullScreen:false,isInIframe:false,fullscreenMode:"",buildfullscreen:function(player,controls,layers,media){if(!player.isVideo){return;}player.isInIframe=(window.location!=window.parent.location);media.addEventListener("loadstart",function(){player.detectFullscreenMode();});var t=this,hideTimeout=null,fullscreenTitle=t.options.fullscreenText?t.options.fullscreenText:mejs.i18n.t("mejs.fullscreen"),fullscreenBtn=$('<div class="mejs-button mejs-fullscreen-button">'+'<button type="button" aria-controls="'+t.id+'" title="'+fullscreenTitle+'" aria-label="'+fullscreenTitle+'"></button>'+"</div>").appendTo(controls).on("click",function(){var isFullScreen=(mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen())||player.isFullScreen;if(isFullScreen){player.exitFullScreen();}else{player.enterFullScreen();}}).on("mouseover",function(){if(t.fullscreenMode=="plugin-hover"){if(hideTimeout!==null){clearTimeout(hideTimeout);delete hideTimeout;}var buttonPos=fullscreenBtn.offset(),containerPos=player.container.offset();media.positionFullscreenButton(buttonPos.left-containerPos.left,buttonPos.top-containerPos.top,true);}}).on("mouseout",function(){if(t.fullscreenMode=="plugin-hover"){if(hideTimeout!==null){clearTimeout(hideTimeout);delete hideTimeout;}hideTimeout=setTimeout(function(){media.hideFullscreenButton();},1500);}});player.fullscreenBtn=fullscreenBtn;t.globalBind("keydown",function(e){if(e.keyCode==27&&((mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen())||t.isFullScreen)){player.exitFullScreen();}});t.normalHeight=0;t.normalWidth=0;if(mejs.MediaFeatures.hasTrueNativeFullScreen){var fullscreenChanged=function(e){if(player.isFullScreen){if(mejs.MediaFeatures.isFullScreen()){player.isNativeFullScreen=true;player.setControlsSize();}else{player.isNativeFullScreen=false;player.exitFullScreen();}}};player.globalBind(mejs.MediaFeatures.fullScreenEventName,fullscreenChanged);}},detectFullscreenMode:function(){var t=this,mode="",features=mejs.MediaFeatures;if(features.hasTrueNativeFullScreen&&t.media.pluginType==="native"){mode="native-native";}else{if(features.hasTrueNativeFullScreen&&t.media.pluginType!=="native"&&!features.hasFirefoxPluginMovingProblem){mode="plugin-native";}else{if(t.usePluginFullScreen){if(mejs.MediaFeatures.supportsPointerEvents){mode="plugin-click";t.createPluginClickThrough();}else{mode="plugin-hover";}}else{mode="fullwindow";}}}t.fullscreenMode=mode;return mode;},isPluginClickThroughCreated:false,createPluginClickThrough:function(){var t=this;if(t.isPluginClickThroughCreated){return;}var fullscreenIsDisabled=false,restoreControls=function(){if(fullscreenIsDisabled){for(var i in hoverDivs){hoverDivs[i].hide();}t.fullscreenBtn.css("pointer-events","");t.controls.css("pointer-events","");t.media.removeEventListener("click",t.clickToPlayPauseCallback);fullscreenIsDisabled=false;}},hoverDivs={},hoverDivNames=["top","left","right","bottom"],i,len,positionHoverDivs=function(){var fullScreenBtnOffsetLeft=fullscreenBtn.offset().left-t.container.offset().left,fullScreenBtnOffsetTop=fullscreenBtn.offset().top-t.container.offset().top,fullScreenBtnWidth=fullscreenBtn.outerWidth(true),fullScreenBtnHeight=fullscreenBtn.outerHeight(true),containerWidth=t.container.width(),containerHeight=t.container.height();for(i in hoverDivs){hoverDivs[i].css({position:"absolute",top:0,left:0});}hoverDivs["top"].width(containerWidth).height(fullScreenBtnOffsetTop);hoverDivs["left"].width(fullScreenBtnOffsetLeft).height(fullScreenBtnHeight).css({top:fullScreenBtnOffsetTop});hoverDivs["right"].width(containerWidth-fullScreenBtnOffsetLeft-fullScreenBtnWidth).height(fullScreenBtnHeight).css({top:fullScreenBtnOffsetTop,left:fullScreenBtnOffsetLeft+fullScreenBtnWidth});hoverDivs["bottom"].width(containerWidth).height(containerHeight-fullScreenBtnHeight-fullScreenBtnOffsetTop).css({top:fullScreenBtnOffsetTop+fullScreenBtnHeight});};t.globalBind("resize",function(){positionHoverDivs();});for(i=0,len=hoverDivNames.length;i<len;i++){hoverDivs[hoverDivNames[i]]=$('<div class="mejs-fullscreen-hover" />').appendTo(t.container).mouseover(restoreControls).hide();}fullscreenBtn.on("mouseover",function(){if(!t.isFullScreen){var buttonPos=fullscreenBtn.offset(),containerPos=player.container.offset();media.positionFullscreenButton(buttonPos.left-containerPos.left,buttonPos.top-containerPos.top,false);t.fullscreenBtn.css("pointer-events","none");t.controls.css("pointer-events","none");t.media.addEventListener("click",t.clickToPlayPauseCallback);for(i in hoverDivs){hoverDivs[i].show();}positionHoverDivs();fullscreenIsDisabled=true;}});media.addEventListener("fullscreenchange",function(e){t.isFullScreen=!t.isFullScreen;if(t.isFullScreen){t.media.removeEventListener("click",t.clickToPlayPauseCallback);}else{t.media.addEventListener("click",t.clickToPlayPauseCallback);}restoreControls();});t.globalBind("mousemove",function(e){if(fullscreenIsDisabled){var fullscreenBtnPos=fullscreenBtn.offset();if(e.pageY<fullscreenBtnPos.top||e.pageY>fullscreenBtnPos.top+fullscreenBtn.outerHeight(true)||e.pageX<fullscreenBtnPos.left||e.pageX>fullscreenBtnPos.left+fullscreenBtn.outerWidth(true)){fullscreenBtn.css("pointer-events","");t.controls.css("pointer-events","");fullscreenIsDisabled=false;}}});t.isPluginClickThroughCreated=true;},cleanfullscreen:function(player){player.exitFullScreen();},containerSizeTimeout:null,enterFullScreen:function(){var t=this;if(mejs.MediaFeatures.isiOS&&mejs.MediaFeatures.hasiOSFullScreen&&typeof t.media.webkitEnterFullscreen==="function"){t.media.webkitEnterFullscreen();return;}$(document.documentElement).addClass("mejs-fullscreen");t.normalHeight=t.container.height();t.normalWidth=t.container.width();if(t.fullscreenMode==="native-native"||t.fullscreenMode==="plugin-native"){mejs.MediaFeatures.requestFullScreen(t.container[0]);if(t.isInIframe){setTimeout(function checkFullscreen(){if(t.isNativeFullScreen){var percentErrorMargin=0.002,windowWidth=$(window).width(),screenWidth=screen.width,absDiff=Math.abs(screenWidth-windowWidth),marginError=screenWidth*percentErrorMargin;if(absDiff>marginError){t.exitFullScreen();}else{setTimeout(checkFullscreen,500);}}},1000);}}else{if(t.fullscreeMode=="fullwindow"){}}t.container.addClass("mejs-container-fullscreen").width("100%").height("100%");t.containerSizeTimeout=setTimeout(function(){t.container.css({width:"100%",height:"100%"});t.setControlsSize();},500);if(t.media.pluginType==="native"){t.$media.width("100%").height("100%");}else{t.container.find(".mejs-shim").width("100%").height("100%");setTimeout(function(){var win=$(window),winW=win.width(),winH=win.height();t.media.setVideoSize(winW,winH);},500);}t.layers.children("div").width("100%").height("100%");if(t.fullscreenBtn){t.fullscreenBtn.removeClass("mejs-fullscreen").addClass("mejs-unfullscreen");}t.setControlsSize();t.isFullScreen=true;var zoomFactor=Math.min(screen.width/t.width,screen.height/t.height);t.container.find(".mejs-captions-text").css("font-size",zoomFactor*100+"%");t.container.find(".mejs-captions-text").css("line-height","normal");t.container.find(".mejs-captions-position").css("bottom","45px");t.container.trigger("enteredfullscreen");},exitFullScreen:function(){var t=this;clearTimeout(t.containerSizeTimeout);if(mejs.MediaFeatures.hasTrueNativeFullScreen&&(mejs.MediaFeatures.isFullScreen()||t.isFullScreen)){mejs.MediaFeatures.cancelFullScreen();}$(document.documentElement).removeClass("mejs-fullscreen");t.container.removeClass("mejs-container-fullscreen").width(t.normalWidth).height(t.normalHeight);if(t.media.pluginType==="native"){t.$media.width(t.normalWidth).height(t.normalHeight);}else{t.container.find(".mejs-shim").width(t.normalWidth).height(t.normalHeight);t.media.setVideoSize(t.normalWidth,t.normalHeight);}t.layers.children("div").width(t.normalWidth).height(t.normalHeight);t.fullscreenBtn.removeClass("mejs-unfullscreen").addClass("mejs-fullscreen");t.setControlsSize();t.isFullScreen=false;t.container.find(".mejs-captions-text").css("font-size","");t.container.find(".mejs-captions-text").css("line-height","");t.container.find(".mejs-captions-position").css("bottom","");t.container.trigger("exitedfullscreen");}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{speeds:["2.00","1.50","1.25","1.00","0.75"],defaultSpeed:"1.00",speedChar:"x"});$.extend(MediaElementPlayer.prototype,{buildspeed:function(player,controls,layers,media){var t=this;if(t.media.pluginType=="native"){var speedButton=null,speedSelector=null,playbackSpeed=null,inputId=null;var speeds=[];var defaultInArray=false;for(var i=0,len=t.options.speeds.length;i<len;i++){var s=t.options.speeds[i];if(typeof(s)==="string"){speeds.push({name:s+t.options.speedChar,value:s});if(s===t.options.defaultSpeed){defaultInArray=true;}}else{speeds.push(s);if(s.value===t.options.defaultSpeed){defaultInArray=true;}}}if(!defaultInArray){speeds.push({name:t.options.defaultSpeed+t.options.speedChar,value:t.options.defaultSpeed});}speeds.sort(function(a,b){return parseFloat(b.value)-parseFloat(a.value);});var getSpeedNameFromValue=function(value){for(i=0,len=speeds.length;i<len;i++){if(speeds[i].value===value){return speeds[i].name;}}};var html='<div class="mejs-button mejs-speed-button">'+'<button type="button">'+getSpeedNameFromValue(t.options.defaultSpeed)+"</button>"+'<div class="mejs-speed-selector">'+"<ul>";for(i=0,il=speeds.length;i<il;i++){inputId=t.id+"-speed-"+speeds[i].value;html+="<li>"+'<input type="radio" name="speed" '+'value="'+speeds[i].value+'" '+'id="'+inputId+'" '+(speeds[i].value===t.options.defaultSpeed?" checked":"")+" />"+'<label for="'+inputId+'" '+(speeds[i].value===t.options.defaultSpeed?' class="mejs-speed-selected"':"")+">"+speeds[i].name+"</label>"+"</li>";}html+="</ul></div></div>";speedButton=$(html).appendTo(controls);speedSelector=speedButton.find(".mejs-speed-selector");playbackSpeed=t.options.defaultSpeed;media.addEventListener("loadedmetadata",function(e){if(playbackSpeed){media.playbackRate=parseFloat(playbackSpeed);}},true);speedSelector.on("click",'input[type="radio"]',function(){var newSpeed=$(this).attr("value");playbackSpeed=newSpeed;media.playbackRate=parseFloat(newSpeed);speedButton.find("button").html(getSpeedNameFromValue(newSpeed));speedButton.find(".mejs-speed-selected").removeClass("mejs-speed-selected");speedButton.find('input[type="radio"]:checked').next().addClass("mejs-speed-selected");});speedButton.one("mouseenter focusin",function(){speedSelector.height(speedButton.find(".mejs-speed-selector ul").outerHeight(true)+speedButton.find(".mejs-speed-translations").outerHeight(true)).css("top",(-1*speedSelector.height())+"px");});}}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{startLanguage:"",tracksText:"",tracksAriaLive:false,hideCaptionsButtonWhenEmpty:true,toggleCaptionsButtonWhenOnlyOne:false,slidesSelector:""});$.extend(MediaElementPlayer.prototype,{hasChapters:false,cleartracks:function(player,controls,layers,media){if(player){if(player.captions){player.captions.remove();}if(player.chapters){player.chapters.remove();}if(player.captionsText){player.captionsText.remove();}if(player.captionsButton){player.captionsButton.remove();}}},buildtracks:function(player,controls,layers,media){if(player.tracks.length===0){return;}var t=this,attr=t.options.tracksAriaLive?'role="log" aria-live="assertive" aria-atomic="false"':"",tracksTitle=t.options.tracksText?t.options.tracksText:mejs.i18n.t("mejs.captions-subtitles"),i,kind;if(t.domNode.textTracks){for(i=t.domNode.textTracks.length-1;i>=0;i--){t.domNode.textTracks[i].mode="hidden";}}t.cleartracks(player,controls,layers,media);player.chapters=$('<div class="mejs-chapters mejs-layer"></div>').prependTo(layers).hide();player.captions=$('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover" '+attr+'><span class="mejs-captions-text"></span></div></div>').prependTo(layers).hide();player.captionsText=player.captions.find(".mejs-captions-text");player.captionsButton=$('<div class="mejs-button mejs-captions-button">'+'<button type="button" aria-controls="'+t.id+'" title="'+tracksTitle+'" aria-label="'+tracksTitle+'"></button>'+'<div class="mejs-captions-selector mejs-offscreen">'+"<ul>"+"<li>"+'<input type="radio" name="'+player.id+'_captions" id="'+player.id+'_captions_none" value="none" checked="checked" />'+'<label for="'+player.id+'_captions_none">'+mejs.i18n.t("mejs.none")+"</label>"+"</li>"+"</ul>"+"</div>"+"</div>").appendTo(controls);var subtitleCount=0;for(i=0;i<player.tracks.length;i++){kind=player.tracks[i].kind;if(kind==="subtitles"||kind==="captions"){subtitleCount++;}}if(t.options.toggleCaptionsButtonWhenOnlyOne&&subtitleCount==1){player.captionsButton.on("click",function(){if(player.selectedTrack===null){lang=player.tracks[0].srclang;}else{lang="none";}player.setTrack(lang);});}else{player.captionsButton.on("mouseenter focusin",function(){$(this).find(".mejs-captions-selector").removeClass("mejs-offscreen");}).on("mouseleave focusout",function(){$(this).find(".mejs-captions-selector").addClass("mejs-offscreen");}).on("click","input[type=radio]",function(){lang=this.value;player.setTrack(lang);}).on("keyup keydown keypress",function(e){e.stopPropagation();});}if(!player.options.alwaysShowControls){player.container.bind("controlsshown",function(){player.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover");}).bind("controlshidden",function(){if(!media.paused){player.container.find(".mejs-captions-position").removeClass("mejs-captions-position-hover");}});}else{player.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover");}player.trackToLoad=-1;player.selectedTrack=null;player.isLoadingTrack=false;for(i=0;i<player.tracks.length;i++){kind=player.tracks[i].kind;if(kind==="subtitles"||kind==="captions"){player.addTrackButton(player.tracks[i].srclang,player.tracks[i].label);}}player.loadNextTrack();media.addEventListener("timeupdate",function(){player.displayCaptions();},false);if(player.options.slidesSelector!==""){player.slidesContainer=$(player.options.slidesSelector);media.addEventListener("timeupdate",function(){player.displaySlides();},false);}media.addEventListener("loadedmetadata",function(){player.displayChapters();},false);player.container.hover(function(){if(player.hasChapters){player.chapters.removeClass("mejs-offscreen");player.chapters.fadeIn(200).height(player.chapters.find(".mejs-chapter").outerHeight());}},function(){if(player.hasChapters&&!media.paused){player.chapters.fadeOut(200,function(){$(this).addClass("mejs-offscreen");$(this).css("display","block");});}});t.container.on("controlsresize",function(){t.adjustLanguageBox();});if(player.node.getAttribute("autoplay")!==null){player.chapters.addClass("mejs-offscreen");}},setTrack:function(lang){var t=this,i;if(lang=="none"){t.selectedTrack=null;t.captionsButton.removeClass("mejs-captions-enabled");}else{for(i=0;i<t.tracks.length;i++){if(t.tracks[i].srclang==lang){if(t.selectedTrack===null){t.captionsButton.addClass("mejs-captions-enabled");}t.selectedTrack=t.tracks[i];t.captions.attr("lang",t.selectedTrack.srclang);t.displayCaptions();break;}}}},loadNextTrack:function(){var t=this;t.trackToLoad++;if(t.trackToLoad<t.tracks.length){t.isLoadingTrack=true;t.loadTrack(t.trackToLoad);}else{t.isLoadingTrack=false;t.checkForTracks();}},loadTrack:function(index){var t=this,track=t.tracks[index],after=function(){track.isLoaded=true;t.enableTrackButton(track.srclang,track.label);t.loadNextTrack();};if(track.src!==undefined||track.src!==""){$.ajax({url:track.src,dataType:"text",success:function(d){if(typeof d=="string"&&(/<tt\s+xml/ig).exec(d)){track.entries=mejs.TrackFormatParser.dfxp.parse(d);}else{track.entries=mejs.TrackFormatParser.webvtt.parse(d);}after();if(track.kind=="chapters"){t.media.addEventListener("play",function(){if(t.media.duration>0){t.displayChapters(track);}},false);}if(track.kind=="slides"){t.setupSlides(track);}},error:function(){t.removeTrackButton(track.srclang);t.loadNextTrack();}});}},enableTrackButton:function(lang,label){var t=this;if(label===""){label=mejs.language.codes[lang]||lang;}t.captionsButton.find("input[value="+lang+"]").prop("disabled",false).siblings("label").html(label);if(t.options.startLanguage==lang){$("#"+t.id+"_captions_"+lang).prop("checked",true).trigger("click");}t.adjustLanguageBox();},removeTrackButton:function(lang){var t=this;t.captionsButton.find("input[value="+lang+"]").closest("li").remove();t.adjustLanguageBox();},addTrackButton:function(lang,label){var t=this;if(label===""){label=mejs.language.codes[lang]||lang;}t.captionsButton.find("ul").append($("<li>"+'<input type="radio" name="'+t.id+'_captions" id="'+t.id+"_captions_"+lang+'" value="'+lang+'" disabled="disabled" />'+'<label for="'+t.id+"_captions_"+lang+'">'+label+" (loading)"+"</label>"+"</li>"));t.adjustLanguageBox();t.container.find(".mejs-captions-translations option[value="+lang+"]").remove();},adjustLanguageBox:function(){var t=this;t.captionsButton.find(".mejs-captions-selector").height(t.captionsButton.find(".mejs-captions-selector ul").outerHeight(true)+t.captionsButton.find(".mejs-captions-translations").outerHeight(true));},checkForTracks:function(){var t=this,hasSubtitles=false;if(t.options.hideCaptionsButtonWhenEmpty){for(var i=0;i<t.tracks.length;i++){var kind=t.tracks[i].kind;if((kind==="subtitles"||kind==="captions")&&t.tracks[i].isLoaded){hasSubtitles=true;break;}}if(!hasSubtitles){t.captionsButton.hide();t.setControlsSize();}}},displayCaptions:function(){if(typeof this.tracks=="undefined"){return;}var t=this,i,track=t.selectedTrack;if(track!==null&&track.isLoaded){for(i=0;i<track.entries.times.length;i++){if(t.media.currentTime>=track.entries.times[i].start&&t.media.currentTime<=track.entries.times[i].stop){t.captionsText.html(track.entries.text[i]).attr("class","mejs-captions-text "+(track.entries.times[i].identifier||""));t.captions.show().height(0);return;}}t.captions.hide();}else{t.captions.hide();}},setupSlides:function(track){var t=this;t.slides=track;t.slides.entries.imgs=[t.slides.entries.text.length];t.showSlide(0);},showSlide:function(index){if(typeof this.tracks=="undefined"||typeof this.slidesContainer=="undefined"){return;}var t=this,url=t.slides.entries.text[index],img=t.slides.entries.imgs[index];if(typeof img=="undefined"||typeof img.fadeIn=="undefined"){t.slides.entries.imgs[index]=img=$('<img src="'+url+'">').on("load",function(){img.appendTo(t.slidesContainer).hide().fadeIn().siblings(":visible").fadeOut();});}else{if(!img.is(":visible")&&!img.is(":animated")){img.fadeIn().siblings(":visible").fadeOut();}}},displaySlides:function(){if(typeof this.slides=="undefined"){return;}var t=this,slides=t.slides,i;for(i=0;i<slides.entries.times.length;i++){if(t.media.currentTime>=slides.entries.times[i].start&&t.media.currentTime<=slides.entries.times[i].stop){t.showSlide(i);return;}}},displayChapters:function(){var t=this,i;for(i=0;i<t.tracks.length;i++){if(t.tracks[i].kind=="chapters"&&t.tracks[i].isLoaded){t.drawChapters(t.tracks[i]);t.hasChapters=true;break;}}},drawChapters:function(chapters){var t=this,i,dur,percent=0,usedPercent=0;t.chapters.empty();for(i=0;i<chapters.entries.times.length;i++){dur=chapters.entries.times[i].stop-chapters.entries.times[i].start;percent=Math.floor(dur/t.media.duration*100);if(percent+usedPercent>100||i==chapters.entries.times.length-1&&percent+usedPercent<100){percent=100-usedPercent;}t.chapters.append($('<div class="mejs-chapter" rel="'+chapters.entries.times[i].start+'" style="left: '+usedPercent.toString()+"%;width: "+percent.toString()+'%;">'+'<div class="mejs-chapter-block'+((i==chapters.entries.times.length-1)?" mejs-chapter-block-last":"")+'">'+'<span class="ch-title">'+chapters.entries.text[i]+"</span>"+'<span class="ch-time">'+mejs.Utility.secondsToTimeCode(chapters.entries.times[i].start,t.options)+"&ndash;"+mejs.Utility.secondsToTimeCode(chapters.entries.times[i].stop,t.options)+"</span>"+"</div>"+"</div>"));usedPercent+=percent;}t.chapters.find("div.mejs-chapter").click(function(){t.media.setCurrentTime(parseFloat($(this).attr("rel")));if(t.media.paused){t.media.play();}});t.chapters.show();}});mejs.language={codes:{af:"Afrikaans",sq:"Albanian",ar:"Arabic",be:"Belarusian",bg:"Bulgarian",ca:"Catalan",zh:"Chinese","zh-cn":"Chinese Simplified","zh-tw":"Chinese Traditional",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",et:"Estonian",fl:"Filipino",fi:"Finnish",fr:"French",gl:"Galician",de:"German",el:"Greek",ht:"Haitian Creole",iw:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",ga:"Irish",it:"Italian",ja:"Japanese",ko:"Korean",lv:"Latvian",lt:"Lithuanian",mk:"Macedonian",ms:"Malay",mt:"Maltese",no:"Norwegian",fa:"Persian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian",sr:"Serbian",sk:"Slovak",sl:"Slovenian",es:"Spanish",sw:"Swahili",sv:"Swedish",tl:"Tagalog",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",cy:"Welsh",yi:"Yiddish"}};mejs.TrackFormatParser={webvtt:{pattern_timecode:/^((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,parse:function(trackText){var i=0,lines=mejs.TrackFormatParser.split2(trackText,/\r?\n/),entries={text:[],times:[]},timecode,text,identifier;for(;i<lines.length;i++){timecode=this.pattern_timecode.exec(lines[i]);if(timecode&&i<lines.length){if((i-1)>=0&&lines[i-1]!==""){identifier=lines[i-1];}i++;text=lines[i];i++;while(lines[i]!==""&&i<lines.length){text=text+"\n"+lines[i];i++;}text=$.trim(text).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target='_blank'>$1</a>");entries.text.push(text);entries.times.push({identifier:identifier,start:(mejs.Utility.convertSMPTEtoSeconds(timecode[1])===0)?0.2:mejs.Utility.convertSMPTEtoSeconds(timecode[1]),stop:mejs.Utility.convertSMPTEtoSeconds(timecode[3]),settings:timecode[5]});}identifier="";}return entries;}},dfxp:{parse:function(trackText){trackText=$(trackText).filter("tt");var i=0,container=trackText.children("div").eq(0),lines=container.find("p"),styleNode=trackText.find("#"+container.attr("style")),styles,text,entries={text:[],times:[]};if(styleNode.length){var attributes=styleNode.removeAttr("id").get(0).attributes;if(attributes.length){styles={};for(i=0;i<attributes.length;i++){styles[attributes[i].name.split(":")[1]]=attributes[i].value;}}}for(i=0;i<lines.length;i++){var style;var _temp_times={start:null,stop:null,style:null};if(lines.eq(i).attr("begin")){_temp_times.start=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i).attr("begin"));}if(!_temp_times.start&&lines.eq(i-1).attr("end")){_temp_times.start=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i-1).attr("end"));}if(lines.eq(i).attr("end")){_temp_times.stop=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i).attr("end"));}if(!_temp_times.stop&&lines.eq(i+1).attr("begin")){_temp_times.stop=mejs.Utility.convertSMPTEtoSeconds(lines.eq(i+1).attr("begin"));}if(styles){style="";for(var _style in styles){style+=_style+":"+styles[_style]+";";}}if(style){_temp_times.style=style;}if(_temp_times.start===0){_temp_times.start=0.2;}entries.times.push(_temp_times);text=$.trim(lines.eq(i).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,"<a href='$1' target='_blank'>$1</a>");entries.text.push(text);}return entries;}},split2:function(text,regex){return text.split(regex);}};if("x\n\ny".split(/\n/gi).length!=3){mejs.TrackFormatParser.split2=function(text,regex){var parts=[],chunk="",i;for(i=0;i<text.length;i++){chunk+=text.substring(i,i+1);if(regex.test(chunk)){parts.push(chunk.replace(regex,""));chunk="";}}parts.push(chunk);return parts;};}})(mejs.$);(function($){$.extend(mejs.MepDefaults,{sourcechooserText:""});$.extend(MediaElementPlayer.prototype,{buildsourcechooser:function(player,controls,layers,media){var t=this,sourceTitle=t.options.sourcechooserText?t.options.sourcechooserText:mejs.i18n.t("mejs.source-chooser"),hoverTimeout;player.sourcechooserButton=$('<div class="mejs-button mejs-sourcechooser-button">'+'<button type="button" role="button" aria-haspopup="true" aria-owns="'+t.id+'" title="'+sourceTitle+'" aria-label="'+sourceTitle+'"></button>'+'<div class="mejs-sourcechooser-selector mejs-offscreen" role="menu" aria-expanded="false" aria-hidden="true">'+"<ul>"+"</ul>"+"</div>"+"</div>").appendTo(controls).hover(function(){clearTimeout(hoverTimeout);player.showSourcechooserSelector();},function(){var self=$(this);hoverTimeout=setTimeout(function(){player.hideSourcechooserSelector();},500);}).on("keydown",function(e){var keyCode=e.keyCode;switch(keyCode){case 32:if(!mejs.MediaFeatures.isFirefox){player.showSourcechooserSelector();}$(this).find(".mejs-sourcechooser-selector").find("input[type=radio]:checked").first().focus();break;case 13:player.showSourcechooserSelector();$(this).find(".mejs-sourcechooser-selector").find("input[type=radio]:checked").first().focus();break;case 27:player.hideSourcechooserSelector();$(this).find("button").focus();break;default:return true;}}).on("focusout",mejs.Utility.debounce(function(e){setTimeout(function(){var parent=$(document.activeElement).closest(".mejs-sourcechooser-selector");if(!parent.length){player.hideSourcechooserSelector();}},0);},100)).delegate("input[type=radio]","click",function(){$(this).attr("aria-selected",true).attr("checked","checked");$(this).closest(".mejs-sourcechooser-selector").find("input[type=radio]").not(this).attr("aria-selected","false").removeAttr("checked");var src=this.value;if(media.currentSrc!=src){var currentTime=media.currentTime;var paused=media.paused;media.pause();media.setSrc(src);media.addEventListener("loadedmetadata",function(e){media.currentTime=currentTime;},true);var canPlayAfterSourceSwitchHandler=function(e){if(!paused){media.play();}media.removeEventListener("canplay",canPlayAfterSourceSwitchHandler,true);};media.addEventListener("canplay",canPlayAfterSourceSwitchHandler,true);media.load();}}).delegate("button","click",function(e){if($(this).siblings(".mejs-sourcechooser-selector").hasClass("mejs-offscreen")){player.showSourcechooserSelector();$(this).siblings(".mejs-sourcechooser-selector").find("input[type=radio]:checked").first().focus();}else{player.hideSourcechooserSelector();}});for(var i in this.node.children){var src=this.node.children[i];if(src.nodeName==="SOURCE"&&(media.canPlayType(src.type)=="probably"||media.canPlayType(src.type)=="maybe")){player.addSourceButton(src.src,src.title,src.type,media.src==src.src);}}},addSourceButton:function(src,label,type,isCurrent){var t=this;if(label===""||label==undefined){label=src;}type=type.split("/")[1];t.sourcechooserButton.find("ul").append($("<li>"+'<input type="radio" name="'+t.id+'_sourcechooser" id="'+t.id+"_sourcechooser_"+label+type+'" role="menuitemradio" value="'+src+'" '+(isCurrent?'checked="checked"':"")+'aria-selected="'+isCurrent+'"'+" />"+'<label for="'+t.id+"_sourcechooser_"+label+type+'" aria-hidden="true">'+label+" ("+type+")</label>"+"</li>"));t.adjustSourcechooserBox();},adjustSourcechooserBox:function(){var t=this;t.sourcechooserButton.find(".mejs-sourcechooser-selector").height(t.sourcechooserButton.find(".mejs-sourcechooser-selector ul").outerHeight(true));},hideSourcechooserSelector:function(){this.sourcechooserButton.find(".mejs-sourcechooser-selector").addClass("mejs-offscreen").attr("aria-expanded","false").attr("aria-hidden","true").find("input[type=radio]").attr("tabindex","-1");},showSourcechooserSelector:function(){this.sourcechooserButton.find(".mejs-sourcechooser-selector").removeClass("mejs-offscreen").attr("aria-expanded","true").attr("aria-hidden","false").find("input[type=radio]").attr("tabindex","0");}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{"contextMenuItems":[{render:function(player){if(typeof player.enterFullScreen=="undefined"){return null;}if(player.isFullScreen){return mejs.i18n.t("mejs.fullscreen-off");}else{return mejs.i18n.t("mejs.fullscreen-on");}},click:function(player){if(player.isFullScreen){player.exitFullScreen();}else{player.enterFullScreen();}}},{render:function(player){if(player.media.muted){return mejs.i18n.t("mejs.unmute");}else{return mejs.i18n.t("mejs.mute");}},click:function(player){if(player.media.muted){player.setMuted(false);}else{player.setMuted(true);}}},{isSeparator:true},{render:function(player){return mejs.i18n.t("mejs.download-video");},click:function(player){window.location.href=player.media.currentSrc;}}]});$.extend(MediaElementPlayer.prototype,{buildcontextmenu:function(player,controls,layers,media){player.contextMenu=$('<div class="mejs-contextmenu"></div>').appendTo($("body")).hide();player.container.bind("contextmenu",function(e){if(player.isContextMenuEnabled){e.preventDefault();player.renderContextMenu(e.clientX-1,e.clientY-1);return false;}});player.container.bind("click",function(){player.contextMenu.hide();});player.contextMenu.bind("mouseleave",function(){player.startContextMenuTimer();});},cleancontextmenu:function(player){player.contextMenu.remove();},isContextMenuEnabled:true,enableContextMenu:function(){this.isContextMenuEnabled=true;},disableContextMenu:function(){this.isContextMenuEnabled=false;},contextMenuTimeout:null,startContextMenuTimer:function(){var t=this;t.killContextMenuTimer();t.contextMenuTimer=setTimeout(function(){t.hideContextMenu();t.killContextMenuTimer();},750);},killContextMenuTimer:function(){var timer=this.contextMenuTimer;if(timer!=null){clearTimeout(timer);delete timer;timer=null;}},hideContextMenu:function(){this.contextMenu.hide();},renderContextMenu:function(x,y){var t=this,html="",items=t.options.contextMenuItems;for(var i=0,il=items.length;i<il;i++){if(items[i].isSeparator){html+='<div class="mejs-contextmenu-separator"></div>';}else{var rendered=items[i].render(t);if(rendered!=null){html+='<div class="mejs-contextmenu-item" data-itemindex="'+i+'" id="element-'+(Math.random()*1000000)+'">'+rendered+"</div>";}}}t.contextMenu.empty().append($(html)).css({top:y,left:x}).show();t.contextMenu.find(".mejs-contextmenu-item").each(function(){var $dom=$(this),itemIndex=parseInt($dom.data("itemindex"),10),item=t.options.contextMenuItems[itemIndex];if(typeof item.show!="undefined"){item.show($dom,t);}$dom.click(function(){if(typeof item.click!="undefined"){item.click(t);}t.contextMenu.hide();});});setTimeout(function(){t.killControlsTimer("rev3");},100);}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{skipBackInterval:30,skipBackText:""});$.extend(MediaElementPlayer.prototype,{buildskipback:function(player,controls,layers,media){var t=this,defaultTitle=mejs.i18n.t("mejs.time-skip-back",t.options.skipBackInterval),skipTitle=t.options.skipBackText?t.options.skipBackText:defaultTitle,loop=$('<div class="mejs-button mejs-skip-back-button">'+'<button type="button" aria-controls="'+t.id+'" title="'+skipTitle+'" aria-label="'+skipTitle+'">'+t.options.skipBackInterval+"</button>"+"</div>").appendTo(controls).click(function(){media.setCurrentTime(Math.max(media.currentTime-t.options.skipBackInterval,0));$(this).find("button").blur();});}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{postrollCloseText:""});$.extend(MediaElementPlayer.prototype,{buildpostroll:function(player,controls,layers,media){var t=this,postrollTitle=t.options.postrollCloseText?t.options.postrollCloseText:mejs.i18n.t("mejs.close"),postrollLink=t.container.find('link[rel="postroll"]').attr("href");if(typeof postrollLink!=="undefined"){player.postroll=$('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">'+postrollTitle+'</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(layers).hide();t.media.addEventListener("ended",function(e){$.ajax({dataType:"html",url:postrollLink,success:function(data,textStatus){layers.find(".mejs-postroll-layer-content").html(data);}});player.postroll.show();},false);}}});})(mejs.$);(function($){$.extend(mejs.MepDefaults,{markerColor:"#E9BC3D",markers:[],markerCallback:function(){}});$.extend(MediaElementPlayer.prototype,{buildmarkers:function(player,controls,layers,media){var t=this,i=0,currentPos=-1,currentMarker=-1,lastPlayPos=-1,lastMarkerCallBack=-1;for(i=0;i<player.options.markers.length;++i){controls.find(".mejs-time-total").append('<span class="mejs-time-marker"></span>');}media.addEventListener("durationchange",function(e){player.setmarkers(controls);});media.addEventListener("timeupdate",function(e){currentPos=Math.floor(media.currentTime);if(lastPlayPos>currentPos){if(lastMarkerCallBack>currentPos){lastMarkerCallBack=-1;}}else{lastPlayPos=currentPos;}for(i=0;i<player.options.markers.length;++i){currentMarker=Math.floor(player.options.markers[i]);if(currentPos===currentMarker&&currentMarker!==lastMarkerCallBack){player.options.markerCallback(media,media.currentTime);lastMarkerCallBack=currentMarker;}}},false);},setmarkers:function(controls){var t=this,i=0,left;for(i=0;i<t.options.markers.length;++i){if(Math.floor(t.options.markers[i])<=t.media.duration&&Math.floor(t.options.markers[i])>=0){left=100*Math.floor(t.options.markers[i])/t.media.duration;$(controls.find(".mejs-time-marker")[i]).css({"width":"1px","left":left+"%","background":t.options.markerColor});}}}});})(mejs.$);
   /* Ende mediaelementplayer */
   /* Start openlayers */
   // version 5.3.0
/**Copyright 2005-present OpenLayers Contributors. All rights reserved.

  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

  Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

  THIS SOFTWARE IS PROVIDED BY OPENLAYERS CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

  The views and conclusions contained in the software and documentation are those of the authors and should not be interpreted as representing official policies, either expressed or implied, of OpenLayers Contributors.*/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ol=e():t.ol=e()}(window,function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=9)}([function(t,e,i){"use strict";t.exports=n,t.exports.default=n;var r=i(5);function n(t,e){if(!(this instanceof n))return new n(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,i){if(!i)return e.indexOf(t);for(var r=0;r<e.length;r++)if(i(t,e[r]))return r;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,r,n){n||(n=y(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],h(n,t.leaf?r(o):o);return n}function h(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function p(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function f(t,e){var i=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,o-r)}function _(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function g(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function y(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,i,n,o){for(var s,a=[e,i];a.length;)(i=a.pop())-(e=a.pop())<=n||(s=e+Math.ceil((i-e)/n/2)*n,r(t,s,e,i,o),a.push(e,s,s,i))}n.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],r=this.toBBox;if(!g(t,e))return i;for(var n,o,s,a,h=[];e;){for(n=0,o=e.children.length;n<o;n++)s=e.children[n],g(t,a=e.leaf?r(s):s)&&(e.leaf?i.push(s):_(t,a)?this._all(s,i):h.push(s));e=h.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!g(t,e))return!1;for(var r,n,o,s,a=[];e;){for(r=0,n=e.children.length;r<n;r++)if(o=e.children[r],g(t,s=e.leaf?i(o):o)){if(e.leaf||_(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(t,e){if(!t)return this;for(var i,r,n,s,a=this.data,h=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),r=l[l.length-1],i=u.pop(),s=!0),a.leaf&&-1!==(n=o(t,a.children,e)))return a.children.splice(n,1),l.push(a),this._condense(l),this;s||a.leaf||!_(a,h)?r?(i++,a=r.children[i],s=!1):a=null:(l.push(a),u.push(i),i=0,r=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:l,compareMinY:u,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,r){var n,o=i-e+1,a=this._maxEntries;if(o<=a)return s(n=y(t.slice(e,i+1)),this.toBBox),n;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),(n=y([])).leaf=!1,n.height=r;var h,l,u,p,c=Math.ceil(o/a),d=c*Math.ceil(Math.sqrt(a));for(v(t,e,i,d,this.compareMinX),h=e;h<=i;h+=d)for(v(t,h,u=Math.min(h+d-1,i),c,this.compareMinY),l=h;l<=u;l+=c)p=Math.min(l+c-1,u),n.children.push(this._build(t,l,p,r-1));return s(n,this.toBBox),n},_chooseSubtree:function(t,e,i,r){for(var n,o,s,a,h,l,u,c;r.push(e),!e.leaf&&r.length-1!==i;){for(u=c=1/0,n=0,o=e.children.length;n<o;n++)h=p(s=e.children[n]),(l=d(t,s)-h)<c?(c=l,u=h<u?h:u,a=s):l===c&&h<u&&(u=h,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var r=this.toBBox,n=i?t:r(t),o=[],s=this._chooseSubtree(n,this.data,e,o);for(s.children.push(t),h(s,n);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(n,o,e)},_split:function(t,e){var i=t[e],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var o=this._chooseSplitIndex(i,n,r),a=y(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data=y([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var r,n,o,s,h,l,u,c;for(l=u=1/0,r=e;r<=i-e;r++)s=f(n=a(t,0,r,this.toBBox),o=a(t,r,i,this.toBBox)),h=p(n)+p(o),s<l?(l=s,c=r,u=h<u?h:u):s===l&&h<u&&(u=h,c=r);return c},_chooseSplitAxis:function(t,e,i){var r=t.leaf?this.compareMinX:l,n=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,i,r)<this._allDistMargin(t,e,i,n)&&t.children.sort(r)},_allDistMargin:function(t,e,i,r){t.children.sort(r);var n,o,s=this.toBBox,l=a(t,0,e,s),u=a(t,i-e,i,s),p=c(l)+c(u);for(n=e;n<i-e;n++)o=t.children[n],h(l,t.leaf?s(o):o),p+=c(l);for(n=i-e-1;n>=e;n--)o=t.children[n],h(u,t.leaf?s(o):o),p+=c(u);return p},_adjustParentBBoxes:function(t,e,i){for(var r=i;r>=0;r--)h(e[r],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():s(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,i){"use strict";t.exports=n;var r=i(6);function n(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;function o(t){return t.type===n.Bytes?t.readVarint()+t.pos:t.pos+1}function s(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function a(t,e,i){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;n>=t;n--)i.buf[n+r]=i.buf[n]}function h(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function l(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function u(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function p(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function c(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function d(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function _(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function g(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function y(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function v(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function m(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}n.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,o=this.pos;this.type=7&r,t(n,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=y(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=m(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=y(this.buf,this.pos)+4294967296*y(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=y(this.buf,this.pos)+4294967296*m(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,r=this.buf;return e=127&(i=r[this.pos++]),i<128?e:(e|=(127&(i=r[this.pos++]))<<7,i<128?e:(e|=(127&(i=r[this.pos++]))<<14,i<128?e:(e|=(127&(i=r[this.pos++]))<<21,i<128?e:function(t,e,i){var r,n,o=i.buf;if(n=o[i.pos++],r=(112&n)>>4,n<128)return s(t,r,e);if(n=o[i.pos++],r|=(127&n)<<3,n<128)return s(t,r,e);if(n=o[i.pos++],r|=(127&n)<<10,n<128)return s(t,r,e);if(n=o[i.pos++],r|=(127&n)<<17,n<128)return s(t,r,e);if(n=o[i.pos++],r|=(127&n)<<24,n<128)return s(t,r,e);if(n=o[i.pos++],r|=(1&n)<<31,n<128)return s(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,i){var r="",n=e;for(;n<i;){var o,s,a,h=t[n],l=null,u=h>239?4:h>223?3:h>191?2:1;if(n+u>i)break;1===u?h<128&&(l=h):2===u?128==(192&(o=t[n+1]))&&(l=(31&h)<<6|63&o)<=127&&(l=null):3===u?(o=t[n+1],s=t[n+2],128==(192&o)&&128==(192&s)&&((l=(15&h)<<12|(63&o)<<6|63&s)<=2047||l>=55296&&l<=57343)&&(l=null)):4===u&&(o=t[n+1],s=t[n+2],a=t[n+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((l=(15&h)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||l>=1114112)&&(l=null)),null===l?(l=65533,u=1):l>65535&&(l-=65536,r+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),r+=String.fromCharCode(l),n+=u}return r}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var i=o(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=o(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===n.Varint)for(;this.buf[this.pos++]>127;);else if(e===n.Bytes)this.pos=this.readVarint()+this.pos;else if(e===n.Fixed32)this.pos+=4;else{if(e!==n.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),v(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),v(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),v(this.buf,-1&t,this.pos),v(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),v(this.buf,-1&t,this.pos),v(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,r;t>=0?(i=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}(i,0,e),function(t,e){var i=(7&t)<<4;if(e.buf[e.pos++]|=i|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var r,n,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!n){r>56319||o+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):n=r;continue}if(r<56320){t[i++]=239,t[i++]=191,t[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&(t[i++]=239,t[i++]=191,t[i++]=189,n=null);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&a(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var r=this.pos-i;r>=128&&a(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,i){this.writeTag(t,n.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){this.writeMessage(t,h,e)},writePackedSVarint:function(t,e){this.writeMessage(t,l,e)},writePackedBoolean:function(t,e){this.writeMessage(t,c,e)},writePackedFloat:function(t,e){this.writeMessage(t,u,e)},writePackedDouble:function(t,e){this.writeMessage(t,p,e)},writePackedFixed32:function(t,e){this.writeMessage(t,d,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,f,e)},writePackedFixed64:function(t,e){this.writeMessage(t,_,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,g,e)},writeBytesField:function(t,e){this.writeTag(t,n.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,n.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,n.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,n.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,n.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,n.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,n.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e,i){var r=i(7);e.Processor=r},,,function(t,e,i){t.exports=function(){"use strict";function t(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function e(t,e){return t<e?-1:t>e?1:0}return function(i,r,n,o,s){!function e(i,r,n,o,s){for(;o>n;){if(o-n>600){var a=o-n+1,h=r-n+1,l=Math.log(a),u=.5*Math.exp(2*l/3),p=.5*Math.sqrt(l*u*(a-u)/a)*(h-a/2<0?-1:1),c=Math.max(n,Math.floor(r-h*u/a+p)),d=Math.min(o,Math.floor(r+(a-h)*u/a+p));e(i,r,c,d,s)}var f=i[r],_=n,g=o;for(t(i,n,r),s(i[o],f)>0&&t(i,n,o);_<g;){for(t(i,_,g),_++,g--;s(i[_],f)<0;)_++;for(;s(i[g],f)>0;)g--}0===s(i[n],f)?t(i,n,g):t(i,++g,o),g<=r&&(n=g+1),r<=g&&(o=g-1)}}(i,r,n||0,o||i.length-1,s||e)}}()},function(t,e){e.read=function(t,e,i,r,n){var o,s,a=8*n-r-1,h=(1<<a)-1,l=h>>1,u=-7,p=i?n-1:0,c=i?-1:1,d=t[e+p];for(p+=c,o=d&(1<<-u)-1,d>>=-u,u+=a;u>0;o=256*o+t[e+p],p+=c,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+t[e+p],p+=c,u-=8);if(0===o)o=1-l;else{if(o===h)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=l}return(d?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,i,r,n,o){var s,a,h,l=8*o-n-1,u=(1<<l)-1,p=u>>1,c=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,f=r?1:-1,_=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-s))<1&&(s--,h*=2),(e+=s+p>=1?c/h:c*Math.pow(2,1-p))*h>=2&&(s++,h/=2),s+p>=u?(a=0,s=u):s+p>=1?(a=(e*h-1)*Math.pow(2,n),s+=p):(a=e*Math.pow(2,p-1)*Math.pow(2,n),s=0));n>=8;t[i+d]=255&a,d+=f,a/=256,n-=8);for(s=s<<n|a,l+=n;l>0;t[i+d]=255&s,d+=f,s/=256,l-=8);t[i+d-f]|=128*_}},function(t,e,i){var r=i(8).newImageData;function n(t){var e=!0;try{new ImageData(10,10)}catch(t){e=!1}function i(t,i,r){return e?new ImageData(t,i,r):{data:t,width:i,height:r}}return function(e){var r,n,o=e.buffers,s=e.meta,a=e.imageOps,h=e.width,l=e.height,u=o.length,p=o[0].byteLength;if(a){var c=new Array(u);for(n=0;n<u;++n)c[n]=i(new Uint8ClampedArray(o[n]),h,l);r=t(c,s).data}else{r=new Uint8ClampedArray(p);var d=new Array(u),f=new Array(u);for(n=0;n<u;++n)d[n]=new Uint8ClampedArray(o[n]),f[n]=[0,0,0,0];for(var _=0;_<p;_+=4){for(var g=0;g<u;++g){var y=d[g];f[g][0]=y[_],f[g][1]=y[_+1],f[g][2]=y[_+2],f[g][3]=y[_+3]}var v=t(f,s);r[_]=v[0],r[_+1]=v[1],r[_+2]=v[2],r[_+3]=v[3]}}return r.buffer}}function o(t,e){var i=Object.keys(t.lib||{}).map(function(e){return"var "+e+" = "+t.lib[e].toString()+";"}).concat(["var __minion__ = ("+n.toString()+")(",t.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),r=new Blob(i,{type:"text/javascript"}),o=URL.createObjectURL(r),s=new Worker(o);return s.addEventListener("message",e),s}function s(t){var e;this._imageOps=!!t.imageOps;var i=[];if(e=0===t.threads?0:this._imageOps?1:t.threads||1)for(var r=0;r<e;++r)i[r]=o(t,this._onWorkerMessage.bind(this,r));else i[0]=function(t,e){var i=n(t.operation);return{postMessage:function(t){setTimeout(function(){e({data:{buffer:i(t),meta:t.meta}})},0)}}}(t,this._onWorkerMessage.bind(this,0));this._workers=i,this._queue=[],this._maxQueueLength=t.queue||1/0,this._running=0,this._dataLookup={},this._job=null}s.prototype.process=function(t,e,i){this._enqueue({inputs:t,meta:e,callback:i}),this._dispatch()},s.prototype.destroy=function(){for(var t in this)this[t]=null;this._destroyed=!0},s.prototype._enqueue=function(t){for(this._queue.push(t);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},s.prototype._dispatch=function(){if(0===this._running&&this._queue.length>0){var t=this._job=this._queue.shift(),e=t.inputs[0].width,i=t.inputs[0].height,r=t.inputs.map(function(t){return t.data.buffer}),n=this._workers.length;if(this._running=n,1===n)this._workers[0].postMessage({buffers:r,meta:t.meta,imageOps:this._imageOps,width:e,height:i},r);else for(var o=t.inputs[0].data.length,s=4*Math.ceil(o/4/n),a=0;a<n;++a){for(var h=a*s,l=[],u=0,p=r.length;u<p;++u)l.push(r[a].slice(h,h+s));this._workers[a].postMessage({buffers:l,meta:t.meta,imageOps:this._imageOps,width:e,height:i},l)}}},s.prototype._onWorkerMessage=function(t,e){this._destroyed||(this._dataLookup[t]=e.data,--this._running,0===this._running&&this._resolveJob())},s.prototype._resolveJob=function(){var t,e,i=this._job,n=this._workers.length;if(1===n)t=new Uint8ClampedArray(this._dataLookup[0].buffer),e=this._dataLookup[0].meta;else{var o=i.inputs[0].data.length;t=new Uint8ClampedArray(o),e=new Array(o);for(var s=4*Math.ceil(o/4/n),a=0;a<n;++a){var h=this._dataLookup[a].buffer,l=a*s;t.set(new Uint8ClampedArray(h),l),e[a]=this._dataLookup[a].meta}}this._job=null,this._dataLookup={},i.callback(null,r(t,i.inputs[0].width,i.inputs[0].height),e),this._dispatch()},t.exports=s},function(t,e){var i=!0;try{new ImageData(10,10)}catch(t){i=!1}var r=document.createElement("canvas").getContext("2d");e.newImageData=function(t,e,n){if(i)return new ImageData(t,e,n);var o=r.createImageData(e,n);return o.data.set(t),o}},function(t,e,i){"use strict";function r(){return function(){throw new Error("Unimplemented abstract method.")}()}i.r(e);var n=0;function o(t){return t.ol_uid||(t.ol_uid=String(++n))}var s="5.3.0",a=function(t){function e(e){var i="Assertion failed. See https://openlayers.org/en/"+("latest"===s?s:"v"+s.split("-")[0])+"/doc/errors/#"+e+" for details.";t.call(this,i),this.code=e,this.name="AssertionError",this.message=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),h={ADD:"add",REMOVE:"remove"},l="propertychange",u="function"==typeof Object.assign?Object.assign:function(t,e){var i=arguments;if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),n=1,o=arguments.length;n<o;++n){var s=i[n];if(void 0!==s&&null!==s)for(var a in s)s.hasOwnProperty(a)&&(r[a]=s[a])}return r};function p(t){for(var e in t)delete t[e]}function c(t){var e=[];for(var i in t)e.push(t[i]);return e}function d(t){var e;for(e in t)return!1;return!e}function f(t,e,i,r){for(var n,o=0,s=t.length;o<s;++o)if((n=t[o]).listener===e&&n.bindTo===i)return r&&(n.deleteIndex=o),n}function _(t,e){var i=g(t);return i?i[e]:void 0}function g(t,e){var i=t.ol_lm;return!i&&e&&(i=t.ol_lm={}),i}function y(t,e){var i=_(t,e);if(i){for(var r=0,n=i.length;r<n;++r)t.removeEventListener(e,i[r].boundListener),p(i[r]);i.length=0;var o=g(t);o&&(delete o[e],0===Object.keys(o).length&&function(t){delete t.ol_lm}(t))}}function v(t,e,i,r,n){var o=g(t,!0),s=o[e];s||(s=o[e]=[]);var a=f(s,i,r,!1);return a?n||(a.callOnce=!1):(a={bindTo:r,callOnce:!!n,listener:i,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var i=t.listener,r=t.bindTo||t.target;return t.callOnce&&E(t),i.call(r,e)};return t.boundListener=e,e}(a)),s.push(a)),a}function m(t,e,i,r){return v(t,e,i,r,!0)}function x(t,e,i,r){var n=_(t,e);if(n){var o=f(n,i,r,!0);o&&E(o)}}function E(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=_(t.target,t.type);if(e){var i="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==i&&e.splice(i,1),0===e.length&&y(t.target,t.type)}p(t)}}function S(t){var e=g(t);if(e)for(var i in e)y(t,i)}var T=function(){this.disposed_=!1};T.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},T.prototype.disposeInternal=function(){};var C=T;function R(){return!0}function w(){return!1}function I(){}var L=function(t){this.propagationStopped,this.type=t,this.target=null};function O(t){t.stopPropagation()}L.prototype.preventDefault=function(){this.propagationStopped=!0},L.prototype.stopPropagation=function(){this.propagationStopped=!0};var P=L,b=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var i=this.listeners_[t];i||(i=this.listeners_[t]=[]),-1===i.indexOf(e)&&i.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new P(t):t,i=e.type;e.target=this;var r,n=this.listeners_[i];if(n){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var o=0,s=n.length;o<s;++o)if(!1===n[o].call(this,e)||e.propagationStopped){r=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var a=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];a--;)this.removeEventListener(i,I);delete this.dispatching_[i]}return r}},e.prototype.disposeInternal=function(){S(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var r=i.indexOf(e);t in this.pendingRemovals_?(i[r]=I,++this.pendingRemovals_[t]):(i.splice(r,1),0===i.length&&delete this.listeners_[t])}},e}(C),M={CHANGE:"change",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"};var F=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(M.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,r=new Array(i),n=0;n<i;++n)r[n]=v(this,t[n],e);return r}return v(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,r=new Array(i),n=0;n<i;++n)r[n]=m(this,t[n],e);return r}return m(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,r=t.length;i<r;++i)x(this,t[i],e);else x(this,t,e)},e}(b),A=function(t){function e(e,i,r){t.call(this,e),this.key=i,this.oldValue=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),N={};function G(t){return N.hasOwnProperty(t)?N[t]:N[t]="change:"+t}var D=function(t){function e(e){t.call(this),o(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return u({},this.values_)},e.prototype.notify=function(t,e){var i;i=G(t),this.dispatchEvent(new A(i,t,e)),i=l,this.dispatchEvent(new A(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var r=this.values_[t];this.values_[t]=e,r!==e&&this.notify(t,r)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(F),k="length",j=function(t){function e(e,i){t.call(this,e),this.element=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),U=function(t){function e(e,i){t.call(this);var r=i||{};if(this.unique_=!!r.unique,this.array_=e||[],this.unique_)for(var n=0,o=this.array_.length;n<o;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,r=e.length;i<r;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(k)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new j(h.ADD,e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,r=e.length;i<r;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new j(h.REMOVE,e)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new j(h.REMOVE,r)),this.dispatchEvent(new j(h.ADD,e))}else{for(var n=i;n<t;++n)this.insertAt(n,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(k,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===t&&i!==e)throw new a(58)},e}(D);function Y(t,e){if(!t)throw new a(e)}var B=function(t){function e(e){if(t.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,v(this,G(this.geometryName_),this.handleGeometryChanged_,this),e)if("function"==typeof e.getSimplifiedGeometry){var i=e;this.setGeometry(i)}else{var r=e;this.setProperties(r)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var r=this.getStyle();return r&&t.setStyle(r),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(E(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=v(t,M.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;if(Array.isArray(t))e=t;else{Y("function"==typeof t.getZIndex,41);var i=t;e=[i]}return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){x(this,G(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=t,v(this,G(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},e}(D);function V(t,e){return t>e?1:t<e?-1:0}function X(t,e){return t.indexOf(e)>=0}function z(t,e,i){var r,n=t.length;if(t[0]<=e)return 0;if(e<=t[n-1])return n-1;if(i>0){for(r=1;r<n;++r)if(t[r]<e)return r-1}else if(i<0){for(r=1;r<n;++r)if(t[r]<=e)return r}else for(r=1;r<n;++r){if(t[r]==e)return r;if(t[r]<e)return t[r-1]-e<e-t[r]?r-1:r}return n-1}function W(t,e,i){for(;e<i;){var r=t[e];t[e]=t[i],t[i]=r,++e,--i}}function K(t,e){for(var i=Array.isArray(e)?e:[e],r=i.length,n=0;n<r;n++)t[t.length]=i[n]}function H(t,e){for(var i,r=t.length>>>0,n=0;n<r;n++)if(e(i=t[n],n,t))return i;return null}function Z(t,e){var i=t.length;if(i!==e.length)return!1;for(var r=0;r<i;r++)if(t[r]!==e[r])return!1;return!0}function q(t,e){var i,r=t.length,n=Array(t.length);for(i=0;i<r;i++)n[i]={index:i,value:t[i]};for(n.sort(function(t,i){return e(t.value,i.value)||t.index-i.index}),i=0;i<t.length;i++)t[i]=n[i].value}function J(t,e){var i;return!t.every(function(r,n){return i=n,!e(r,n,t)})?i:-1}var Q={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},$={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function tt(t){for(var e=ht(),i=0,r=t.length;i<r;++i)_t(e,t[i]);return e}function et(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function it(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function rt(t,e,i){var r,n;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(n=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*n}function nt(t,e){return st(t,e[0],e[1])}function ot(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function st(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function at(t,e){var i=t[0],r=t[1],n=t[2],o=t[3],s=e[0],a=e[1],h=$.UNKNOWN;return s<i?h|=$.LEFT:s>n&&(h|=$.RIGHT),a<r?h|=$.BELOW:a>o&&(h|=$.ABOVE),h===$.UNKNOWN&&(h=$.INTERSECTING),h}function ht(){return[1/0,1/0,-1/0,-1/0]}function lt(t,e,i,r,n){return n?(n[0]=t,n[1]=e,n[2]=i,n[3]=r,n):[t,e,i,r]}function ut(t){return lt(1/0,1/0,-1/0,-1/0,t)}function pt(t,e){var i=t[0],r=t[1];return lt(i,r,i,r,e)}function ct(t,e,i,r,n){return yt(ut(n),t,e,i,r)}function dt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function ft(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function _t(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function gt(t,e){for(var i=0,r=e.length;i<r;++i)_t(t,e[i]);return t}function yt(t,e,i,r,n){for(;i<r;i+=n)vt(t,e[i],e[i+1]);return t}function vt(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function mt(t,e,i){var r;return(r=e.call(i,Et(t)))?r:(r=e.call(i,St(t)))?r:(r=e.call(i,Lt(t)))?r:(r=e.call(i,It(t)))||!1}function xt(t){var e=0;return bt(t)||(e=Ot(t)*Rt(t)),e}function Et(t){return[t[0],t[1]]}function St(t){return[t[2],t[1]]}function Tt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Ct(t,e,i,r,n){var o=e*r[0]/2,s=e*r[1]/2,a=Math.cos(i),h=Math.sin(i),l=o*a,u=o*h,p=s*a,c=s*h,d=t[0],f=t[1],_=d-l+c,g=d-l-c,y=d+l-c,v=d+l+c,m=f-u-p,x=f-u+p,E=f+u+p,S=f+u-p;return lt(Math.min(_,g,y,v),Math.min(m,x,E,S),Math.max(_,g,y,v),Math.max(m,x,E,S),n)}function Rt(t){return t[3]-t[1]}function wt(t,e,i){var r=i||[1/0,1/0,-1/0,-1/0];return Pt(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):ut(r),r}function It(t){return[t[0],t[3]]}function Lt(t){return[t[2],t[3]]}function Ot(t){return t[2]-t[0]}function Pt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function bt(t){return t[2]<t[0]||t[3]<t[1]}function Mt(t,e){var i=(t[2]-t[0])/2*(e-1),r=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=r,t[3]+=r}function Ft(t,e,i){var r=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];return e(r,r,2),function(t,e,i){return lt(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}([r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]],i)}var At={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"},Nt={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};function Gt(t,e,i,r,n,o){for(var s=o||[],a=0,h=e;h<i;h+=r){var l=t[h],u=t[h+1];s[a++]=n[0]*l+n[2]*u+n[4],s[a++]=n[1]*l+n[3]*u+n[5]}return o&&s.length!=a&&(s.length=a),s}function Dt(t,e,i,r,n,o,s){for(var a=s||[],h=0,l=e;l<i;l+=r){a[h++]=t[l]+n,a[h++]=t[l+1]+o;for(var u=l+2;u<l+r;++u)a[h++]=t[u]}return s&&a.length!=h&&(a.length=h),a}function kt(t,e,i){return Math.min(Math.max(t,e),i)}var jt="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function Ut(t,e,i,r,n,o){var s=n-i,a=o-r;if(0!==s||0!==a){var h=((t-i)*s+(e-r)*a)/(s*s+a*a);h>1?(i=n,r=o):h>0&&(i+=s*h,r+=a*h)}return Yt(t,e,i,r)}function Yt(t,e,i,r){var n=i-t,o=r-e;return n*n+o*o}function Bt(t){return 180*t/Math.PI}function Vt(t){return t*Math.PI/180}function Xt(t,e){var i=t%e;return i*e<0?i+e:i}function zt(t,e,i){return t+i*(e-t)}
/**
 * @license
 * Latitude/longitude spherical geodesy formulae taken from
 * http://www.movable-type.co.uk/scripts/latlong.html
 * Licensed under CC-BY-3.0.
 */var Wt=6371008.8;function Kt(t,e,i){var r=i||Wt,n=Vt(t[1]),o=Vt(e[1]),s=(o-n)/2,a=Vt(e[0]-t[0])/2,h=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(n)*Math.cos(o);return 2*r*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}function Ht(t,e){for(var i=0,r=0,n=t.length;r<n-1;++r)i+=Kt(t[r],t[r+1],e);return i}function Zt(t,e){for(var i=0,r=t.length,n=t[r-1][0],o=t[r-1][1],s=0;s<r;s++){var a=t[s][0],h=t[s][1];i+=Vt(a-n)*(2+Math.sin(Vt(o))+Math.sin(Vt(h))),n=a,o=h}return i*e*e/2}function qt(t,e,i,r){var n=r||Wt,o=Vt(t[1]),s=Vt(t[0]),a=e/n,h=Math.asin(Math.sin(o)*Math.cos(a)+Math.cos(o)*Math.sin(a)*Math.cos(i));return[Bt(s+Math.atan2(Math.sin(i)*Math.sin(a)*Math.cos(o),Math.cos(a)-Math.sin(o)*Math.sin(h))),Bt(h)]}var Jt={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},Qt={};Qt[Jt.DEGREES]=2*Math.PI*6370997/360,Qt[Jt.FEET]=.3048,Qt[Jt.METERS]=1,Qt[Jt.USFEET]=1200/3937;var $t=Jt,te=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};te.prototype.canWrapX=function(){return this.canWrapX_},te.prototype.getCode=function(){return this.code_},te.prototype.getExtent=function(){return this.extent_},te.prototype.getUnits=function(){return this.units_},te.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||Qt[this.units_]},te.prototype.getWorldExtent=function(){return this.worldExtent_},te.prototype.getAxisOrientation=function(){return this.axisOrientation_},te.prototype.isGlobal=function(){return this.global_},te.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},te.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},te.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},te.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},te.prototype.setWorldExtent=function(t){this.worldExtent_=t},te.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},te.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var ee=te,ie=6378137,re=Math.PI*ie,ne=[-re,-re,re,re],oe=[-180,-85,180,85],se=function(t){function e(e){t.call(this,{code:e,units:$t.METERS,extent:ne,global:!0,worldExtent:oe,getPointResolution:function(t,e){return t/jt(e[1]/ie)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ee),ae=[new se("EPSG:3857"),new se("EPSG:102100"),new se("EPSG:102113"),new se("EPSG:900913"),new se("urn:ogc:def:crs:EPSG:6.18:3:3857"),new se("urn:ogc:def:crs:EPSG::3857"),new se("http://www.opengis.net/gml/srs/epsg.xml#3857")];function he(t,e,i){var r=t.length,n=i>1?i:2,o=e;void 0===o&&(o=n>2?t.slice():new Array(r));for(var s=re,a=0;a<r;a+=n){o[a]=s*t[a]/180;var h=ie*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));h>s?h=s:h<-s&&(h=-s),o[a+1]=h}return o}function le(t,e,i){var r=t.length,n=i>1?i:2,o=e;void 0===o&&(o=n>2?t.slice():new Array(r));for(var s=0;s<r;s+=n)o[s]=180*t[s]/re,o[s+1]=360*Math.atan(Math.exp(t[s+1]/ie))/Math.PI-90;return o}var ue=[-180,-90,180,90],pe=6378137*Math.PI/180,ce=function(t){function e(e,i){t.call(this,{code:e,units:$t.DEGREES,extent:ue,axisOrientation:i,global:!0,metersPerUnit:pe,worldExtent:ue})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ee),de=[new ce("CRS:84"),new ce("EPSG:4326","neu"),new ce("urn:ogc:def:crs:EPSG::4326","neu"),new ce("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new ce("urn:ogc:def:crs:OGC:1.3:CRS84"),new ce("urn:ogc:def:crs:OGC:2:84"),new ce("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ce("urn:x-ogc:def:crs:EPSG:4326","neu")],fe={};var _e={};function ge(t,e,i){var r=t.getCode(),n=e.getCode();r in _e||(_e[r]={}),_e[r][n]=i}function ye(t,e){var i;return t in _e&&e in _e[t]&&(i=_e[t][e]),i}function ve(t,e,i){var r;if(void 0!==e){for(var n=0,o=t.length;n<o;++n)e[n]=t[n];r=e}else r=t.slice();return r}function me(t,e,i){if(void 0!==e&&t!==e){for(var r=0,n=t.length;r<n;++r)e[r]=t[r];t=e}return t}function xe(t){!function(t,e){fe[t]=e}(t.getCode(),t),ge(t,t,ve)}function Ee(t){return"string"==typeof t?function(t){return fe[t]||null}(t):t||null}function Se(t,e,i,r){var n,o=(t=Ee(t)).getPointResolutionFunc();if(o)n=o(e,i);else if(t.getUnits()==$t.DEGREES&&!r||r==$t.DEGREES)n=e;else{var s=Le(t,Ee("EPSG:4326")),a=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];n=(Kt((a=s(a,a,2)).slice(0,2),a.slice(2,4))+Kt(a.slice(4,6),a.slice(6,8)))/2;var h=r?Qt[r]:t.getMetersPerUnit();void 0!==h&&(n/=h)}return n}function Te(t){!function(t){t.forEach(xe)}(t),t.forEach(function(e){t.forEach(function(t){e!==t&&ge(e,t,ve)})})}function Ce(t,e){return t?"string"==typeof t?Ee(t):t:Ee(e)}function Re(t){return function(e,i,r){for(var n=e.length,o=void 0!==r?r:2,s=void 0!==i?i:new Array(n),a=0;a<n;a+=o){var h=t([e[a],e[a+1]]);s[a]=h[0],s[a+1]=h[1];for(var l=o-1;l>=2;--l)s[a+l]=e[a+l]}return s}}function we(t,e,i,r){var n=Ee(t),o=Ee(e);ge(n,o,Re(i)),ge(o,n,Re(r))}function Ie(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?i:Le(t,e)===ve&&i}function Le(t,e){var i=ye(t.getCode(),e.getCode());return i||(i=me),i}function Oe(t,e){return Le(Ee(t),Ee(e))}function Pe(t,e,i){return Oe(e,i)(t,void 0,t.length)}function be(t,e,i){return Ft(t,Oe(e,i))}Te(ae),Te(de),function(t,e,i,r){t.forEach(function(t){e.forEach(function(e){ge(t,e,i),ge(e,t,r)})})}(de,ae,he,le);var Me=new Array(6);function Fe(t){return Ne(t,1,0,0,1,0,0)}function Ae(t,e){var i=t[0],r=t[1],n=t[2],o=t[3],s=t[4],a=t[5],h=e[0],l=e[1],u=e[2],p=e[3],c=e[4],d=e[5];return t[0]=i*h+n*l,t[1]=r*h+o*l,t[2]=i*u+n*p,t[3]=r*u+o*p,t[4]=i*c+n*d+s,t[5]=r*c+o*d+a,t}function Ne(t,e,i,r,n,o,s){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=o,t[5]=s,t}function Ge(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function De(t,e){var i=e[0],r=e[1];return e[0]=t[0]*i+t[2]*r+t[4],e[1]=t[1]*i+t[3]*r+t[5],e}function ke(t,e){var i=Math.cos(e),r=Math.sin(e);return Ae(t,Ne(Me,i,r,-r,i,0,0))}function je(t,e,i){return Ae(t,Ne(Me,e,0,0,i,0,0))}function Ue(t,e,i){return Ae(t,Ne(Me,1,0,0,1,e,i))}function Ye(t,e,i,r,n,o,s,a){var h=Math.sin(o),l=Math.cos(o);return t[0]=r*l,t[1]=n*h,t[2]=-r*h,t[3]=n*l,t[4]=s*r*l-a*r*h+e,t[5]=s*n*h+a*n*l+i,t}function Be(t){var e=function(t){return t[0]*t[3]-t[1]*t[2]}(t);Y(0!==e,32);var i=t[0],r=t[1],n=t[2],o=t[3],s=t[4],a=t[5];return t[0]=o/e,t[1]=-r/e,t[2]=-n/e,t[3]=i/e,t[4]=(n*a-o*s)/e,t[5]=-(i*a-r*s)/e,t}var Ve=[1,0,0,1,0,0],Xe=function(t){function e(){t.call(this),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return r()},e.prototype.closestPointXY=function(t,e,i,n){return r()},e.prototype.containsXY=function(t,e){return!1},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return r()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){r()},e.prototype.scale=function(t,e,i){r()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return r()},e.prototype.getType=function(){return r()},e.prototype.applyTransform=function(t){r()},e.prototype.intersectsExtent=function(t){return r()},e.prototype.translate=function(t,e){r()},e.prototype.transform=function(t,e){var i=Ee(t),r=i.getUnits()==$t.TILE_PIXELS?function(t,r,n){var o=i.getExtent(),s=i.getWorldExtent(),a=Rt(s)/Rt(o);return Ye(Ve,s[0],s[3],a,-a,0,0,0),Gt(t,0,t.length,n,Ve,r),Oe(i,e)(t,r,n)}:Oe(i,e);return this.applyTransform(r),this},e}(D);function ze(t){var e;return t==At.XY?e=2:t==At.XYZ||t==At.XYM?e=3:t==At.XYZM&&(e=4),e}var We=function(t){function e(){t.call(this),this.layout=At.XY,this.stride=2,this.flatCoordinates=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeExtent=function(t){return ct(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return r()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(p(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=ze(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){r()},e.prototype.setLayout=function(t,e,i){var r;if(t)r=ze(t);else{for(var n=0;n<i;++n){if(0===e.length)return this.layout=At.XY,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=At.XY:3==t?e=At.XYZ:4==t&&(e=At.XYZM);return e}(r=e.length)}this.layout=t,this.stride=r},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var r=this.getStride();!function(t,e,i,r,n,o,s){for(var a=s||[],h=Math.cos(n),l=Math.sin(n),u=o[0],p=o[1],c=0,d=e;d<i;d+=r){var f=t[d]-u,_=t[d+1]-p;a[c++]=u+f*h-_*l,a[c++]=p+f*l+_*h;for(var g=d+2;g<d+r;++g)a[c++]=t[g]}s&&a.length!=c&&(a.length=c)}(i,0,i.length,r,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var r=e;void 0===r&&(r=t);var n=i;n||(n=Tt(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,i,r,n,o,s,a){for(var h=a||[],l=s[0],u=s[1],p=0,c=e;c<i;c+=r){var d=t[c]-l,f=t[c+1]-u;h[p++]=l+n*d,h[p++]=u+o*f;for(var _=c+2;_<c+r;++_)h[p++]=t[_]}a&&h.length!=p&&(h.length=p)}(o,0,o.length,s,t,r,n,o),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var r=this.getStride();Dt(i,0,i.length,r,t,e,i),this.changed()}},e}(Xe);function Ke(t,e,i,r){for(var n=0,o=t[i-r],s=t[i-r+1];e<i;e+=r){var a=t[e],h=t[e+1];n+=s*a-o*h,o=a,s=h}return n/2}function He(t,e,i,r){for(var n=0,o=0,s=i.length;o<s;++o){var a=i[o];n+=Ke(t,e,a,r),e=a}return n}function Ze(t,e,i,r,n,o,s){var a,h=t[e],l=t[e+1],u=t[i]-h,p=t[i+1]-l;if(0===u&&0===p)a=e;else{var c=((n-h)*u+(o-l)*p)/(u*u+p*p);if(c>1)a=i;else{if(c>0){for(var d=0;d<r;++d)s[d]=zt(t[e+d],t[i+d],c);return void(s.length=r)}a=e}}for(var f=0;f<r;++f)s[f]=t[a+f];s.length=r}function qe(t,e,i,r,n){var o=t[e],s=t[e+1];for(e+=r;e<i;e+=r){var a=t[e],h=t[e+1],l=Yt(o,s,a,h);l>n&&(n=l),o=a,s=h}return n}function Je(t,e,i,r,n){for(var o=0,s=i.length;o<s;++o){var a=i[o];n=qe(t,e,a,r,n),e=a}return n}function Qe(t,e,i,r,n,o,s,a,h,l,u){if(e==i)return l;var p,c;if(0===n){if((c=Yt(s,a,t[e],t[e+1]))<l){for(p=0;p<r;++p)h[p]=t[e+p];return h.length=r,c}return l}for(var d=u||[NaN,NaN],f=e+r;f<i;)if(Ze(t,f-r,f,r,s,a,d),(c=Yt(s,a,d[0],d[1]))<l){for(l=c,p=0;p<r;++p)h[p]=d[p];h.length=r,f+=r}else f+=r*Math.max((Math.sqrt(c)-Math.sqrt(l))/n|0,1);if(o&&(Ze(t,i-r,e,r,s,a,d),(c=Yt(s,a,d[0],d[1]))<l)){for(l=c,p=0;p<r;++p)h[p]=d[p];h.length=r}return l}function $e(t,e,i,r,n,o,s,a,h,l,u){for(var p=u||[NaN,NaN],c=0,d=i.length;c<d;++c){var f=i[c];l=Qe(t,e,f,r,n,o,s,a,h,l,p),e=f}return l}function ti(t,e,i,r){for(var n=0,o=i.length;n<o;++n)t[e++]=i[n];return e}function ei(t,e,i,r){for(var n=0,o=i.length;n<o;++n)for(var s=i[n],a=0;a<r;++a)t[e++]=s[a];return e}function ii(t,e,i,r,n){for(var o=n||[],s=0,a=0,h=i.length;a<h;++a){var l=ei(t,e,i[a],r);o[s++]=l,e=l}return o.length=s,o}function ri(t,e,i,r,n){for(var o=void 0!==n?n:[],s=0,a=e;a<i;a+=r)o[s++]=t.slice(a,a+r);return o.length=s,o}function ni(t,e,i,r,n){for(var o=void 0!==n?n:[],s=0,a=0,h=i.length;a<h;++a){var l=i[a];o[s++]=ri(t,e,l,r,o[s]),e=l}return o.length=s,o}function oi(t,e,i,r,n){for(var o=void 0!==n?n:[],s=0,a=0,h=i.length;a<h;++a){var l=i[a];o[s++]=ni(t,e,l,r,o[s]),e=l[l.length-1]}return o.length=s,o}function si(t,e,i,r,n,o,s){var a=(i-e)/r;if(a<3){for(;e<i;e+=r)o[s++]=t[e],o[s++]=t[e+1];return s}var h=new Array(a);h[0]=1,h[a-1]=1;for(var l=[e,i-r],u=0;l.length>0;){for(var p=l.pop(),c=l.pop(),d=0,f=t[c],_=t[c+1],g=t[p],y=t[p+1],v=c+r;v<p;v+=r){var m=Ut(t[v],t[v+1],f,_,g,y);m>d&&(u=v,d=m)}d>n&&(h[(u-e)/r]=1,c+r<u&&l.push(c,u),u+r<p&&l.push(u,p))}for(var x=0;x<a;++x)h[x]&&(o[s++]=t[e+x*r],o[s++]=t[e+x*r+1]);return s}function ai(t,e,i,r,n,o,s,a){for(var h=0,l=i.length;h<l;++h){var u=i[h];s=si(t,e,u,r,n,o,s),a.push(s),e=u}return s}function hi(t,e){return e*Math.round(t/e)}function li(t,e,i,r,n,o,s){if(e==i)return s;var a,h,l=hi(t[e],n),u=hi(t[e+1],n);e+=r,o[s++]=l,o[s++]=u;do{if(a=hi(t[e],n),h=hi(t[e+1],n),(e+=r)==i)return o[s++]=a,o[s++]=h,s}while(a==l&&h==u);for(;e<i;){var p=hi(t[e],n),c=hi(t[e+1],n);if(e+=r,p!=a||c!=h){var d=a-l,f=h-u,_=p-l,g=c-u;d*g==f*_&&(d<0&&_<d||d==_||d>0&&_>d)&&(f<0&&g<f||f==g||f>0&&g>f)?(a=p,h=c):(o[s++]=a,o[s++]=h,l=a,u=h,a=p,h=c)}}return o[s++]=a,o[s++]=h,s}function ui(t,e,i,r,n,o,s,a){for(var h=0,l=i.length;h<l;++h){var u=i[h];s=li(t,e,u,r,n,o,s),a.push(s),e=u}return s}var pi=function(t){function e(e,i){t.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,r){return r<rt(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Qe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,r))},e.prototype.getArea=function(){return Ke(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return ri(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=si(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,At.XY)},e.prototype.getType=function(){return Nt.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ei(this.flatCoordinates,0,t,this.stride),this.changed()},e}(We),ci=function(t){function e(e,i){t.call(this),this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,r){var n=this.flatCoordinates,o=Yt(t,e,n[0],n[1]);if(o<r){for(var s=this.stride,a=0;a<s;++a)i[a]=n[a];return i.length=s,o}return r},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return pt(this.flatCoordinates,t)},e.prototype.getType=function(){return Nt.POINT},e.prototype.intersectsExtent=function(t){return st(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ti(this.flatCoordinates,0,t,this.stride),this.changed()},e}(We);function di(t,e,i,r,n){return!mt(n,function(n){return!fi(t,e,i,r,n[0],n[1])})}function fi(t,e,i,r,n,o){for(var s=0,a=t[i-r],h=t[i-r+1];e<i;e+=r){var l=t[e],u=t[e+1];h<=o?u>o&&(l-a)*(o-h)-(n-a)*(u-h)>0&&s++:u<=o&&(l-a)*(o-h)-(n-a)*(u-h)<0&&s--,a=l,h=u}return 0!==s}function _i(t,e,i,r,n,o){if(0===i.length)return!1;if(!fi(t,e,i[0],r,n,o))return!1;for(var s=1,a=i.length;s<a;++s)if(fi(t,i[s-1],i[s],r,n,o))return!1;return!0}function gi(t,e,i,r,n,o,s){for(var a,h,l,u,p,c,d,f=n[o+1],_=[],g=0,y=i.length;g<y;++g){var v=i[g];for(u=t[v-r],c=t[v-r+1],a=e;a<v;a+=r)p=t[a],d=t[a+1],(f<=c&&d<=f||c<=f&&f<=d)&&(l=(f-c)/(d-c)*(p-u)+u,_.push(l)),u=p,c=d}var m=NaN,x=-1/0;for(_.sort(V),u=_[0],a=1,h=_.length;a<h;++a){p=_[a];var E=Math.abs(p-u);E>x&&_i(t,e,i,r,l=(u+p)/2,f)&&(m=l,x=E),u=p}return isNaN(m)&&(m=n[o]),s?(s.push(m,f,x),s):[m,f,x]}function yi(t,e,i,r,n){for(var o=[],s=0,a=i.length;s<a;++s){var h=i[s];o=gi(t,e,h,r,n,2*s,o),e=h[h.length-1]}return o}function vi(t,e,i,r,n,o){for(var s,a=[t[e],t[e+1]],h=[];e+r<i;e+=r){if(h[0]=t[e+r],h[1]=t[e+r+1],s=n.call(o,a,h))return s;a[0]=h[0],a[1]=h[1]}return!1}function mi(t,e,i,r,n){var o=yt([1/0,1/0,-1/0,-1/0],t,e,i,r);return!!Pt(n,o)&&(!!ot(n,o)||(o[0]>=n[0]&&o[2]<=n[2]||(o[1]>=n[1]&&o[3]<=n[3]||vi(t,e,i,r,function(t,e){return function(t,e,i){var r=!1,n=at(t,e),o=at(t,i);if(n===$.INTERSECTING||o===$.INTERSECTING)r=!0;else{var s,a,h=t[0],l=t[1],u=t[2],p=t[3],c=e[0],d=e[1],f=i[0],_=i[1],g=(_-d)/(f-c);o&$.ABOVE&&!(n&$.ABOVE)&&(r=(s=f-(_-p)/g)>=h&&s<=u),r||!(o&$.RIGHT)||n&$.RIGHT||(r=(a=_-(f-u)*g)>=l&&a<=p),r||!(o&$.BELOW)||n&$.BELOW||(r=(s=f-(_-l)/g)>=h&&s<=u),r||!(o&$.LEFT)||n&$.LEFT||(r=(a=_-(f-h)*g)>=l&&a<=p)}return r}(n,t,e)}))))}function xi(t,e,i,r,n){if(!function(t,e,i,r,n){return!!(mi(t,e,i,r,n)||fi(t,e,i,r,n[0],n[1])||fi(t,e,i,r,n[0],n[3])||fi(t,e,i,r,n[2],n[1])||fi(t,e,i,r,n[2],n[3]))}(t,e,i[0],r,n))return!1;if(1===i.length)return!0;for(var o=1,s=i.length;o<s;++o)if(di(t,i[o-1],i[o],r,n)&&!mi(t,i[o-1],i[o],r,n))return!1;return!0}function Ei(t,e,i,r){for(;e<i-r;){for(var n=0;n<r;++n){var o=t[e+n];t[e+n]=t[i-r+n],t[i-r+n]=o}e+=r,i-=r}}function Si(t,e,i,r){for(var n=0,o=t[i-r],s=t[i-r+1];e<i;e+=r){var a=t[e],h=t[e+1];n+=(a-o)*(h+s),o=a,s=h}return n>0}function Ti(t,e,i,r,n){for(var o=void 0!==n&&n,s=0,a=i.length;s<a;++s){var h=i[s],l=Si(t,e,h,r);if(0===s){if(o&&l||!o&&!l)return!1}else if(o&&!l||!o&&l)return!1;e=h}return!0}function Ci(t,e,i,r,n){for(var o=void 0!==n&&n,s=0,a=i.length;s<a;++s){var h=i[s],l=Si(t,e,h,r);(0===s?o&&l||!o&&!l:o&&!l||!o&&l)&&Ei(t,e,h,r),e=h}return e}function Ri(t,e,i,r,n){for(var o=0,s=i.length;o<s;++o)e=Ci(t,e,i[o],r,n);return e}var wi=function(t){function e(e,i,r){t.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==i&&r?(this.setFlatCoordinates(i,e),this.ends_=r):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLinearRing=function(t){this.flatCoordinates?K(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,r){return r<rt(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Je(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$e(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,r))},e.prototype.containsXY=function(t,e){return _i(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return He(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Ci(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,ni(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Tt(this.getExtent());this.flatInteriorPoint_=gi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new ci(this.getFlatInteriorPoint(),At.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new pi(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,r=[],n=0,o=0,s=i.length;o<s;++o){var a=i[o],h=new pi(e.slice(n,a),t);r.push(h),n=a}return r},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Ti(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ci(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=ui(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,r),new e(i,At.XY,r)},e.prototype.getType=function(){return Nt.POLYGON},e.prototype.intersectsExtent=function(t){return xi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=ii(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(We),Ii=wi;function Li(t,e,i,r){for(var n=i||32,o=[],s=0;s<n;++s)K(o,qt(t,e,2*Math.PI*s/n,r));return o.push(o[0],o[1]),new wi(o,At.XY,[o.length])}function Oi(t){var e=t[0],i=t[1],r=t[2],n=t[3],o=[e,i,e,n,r,n,r,i,e,i];return new wi(o,At.XY,[o.length])}function Pi(t,e,i){for(var r=e||32,n=t.getStride(),o=t.getLayout(),s=t.getCenter(),a=n*(r+1),h=new Array(a),l=0;l<a;l+=n){h[l]=0,h[l+1]=0;for(var u=2;u<n;u++)h[l+u]=s[u]}var p=[h.length],c=new wi(h,o,p);return bi(c,s,t.getRadius(),i),c}function bi(t,e,i,r){for(var n=t.getFlatCoordinates(),o=t.getStride(),s=n.length/o-1,a=r||0,h=0;h<=s;++h){var l=h*o,u=a+2*Xt(h,s)*Math.PI/s;n[l]=e[0]+i*Math.cos(u),n[l+1]=e[1]+i*Math.sin(u)}t.changed()}var Mi="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",Fi=-1!==Mi.indexOf("firefox"),Ai=-1!==Mi.indexOf("safari")&&-1==Mi.indexOf("chrom"),Ni=-1!==Mi.indexOf("webkit")&&-1==Mi.indexOf("edge"),Gi=-1!==Mi.indexOf("macintosh"),Di=window.devicePixelRatio||1,ki=function(){var t=!1;try{t=!!document.createElement("canvas").getContext("2d").setLineDash}catch(t){}return t}(),ji="geolocation"in navigator,Ui="ontouchstart"in window,Yi="PointerEvent"in window,Bi=!!navigator.msPointerEnabled,Vi={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},Xi=function(t){function e(e){t.call(this,M.ERROR),this.code=e.code,this.message=e.message}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),zi=function(t){function e(e){t.call(this);var i=e||{};this.position_=null,this.transform_=me,this.watchId_=void 0,v(this,G(Vi.PROJECTION),this.handleProjectionChanged_,this),v(this,G(Vi.TRACKING),this.handleTrackingChanged_,this),void 0!==i.projection&&this.setProjection(i.projection),void 0!==i.trackingOptions&&this.setTrackingOptions(i.trackingOptions),this.setTracking(void 0!==i.tracking&&i.tracking)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.setTracking(!1),t.prototype.disposeInternal.call(this)},e.prototype.handleProjectionChanged_=function(){var t=this.getProjection();t&&(this.transform_=Le(Ee("EPSG:4326"),t),this.position_&&this.set(Vi.POSITION,this.transform_(this.position_)))},e.prototype.handleTrackingChanged_=function(){if(ji){var t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},e.prototype.positionChange_=function(t){var e=t.coords;this.set(Vi.ACCURACY,e.accuracy),this.set(Vi.ALTITUDE,null===e.altitude?void 0:e.altitude),this.set(Vi.ALTITUDE_ACCURACY,null===e.altitudeAccuracy?void 0:e.altitudeAccuracy),this.set(Vi.HEADING,null===e.heading?void 0:Vt(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];var i=this.transform_(this.position_);this.set(Vi.POSITION,i),this.set(Vi.SPEED,null===e.speed?void 0:e.speed);var r=Li(this.position_,e.accuracy);r.applyTransform(this.transform_),this.set(Vi.ACCURACY_GEOMETRY,r),this.changed()},e.prototype.positionError_=function(t){this.setTracking(!1),this.dispatchEvent(new Xi(t))},e.prototype.getAccuracy=function(){return this.get(Vi.ACCURACY)},e.prototype.getAccuracyGeometry=function(){return this.get(Vi.ACCURACY_GEOMETRY)||null},e.prototype.getAltitude=function(){return this.get(Vi.ALTITUDE)},e.prototype.getAltitudeAccuracy=function(){return this.get(Vi.ALTITUDE_ACCURACY)},e.prototype.getHeading=function(){return this.get(Vi.HEADING)},e.prototype.getPosition=function(){return this.get(Vi.POSITION)},e.prototype.getProjection=function(){return this.get(Vi.PROJECTION)},e.prototype.getSpeed=function(){return this.get(Vi.SPEED)},e.prototype.getTracking=function(){return this.get(Vi.TRACKING)},e.prototype.getTrackingOptions=function(){return this.get(Vi.TRACKING_OPTIONS)},e.prototype.setProjection=function(t){this.set(Vi.PROJECTION,Ee(t))},e.prototype.setTracking=function(t){this.set(Vi.TRACKING,t)},e.prototype.setTrackingOptions=function(t){this.set(Vi.TRACKING_OPTIONS,t)},e}(D);function Wi(t,e,i){var r=void 0!==i?t.toFixed(i):""+t,n=r.indexOf(".");return(n=-1===n?r.length:n)>e?r:new Array(1+e-n).join("0")+r}function Ki(t,e){for(var i=(""+t).split("."),r=(""+e).split("."),n=0;n<Math.max(i.length,r.length);n++){var o=parseInt(i[n]||"0",10),s=parseInt(r[n]||"0",10);if(o>s)return 1;if(s>o)return-1}return 0}function Hi(t,e){return t[0]+=e[0],t[1]+=e[1],t}function Zi(t,e){var i,r,n=t[0],o=t[1],s=e[0],a=e[1],h=s[0],l=s[1],u=a[0],p=a[1],c=u-h,d=p-l,f=0===c&&0===d?0:(c*(n-h)+d*(o-l))/(c*c+d*d||0);return f<=0?(i=h,r=l):f>=1?(i=u,r=p):(i=h+f*c,r=l+f*d),[i,r]}function qi(t,e,i){var r=Xt(e+180,360)-180,n=Math.abs(3600*r),o=i||0,s=Math.pow(10,o),a=Math.floor(n/3600),h=Math.floor((n-3600*a)/60),l=n-3600*a-60*h;return(l=Math.ceil(l*s)/s)>=60&&(l=0,h+=1),h>=60&&(h=0,a+=1),a+"° "+Wi(h,2)+"′ "+Wi(l,2,o)+"″"+(0==r?"":" "+t.charAt(r<0?1:0))}function Ji(t,e,i){return t?e.replace("{x}",t[0].toFixed(i)).replace("{y}",t[1].toFixed(i)):""}function Qi(t,e){for(var i=!0,r=t.length-1;r>=0;--r)if(t[r]!=e[r]){i=!1;break}return i}function $i(t,e){var i=Math.cos(e),r=Math.sin(e),n=t[0]*i-t[1]*r,o=t[1]*i+t[0]*r;return t[0]=n,t[1]=o,t}function tr(t,e){return t[0]*=e,t[1]*=e,t}function er(t,e){var i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r}function ir(t,e){return Math.sqrt(er(t,e))}function rr(t,e){return er(t,Zi(t,e))}function nr(t,e){return Ji(t,"{x}, {y}",e)}function or(t,e,i,r,n,o){var s=NaN,a=NaN,h=(i-e)/r;if(1===h)s=t[e],a=t[e+1];else if(2==h)s=(1-n)*t[e]+n*t[e+r],a=(1-n)*t[e+1]+n*t[e+r+1];else if(0!==h){for(var l=t[e],u=t[e+1],p=0,c=[0],d=e+r;d<i;d+=r){var f=t[d],_=t[d+1];p+=Math.sqrt((f-l)*(f-l)+(_-u)*(_-u)),c.push(p),l=f,u=_}var g=n*p,y=function(t,e,i){for(var r,n,o=i||V,s=0,a=t.length,h=!1;s<a;)(n=+o(t[r=s+(a-s>>1)],e))<0?s=r+1:(a=r,h=!n);return h?s:~s}(c,g);if(y<0){var v=(g-c[-y-2])/(c[-y-1]-c[-y-2]),m=e+(-y-2)*r;s=zt(t[m],t[m+r],v),a=zt(t[m+1],t[m+r+1],v)}else s=t[e+y*r],a=t[e+y*r+1]}return o?(o[0]=s,o[1]=a,o):[s,a]}function sr(t,e,i,r,n,o){if(i==e)return null;var s;if(n<t[e+r-1])return o?((s=t.slice(e,e+r))[r-1]=n,s):null;if(t[i-1]<n)return o?((s=t.slice(i-r,i))[r-1]=n,s):null;if(n==t[e+r-1])return t.slice(e,e+r);for(var a=e/r,h=i/r;a<h;){var l=a+h>>1;n<t[(l+1)*r-1]?h=l:a=l+1}var u=t[a*r-1];if(n==u)return t.slice((a-1)*r,(a-1)*r+r);var p=(n-u)/(t[(a+1)*r-1]-u);s=[];for(var c=0;c<r-1;++c)s.push(zt(t[(a-1)*r+c],t[a*r+c],p));return s.push(n),s}function ar(t,e,i,r){for(var n=t[e],o=t[e+1],s=0,a=e+r;a<i;a+=r){var h=t[a],l=t[a+1];s+=Math.sqrt((h-n)*(h-n)+(l-o)*(l-o)),n=h,o=l}return s}var hr=function(t){function e(e,i){t.call(this),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendCoordinate=function(t){this.flatCoordinates?K(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,r){return r<rt(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Qe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,r))},e.prototype.forEachSegment=function(t){return vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=At.XYM&&this.layout!=At.XYZM)return null;var i=void 0!==e&&e;return sr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return ri(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return or(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return ar(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=si(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,At.XY)},e.prototype.getType=function(){return Nt.LINE_STRING},e.prototype.intersectsExtent=function(t){return mi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ei(this.flatCoordinates,0,t,this.stride),this.changed()},e}(We);function lr(t,e,i){for(var r,n,o,s,a,h,l=[],u=t(0),p=t(1),c=e(u),d=e(p),f=[p,u],_=[d,c],g=[1,0],y={},v=1e5;--v>0&&g.length>0;)o=g.pop(),u=f.pop(),c=_.pop(),(h=o.toString())in y||(l.push(c[0],c[1]),y[h]=!0),s=g.pop(),p=f.pop(),d=_.pop(),Ut((n=e(r=t(a=(o+s)/2)))[0],n[1],c[0],c[1],d[0],d[1])<i?(l.push(d[0],d[1]),y[h=s.toString()]=!0):(g.push(s,a,a,o),_.push(d,n,n,c),f.push(p,r,r,u));return l}var ur={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render",RENDERCOMPLETE:"rendercomplete"},pr=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,cr=/^([a-z]*)$/i;function dr(t){return"string"==typeof t?t:yr(t)}var fr=function(){var t={},e=0;return function(i){var r;if(t.hasOwnProperty(i))r=t[i];else{if(e>=1024){var n=0;for(var o in t)0==(3&n++)&&(delete t[o],--e)}r=function(t){var e,i,r,n,o;cr.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}return""}(t));if(pr.exec(t)){var s,a=t.length-1;s=a<=4?1:2;var h=4===a||8===a;e=parseInt(t.substr(1+0*s,s),16),i=parseInt(t.substr(1+1*s,s),16),r=parseInt(t.substr(1+2*s,s),16),n=h?parseInt(t.substr(1+3*s,s),16):255,1==s&&(e=(e<<4)+e,i=(i<<4)+i,r=(r<<4)+r,h&&(n=(n<<4)+n)),o=[e,i,r,n/255]}else 0==t.indexOf("rgba(")?gr(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),gr(o)):Y(!1,14);return o}(i),t[i]=r,++e}return r}}();function _r(t){return Array.isArray(t)?t:fr(t)}function gr(t){return t[0]=kt(t[0]+.5|0,0,255),t[1]=kt(t[1]+.5|0,0,255),t[2]=kt(t[2]+.5|0,0,255),t[3]=kt(t[3],0,1),t}function yr(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var r=t[2];return r!=(0|r)&&(r=r+.5|0),"rgba("+e+","+i+","+r+","+(void 0===t[3]?1:t[3])+")"}var vr=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};vr.prototype.clone=function(){var t=this.getColor();return new vr({color:Array.isArray(t)?t.slice():t||void 0})},vr.prototype.getColor=function(){return this.color_},vr.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},vr.prototype.getChecksum=function(){if(void 0===this.checksum_){var t=this.color_;t?Array.isArray(t)||"string"==typeof t?this.checksum_="f"+dr(t):this.checksum_=o(this.color_):this.checksum_="f-"}return this.checksum_};var mr=vr,xr=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};xr.prototype.clone=function(){var t=this.getColor();return new xr({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},xr.prototype.getColor=function(){return this.color_},xr.prototype.getLineCap=function(){return this.lineCap_},xr.prototype.getLineDash=function(){return this.lineDash_},xr.prototype.getLineDashOffset=function(){return this.lineDashOffset_},xr.prototype.getLineJoin=function(){return this.lineJoin_},xr.prototype.getMiterLimit=function(){return this.miterLimit_},xr.prototype.getWidth=function(){return this.width_},xr.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},xr.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},xr.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},xr.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},xr.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},xr.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},xr.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},xr.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=o(this.color_):this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};var Er=xr,Sr="point",Tr="line",Cr=function(t){var e=t||{};this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.text_=e.text,this.textAlign_=e.textAlign,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new mr({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:Sr,this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding};Cr.prototype.clone=function(){return new Cr({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0})},Cr.prototype.getOverflow=function(){return this.overflow_},Cr.prototype.getFont=function(){return this.font_},Cr.prototype.getMaxAngle=function(){return this.maxAngle_},Cr.prototype.getPlacement=function(){return this.placement_},Cr.prototype.getOffsetX=function(){return this.offsetX_},Cr.prototype.getOffsetY=function(){return this.offsetY_},Cr.prototype.getFill=function(){return this.fill_},Cr.prototype.getRotateWithView=function(){return this.rotateWithView_},Cr.prototype.getRotation=function(){return this.rotation_},Cr.prototype.getScale=function(){return this.scale_},Cr.prototype.getStroke=function(){return this.stroke_},Cr.prototype.getText=function(){return this.text_},Cr.prototype.getTextAlign=function(){return this.textAlign_},Cr.prototype.getTextBaseline=function(){return this.textBaseline_},Cr.prototype.getBackgroundFill=function(){return this.backgroundFill_},Cr.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},Cr.prototype.getPadding=function(){return this.padding_},Cr.prototype.setOverflow=function(t){this.overflow_=t},Cr.prototype.setFont=function(t){this.font_=t},Cr.prototype.setMaxAngle=function(t){this.maxAngle_=t},Cr.prototype.setOffsetX=function(t){this.offsetX_=t},Cr.prototype.setOffsetY=function(t){this.offsetY_=t},Cr.prototype.setPlacement=function(t){this.placement_=t},Cr.prototype.setFill=function(t){this.fill_=t},Cr.prototype.setRotation=function(t){this.rotation_=t},Cr.prototype.setScale=function(t){this.scale_=t},Cr.prototype.setStroke=function(t){this.stroke_=t},Cr.prototype.setText=function(t){this.text_=t},Cr.prototype.setTextAlign=function(t){this.textAlign_=t},Cr.prototype.setTextBaseline=function(t){this.textBaseline_=t},Cr.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},Cr.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},Cr.prototype.setPadding=function(t){this.padding_=t};var Rr=Cr,wr=new Er({color:"rgba(0,0,0,0.2)"}),Ir=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],Lr=function(t){var e=t||{};this.map_=null,this.postcomposeListenerKey_=null,this.projection_=null,this.maxLat_=1/0,this.maxLon_=1/0,this.minLat_=-1/0,this.minLon_=-1/0,this.maxLatP_=1/0,this.maxLonP_=1/0,this.minLatP_=-1/0,this.minLonP_=-1/0,this.targetSize_=void 0!==e.targetSize?e.targetSize:100,this.maxLines_=void 0!==e.maxLines?e.maxLines:100,this.meridians_=[],this.parallels_=[],this.strokeStyle_=void 0!==e.strokeStyle?e.strokeStyle:wr,this.fromLonLatTransform_=void 0,this.toLonLatTransform_=void 0,this.projectionCenterLonLat_=null,this.meridiansLabels_=null,this.parallelsLabels_=null,1==e.showLabels&&(this.lonLabelFormatter_=void 0==e.lonLabelFormatter?qi.bind(this,"EW"):e.lonLabelFormatter,this.latLabelFormatter_=void 0==e.latLabelFormatter?qi.bind(this,"NS"):e.latLabelFormatter,this.lonLabelPosition_=void 0==e.lonLabelPosition?0:e.lonLabelPosition,this.latLabelPosition_=void 0==e.latLabelPosition?1:e.latLabelPosition,this.lonLabelStyle_=void 0!==e.lonLabelStyle?e.lonLabelStyle:new Rr({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new mr({color:"rgba(0,0,0,1)"}),stroke:new Er({color:"rgba(255,255,255,1)",width:3})}),this.latLabelStyle_=void 0!==e.latLabelStyle?e.latLabelStyle:new Rr({font:"12px Calibri,sans-serif",textAlign:"end",fill:new mr({color:"rgba(0,0,0,1)"}),stroke:new Er({color:"rgba(255,255,255,1)",width:3})}),this.meridiansLabels_=[],this.parallelsLabels_=[]),this.intervals_=void 0!==e.intervals?e.intervals:Ir,this.setMap(void 0!==e.map?e.map:null)};Lr.prototype.addMeridian_=function(t,e,i,r,n,o){var s=this.getMeridian_(t,e,i,r,o);if(Pt(s.getExtent(),n)){if(this.meridiansLabels_){var a=this.getMeridianPoint_(s,n,o);this.meridiansLabels_[o]={geom:a,text:this.lonLabelFormatter_(t)}}this.meridians_[o++]=s}return o},Lr.prototype.getMeridianPoint_=function(t,e,i){var r,n=t.getFlatCoordinates(),o=Math.max(e[1],n[1]),s=Math.min(e[3],n[n.length-1]),a=kt(e[1]+Math.abs(e[1]-e[3])*this.lonLabelPosition_,o,s),h=[n[0],a];return i in this.meridiansLabels_?(r=this.meridiansLabels_[i].geom).setCoordinates(h):r=new ci(h),r},Lr.prototype.addParallel_=function(t,e,i,r,n,o){var s=this.getParallel_(t,e,i,r,o);if(Pt(s.getExtent(),n)){if(this.parallelsLabels_){var a=this.getParallelPoint_(s,n,o);this.parallelsLabels_[o]={geom:a,text:this.latLabelFormatter_(t)}}this.parallels_[o++]=s}return o},Lr.prototype.getParallelPoint_=function(t,e,i){var r,n=t.getFlatCoordinates(),o=Math.max(e[0],n[0]),s=Math.min(e[2],n[n.length-2]),a=[kt(e[0]+Math.abs(e[0]-e[2])*this.latLabelPosition_,o,s),n[1]];return i in this.parallelsLabels_?(r=this.parallelsLabels_[i].geom).setCoordinates(a):r=new ci(a),r},Lr.prototype.createGraticule_=function(t,e,i,r){var n=this.getInterval_(i);if(-1==n)return this.meridians_.length=this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var o,s,a,h,l=this.toLonLatTransform_(e),u=l[0],p=l[1],c=this.maxLines_,d=[Math.max(t[0],this.minLonP_),Math.max(t[1],this.minLatP_),Math.min(t[2],this.maxLonP_),Math.min(t[3],this.maxLatP_)],f=(d=be(d,this.projection_,"EPSG:4326"))[3],_=d[2],g=d[1],y=d[0];for(h=kt(u=Math.floor(u/n)*n,this.minLon_,this.maxLon_),s=this.addMeridian_(h,g,f,r,t,0),o=0;h!=this.minLon_&&o++<c;)h=Math.max(h-n,this.minLon_),s=this.addMeridian_(h,g,f,r,t,s);for(h=kt(u,this.minLon_,this.maxLon_),o=0;h!=this.maxLon_&&o++<c;)h=Math.min(h+n,this.maxLon_),s=this.addMeridian_(h,g,f,r,t,s);for(this.meridians_.length=s,this.meridiansLabels_&&(this.meridiansLabels_.length=s),a=kt(p=Math.floor(p/n)*n,this.minLat_,this.maxLat_),s=this.addParallel_(a,y,_,r,t,0),o=0;a!=this.minLat_&&o++<c;)a=Math.max(a-n,this.minLat_),s=this.addParallel_(a,y,_,r,t,s);for(a=kt(p,this.minLat_,this.maxLat_),o=0;a!=this.maxLat_&&o++<c;)a=Math.min(a+n,this.maxLat_),s=this.addParallel_(a,y,_,r,t,s);this.parallels_.length=s,this.parallelsLabels_&&(this.parallelsLabels_.length=s)},Lr.prototype.getInterval_=function(t){for(var e=this.projectionCenterLonLat_[0],i=this.projectionCenterLonLat_[1],r=-1,n=Math.pow(this.targetSize_*t,2),o=[],s=[],a=0,h=this.intervals_.length;a<h;++a){var l=this.intervals_[a]/2;if(o[0]=e-l,o[1]=i-l,s[0]=e+l,s[1]=i+l,this.fromLonLatTransform_(o,o),this.fromLonLatTransform_(s,s),Math.pow(s[0]-o[0],2)+Math.pow(s[1]-o[1],2)<=n)break;r=this.intervals_[a]}return r},Lr.prototype.getMap=function(){return this.map_},Lr.prototype.getMeridian_=function(t,e,i,r,n){var o=function(t,e,i,r,n){return lr(function(r){return[t,e+(i-e)*r]},Oe(Ee("EPSG:4326"),r),n)}(t,e,i,this.projection_,r),s=this.meridians_[n];return s?(s.setFlatCoordinates(At.XY,o),s.changed()):s=this.meridians_[n]=new hr(o,At.XY),s},Lr.prototype.getMeridians=function(){return this.meridians_},Lr.prototype.getParallel_=function(t,e,i,r,n){var o=function(t,e,i,r,n){return lr(function(r){return[e+(i-e)*r,t]},Oe(Ee("EPSG:4326"),r),n)}(t,e,i,this.projection_,r),s=this.parallels_[n];return s?(s.setFlatCoordinates(At.XY,o),s.changed()):s=new hr(o,At.XY),s},Lr.prototype.getParallels=function(){return this.parallels_},Lr.prototype.handlePostCompose_=function(t){var e,i,r,n,o=t.vectorContext,s=t.frameState,a=s.extent,h=s.viewState,l=h.center,u=h.projection,p=h.resolution,c=s.pixelRatio,d=p*p/(4*c*c);for((!this.projection_||!Ie(this.projection_,u))&&this.updateProjectionInfo_(u),this.createGraticule_(a,l,p,d),o.setFillStrokeStyle(null,this.strokeStyle_),e=0,i=this.meridians_.length;e<i;++e)r=this.meridians_[e],o.drawGeometry(r);for(e=0,i=this.parallels_.length;e<i;++e)r=this.parallels_[e],o.drawGeometry(r);if(this.meridiansLabels_)for(e=0,i=this.meridiansLabels_.length;e<i;++e)n=this.meridiansLabels_[e],this.lonLabelStyle_.setText(n.text),o.setTextStyle(this.lonLabelStyle_),o.drawGeometry(n.geom);if(this.parallelsLabels_)for(e=0,i=this.parallelsLabels_.length;e<i;++e)n=this.parallelsLabels_[e],this.latLabelStyle_.setText(n.text),o.setTextStyle(this.latLabelStyle_),o.drawGeometry(n.geom)},Lr.prototype.updateProjectionInfo_=function(t){var e=Ee("EPSG:4326"),i=t.getWorldExtent(),r=be(i,e,t);this.maxLat_=i[3],this.maxLon_=i[2],this.minLat_=i[1],this.minLon_=i[0],this.maxLatP_=r[3],this.maxLonP_=r[2],this.minLatP_=r[1],this.minLonP_=r[0],this.fromLonLatTransform_=Oe(e,t),this.toLonLatTransform_=Oe(t,e),this.projectionCenterLonLat_=this.toLonLatTransform_(Tt(t.getExtent())),this.projection_=t},Lr.prototype.setMap=function(t){this.map_&&(E(this.postcomposeListenerKey_),this.postcomposeListenerKey_=null,this.map_.render()),t&&(this.postcomposeListenerKey_=v(t,ur.POSTCOMPOSE,this.handlePostCompose_,this),t.render()),this.map_=t};var Or=Lr,Pr=function(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0};Pr.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},Pr.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},Pr.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var r=this.points_[e+2]-this.points_[i+2];if(r<1e3/60)return!1;var n=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,n),this.initialVelocity_=Math.sqrt(n*n+o*o)/r,this.initialVelocity_>this.minVelocity_},Pr.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},Pr.prototype.getAngle=function(){return this.angle_};var br=Pr,Mr=function(t){function e(e,i,r){t.call(this,e),this.map=i,this.frameState=void 0!==r?r:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),Fr=function(t){function e(e,i,r,n,o){t.call(this,e,i,o),this.originalEvent=r,this.pixel=i.getEventPixel(r),this.coordinate=i.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==n&&n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Mr),Ar={SINGLECLICK:"singleclick",CLICK:M.CLICK,DBLCLICK:M.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Nr=function(t){function e(e,i,r,n,o){t.call(this,e,i,r.originalEvent,n,o),this.pointerEvent=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Fr),Gr={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Dr=function(t,e){this.dispatcher=t,this.mapping_=e};Dr.prototype.getEvents=function(){return Object.keys(this.mapping_)},Dr.prototype.getHandlerForEvent=function(t){return this.mapping_[t]};var kr=Dr,jr=1,Ur="mouse";function Yr(t){if(!this.isEventSimulatedFromTouch_(t)){jr.toString()in this.pointerMap&&this.cancel(t);var e=Wr(t,this.dispatcher);this.pointerMap[jr.toString()]=t,this.dispatcher.down(e,t)}}function Br(t){if(!this.isEventSimulatedFromTouch_(t)){var e=Wr(t,this.dispatcher);this.dispatcher.move(e,t)}}function Vr(t){if(!this.isEventSimulatedFromTouch_(t)){var e=this.pointerMap[jr.toString()];if(e&&e.button===t.button){var i=Wr(t,this.dispatcher);this.dispatcher.up(i,t),this.cleanupMouse()}}}function Xr(t){if(!this.isEventSimulatedFromTouch_(t)){var e=Wr(t,this.dispatcher);this.dispatcher.enterOver(e,t)}}function zr(t){if(!this.isEventSimulatedFromTouch_(t)){var e=Wr(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}}function Wr(t,e){var i=e.cloneEvent(t,t),r=i.preventDefault;return i.preventDefault=function(){t.preventDefault(),r()},i.pointerId=jr,i.isPrimary=!0,i.pointerType=Ur,i}var Kr=function(t){function e(e){var i={mousedown:Yr,mousemove:Br,mouseup:Vr,mouseover:Xr,mouseout:zr};t.call(this,e,i),this.pointerMap=e.pointerMap,this.lastTouches=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isEventSimulatedFromTouch_=function(t){for(var e=this.lastTouches,i=t.clientX,r=t.clientY,n=0,o=e.length,s=void 0;n<o&&(s=e[n]);n++){var a=Math.abs(i-s[0]),h=Math.abs(r-s[1]);if(a<=25&&h<=25)return!0}return!1},e.prototype.cancel=function(t){var e=Wr(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},e.prototype.cleanupMouse=function(){delete this.pointerMap[jr.toString()]},e}(kr),Hr=["","unavailable","touch","pen","mouse"];function Zr(t){this.pointerMap[t.pointerId.toString()]=t;var e=this.prepareEvent_(t);this.dispatcher.down(e,t)}function qr(t){var e=this.prepareEvent_(t);this.dispatcher.move(e,t)}function Jr(t){var e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)}function Qr(t){var e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)}function $r(t){var e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)}function tn(t){var e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)}function en(t){var e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)}function rn(t){var e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)}var nn=function(t){function e(e){var i={MSPointerDown:Zr,MSPointerMove:qr,MSPointerUp:Jr,MSPointerOut:Qr,MSPointerOver:$r,MSPointerCancel:tn,MSGotPointerCapture:rn,MSLostPointerCapture:en};t.call(this,e,i),this.pointerMap=e.pointerMap}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvent_=function(t){var e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=Hr[t.pointerType]),e},e.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},e}(kr);function on(t){this.dispatcher.fireNativeEvent(t)}function sn(t){this.dispatcher.fireNativeEvent(t)}function an(t){this.dispatcher.fireNativeEvent(t)}function hn(t){this.dispatcher.fireNativeEvent(t)}function ln(t){this.dispatcher.fireNativeEvent(t)}function un(t){this.dispatcher.fireNativeEvent(t)}function pn(t){this.dispatcher.fireNativeEvent(t)}function cn(t){this.dispatcher.fireNativeEvent(t)}var dn=function(t){function e(e){var i={pointerdown:on,pointermove:sn,pointerup:an,pointerout:hn,pointerover:ln,pointercancel:un,gotpointercapture:cn,lostpointercapture:pn};t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(kr),fn=!1,_n=function(t){function e(e,i,r){t.call(this,e),this.originalEvent=i;var n=r||{};this.buttons=function(t){var e;if(t.buttons||fn)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e}(n),this.pressure=function(t,e){var i=0;i=t.pressure?t.pressure:e?.5:0;return i}(n,this.buttons),this.bubbles="bubbles"in n&&n.bubbles,this.cancelable="cancelable"in n&&n.cancelable,this.view="view"in n?n.view:null,this.detail="detail"in n?n.detail:null,this.screenX="screenX"in n?n.screenX:0,this.screenY="screenY"in n?n.screenY:0,this.clientX="clientX"in n?n.clientX:0,this.clientY="clientY"in n?n.clientY:0,this.ctrlKey="ctrlKey"in n&&n.ctrlKey,this.altKey="altKey"in n&&n.altKey,this.shiftKey="shiftKey"in n&&n.shiftKey,this.metaKey="metaKey"in n&&n.metaKey,this.button="button"in n?n.button:0,this.relatedTarget="relatedTarget"in n?n.relatedTarget:null,this.pointerId="pointerId"in n?n.pointerId:0,this.width="width"in n?n.width:0,this.height="height"in n?n.height:0,this.tiltX="tiltX"in n?n.tiltX:0,this.tiltY="tiltY"in n?n.tiltY:0,this.pointerType="pointerType"in n?n.pointerType:"",this.hwTimestamp="hwTimestamp"in n?n.hwTimestamp:0,this.isPrimary="isPrimary"in n&&n.isPrimary,i.preventDefault&&(this.preventDefault=function(){i.preventDefault()})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P);!function(){try{var t=new MouseEvent("click",{buttons:1});fn=1===t.buttons}catch(t){}}();var gn=_n;function yn(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)}function vn(t){this.processTouches_(t,this.moveOverOut_)}function mn(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)}function xn(t){this.processTouches_(t,this.cancelOut_)}var En=function(t){function e(e,i){var r={touchstart:yn,touchmove:vn,touchend:mn,touchcancel:xn};t.call(this,e,r),this.pointerMap=e.pointerMap,this.mouseSource=i,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_,this.dedupTimeout_=2500}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},e.prototype.setPrimaryTouch_=function(t){var e=Object.keys(this.pointerMap).length;(0===e||1===e&&jr.toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},e.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},e.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),200)},e.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},e.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},e.prototype.touchToPointer_=function(t,e){var i=this.dispatcher.cloneEvent(t,e);return i.pointerId=e.identifier+2,i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount_,i.button=0,i.buttons=1,i.width=e.radiusX||0,i.height=e.radiusY||0,i.pressure=e.force||.5,i.isPrimary=this.isPrimaryTouch_(e),i.pointerType="touch",i.clientX=e.clientX,i.clientY=e.clientY,i.screenX=e.screenX,i.screenY=e.screenY,i},e.prototype.processTouches_=function(t,e){var i=Array.prototype.slice.call(t.changedTouches),r=i.length;function n(){t.preventDefault()}for(var o=0;o<r;++o){var s=this.touchToPointer_(t,i[o]);s.preventDefault=n,e.call(this,t,s)}},e.prototype.findTouch_=function(t,e){for(var i=t.length,r=0;r<i;r++){if(t[r].identifier===e)return!0}return!1},e.prototype.vacuumTouches_=function(t){var e=t.touches,i=Object.keys(this.pointerMap),r=i.length;if(r>=e.length){for(var n=[],o=0;o<r;++o){var s=Number(i[o]),a=this.pointerMap[s];s==jr||this.findTouch_(e,s-2)||n.push(a.out)}for(var h=0;h<n.length;++h)this.cancelOut_(t,n[h])}},e.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},e.prototype.moveOverOut_=function(t,e){var i=e,r=this.pointerMap[i.pointerId];if(r){var n=r.out,o=r.outTarget;this.dispatcher.move(i,t),n&&o!==i.target&&(n.relatedTarget=i.target,i.relatedTarget=o,n.target=o,i.target?(this.dispatcher.leaveOut(n,t),this.dispatcher.enterOver(i,t)):(i.target=o,i.relatedTarget=null,this.cancelOut_(t,i))),r.out=i,r.outTarget=i.target}},e.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},e.prototype.dedupSynthMouse_=function(t){var e=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){var r=[i.clientX,i.clientY];e.push(r),setTimeout(function(){!function(t,e){var i=t.indexOf(e),r=i>-1;r&&t.splice(i,1)}(e,r)},this.dedupTimeout_)}},e}(kr),Sn=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]],Tn=function(t){function e(e){t.call(this),this.element_=e,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.registerSources=function(){if(Yi)this.registerSource("native",new dn(this));else if(Bi)this.registerSource("ms",new nn(this));else{var t=new Kr(this);this.registerSource("mouse",t),Ui&&this.registerSource("touch",new En(this,t))}this.register_()},e.prototype.registerSource=function(t,e){var i=e,r=i.getEvents();r&&(r.forEach(function(t){var e=i.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(i))}.bind(this)),this.eventSourceList_.push(i))},e.prototype.register_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.addEvents_(i.getEvents())}},e.prototype.unregister_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.removeEvents_(i.getEvents())}},e.prototype.eventHandler_=function(t){var e=t.type,i=this.eventMap_[e];i&&i(t)},e.prototype.addEvents_=function(t){t.forEach(function(t){v(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.removeEvents_=function(t){t.forEach(function(t){x(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.cloneEvent=function(t,e){for(var i={},r=0,n=Sn.length;r<n;r++){var o=Sn[r][0];i[o]=t[o]||e[o]||Sn[r][1]}return i},e.prototype.down=function(t,e){this.fireEvent(Gr.POINTERDOWN,t,e)},e.prototype.move=function(t,e){this.fireEvent(Gr.POINTERMOVE,t,e)},e.prototype.up=function(t,e){this.fireEvent(Gr.POINTERUP,t,e)},e.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(Gr.POINTERENTER,t,e)},e.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(Gr.POINTERLEAVE,t,e)},e.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(Gr.POINTEROVER,t,e)},e.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(Gr.POINTEROUT,t,e)},e.prototype.cancel=function(t,e){this.fireEvent(Gr.POINTERCANCEL,t,e)},e.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},e.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},e.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},e.prototype.makeEvent=function(t,e,i){return new gn(t,i,e)},e.prototype.fireEvent=function(t,e,i){var r=this.makeEvent(t,e,i);this.dispatchEvent(r)},e.prototype.fireNativeEvent=function(t){var e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},e.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,Wr(e,this),e)},e.prototype.disposeInternal=function(){this.unregister_(),t.prototype.disposeInternal.call(this)},e}(b),Cn=function(t){function e(e,i){t.call(this),this.map_=e,this.clickTimeoutId_,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=i?i*Di:Di,this.down_=null;var r=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new Tn(r),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=v(this.pointerEventHandler_,Gr.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=v(this.pointerEventHandler_,Gr.POINTERMOVE,this.relayEvent_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emulateClick_=function(t){var e=new Nr(Ar.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Nr(Ar.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new Nr(Ar.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==Ar.POINTERUP||e.type==Ar.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==Ar.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Nr(Ar.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(E),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new Nr(Ar.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new Tn(document),this.dragListenerKeys_.push(v(this.documentPointerEventHandler_,Ar.POINTERMOVE,this.handlePointerMove_,this),v(this.documentPointerEventHandler_,Ar.POINTERUP,this.handlePointerUp_,this),v(this.pointerEventHandler_,Ar.POINTERCANCEL,this.handlePointerUp_,this)))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new Nr(Ar.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},e.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Nr(t.type,this.map_,t,e))},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(E(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(E(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(E),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),t.prototype.disposeInternal.call(this)},e}(b),Rn="postrender",wn="movestart",In="moveend",Ln={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},On={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5},Pn=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}};Pn.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,p(this.queuedElements_)},Pn.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var r=this.keyFunction_(i);return delete this.queuedElements_[r],i},Pn.prototype.enqueue=function(t){Y(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},Pn.prototype.getCount=function(){return this.elements_.length},Pn.prototype.getLeftChildIndex_=function(t){return 2*t+1},Pn.prototype.getRightChildIndex_=function(t){return 2*t+2},Pn.prototype.getParentIndex_=function(t){return t-1>>1},Pn.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},Pn.prototype.isEmpty=function(){return 0===this.elements_.length},Pn.prototype.isKeyQueued=function(t){return t in this.queuedElements_},Pn.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},Pn.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,r=e.length,n=e[t],o=i[t],s=t;t<r>>1;){var a=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),l=h<r&&i[h]<i[a]?h:a;e[t]=e[l],i[t]=i[l],t=l}e[t]=n,i[t]=o,this.siftDown_(s,t)},Pn.prototype.siftDown_=function(t,e){for(var i=this.elements_,r=this.priorities_,n=i[e],o=r[e];e>t;){var s=this.getParentIndex_(e);if(!(r[s]>o))break;i[e]=i[s],r[e]=r[s],e=s}i[e]=n,r[e]=o},Pn.prototype.reprioritize=function(){var t,e,i,r=this.priorityFunction_,n=this.elements_,o=this.priorities_,s=0,a=n.length;for(e=0;e<a;++e)(i=r(t=n[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(o[s]=i,n[s++]=t);n.length=s,o.length=s,this.heapify_()};var bn=Pn,Mn=function(t){function e(e,i){t.call(this,function(t){return e.apply(null,t)},function(t){return t[0].getKey()}),this.tileChangeCallback_=i,this.tilesLoading_=0,this.tilesLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);i&&v(e[0],M.CHANGE,this.handleTileChange,this);return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(i===On.LOADED||i===On.ERROR||i===On.EMPTY||i===On.ABORT){x(e,M.CHANGE,this.handleTileChange,this);var r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,r,n,o=0,s=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)n=(r=this.dequeue()[0]).getKey(),(i=r.getState())===On.ABORT?s=!0:i!==On.IDLE||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++o,r.load());0===o&&s&&this.tileChangeCallback_()},e}(bn),Fn=42,An=256;function Nn(t){return t}function Gn(t,e){return void 0!==t?0:void 0}function Dn(t,e){return void 0!==t?t+e:void 0}var kn=0,jn=1,Un="center",Yn="resolution",Bn="rotation";function Vn(t){return Math.pow(t,3)}function Xn(t){return 1-Vn(1-t)}function zn(t){return 3*t*t-2*t*t*t}function Wn(t){return t}var Kn=0;function Hn(t,e){setTimeout(function(){t(e)},0)}function Zn(t){return!(t.sourceCenter&&t.targetCenter&&!Qi(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}var qn=function(t){function e(e){t.call(this);var i=u({},e);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=Ce(i.projection,"EPSG:3857"),this.applyOptions_(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.applyOptions_=function(t){var e={};e[Un]=void 0!==t.center?t.center:null;var i=function(t){var e,i,r,n=void 0!==t.minZoom?t.minZoom:Kn,o=void 0!==t.maxZoom?t.maxZoom:28,s=void 0!==t.zoomFactor?t.zoomFactor:2;if(void 0!==t.resolutions){var a=t.resolutions;i=a[n],r=void 0!==a[o]?a[o]:a[a.length-1],e=function(t){return function(e,i,r){if(void 0!==e){var n=z(t,e,r);n=kt(n+i,0,t.length-1);var o=Math.floor(n);if(n!=o&&o<t.length-1){var s=t[o]/t[o+1];return t[o]/Math.pow(s,n-o)}return t[o]}}}(a)}else{var h=Ce(t.projection,"EPSG:3857"),l=h.getExtent(),u=l?Math.max(Ot(l),Rt(l)):360*Qt[$t.DEGREES]/h.getMetersPerUnit(),p=u/An/Math.pow(2,Kn),c=p/Math.pow(2,28-Kn);void 0!==(i=t.maxResolution)?n=0:i=p/Math.pow(s,n),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(s,o):p/Math.pow(s,o):c),o=n+Math.floor(Math.log(i/r)/Math.log(s)),r=i/Math.pow(s,o-n),e=function(t,e,i){return function(r,n,o){if(void 0!==r){var s=-o/2+.5,a=Math.floor(Math.log(e/r)/Math.log(t)+s),h=Math.max(a+n,0);return void 0!==i&&(h=Math.min(h,i)),e/Math.pow(t,h)}}}(s,i,o-n)}return{constraint:e,maxResolution:i,minResolution:r,minZoom:n,zoomFactor:s}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=i.minZoom;var r=function(t){return void 0!==t.extent?function(t){return function(e){return e?[kt(e[0],t[0],t[2]),kt(e[1],t[1],t[3])]:void 0}}(t.extent):Nn}(t),n=i.constraint,o=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?function(t){var e=t||Vt(5);return function(t,i){return void 0!==t?Math.abs(t+i)<=e?0:t+i:void 0}}():!1===e?Dn:"number"==typeof e?function(t){var e=2*Math.PI/t;return function(t,i){return void 0!==t?t=Math.floor((t+i)/e+.5)*e:void 0}}(e):Dn}return Gn}(t);this.constraints_={center:r,resolution:n,rotation:o},void 0!==t.resolution?e[Yn]=t.resolution:void 0!==t.zoom&&(e[Yn]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(e[Yn]=kt(Number(this.getResolution()||e[Yn]),this.minResolution_,this.maxResolution_))),e[Bn]=void 0!==t.rotation?t.rotation:0,this.setProperties(e),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=u({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenter(),e.rotation=this.getRotation(),u({},e,t)},e.prototype.animate=function(t){var e,i=arguments,r=arguments.length;if(r>1&&"function"==typeof arguments[r-1]&&(e=arguments[r-1],--r),!this.isDef()){var n=arguments[r-1];return n.center&&this.setCenter(n.center),void 0!==n.zoom&&this.setZoom(n.zoom),void 0!==n.rotation&&this.setRotation(n.rotation),void(e&&Hn(e,!0))}for(var o=Date.now(),s=this.getCenter().slice(),a=this.getResolution(),h=this.getRotation(),l=[],u=0;u<r;++u){var p=i[u],c={start:o,complete:!1,anchor:p.anchor,duration:void 0!==p.duration?p.duration:1e3,easing:p.easing||zn};if(p.center&&(c.sourceCenter=s,c.targetCenter=p.center,s=c.targetCenter),void 0!==p.zoom?(c.sourceResolution=a,c.targetResolution=this.constrainResolution(this.maxResolution_,p.zoom-this.minZoom_,0),a=c.targetResolution):p.resolution&&(c.sourceResolution=a,c.targetResolution=p.resolution,a=c.targetResolution),void 0!==p.rotation){c.sourceRotation=h;var d=Xt(p.rotation-h+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=h+d,h=c.targetRotation}c.callback=e,Zn(c)?c.complete=!0:o+=c.duration,l.push(c)}this.animations_.push(l),this.setHint(kn,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[kn]>0},e.prototype.getInteracting=function(){return this.hints_[jn]>0},e.prototype.cancelAnimations=function(){this.setHint(kn,-this.hints_[kn]);for(var t=0,e=this.animations_.length;t<e;++t){var i=this.animations_[t];i[0].callback&&Hn(i[0].callback,!1)}this.animations_.length=0},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;i>=0;--i){for(var r=this.animations_[i],n=!0,o=0,s=r.length;o<s;++o){var a=r[o];if(!a.complete){var h=t-a.start,l=a.duration>0?h/a.duration:1;l>=1?(a.complete=!0,l=1):n=!1;var u=a.easing(l);if(a.sourceCenter){var p=a.sourceCenter[0],c=a.sourceCenter[1],d=p+u*(a.targetCenter[0]-p),f=c+u*(a.targetCenter[1]-c);this.set(Un,[d,f])}if(a.sourceResolution&&a.targetResolution){var _=1===u?a.targetResolution:a.sourceResolution+u*(a.targetResolution-a.sourceResolution);a.anchor&&this.set(Un,this.calculateCenterZoom(_,a.anchor)),this.set(Yn,_)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var g=1===u?Xt(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+u*(a.targetRotation-a.sourceRotation);a.anchor&&this.set(Un,this.calculateCenterRotate(g,a.anchor)),this.set(Bn,g)}if(e=!0,!a.complete)break}}if(n){this.animations_[i]=null,this.setHint(kn,-1);var y=r[0].callback;y&&Hn(y,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},e.prototype.calculateCenterRotate=function(t,e){var i,r=this.getCenter();return void 0!==r&&($i(i=[r[0]-e[0],r[1]-e[1]],t-this.getRotation()),Hi(i,e)),i},e.prototype.calculateCenterZoom=function(t,e){var i,r=this.getCenter(),n=this.getResolution();void 0!==r&&void 0!==n&&(i=[e[0]-t*(e[0]-r[0])/n,e[1]-t*(e[1]-r[1])/n]);return i},e.prototype.getSizeFromViewport_=function(){var t=[100,100],e='.ol-viewport[data-view="'+o(this)+'"]',i=document.querySelector(e);if(i){var r=getComputedStyle(i);t[0]=parseInt(r.width,10),t[1]=parseInt(r.height,10)}return t},e.prototype.constrainCenter=function(t){return this.constraints_.center(t)},e.prototype.constrainResolution=function(t,e,i){var r=e||0,n=i||0;return this.constraints_.resolution(t,r,n)},e.prototype.constrainRotation=function(t,e){var i=e||0;return this.constraints_.rotation(t,i)},e.prototype.getCenter=function(){return this.get(Un)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var e=t||this.getSizeFromViewport_(),i=this.getCenter();Y(i,1);var r=this.getResolution();Y(void 0!==r,2);var n=this.getRotation();return Y(void 0!==n,3),Ct(i,r,n,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Yn)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){var i=e||this.getSizeFromViewport_(),r=Ot(t)/i[0],n=Rt(t)/i[1];return Math.max(r,n)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.maxResolution_,r=this.minResolution_,n=Math.log(i/r)/Math.log(e);return function(t){return i/Math.pow(e,t*n)}},e.prototype.getRotation=function(){return this.get(Bn)},e.prototype.getValueForResolutionFunction=function(t){var e=t||2,i=this.maxResolution_,r=this.minResolution_,n=Math.log(i/r)/Math.log(e);return function(t){return Math.log(i/t)/Math.log(e)/n}},e.prototype.getState=function(t){var e=this.getCenter(),i=this.getProjection(),r=this.getResolution(),n=r/t,o=this.getRotation();return{center:[Math.round(e[0]/n)*n,Math.round(e[1]/n)*n],projection:void 0!==i?i:null,resolution:r,rotation:o,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,i,r=this.minZoom_||0;if(this.resolutions_){var n=z(this.resolutions_,t,1);r=n,e=this.resolutions_[n],i=n==this.resolutions_.length-1?2:e/this.resolutions_[n+1]}else e=this.maxResolution_,i=this.zoomFactor_;return r+Math.log(e/t)/Math.log(i)},e.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},e.prototype.fit=function(t,e){var i,r=e||{},n=r.size;n||(n=this.getSizeFromViewport_()),Y(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)?(Y(!bt(t),25),i=Oi(t)):t.getType()===Nt.CIRCLE?(i=Oi(t=t.getExtent())).rotate(this.getRotation(),Tt(t)):i=t;var o,s=void 0!==r.padding?r.padding:[0,0,0,0],a=void 0===r.constrainResolution||r.constrainResolution,h=void 0!==r.nearest&&r.nearest;o=void 0!==r.minResolution?r.minResolution:void 0!==r.maxZoom?this.constrainResolution(this.maxResolution_,r.maxZoom-this.minZoom_,0):0;for(var l=i.getFlatCoordinates(),u=this.getRotation(),p=Math.cos(-u),c=Math.sin(-u),d=1/0,f=1/0,_=-1/0,g=-1/0,y=i.getStride(),v=0,m=l.length;v<m;v+=y){var x=l[v]*p-l[v+1]*c,E=l[v]*c+l[v+1]*p;d=Math.min(d,x),f=Math.min(f,E),_=Math.max(_,x),g=Math.max(g,E)}var S=this.getResolutionForExtent([d,f,_,g],[n[0]-s[1]-s[3],n[1]-s[0]-s[2]]);if(S=isNaN(S)?o:Math.max(S,o),a){var T=this.constrainResolution(S,0,0);!h&&T<S&&(T=this.constrainResolution(T,-1,0)),S=T}c=-c;var C=(d+_)/2,R=(f+g)/2,w=[(C+=(s[1]-s[3])/2*S)*p-(R+=(s[0]-s[2])/2*S)*c,R*p+C*c],L=r.callback?r.callback:I;void 0!==r.duration?this.animate({resolution:S,center:w,duration:r.duration,easing:r.easing},L):(this.setResolution(S),this.setCenter(w),Hn(L,!0))},e.prototype.centerOn=function(t,e,i){var r=this.getRotation(),n=Math.cos(-r),o=Math.sin(-r),s=t[0]*n-t[1]*o,a=t[1]*n+t[0]*o,h=this.getResolution(),l=(s+=(e[0]/2-i[0])*h)*n-(a+=(i[1]-e[1]/2)*h)*(o=-o),u=a*n+s*o;this.setCenter([l,u])},e.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},e.prototype.rotate=function(t,e){if(void 0!==e){var i=this.calculateCenterRotate(t,e);this.setCenter(i)}this.setRotation(t)},e.prototype.setCenter=function(t){this.set(Un,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.set(Yn,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setRotation=function(t){this.set(Bn,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e}(D);function Jn(t,e){var i=document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function Qn(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function $n(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function to(t){for(;t.lastChild;)t.removeChild(t.lastChild)}var eo={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"},io=function(t){function e(e){t.call(this);var i=u({},e);i[eo.OPACITY]=void 0!==e.opacity?e.opacity:1,i[eo.VISIBLE]=void 0===e.visible||e.visible,i[eo.Z_INDEX]=e.zIndex,i[eo.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,i[eo.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,this.setProperties(i),this.state_=null,this.type}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return this.type},e.prototype.getLayerState=function(){var t=this.state_||{layer:this,managed:!0};return t.opacity=kt(this.getOpacity(),0,1),t.sourceState=this.getSourceState(),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=this.getZIndex()||0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),this.state_=t,t},e.prototype.getLayersArray=function(t){return r()},e.prototype.getLayerStatesArray=function(t){return r()},e.prototype.getExtent=function(){return this.get(eo.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(eo.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(eo.MIN_RESOLUTION)},e.prototype.getOpacity=function(){return this.get(eo.OPACITY)},e.prototype.getSourceState=function(){return r()},e.prototype.getVisible=function(){return this.get(eo.VISIBLE)},e.prototype.getZIndex=function(){return this.get(eo.Z_INDEX)},e.prototype.setExtent=function(t){this.set(eo.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(eo.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(eo.MIN_RESOLUTION,t)},e.prototype.setOpacity=function(t){this.set(eo.OPACITY,t)},e.prototype.setVisible=function(t){this.set(eo.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(eo.Z_INDEX,t)},e}(D),ro={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},no={LAYERS:"layers"},oo=function(t){function e(e){var i=e||{},r=u({},i);delete r.layers;var n=i.layers;t.call(this,r),this.layersListenerKeys_=[],this.listenerKeys_={},v(this,G(no.LAYERS),this.handleLayersChanged_,this),n?Array.isArray(n)?n=new U(n.slice(),{unique:!0}):Y("function"==typeof n.getArray,43):n=new U(void 0,{unique:!0}),this.setLayers(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(E),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(v(t,h.ADD,this.handleLayersAdd_,this),v(t,h.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(E);p(this.listenerKeys_);for(var i=t.getArray(),r=0,n=i.length;r<n;r++){var s=i[r];this.listenerKeys_[o(s)]=[v(s,l,this.handleLayerChange_,this),v(s,M.CHANGE,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[o(e)]=[v(e,l,this.handleLayerChange_,this),v(e,M.CHANGE,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=o(t.element);this.listenerKeys_[e].forEach(E),delete this.listenerKeys_[e],this.changed()},e.prototype.getLayers=function(){return this.get(no.LAYERS)},e.prototype.setLayers=function(t){this.set(no.LAYERS,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach(function(t){t.getLayersArray(e)}),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(e)});for(var r=this.getLayerState(),n=i,o=e.length;n<o;n++){var s=e[n];s.opacity*=r.opacity,s.visible=s.visible&&r.visible,s.maxResolution=Math.min(s.maxResolution,r.maxResolution),s.minResolution=Math.max(s.minResolution,r.minResolution),void 0!==r.extent&&(void 0!==s.extent?s.extent=wt(s.extent,r.extent):s.extent=r.extent)}return e},e.prototype.getSourceState=function(){return ro.READY},e}(io);function so(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]+2*e,i[1]=t[1]+2*e,i}function ao(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i}function ho(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)}var lo=function(t){function e(e){t.call(this);var i=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,r,n,o={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new oo({layers:t.layers});o[Ln.LAYERGROUP]=s,o[Ln.TARGET]=t.target,o[Ln.VIEW]=void 0!==t.view?t.view:new qn,void 0!==t.controls&&(Array.isArray(t.controls)?i=new U(t.controls.slice()):(Y("function"==typeof t.controls.getArray,47),i=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?r=new U(t.interactions.slice()):(Y("function"==typeof t.interactions.getArray,48),r=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?n=new U(t.overlays.slice()):(Y("function"==typeof t.overlays.getArray,49),n=t.overlays):n=new U;return{controls:i,interactions:r,keyboardEventTarget:e,overlays:n,values:o}}(e);this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:Di,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+(Ui?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var r=[M.CLICK,M.DBLCLICK,M.MOUSEDOWN,M.TOUCHSTART,M.MSPOINTERDOWN,Ar.POINTERDOWN,M.MOUSEWHEEL,M.WHEEL],n=0,o=r.length;n<o;++n)v(this.overlayContainerStopEvent_,r[n],O);for(var s in this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new Cn(this,e.moveTolerance),Ar)v(this.mapBrowserEventHandler_,Ar[s],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=i.keyboardEventTarget,this.keyHandlerKeys_=null,v(this.viewport_,M.CONTEXTMENU,this.handleBrowserEvent,this),v(this.viewport_,M.WHEEL,this.handleBrowserEvent,this),v(this.viewport_,M.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=i.controls||new U,this.interactions=i.interactions||new U,this.overlays_=i.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new Mn(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},v(this,G(Ln.LAYERGROUP),this.handleLayerGroupChanged_,this),v(this,G(Ln.VIEW),this.handleViewChanged_,this),v(this,G(Ln.SIZE),this.handleSizeChanged_,this),v(this,G(Ln.TARGET),this.handleTargetChanged_,this),this.setProperties(i.values),this.controls.forEach(function(t){t.setMap(this)}.bind(this)),v(this.controls,h.ADD,function(t){t.element.setMap(this)},this),v(this.controls,h.REMOVE,function(t){t.element.setMap(null)},this),this.interactions.forEach(function(t){t.setMap(this)}.bind(this)),v(this.interactions,h.ADD,function(t){t.element.setMap(this)},this),v(this.interactions,h.REMOVE,function(t){t.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),v(this.overlays_,h.ADD,function(t){this.addOverlayInternal_(t.element)},this),v(this.overlays_,h.REMOVE,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)},this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),x(this.viewport_,M.CONTEXTMENU,this.handleBrowserEvent,this),x(this.viewport_,M.WHEEL,this.handleBrowserEvent,this),x(this.viewport_,M.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(M.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_){var r=this.getCoordinateFromPixel(t),n=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==i.layerFilter?i.layerFilter:R;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,n,e,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var i=null;return this.forEachFeatureAtPixel(t,function(t){i||(i=[]),i.push(t)},e),i},e.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_){var r=i||{},n=void 0!==r.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=r.layerFilter||R;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,n,e,null,o,null)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixel(t),r=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:R,n=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,n,r,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},e.prototype.getTarget=function(){return this.get(Ln.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){var e=this.frameState_;return e?De(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(Ln.LAYERGROUP)},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getPixelFromCoordinate=function(t){var e=this.frameState_;return e?De(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(Ln.SIZE)},e.prototype.getView=function(){return this.get(Ln.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getTilePriority=function(t,e,i,r){var n=this.frameState_;if(!(n&&e in n.wantedTiles))return 1/0;if(!n.wantedTiles[e][t.getKey()])return 1/0;var o=i[0]-n.focus[0],s=i[1]-n.focus[1];return 65536*Math.log(r)+Math.sqrt(o*o+s*s)/r},e.prototype.handleBrowserEvent=function(t,e){var i=e||t.type,r=new Fr(i,this,t);this.handleMapBrowserEvent(r)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){this.focus_=t.coordinate,t.frameState=this.frameState_;var e=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var i=e.length-1;i>=0;i--){var r=e[i];if(r.getActive())if(!r.handleEvent(t))break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_,r=i;if(t){var n=t.viewHints;n[kn]&&(i=this.loadTilesWhileAnimating_?8:0,r=2),n[jn]&&(i=this.loadTilesWhileInteracting_?8:0,r=2)}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,r))}!t||!this.hasListener(ur.RENDERCOMPLETE)||t.animate||this.tileQueue_.getTilesLoading()||function t(e){for(var i=0,r=e.length;i<r;++i){var n=e[i];if("function"==typeof n.getLayers)return t(n.getLayers().getArray());var o=n.getSource();if(o&&o.loading)return!0}return!1}(this.getLayers().getArray())||this.renderer_.dispatchRenderEvent(ur.RENDERCOMPLETE,t);for(var o=this.postRenderFunctions_,s=0,a=o.length;s<a;++s)o[s](this,t);o.length=0},e.prototype.handleSizeChanged_=function(){this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,i=this.keyHandlerKeys_.length;e<i;++e)E(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_);var r=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[v(r,M.KEYDOWN,this.handleBrowserEvent,this),v(r,M.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(M.RESIZE,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),$n(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(M.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(E(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(E(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",o(t)),this.viewPropertyListenerKey_=v(t,l,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=v(t,M.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(E),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[v(t,l,this.render,this),v(t,M.CHANGE,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e,i=this.getSize(),r=this.getView(),n=[1/0,1/0,-1/0,-1/0],s=this.frameState_,a=null;if(void 0!==i&&function(t){return t[0]>0&&t[1]>0}(i)&&r&&r.isDef()){for(var h=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=this.getLayerGroup().getLayerStatesArray(),u={},p=0,c=l.length;p<c;++p)u[o(l[p].layer)]=l[p];e=r.getState(this.pixelRatio_),a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:n,focus:this.focus_?this.focus_:e.center,index:this.frameIndex_++,layerStates:u,layerStatesArray:l,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:e,viewHints:h,wantedTiles:{}}}if(a&&(a.extent=Ct(e.center,e.resolution,e.rotation,a.size,n)),this.frameState_=a,this.renderer_.renderFrame(a),a){if(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),s)(!this.previousExtent_||!bt(this.previousExtent_)&&!dt(a.extent,this.previousExtent_))&&(this.dispatchEvent(new Mr(wn,this,s)),this.previousExtent_=ut(this.previousExtent_));this.previousExtent_&&!a.viewHints[kn]&&!a.viewHints[jn]&&!dt(a.extent,this.previousExtent_)&&(this.dispatchEvent(new Mr(In,this,a)),it(a.extent,this.previousExtent_))}this.dispatchEvent(new Mr(Rn,this,a)),setTimeout(this.handlePostRender.bind(this),0)},e.prototype.setLayerGroup=function(t){this.set(Ln.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(Ln.SIZE,t)},e.prototype.setTarget=function(t){this.set(Ln.TARGET,t)},e.prototype.setView=function(t){this.set(Ln.VIEW,t)},e.prototype.skipFeature=function(t){this.skippedFeatureUids_[o(t)]=!0,this.render()},e.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},e.prototype.unskipFeature=function(t){delete this.skippedFeatureUids_[o(t)],this.render()},e}(D);var uo=function(t){function e(e){t.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:I,e.target&&this.setTarget(e.target)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){$n(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&$n(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)E(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==I&&this.listenerKeys.push(v(t,Rn,this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(D),po="ol-hidden",co="ol-selectable",fo="ol-unselectable",_o="ol-unsupported",go="ol-control",yo="ol-collapsed",vo=function(){var t,e={};return function(i){if(t||(t=document.createElement("div").style),!(i in e)){t.font=i;var r=t.fontFamily;if(t.font="",!r)return null;e[i]=r.split(/,\s?/)}return e[i]}}();function mo(t,e){return t.visible&&e>=t.minResolution&&e<t.maxResolution}var xo=function(t){function e(e){var i=u({},e);delete i.source,t.call(this,i),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),v(this,G(eo.SOURCE),this.handleSourcePropertyChange_,this);var r=e.source?e.source:null;this.setSource(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(eo.SOURCE)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():ro.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(E(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=v(t,M.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(E(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(E(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=v(t,ur.PRECOMPOSE,function(t){var e=t,i=this.getLayerState();i.managed=!1,void 0===this.getZIndex()&&(i.zIndex=1/0),e.frameState.layerStatesArray.push(i),e.frameState.layerStates[o(this)]=i},this),this.mapRenderKey_=v(this,M.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(eo.SOURCE,t)},e}(io);function Eo(t){this.updateElement_(t.frameState)}var So=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||Eo,target:i.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===i.collapsed||i.collapsed,this.overrideCollapsible_=void 0!==i.collapsible,this.collapsible_=void 0===i.collapsible||i.collapsible,this.collapsible_||(this.collapsed_=!1);var r=void 0!==i.className?i.className:"ol-attribution",n=void 0!==i.tipLabel?i.tipLabel:"Attributions",o=void 0!==i.collapseLabel?i.collapseLabel:"»";"string"==typeof o?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o):this.collapseLabel_=o;var s=void 0!==i.label?i.label:"i";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s):this.label_=s;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,h=document.createElement("button");h.setAttribute("type","button"),h.title=n,h.appendChild(a),v(h,M.CLICK,this.handleClick_,this);var l=r+" "+fo+" "+go+(this.collapsed_&&this.collapsible_?" "+yo:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=l,u.appendChild(this.ulElement_),u.appendChild(h),this.renderedAttributions_=[],this.renderedVisible_=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.collectSourceAttributions_=function(t){for(var e={},i=[],r=t.layerStatesArray,n=t.viewState.resolution,o=0,s=r.length;o<s;++o){var a=r[o];if(mo(a,n)){var h=a.layer.getSource();if(h){var l=h.getAttributions();if(l){var u=l(t);if(u)if(this.overrideCollapsible_||!1!==h.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(u))for(var p=0,c=u.length;p<c;++p)u[p]in e||(i.push(u[p]),e[u[p]]=!0);else u in e||(i.push(u),e[u]=!0)}}}}return i},e.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Z(e,this.renderedAttributions_)){to(this.ulElement_);for(var r=0,n=e.length;r<n;++r){var o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle(yo),this.collapsed_?Qn(this.collapseLabel_,this.label_):Qn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e}(uo);function To(t){var e=t.frameState;if(e){var i=e.viewState.rotation;if(i!=this.rotation_){var r="rotate("+i+"rad)";if(this.autoHide_){var n=this.element.classList.contains(po);n||0!==i?n&&0!==i&&this.element.classList.remove(po):this.element.classList.add(po)}this.label_.style.msTransform=r,this.label_.style.webkitTransform=r,this.label_.style.transform=r}this.rotation_=i}}var Co=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||To,target:i.target});var r=void 0!==i.className?i.className:"ol-rotate",n=void 0!==i.label?i.label:"⇧";this.label_=null,"string"==typeof n?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=n):(this.label_=n,this.label_.classList.add("ol-compass"));var o=i.tipLabel?i.tipLabel:"Reset rotation",s=document.createElement("button");s.className=r+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),v(s,M.CLICK,this.handleClick_,this);var a=r+" "+fo+" "+go,h=this.element;h.className=a,h.appendChild(s),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,this.duration_=void 0!==i.duration?i.duration:250,this.autoHide_=void 0===i.autoHide||i.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(po)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:Xn}):t.setRotation(0))},e}(uo),Ro=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target});var r=void 0!==i.className?i.className:"ol-zoom",n=void 0!==i.delta?i.delta:1,o=void 0!==i.zoomInLabel?i.zoomInLabel:"+",s=void 0!==i.zoomOutLabel?i.zoomOutLabel:"−",a=void 0!==i.zoomInTipLabel?i.zoomInTipLabel:"Zoom in",h=void 0!==i.zoomOutTipLabel?i.zoomOutTipLabel:"Zoom out",l=document.createElement("button");l.className=r+"-in",l.setAttribute("type","button"),l.title=a,l.appendChild("string"==typeof o?document.createTextNode(o):o),v(l,M.CLICK,this.handleClick_.bind(this,n));var u=document.createElement("button");u.className=r+"-out",u.setAttribute("type","button"),u.title=h,u.appendChild("string"==typeof s?document.createTextNode(s):s),v(u,M.CLICK,this.handleClick_.bind(this,-n));var p=r+" "+fo+" "+go,c=this.element;c.className=p,c.appendChild(l),c.appendChild(u),this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var i=e.getResolution();if(i){var r=e.constrainResolution(i,t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:r,duration:this.duration_,easing:Xn})):e.setResolution(r)}}},e}(uo);function wo(t){var e=t||{},i=new U;return(void 0===e.zoom||e.zoom)&&i.push(new Ro(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&i.push(new Co(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&i.push(new So(e.attributionOptions)),i}var Io={ACTIVE:"active"};function Lo(t,e,i,r){Oo(t,e=t.constrainRotation(e,0),i,r)}function Oo(t,e,i,r){if(void 0!==e){var n=t.getRotation(),o=t.getCenter();void 0!==n&&o&&r>0?t.animate({rotation:e,anchor:i,duration:r,easing:Xn}):t.rotate(e,i)}}function Po(t,e,i,r,n){Mo(t,e=t.constrainResolution(e,0,n),i,r)}function bo(t,e,i,r){var n=t.getResolution(),o=t.constrainResolution(n,e,0);if(void 0!==o){var s=t.getResolutions();o=kt(o,t.getMinResolution()||s[s.length-1],t.getMaxResolution()||s[0])}if(i&&void 0!==o&&o!==n){var a=t.getCenter(),h=t.calculateCenterZoom(o,i);h=t.constrainCenter(h),i=[(o*a[0]-n*h[0])/(o-n),(o*a[1]-n*h[1])/(o-n)]}Mo(t,o,i,r)}function Mo(t,e,i,r){if(e){var n=t.getResolution(),o=t.getCenter();if(void 0!==n&&o&&e!==n&&r)t.animate({resolution:e,anchor:i,duration:r,easing:Xn});else{if(i){var s=t.calculateCenterZoom(e,i);t.setCenter(s)}t.setResolution(e)}}}var Fo=function(t){function e(e){t.call(this),e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getActive=function(){return this.get(Io.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(Io.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(D);function Ao(t){var e=!1;if(t.type==Ar.DBLCLICK){var i=t.originalEvent,r=t.map,n=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_;bo(r.getView(),o,n,this.duration_),t.preventDefault(),e=!0}return!e}var No=function(t){function e(e){t.call(this,{handleEvent:Ao});var i=e||{};this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Fo),Go=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Do=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ko=function(t){return t.target.getTargetElement()===document.activeElement},jo=R,Uo=function(t){var e=t.originalEvent;return 0==e.button&&!(Ni&&Gi&&e.ctrlKey)},Yo=w,Bo=function(t){return"pointermove"==t.type},Vo=function(t){return t.type==Ar.SINGLECLICK},Xo=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},zo=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Wo=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},Ko=function(t){var e=t.pointerEvent;return Y(void 0!==e,56),"mouse"==e.pointerType},Ho=function(t){var e=t.pointerEvent;return Y(void 0!==e,56),e.isPrimary&&0===e.button};function Zo(t){for(var e=t.length,i=0,r=0,n=0;n<e;n++)i+=t[n].clientX,r+=t[n].clientY;return[i/e,r/e]}var qo=function(t){function e(e){var i=e||{};t.call(this,i),i.handleDownEvent&&(this.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(this.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(this.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(this.handleUpEvent=i.handleUpEvent),i.stopDown&&(this.stopDown=i.stopDown),this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Ar.POINTERDRAG)this.handleDragEvent(t);else if(t.type==Ar.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Ar.POINTERDOWN){var r=this.handleDownEvent(t);r&&t.preventDefault(),this.handlingDownUpSequence=r,e=this.stopDown(r)}else t.type==Ar.POINTERMOVE&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===Ar.POINTERDOWN||e===Ar.POINTERDRAG||e===Ar.POINTERUP}(t)){var e=t.pointerEvent,i=e.pointerId.toString();t.type==Ar.POINTERUP?delete this.trackedPointers_[i]:t.type==Ar.POINTERDOWN?this.trackedPointers_[i]=e:i in this.trackedPointers_&&(this.trackedPointers_[i]=e),this.targetPointers=c(this.trackedPointers_)}},e}(Fo),Jo=function(t){function e(e){t.call(this,{stopDown:w});var i=e||{};this.kinetic_=i.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1,this.condition_=i.condition?i.condition:Xo,this.noKinetic_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().setHint(jn,1));var e=this.targetPointers,i=Zo(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var r=this.lastCentroid[0]-i[0],n=i[1]-this.lastCentroid[1],o=t.map.getView(),s=[r,n];tr(s,o.getResolution()),$i(s,o.getRotation()),Hi(s,o.getCenter()),s=o.constrainCenter(s),o.setCenter(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length},e.prototype.handleUpEvent=function(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),o=i.getCenter(),s=e.getPixelFromCoordinate(o),a=e.getCoordinateFromPixel([s[0]-r*Math.cos(n),s[1]-r*Math.sin(n)]);i.animate({center:i.constrainCenter(a),duration:500,easing:Xn})}return this.panning_&&(this.panning_=!1,i.setHint(jn,-1)),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},e}(qo),Qo=function(t){function e(e){var i=e||{};t.call(this,{stopDown:w}),this.condition_=i.condition?i.condition:Do,this.lastAngle_=void 0,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){if(Ko(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==Gn){var r=e.getSize(),n=t.pixel,o=Math.atan2(r[1]/2-n[1],n[0]-r[0]/2);if(void 0!==this.lastAngle_){var s=o-this.lastAngle_;Oo(i,i.getRotation()-s)}this.lastAngle_=o}}},e.prototype.handleUpEvent=function(t){if(!Ko(t))return!0;var e=t.map.getView();return e.setHint(jn,-1),Lo(e,e.getRotation(),void 0,this.duration_),!1},e.prototype.handleDownEvent=function(t){return!!Ko(t)&&(!(!Uo(t)||!this.condition_(t))&&(t.map.getView().setHint(jn,1),this.lastAngle_=void 0,!0))},e}(qo),$o=function(t){function e(e){t.call(this),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i=this.element_.style;i.left=Math.min(t[0],e[0])+"px",i.top=Math.min(t[1],e[1])+"px",i.width=Math.abs(e[0]-t[0])+"px",i.height=Math.abs(e[1]-t[1])+"px"},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Ii([i])},e.prototype.getGeometry=function(){return this.geometry_},e}(C),ts="boxstart",es="boxdrag",is="boxend",rs=function(t){function e(e,i,r){t.call(this,e),this.coordinate=i,this.mapBrowserEvent=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),ns=function(t){function e(e){t.call(this);var i=e||{};this.box_=new $o(i.className||"ol-dragbox"),this.minArea_=void 0!==i.minArea?i.minArea:64,this.onBoxEnd_=i.onBoxEnd?i.onBoxEnd:I,this.startPixel_=null,this.condition_=i.condition?i.condition:jo,this.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:this.defaultBoxEndCondition}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.defaultBoxEndCondition=function(t,e,i){var r=i[0]-e[0],n=i[1]-e[1];return r*r+n*n>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){Ko(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new rs(es,t.coordinate,t)))},e.prototype.handleUpEvent=function(t){return!Ko(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new rs(is,t.coordinate,t))),!1)},e.prototype.handleDownEvent=function(t){return!!Ko(t)&&(!(!Uo(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new rs(ts,t.coordinate,t)),!0))},e}(qo);function os(){var t=this.getMap(),e=t.getView(),i=t.getSize(),r=this.getGeometry().getExtent();if(this.out_){var n=e.calculateExtent(i),o=function(t,e){return gt(ut(e),t)}([t.getPixelFromCoordinate(Et(r)),t.getPixelFromCoordinate(Lt(r))]);Mt(n,1/e.getResolutionForExtent(o,i)),r=n}var s=e.constrainResolution(e.getResolutionForExtent(r,i)),a=Tt(r);a=e.constrainCenter(a),e.animate({resolution:s,center:a,duration:this.duration_,easing:Xn})}var ss=function(t){function e(e){var i=e||{},r=i.condition?i.condition:zo;t.call(this,{condition:r,className:i.className||"ol-dragzoom",onBoxEnd:os}),this.duration_=void 0!==i.duration?i.duration:200,this.out_=void 0!==i.out&&i.out}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ns),as={LEFT:37,UP:38,RIGHT:39,DOWN:40};function hs(t){var e=!1;if(t.type==M.KEYDOWN){var i=t.originalEvent.keyCode;if(this.condition_(t)&&(i==as.DOWN||i==as.LEFT||i==as.RIGHT||i==as.UP)){var r=t.map.getView(),n=r.getResolution()*this.pixelDelta_,o=0,s=0;i==as.DOWN?s=-n:i==as.LEFT?o=-n:i==as.RIGHT?o=n:s=n;var a=[o,s];$i(a,r.getRotation()),function(t,e,i){var r=t.getCenter();if(r){var n=t.constrainCenter([r[0]+e[0],r[1]+e[1]]);i?t.animate({duration:i,easing:Wn,center:n}):t.setCenter(n)}}(r,a,this.duration_),t.preventDefault(),e=!0}}return!e}var ls=function(t){function e(e){t.call(this,{handleEvent:hs});var i=e||{};this.defaultCondition_=function(t){return Xo(t)&&Wo(t)},this.condition_=void 0!==i.condition?i.condition:this.defaultCondition_,this.duration_=void 0!==i.duration?i.duration:100,this.pixelDelta_=void 0!==i.pixelDelta?i.pixelDelta:128}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Fo);function us(t){var e=!1;if(t.type==M.KEYDOWN||t.type==M.KEYPRESS){var i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){var r=t.map,n=i=="+".charCodeAt(0)?this.delta_:-this.delta_;bo(r.getView(),n,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}var ps=function(t){function e(e){t.call(this,{handleEvent:us});var i=e||{};this.condition_=i.condition?i.condition:Wo,this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:100}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Fo),cs="trackpad",ds="wheel",fs=function(t){function e(e){var i=e||{};t.call(this,i),this.delta_=0,this.duration_=void 0!==i.duration?i.duration:250,this.timeout_=void 0!==i.timeout?i.timeout:80,this.useAnchor_=void 0===i.useAnchor||i.useAnchor,this.constrainResolution_=i.constrainResolution||!1,this.condition_=i.condition?i.condition:jo,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(jn,-1)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var e=t.type;if(e!==M.WHEEL&&e!==M.MOUSEWHEEL)return!0;t.preventDefault();var i,r=t.map,n=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==M.WHEEL?(i=n.deltaY,Fi&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=Di),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)):t.type==M.MOUSEWHEEL&&(i=-n.wheelDeltaY,Ai&&(i/=3)),0===i)return!1;var o=Date.now();if(void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?cs:ds),this.mode_===cs){var s=r.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):s.setHint(jn,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var a=s.getResolution()*Math.pow(2,i/this.trackpadDeltaPerZoom_),h=s.getMinResolution(),l=s.getMaxResolution(),u=0;if(a<h?(a=Math.max(a,h/this.trackpadZoomBuffer_),u=1):a>l&&(a=Math.min(a,l*this.trackpadZoomBuffer_),u=-1),this.lastAnchor_){var p=s.calculateCenterZoom(a,this.lastAnchor_);s.setCenter(s.constrainCenter(p))}return s.setResolution(a),0===u&&this.constrainResolution_&&s.animate({resolution:s.constrainResolution(a,i>0?-1:1),easing:Xn,anchor:this.lastAnchor_,duration:this.duration_}),u>0?s.animate({resolution:h,easing:Xn,anchor:this.lastAnchor_,duration:500}):u<0&&s.animate({resolution:l,easing:Xn,anchor:this.lastAnchor_,duration:500}),this.startTime_=o,!1}this.delta_+=i;var c=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),c),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();bo(e,-kt(this.delta_,-1,1),this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Fo),_s=function(t){function e(e){var i=e||{},r=i;r.stopDown||(r.stopDown=w),t.call(this,r),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==i.threshold?i.threshold:.3,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){var e=0,i=this.targetPointers[0],r=this.targetPointers[1],n=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(void 0!==this.lastAngle_){var o=n-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=n;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==Gn){var h=s.getViewport().getBoundingClientRect(),l=Zo(this.targetPointers);if(l[0]-=h.left,l[1]-=h.top,this.anchor_=s.getCoordinateFromPixel(l),this.rotating_){var u=a.getRotation();s.render(),Oo(a,u+e,this.anchor_)}}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView();if(e.setHint(jn,-1),this.rotating_)Lo(e,e.getRotation(),this.anchor_,this.duration_);return!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().setHint(jn,1),!0}return!1},e}(qo),gs=function(t){function e(e){var i=e||{},r=i;r.stopDown||(r.stopDown=w),t.call(this,r),this.constrainResolution_=i.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==i.duration?i.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){var e=1,i=this.targetPointers[0],r=this.targetPointers[1],n=i.clientX-r.clientX,o=i.clientY-r.clientY,s=Math.sqrt(n*n+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,h=a.getView(),l=h.getResolution(),u=h.getMaxResolution(),p=h.getMinResolution(),c=l*e;c>u?(e=u/l,c=u):c<p&&(e=p/l,c=p),1!=e&&(this.lastScaleDelta_=e);var d=a.getViewport().getBoundingClientRect(),f=Zo(this.targetPointers);f[0]-=d.left,f[1]-=d.top,this.anchor_=a.getCoordinateFromPixel(f),a.render(),Mo(h,c,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView();e.setHint(jn,-1);var i=e.getResolution();if(this.constrainResolution_||i<e.getMinResolution()||i>e.getMaxResolution()){var r=this.lastScaleDelta_-1;Po(e,i,this.anchor_,this.duration_,r)}return!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(jn,1),!0}return!1},e}(qo);function ys(t){var e=t||{},i=new U,r=new br(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new Qo),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new No({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new Jo({condition:e.onFocusOnly?ko:void 0,kinetic:r})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new _s),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new gs({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new ls),i.push(new ps({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new fs({condition:e.onFocusOnly?ko:void 0,constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new ss({duration:e.zoomDuration})),i}var vs=.5,ms=function(t){function e(e,i,r,n){t.call(this),this.extent=e,this.pixelRatio_=r,this.resolution=i,this.state=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(M.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return r()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){r()},e}(b),xs={IDLE:0,LOADING:1,LOADED:2,ERROR:3},Es=function(t){function e(e,i,r,n,o){var s=void 0!==o?xs.IDLE:xs.LOADED;t.call(this,e,i,r,s),this.loader_=void 0!==o?o:null,this.canvas_=n,this.error_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getError=function(){return this.error_},e.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=xs.ERROR):this.state=xs.LOADED,this.changed()},e.prototype.load=function(){this.state==xs.IDLE&&(this.state=xs.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},e.prototype.getImage=function(){return this.canvas_},e}(ms),Ss={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"},Ts={IMAGE:"image",VECTOR:"vector"},Cs=function(t){function e(e,i,r,n,o){t.call(this,e),this.vectorContext=i,this.frameState=r,this.context=n,this.glContext=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),Rs=function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(M.CLEAR)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var i=this.oldest_;i;)t.call(e,i.value_,i.key_,this),i=i.newer},e.prototype.get=function(t){var e=this.entries_[t];return Y(void 0!==e,15),e===this.newest_?e.value_:(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e,e.value_)},e.prototype.remove=function(t){var e=this.entries_[t];return Y(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){Y(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(b),ws=[0,0,0,1],Is=[],Ls=[0,0,0,1],Os=[0,0,0,0],Ps=new Rs,bs={},Ms=null,Fs={},As=function(){var t,e,i=60,r=bs,n="32px ",o=["monospace","serif"],s=o.length,a="wmytzilWMYTZIL@#/&?$%10";function h(t){for(var i=Ns(),r=100;r<=700;r+=300){for(var h=r+" ",l=!0,u=0;u<s;++u){var p=o[u];if(i.font=h+n+p,e=i.measureText(a).width,t!=p){i.font=h+n+t+","+p;var c=i.measureText(a).width;l=l&&c!=e}}if(l)return!0}return!1}function l(){var e=!0;for(var n in r)r[n]<i&&(h(n)?(r[n]=i,p(Fs),Ms=null,Ps.clear()):(++r[n],e=!1));e&&(clearInterval(t),t=void 0)}return function(e){var n=vo(e);if(n)for(var o=0,s=n.length;o<s;++o){var a=n[o];a in r||(r[a]=i,h(a)||(r[a]=0,void 0===t&&(t=setInterval(l,32))))}}}();function Ns(){return Ms||(Ms=Jn(1,1)),Ms}var Gs=function(){var t,e=Fs;return function(i){var r=e[i];return void 0==r&&(t||((t=document.createElement("span")).textContent="M",t.style.margin=t.style.padding="0 !important",t.style.position="absolute !important",t.style.left="-99999px !important"),t.style.font=i,document.body.appendChild(t),r=e[i]=t.offsetHeight,document.body.removeChild(t)),r}}();function Ds(t,e){var i=Ns();return t!=i.font&&(i.font=t),i.measureText(e).width}function ks(t,e,i,r){0!==e&&(t.translate(i,r),t.rotate(e),t.translate(-i,-r))}var js=[1,0,0,1,0,0];function Us(t,e,i,r,n,o,s,a,h,l,u){var p;1!=i&&(p=t.globalAlpha,t.globalAlpha=p*i),e&&t.setTransform.apply(t,e),t.drawImage(r,n,o,s,a,h,l,s*u,a*u),p&&(t.globalAlpha=p),e&&t.setTransform.apply(t,js)}function Ys(t){return Array.isArray(t)?yr(t):t}var Bs=function(){};Bs.prototype.drawCustom=function(t,e,i){},Bs.prototype.drawGeometry=function(t){},Bs.prototype.setStyle=function(t){},Bs.prototype.drawCircle=function(t,e){},Bs.prototype.drawFeature=function(t,e){},Bs.prototype.drawGeometryCollection=function(t,e){},Bs.prototype.drawLineString=function(t,e){},Bs.prototype.drawMultiLineString=function(t,e){},Bs.prototype.drawMultiPoint=function(t,e){},Bs.prototype.drawMultiPolygon=function(t,e){},Bs.prototype.drawPoint=function(t,e){},Bs.prototype.drawPolygon=function(t,e){},Bs.prototype.drawText=function(t,e){},Bs.prototype.setFillStrokeStyle=function(t,e){},Bs.prototype.setImageStyle=function(t,e){},Bs.prototype.setTextStyle=function(t,e){};var Vs=Bs,Xs=function(t){function e(e,i,r,n,o){t.call(this),this.context_=e,this.pixelRatio_=i,this.extent_=r,this.transform_=n,this.viewRotation_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawImages_=function(t,e,i,r){if(this.image_){var n=Gt(t,e,i,2,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);var h=this.imageRotation_;this.imageRotateWithView_&&(h+=this.viewRotation_);for(var l=0,u=n.length;l<u;l+=2){var p=n[l]-this.imageAnchorX_,c=n[l+1]-this.imageAnchorY_;if(0!==h||1!=this.imageScale_){var d=p+this.imageAnchorX_,f=c+this.imageAnchorY_;Ye(s,d,f,this.imageScale_,this.imageScale_,h,-d,-f),o.setTransform.apply(o,s)}o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,p,c,this.imageWidth_,this.imageHeight_)}0===h&&1==this.imageScale_||o.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(o.globalAlpha=a)}},e.prototype.drawText_=function(t,e,i,r){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var n=Gt(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=r){var a=n[e]+this.textOffsetX_,h=n[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_){var l=Ye(this.tmpLocalTransform_,a,h,this.textScale_,this.textScale_,s,-a,-h);o.setTransform.apply(o,l)}this.textStrokeState_&&o.strokeText(this.text_,a,h),this.textFillState_&&o.fillText(this.text_,a,h)}0===s&&1==this.textScale_||o.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,r,n){var o=this.context_,s=Gt(t,e,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);var a=s.length;n&&(a-=2);for(var h=2;h<a;h+=2)o.lineTo(s[h],s[h+1]);return n&&o.closePath(),i},e.prototype.drawRings_=function(t,e,i,r){for(var n=0,o=i.length;n<o;++n)e=this.moveToLineTo_(t,e,i[n],r,!0);return e},e.prototype.drawCircle=function(t){if(Pt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,i){var r=t.getFlatCoordinates();if(r){var n=t.getStride();return Gt(r,0,r.length,n,e,i)}return null}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],r=e[3]-e[1],n=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],n,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.drawGeometry=function(t){switch(t.getType()){case Nt.POINT:this.drawPoint(t);break;case Nt.LINE_STRING:this.drawLineString(t);break;case Nt.POLYGON:this.drawPolygon(t);break;case Nt.MULTI_POINT:this.drawMultiPoint(t);break;case Nt.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case Nt.MULTI_POLYGON:this.drawMultiPolygon(t);break;case Nt.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case Nt.CIRCLE:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&Pt(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,r=e.length;i<r;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(Pt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var r=t.getFlatMidpoint();this.drawText_(r,0,2,2)}}},e.prototype.drawMultiLineString=function(t){var e=t.getExtent();if(Pt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,r=t.getFlatCoordinates(),n=0,o=t.getEnds(),s=t.getStride();i.beginPath();for(var a=0,h=o.length;a<h;++a)n=this.moveToLineTo_(r,n,o[a],s,!1);i.stroke()}if(""!==this.text_){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}},e.prototype.drawPolygon=function(t){if(Pt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(Pt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),r=0,n=t.getEndss(),o=t.getStride();e.beginPath();for(var s=0,a=n.length;s<a;++s){var h=n[s];r=this.drawRings_(i,r,h,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var l=t.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=e.lineCap=t.lineCap),ki&&(Z(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,ki&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,r=t.textAlign?t.textAlign:"center";i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=r&&(i.textAlign=e.textAlign=r),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:Ys(i||ws)}}else this.fillState_=null;if(e){var r=e.getColor(),n=e.getLineCap(),o=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),h=e.getWidth(),l=e.getMiterLimit();this.strokeState_={lineCap:void 0!==n?n:"round",lineDash:o||Is,lineDashOffset:s||0,lineJoin:void 0!==a?a:"round",lineWidth:this.pixelRatio_*(void 0!==h?h:1),miterLimit:void 0!==l?l:10,strokeStyle:Ys(r||Ls)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),r=t.getOrigin(),n=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=n[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=n[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:Ys(i||ws)}}else this.textFillState_=null;var r=t.getStroke();if(r){var n=r.getColor(),o=r.getLineCap(),s=r.getLineDash(),a=r.getLineDashOffset(),h=r.getLineJoin(),l=r.getWidth(),u=r.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:"round",lineDash:s||Is,lineDashOffset:a||0,lineJoin:void 0!==h?h:"round",lineWidth:void 0!==l?l:1,miterLimit:void 0!==u?u:10,strokeStyle:Ys(n||Ls)}}else this.textStrokeState_=null;var p=t.getFont(),c=t.getOffsetX(),d=t.getOffsetY(),f=t.getRotateWithView(),_=t.getRotation(),g=t.getScale(),y=t.getText(),v=t.getTextAlign(),m=t.getTextBaseline();this.textState_={font:void 0!==p?p:"10px sans-serif",textAlign:void 0!==v?v:"center",textBaseline:void 0!==m?m:"middle"},this.text_=void 0!==y?y:"",this.textOffsetX_=void 0!==c?this.pixelRatio_*c:0,this.textOffsetY_=void 0!==d?this.pixelRatio_*d:0,this.textRotateWithView_=void 0!==f&&f,this.textRotation_=void 0!==_?_:0,this.textScale_=this.pixelRatio_*(void 0!==g?g:1)}else this.text_=""},e}(Vs),zs=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function Ws(t,e,i){return e+":"+t+":"+(i?dr(i):"null")}zs.prototype.clear=function(){this.cache_={},this.cacheSize_=0},zs.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},zs.prototype.get=function(t,e,i){var r=Ws(t,e,i);return r in this.cache_?this.cache_[r]:null},zs.prototype.set=function(t,e,i,r){var n=Ws(t,e,i);this.cache_[n]=r,++this.cacheSize_},zs.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()};var Ks=new zs;function Hs(t,e){Ks.expire()}function Zs(t,e){return t.zIndex-e.zIndex}var qs=function(t){function e(e){t.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispatchRenderEvent=function(t,e){r()},e.prototype.registerLayerRenderers=function(t){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,t)},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;Ye(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Be(Ge(r,i))},e.prototype.removeLayerRenderers=function(){for(var t in this.layerRenderers_)this.removeLayerRendererByKey_(t).dispose()},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,n,s,a){var h,l=e.viewState,u=l.resolution;function p(t,i){var s=e.layerStates[o(i)].managed;if(!(o(t)in e.skippedFeatureUids)||s)return r.call(n,t,s?i:null)}var c=l.projection,d=t;if(c.canWrapX()){var f=c.getExtent(),_=Ot(f),g=t[0];if(g<f[0]||g>f[2])d=[g+_*Math.ceil((f[0]-g)/_),t[1]]}var y,v=e.layerStatesArray;for(y=v.length-1;y>=0;--y){var m=v[y],x=m.layer;if(mo(m,u)&&s.call(a,x)){var E=this.getLayerRenderer(x),S=x.getSource();if(S&&(h=E.forEachFeatureAtCoordinate(S.getWrapX()?d:t,e,i,p)),h)return h}}},e.prototype.forEachLayerAtPixel=function(t,e,i,n,o,s,a){return r()},e.prototype.hasFeatureAtCoordinate=function(t,e,i,r,n){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,R,this,r,n)},e.prototype.getLayerRenderer=function(t){var e=o(t);if(e in this.layerRenderers_)return this.layerRenderers_[e];for(var i,r=0,n=this.layerRendererConstructors_.length;r<n;++r){var s=this.layerRendererConstructors_[r];if(s.handles(t)){i=s.create(this,t);break}}if(!i)throw new Error("Unable to create renderer for layer: "+t.getType());return this.layerRenderers_[e]=i,this.layerRendererListeners_[e]=v(i,M.CHANGE,this.handleLayerRendererChange_,this),i},e.prototype.getLayerRendererByKey=function(t){return this.layerRenderers_[t]},e.prototype.getLayerRenderers=function(){return this.layerRenderers_},e.prototype.getMap=function(){return this.map_},e.prototype.handleLayerRendererChange_=function(){this.map_.render()},e.prototype.removeLayerRendererByKey_=function(t){var e=this.layerRenderers_[t];return delete this.layerRenderers_[t],E(this.layerRendererListeners_[t]),delete this.layerRendererListeners_[t],e},e.prototype.removeUnusedLayerRenderers_=function(t,e){for(var i in this.layerRenderers_)e&&i in e.layerStates||this.removeLayerRendererByKey_(i).dispose()},e.prototype.renderFrame=function(t){r()},e.prototype.scheduleExpireIconCache=function(t){t.postRenderFunctions.push(Hs)},e.prototype.scheduleRemoveUnusedLayerRenderers=function(t){for(var e in this.layerRenderers_)if(!(e in t.layerStates))return void t.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},e}(C),Js=[],Qs=function(t){function e(e){t.call(this,e);var i=e.getViewport();this.context_=Jn(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=fo,i.insertBefore(this.canvas_,i.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispatchRenderEvent=function(t,e){var i=this.getMap(),r=this.context_;if(i.hasListener(t)){var n=e.extent,o=e.pixelRatio,s=e.viewState.rotation,a=this.getTransform(e),h=new Xs(r,o,n,a,s),l=new Cs(t,h,e,r,null);i.dispatchEvent(l)}},e.prototype.getTransform=function(t){var e=t.viewState,i=this.canvas_.width/2,r=this.canvas_.height/2,n=t.pixelRatio/e.resolution,o=-n,s=-e.rotation,a=-e.center[0],h=-e.center[1];return Ye(this.transform_,i,r,n,o,s,a,h)},e.prototype.renderFrame=function(t){if(t){var e=this.context_,i=t.pixelRatio,r=Math.round(t.size[0]*i),n=Math.round(t.size[1]*i);this.canvas_.width!=r||this.canvas_.height!=n?(this.canvas_.width=r,this.canvas_.height=n):e.clearRect(0,0,r,n);var o=t.viewState.rotation;this.calculateMatrices2D(t),this.dispatchRenderEvent(ur.PRECOMPOSE,t);var s=t.layerStatesArray;q(s,Zs),o&&(e.save(),ks(e,o,r/2,n/2));var a,h,l=t.viewState.resolution;for(a=0,h=s.length;a<h;++a){var u=s[a],p=u.layer,c=this.getLayerRenderer(p);mo(u,l)&&u.sourceState==ro.READY&&(c.prepareFrame(t,u)&&c.composeFrame(t,u,e))}o&&e.restore(),this.dispatchRenderEvent(ur.POSTCOMPOSE,t),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1)},e.prototype.forEachLayerAtPixel=function(t,e,i,r,n,o,s){var a,h,l=e.viewState.resolution,u=e.layerStatesArray,p=u.length,c=De(e.pixelToCoordinateTransform,t.slice());for(h=p-1;h>=0;--h){var d=u[h],f=d.layer;if(mo(d,l)&&o.call(s,f))if(a=this.getLayerRenderer(f).forEachLayerAtCoordinate(c,e,i,r,n))return a}},e.prototype.registerLayerRenderers=function(e){t.prototype.registerLayerRenderers.call(this,e);for(var i=0,r=e.length;i<r;++i){var n=e[i];X(Js,n)||Js.push(n)}},e}(qs),$s=function(t){function e(e){t.call(this),this.layer_=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createLoadedTileFinder=function(t,e,i){return function(r,n){return t.forEachLoadedTile(e,r,n,function(t){i[r]||(i[r]={}),i[r][t.tileCoord.toString()]=t})}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r){},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleImageChange_=function(t){t.target.getState()===xs.LOADED&&this.renderIfReadyAndVisible()},e.prototype.hasFeatureAtCoordinate=function(t,e){return!1},e.prototype.loadImage=function(t){var e=t.getState();return e!=xs.LOADED&&e!=xs.ERROR&&v(t,M.CHANGE,this.handleImageChange_,this),e==xs.IDLE&&(t.load(),e=t.getState()),e==xs.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==ro.READY&&this.changed()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var r=o(t);r in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[r])}.bind(null,e);t.postRenderFunctions.push(i)}},e.prototype.updateUsedTiles=function(t,e,i,r){var n=o(e),s=i.toString();n in t?s in t[n]?t[n][s].extend(r):t[n][s]=r:(t[n]={},t[n][s]=r)},e.prototype.manageTilePyramid=function(t,e,i,r,n,s,a,h,l,u){var p=o(e);p in t.wantedTiles||(t.wantedTiles[p]={});var c,d,f,_,g,y,v=t.wantedTiles[p],m=t.tileQueue;for(y=i.getMinZoom();y<=a;++y)for(d=i.getTileRangeForExtentAndZ(s,y,d),f=i.getResolution(y),_=d.minX;_<=d.maxX;++_)for(g=d.minY;g<=d.maxY;++g)a-y<=h?((c=e.getTile(y,_,g,r,n)).getState()==On.IDLE&&(v[c.getKey()]=!0,m.isKeyQueued(c.getKey())||m.enqueue([c,p,i.getTileCoordCenter(c.tileCoord),f])),void 0!==l&&l.call(u,c)):e.useTile(y,_,g,n)},e}(F),ta=function(t){function e(e){t.call(this,e),this.renderedResolution,this.transform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clip=function(t,e,i){var r=e.pixelRatio,n=e.size[0]*r,o=e.size[1]*r,s=e.viewState.rotation,a=It(i),h=Lt(i),l=St(i),u=Et(i);De(e.coordinateToPixelTransform,a),De(e.coordinateToPixelTransform,h),De(e.coordinateToPixelTransform,l),De(e.coordinateToPixelTransform,u),t.save(),ks(t,-s,n/2,o/2),t.beginPath(),t.moveTo(a[0]*r,a[1]*r),t.lineTo(h[0]*r,h[1]*r),t.lineTo(l[0]*r,l[1]*r),t.lineTo(u[0]*r,u[1]*r),t.clip(),ks(t,s,n/2,o/2)},e.prototype.dispatchComposeEvent_=function(t,e,i,r){var n=this.getLayer();if(n.hasListener(t)){var o=i.size[0]*i.pixelRatio,s=i.size[1]*i.pixelRatio,a=i.viewState.rotation;ks(e,-a,o/2,s/2);var h=void 0!==r?r:this.getTransform(i,0),l=new Xs(e,i.pixelRatio,i.extent,h,i.viewState.rotation),u=new Cs(t,l,i,e,null);n.dispatchEvent(u),ks(e,a,o/2,s/2)}},e.prototype.forEachLayerAtCoordinate=function(t,e,i,r,n){return this.forEachFeatureAtCoordinate(t,e,i,R)?r.call(n,this.getLayer(),null):void 0},e.prototype.postCompose=function(t,e,i,r){this.dispatchComposeEvent_(ur.POSTCOMPOSE,t,e,r)},e.prototype.preCompose=function(t,e,i){this.dispatchComposeEvent_(ur.PRECOMPOSE,t,e,i)},e.prototype.dispatchRenderEvent=function(t,e,i){this.dispatchComposeEvent_(ur.RENDER,t,e,i)},e.prototype.getTransform=function(t,e){var i=t.viewState,r=t.pixelRatio,n=r*t.size[0]/2,o=r*t.size[1]/2,s=r/i.resolution,a=-s,h=-i.rotation,l=-i.center[0]+e,u=-i.center[1];return Ye(this.transform_,n,o,s,a,h,l,u)},e.prototype.composeFrame=function(t,e,i){r()},e.prototype.prepareFrame=function(t,e){return r()},e}($s),ea=function(t){function e(e){t.call(this,e),this.coordinateToCanvasPixelTransform=[1,0,0,1,0,0],this.hitCanvasContext_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.composeFrame=function(t,e,i){this.preCompose(i,t);var r=this.getImage();if(r){var n=e.extent,o=void 0!==n&&!ot(n,t.extent)&&Pt(n,t.extent);o&&this.clip(i,t,n);var s=this.getImageTransform(),a=i.globalAlpha;i.globalAlpha=e.opacity;var h=s[4],l=s[5],u=r.width*s[0],p=r.height*s[3];u>=.5&&p>=.5&&i.drawImage(r,0,0,+r.width,+r.height,Math.round(h),Math.round(l),Math.round(u),Math.round(p)),i.globalAlpha=a,o&&i.restore()}this.postCompose(i,t,e)},e.prototype.getImage=function(){return r()},e.prototype.getImageTransform=function(){return r()},e.prototype.forEachLayerAtCoordinate=function(t,e,i,r,n){if(this.getImage()){var o=De(this.coordinateToCanvasPixelTransform,t.slice());tr(o,e.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=Jn(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),o[0],o[1],1,1,0,0,1,1);var s=this.hitCanvasContext_.getImageData(0,0,1,1).data;return s[3]>0?r.call(n,this.getLayer(),s):void 0}},e}(ta),ia=function(t){function e(i){if(t.call(this,i),this.image_=null,this.imageTransform_=[1,0,0,1,0,0],this.skippedFeatures_=[],this.vectorRenderer_=null,i.getType()===Ss.VECTOR)for(var r=0,n=Js.length;r<n;++r){var o=Js[r];if(o!==e&&o.handles(i)){this.vectorRenderer_=new o(i);break}}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.vectorRenderer_&&this.vectorRenderer_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_?this.image_.getImage():null},e.prototype.getImageTransform=function(){return this.imageTransform_},e.prototype.prepareFrame=function(t,e){var i,r=t.pixelRatio,n=t.size,o=t.viewState,s=o.center,a=o.resolution,h=this.getLayer().getSource(),l=t.viewHints,p=this.vectorRenderer_,c=t.extent;if(p||void 0===e.extent||(c=wt(c,e.extent)),!l[kn]&&!l[jn]&&!bt(c)){var d=o.projection,f=this.skippedFeatures_;if(p){var _=p.context,g=u({},t,{size:[Ot(c)/a,Rt(c)/a],viewState:u({},t.viewState,{rotation:0})}),y=Object.keys(g.skippedFeatureUids).sort();i=new Es(c,a,r,_.canvas,function(t){!p.prepareFrame(g,e)||!p.replayGroupChanged&&Z(f,y)||(_.canvas.width=g.size[0]*r,_.canvas.height=g.size[1]*r,p.compose(_,g,e),f=y,t())})}else i=h.getImage(c,a,r,d);i&&this.loadImage(i)&&(this.image_=i,this.skippedFeatures_=f)}if(this.image_){var v=(i=this.image_).getExtent(),m=i.getResolution(),x=i.getPixelRatio(),E=r*m/(a*x),S=Ye(this.imageTransform_,r*n[0]/2,r*n[1]/2,E,E,0,x*(v[0]-s[0])/m,x*(s[1]-v[3])/m);Ye(this.coordinateToCanvasPixelTransform,r*n[0]/2-S[4],r*n[1]/2-S[5],r/a,-r/a,0,-s[0],-s[1]),this.renderedResolution=m*r/x}return!!this.image_},e.prototype.forEachFeatureAtCoordinate=function(e,i,r,n){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,i,r,n):t.prototype.forEachFeatureAtCoordinate.call(this,e,i,r,n)},e}(ea);ia.handles=function(t){return t.getType()===Ss.IMAGE||t.getType()===Ss.VECTOR&&t.getRenderMode()===Ts.IMAGE},ia.create=function(t,e){return new ia(e)};var ra=ia,na=function(t,e,i,r){this.minX=t,this.maxX=e,this.minY=i,this.maxY=r};function oa(t,e,i,r,n){return void 0!==n?(n.minX=t,n.maxX=e,n.minY=i,n.maxY=r,n):new na(t,e,i,r)}na.prototype.contains=function(t){return this.containsXY(t[1],t[2])},na.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},na.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},na.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},na.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},na.prototype.getHeight=function(){return this.maxY-this.minY+1},na.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},na.prototype.getWidth=function(){return this.maxX-this.minX+1},na.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY};var sa=na,aa=function(t){function e(e,i){t.call(this,e),this.context=i?null:Jn(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new sa(0,0,0,0),this.imageTransform_=[1,0,0,1,0,0],this.zDirection=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isDrawableTile_=function(t){var e=this.getLayer(),i=t.getState(),r=e.getUseInterimTilesOnError();return i==On.LOADED||i==On.EMPTY||i==On.ERROR&&!r},e.prototype.getTile=function(t,e,i,r,n){var o=this.getLayer(),s=o.getSource().getTile(t,e,i,r,n);return s.getState()==On.ERROR&&(o.getUseInterimTilesOnError()?o.getPreload()>0&&(this.newTiles_=!0):s.setState(On.LOADED)),this.isDrawableTile_(s)||(s=s.getInterimTile()),s},e.prototype.prepareFrame=function(t,e){var i=t.pixelRatio,r=t.size,n=t.viewState,s=n.projection,a=n.resolution,h=n.center,l=this.getLayer(),u=l.getSource(),p=u.getRevision(),c=u.getTileGridForProjection(s),d=c.getZForResolution(a,this.zDirection),f=c.getResolution(d),_=Math.round(a/f)||1,g=t.extent;if(void 0!==e.extent&&(g=wt(g,e.extent)),bt(g))return!1;var y=c.getTileRangeForExtentAndZ(g,d),v=c.getTileRangeExtent(d,y),m=u.getTilePixelRatio(i),x={};x[d]={};var E,S,T,C=this.createLoadedTileFinder(u,s,x),R=t.viewHints,w=R[kn]||R[jn],I=this.tmpExtent,L=this.tmpTileRange_;for(this.newTiles_=!1,S=y.minX;S<=y.maxX;++S)for(T=y.minY;T<=y.maxY;++T)if(!(Date.now()-t.time>16&&w)){if(E=this.getTile(d,S,T,i,s),this.isDrawableTile_(E)){var O=o(this);if(E.getState()==On.LOADED){x[d][E.tileCoord.toString()]=E;var P=E.inTransition(O);this.newTiles_||!P&&-1!==this.renderedTiles.indexOf(E)||(this.newTiles_=!0)}if(1===E.getAlpha(O,t.time))continue}var b=c.getTileCoordChildTileRange(E.tileCoord,L,I),M=!1;b&&(M=C(d+1,b)),M||c.forEachTileCoordParentTileRange(E.tileCoord,C,null,L,I)}var F=f*i/m*_;if(!(this.renderedResolution&&Date.now()-t.time>16&&w)&&(this.newTiles_||!this.renderedExtent_||!ot(this.renderedExtent_,g)||this.renderedRevision!=p||_!=this.oversampling_||!w&&F!=this.renderedResolution)){var A=this.context;if(A){var N=u.getTilePixelSize(d,i,s),G=Math.round(y.getWidth()*N[0]/_),D=Math.round(y.getHeight()*N[1]/_),k=A.canvas;k.width!=G||k.height!=D?(this.oversampling_=_,k.width=G,k.height=D):(this.renderedExtent_&&!dt(v,this.renderedExtent_)&&A.clearRect(0,0,G,D),_=this.oversampling_)}this.renderedTiles.length=0;var j,U,Y,B,V,X,z,W,K,H,Z=Object.keys(x).map(Number);for(Z.sort(function(t,e){return t===d?1:e===d?-1:t>e?1:t<e?-1:0}),B=0,V=Z.length;B<V;++B)for(var q in Y=Z[B],U=u.getTilePixelSize(Y,i,s),j=c.getResolution(Y)/f,z=m*u.getGutterForProjection(s),W=x[Y])E=W[q],S=((X=c.getTileCoordExtent(E.getTileCoord(),I))[0]-v[0])/f*m/_,T=(v[3]-X[3])/f*m/_,K=U[0]*j/_,H=U[1]*j/_,this.drawTileImage(E,t,e,S,T,K,H,z,d===Y),this.renderedTiles.push(E);this.renderedRevision=p,this.renderedResolution=f*i/m*_,this.renderedExtent_=v}var J=this.renderedResolution/a,Q=Ye(this.imageTransform_,i*r[0]/2,i*r[1]/2,J,J,0,(this.renderedExtent_[0]-h[0])/this.renderedResolution*i,(h[1]-this.renderedExtent_[3])/this.renderedResolution*i);return Ye(this.coordinateToCanvasPixelTransform,i*r[0]/2-Q[4],i*r[1]/2-Q[5],i/a,-i/a,0,-h[0],-h[1]),this.updateUsedTiles(t.usedTiles,u,d,y),this.manageTilePyramid(t,u,c,i,s,g,d,l.getPreload()),this.scheduleExpireCache(t,u),this.renderedTiles.length>0},e.prototype.drawTileImage=function(t,e,i,r,n,s,a,h,l){var u=this.getTileImage(t);if(u){var p=o(this),c=l?t.getAlpha(p,e.time):1,d=this.getLayer().getSource();1!==c||d.getOpaque(e.viewState.projection)||this.context.clearRect(r,n,s,a);var f=c!==this.context.globalAlpha;f&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(u,h,h,u.width-2*h,u.height-2*h,r,n,s,a),f&&this.context.restore(),1!==c?e.animate=!0:l&&t.endTransition(p)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getImageTransform=function(){return this.imageTransform_},e.prototype.getTileImage=function(t){return t.getImage()},e}(ea);aa.handles=function(t){return t.getType()===Ss.TILE},aa.create=function(t,e){return new aa(e)},aa.prototype.getLayer;var ha=aa,la=i(0),ua=i.n(la),pa=function(){};pa.prototype.getReplay=function(t,e){return r()},pa.prototype.isEmpty=function(){return r()},pa.prototype.addDeclutter=function(t){return r()};var ca=pa,da={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};function fa(t,e,i,r,n,o,s,a){for(var h,l,u,p=[],c=t[e]>t[i-r],d=n.length,f=t[e],_=t[e+1],g=t[e+=r],y=t[e+1],v=0,m=Math.sqrt(Math.pow(g-f,2)+Math.pow(y-_,2)),x="",E=0,S=0;S<d;++S){l=c?d-S-1:S;var T=n.charAt(l),C=o(x=c?T+x:x+T)-E;E+=C;for(var R=s+C/2;e<i-r&&v+m<R;)f=g,_=y,g=t[e+=r],y=t[e+1],v+=m,m=Math.sqrt(Math.pow(g-f,2)+Math.pow(y-_,2));var w=R-v,I=Math.atan2(y-_,g-f);if(c&&(I+=I>0?-Math.PI:Math.PI),void 0!==u){var L=I-u;if(L+=L>Math.PI?-2*Math.PI:L<-Math.PI?2*Math.PI:0,Math.abs(L)>a)return null}var O=w/m,P=zt(f,g,O),b=zt(_,y,O);u==I?(c&&(h[0]=P,h[1]=b,h[2]=C/2),h[4]=x):(E=C,h=[P,b,C/2,I,x=T],c?p.unshift(h):p.push(h),u=I),s+=C}return p}var _a={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},ga=[_a.FILL],ya=[_a.STROKE],va=[_a.BEGIN_PATH],ma=[_a.CLOSE_PATH],xa=_a,Ea=[da.POLYGON,da.CIRCLE,da.LINE_STRING,da.IMAGE,da.TEXT,da.DEFAULT],Sa={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Ta=[1/0,1/0,-1/0,-1/0],Ca=[1,0,0,1,0,0],Ra=function(t){function e(e,i,r,n,o,s){t.call(this),this.declutterTree=s,this.tolerance=e,this.maxExtent=i,this.overlaps=o,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=r,this.alignFill_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replayTextBackground_=function(t,e,i,r,n,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,n),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},e.prototype.replayImage_=function(t,e,i,r,n,o,s,a,h,l,u,p,c,d,f,_,g,y){var v=g||y;e-=n*=c,i-=o*=c;var m,x,E,S,T=f+l>r.width?r.width-l:f,C=a+u>r.height?r.height-u:a,R=_[3]+T*c+_[1],w=_[0]+C*c+_[2],I=e-_[3],L=i-_[0];(v||0!==p)&&(m=[I,L],x=[I+R,L],E=[I+R,L+w],S=[I,L+w]);var O=null;if(0!==p){var P=e+n,b=i+o;O=Ye(Ca,P,b,1,1,p,-P,-b),ut(Ta),_t(Ta,De(Ca,m)),_t(Ta,De(Ca,x)),_t(Ta,De(Ca,E)),_t(Ta,De(Ca,S))}else lt(I,L,I+R,L+w,Ta);var M=t.canvas,F=y?y[2]*c/2:0,A=Ta[0]-F<=M.width&&Ta[2]+F>=0&&Ta[1]-F<=M.height&&Ta[3]+F>=0;if(d&&(e=Math.round(e),i=Math.round(i)),s){if(!A&&1==s[4])return;ft(s,Ta);var N=A?[t,O?O.slice(0):null,h,r,l,u,T,C,e,i,c]:null;N&&v&&N.push(g,y,m,x,E,S),s.push(N)}else A&&(v&&this.replayTextBackground_(t,m,x,E,S,g,y),Us(t,O,h,r,l,u,T,C,e,i,c))},e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},e.prototype.appendFlatCoordinates=function(t,e,i,r,n,o){var s=this.coordinates.length,a=this.getBufferedMaxExtent();o&&(e+=r);var h,l,u,p=[t[e],t[e+1]],c=[NaN,NaN],d=!0;for(h=e+r;h<i;h+=r)c[0]=t[h],c[1]=t[h+1],(u=at(a,c))!==l?(d&&(this.coordinates[s++]=p[0],this.coordinates[s++]=p[1]),this.coordinates[s++]=c[0],this.coordinates[s++]=c[1],d=!1):u===$.INTERSECTING?(this.coordinates[s++]=c[0],this.coordinates[s++]=c[1],d=!1):d=!0,p[0]=c[0],p[1]=c[1],l=u;return(n&&d||h===e+r)&&(this.coordinates[s++]=p[0],this.coordinates[s++]=p[1]),s},e.prototype.drawCustomCoordinates_=function(t,e,i,r,n){for(var o=0,s=i.length;o<s;++o){var a=i[o],h=this.appendFlatCoordinates(t,e,a,r,!1,!1);n.push(h),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var r,n,o,s,a,h=t.getType(),l=t.getStride(),u=this.coordinates.length;if(h==Nt.MULTI_POLYGON){r=(t=t).getOrientedFlatCoordinates(),s=[];var p=t.getEndss();a=0;for(var c=0,d=p.length;c<d;++c){var f=[];a=this.drawCustomCoordinates_(r,a,p[c],l,f),s.push(f)}this.instructions.push([xa.CUSTOM,u,s,t,i,oi])}else h==Nt.POLYGON||h==Nt.MULTI_LINE_STRING?(o=[],r=h==Nt.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(r,0,t.getEnds(),l,o),this.instructions.push([xa.CUSTOM,u,o,t,i,ni])):h==Nt.LINE_STRING||h==Nt.MULTI_POINT?(r=t.getFlatCoordinates(),n=this.appendFlatCoordinates(r,0,r.length,l,!1,!1),this.instructions.push([xa.CUSTOM,u,n,t,i,ri])):h==Nt.POINT&&(r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),n=this.coordinates.length,this.instructions.push([xa.CUSTOM,u,n,t,i]));this.endGeometry(t,e)},e.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[xa.BEGIN_GEOMETRY,e,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[xa.BEGIN_GEOMETRY,e,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){},e.prototype.fill_=function(t){if(this.alignFill_){var e=De(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.setTransform.apply(t,js)},e.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],ki&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},e.prototype.renderDeclutter_=function(t,e){if(t&&t.length>5){var i=t[4];if(1==i||i==t.length-5){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(!this.declutterTree.collides(r)){this.declutterTree.insert(r);for(var n=5,o=t.length;n<o;++n){var s=t[n];s&&(s.length>11&&this.replayTextBackground_(s[0],s[13],s[14],s[15],s[16],s[11],s[12]),Us.apply(void 0,s))}}t.length=5,ut(t)}}},e.prototype.replay_=function(t,e,i,r,n,s,a){var h;this.pixelCoordinates_&&Z(e,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=Gt(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),Ge(this.renderedTransform_,e));for(var l,u,p,c,f,_,g,y,v,m,x,E,S=!d(i),T=0,C=r.length,R=0,w=0,I=0,L=null,O=null,P=this.coordinateCache_,b=this.viewRotation_,M={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:b},F=this.instructions!=r||this.overlaps?0:200;T<C;){var A=r[T];switch(A[0]){case xa.BEGIN_GEOMETRY:m=A[1],S&&i[o(m)]||!m.getGeometry()?T=A[2]:void 0===a||Pt(a,m.getGeometry().getExtent())?++T:T=A[2]+1;break;case xa.BEGIN_PATH:w>F&&(this.fill_(t),w=0),I>F&&(t.stroke(),I=0),w||I||(t.beginPath(),c=f=NaN),++T;break;case xa.CIRCLE:var N=h[R=A[1]],G=h[R+1],D=h[R+2]-N,k=h[R+3]-G,j=Math.sqrt(D*D+k*k);t.moveTo(N+j,G),t.arc(N,G,j,0,2*Math.PI,!0),++T;break;case xa.CLOSE_PATH:t.closePath(),++T;break;case xa.CUSTOM:R=A[1],l=A[2];var U=A[3],Y=A[4],B=6==A.length?A[5]:void 0;M.geometry=U,M.feature=m,T in P||(P[T]=[]);var V=P[T];B?B(h,R,l,2,V):(V[0]=h[R],V[1]=h[R+1],V.length=2),Y(V,M),++T;break;case xa.DRAW_IMAGE:R=A[1],l=A[2],v=A[3],u=A[4],p=A[5],y=s?null:A[6];var X=A[7],z=A[8],W=A[9],K=A[10],H=A[11],q=A[12],J=A[13],Q=A[14],$=void 0,tt=void 0,et=void 0;for(A.length>16?($=A[15],tt=A[16],et=A[17]):($=Os,tt=et=!1),H&&(q+=b);R<l;R+=2)this.replayImage_(t,h[R],h[R+1],v,u,p,y,X,z,W,K,q,J,n,Q,$,tt?L:null,et?O:null);this.renderDeclutter_(y,m),++T;break;case xa.DRAW_CHARS:var it=A[1],rt=A[2],nt=A[3];y=s?null:A[4];var ot=A[5],st=A[6],at=A[7],ht=A[8],lt=A[9],ut=A[10],pt=A[11],ct=A[12],dt=A[13],ft=A[14],_t=ar(h,it,rt,2),gt=ht(ct);if(ot||gt<=_t){var yt=this,vt=yt.textStates[dt].textAlign,mt=fa(h,it,rt,2,ct,ht,(_t-gt)*Sa[vt],at);if(mt){var xt=void 0,Et=void 0,St=void 0,Tt=void 0,Ct=void 0;if(ut)for(xt=0,Et=mt.length;xt<Et;++xt)St=(Ct=mt[xt])[4],Tt=yt.getImage(St,dt,"",ut),u=Ct[2]+pt,p=nt*Tt.height+2*(.5-nt)*pt-lt,this.replayImage_(t,Ct[0],Ct[1],Tt,u,p,y,Tt.height,1,0,0,Ct[3],ft,!1,Tt.width,Os,null,null);if(st)for(xt=0,Et=mt.length;xt<Et;++xt)St=(Ct=mt[xt])[4],Tt=yt.getImage(St,dt,st,""),u=Ct[2],p=nt*Tt.height-lt,this.replayImage_(t,Ct[0],Ct[1],Tt,u,p,y,Tt.height,1,0,0,Ct[3],ft,!1,Tt.width,Os,null,null)}}this.renderDeclutter_(y,m),++T;break;case xa.END_GEOMETRY:if(void 0!==s){var Rt=s(m=A[1]);if(Rt)return Rt}++T;break;case xa.FILL:F?w++:this.fill_(t),++T;break;case xa.MOVE_TO_LINE_TO:for(R=A[1],l=A[2],x=h[R],g=(E=h[R+1])+.5|0,(_=x+.5|0)===c&&g===f||(t.moveTo(x,E),c=_,f=g),R+=2;R<l;R+=2)_=(x=h[R])+.5|0,g=(E=h[R+1])+.5|0,R!=l-2&&_===c&&g===f||(t.lineTo(x,E),c=_,f=g);++T;break;case xa.SET_FILL_STYLE:L=A,this.alignFill_=A[2],w&&(this.fill_(t),w=0,I&&(t.stroke(),I=0)),t.fillStyle=A[1],++T;break;case xa.SET_STROKE_STYLE:O=A,I&&(t.stroke(),I=0),this.setStrokeStyle_(t,A),++T;break;case xa.STROKE:F?I++:t.stroke(),++T;break;default:++T}}w&&this.fill_(t),I&&t.stroke()},e.prototype.replay=function(t,e,i,r,n){this.viewRotation_=i,this.replay_(t,e,r,this.instructions,n,void 0,void 0)},e.prototype.replayHitDetection=function(t,e,i,r,n,o){return this.viewRotation_=i,this.replay_(t,e,r,this.hitDetectionInstructions,!0,n,o)},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,r,n=e.length,o=-1;for(t=0;t<n;++t)(r=(i=e[t])[0])==xa.END_GEOMETRY?o=t:r==xa.BEGIN_GEOMETRY&&(i[2]=t,W(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var r=t.getColor();i.fillStyle=Ys(r||ws)}else i.fillStyle=void 0;if(e){var n=e.getColor();i.strokeStyle=Ys(n||Ls);var o=e.getLineCap();i.lineCap=void 0!==o?o:"round";var s=e.getLineDash();i.lineDash=s?s.slice():Is;var a=e.getLineDashOffset();i.lineDashOffset=a||0;var h=e.getLineJoin();i.lineJoin=void 0!==h?h:"round";var l=e.getWidth();i.lineWidth=void 0!==l?l:1;var u=e.getMiterLimit();i.miterLimit=void 0!==u?u:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t,e){var i=t.fillStyle,r=[xa.SET_FILL_STYLE,i];return"string"!=typeof i&&r.push(!0),r},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[xa.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e,i){var r=t.fillStyle;"string"==typeof r&&t.currentFillStyle==r||(void 0!==r&&this.instructions.push(e.call(this,t,i)),t.currentFillStyle=r)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,r=t.lineCap,n=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||n!=t.currentLineDash&&!Z(t.currentLineDash,n)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=h)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=n,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=h)},e.prototype.endGeometry=function(t,e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var i=[xa.END_GEOMETRY,e];this.instructions.push(i),this.hitDetectionInstructions.push(i)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=it(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;et(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(Vs),wa=function(t){function e(e,i,r,n,o,s){t.call(this,e,i,r,n,o,s),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,r){return this.appendFlatCoordinates(t,e,i,r,!1,!1)},e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),r=t.getStride(),n=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,r);this.instructions.push([xa.DRAW_IMAGE,n,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([xa.DRAW_IMAGE,n,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t,e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),r=t.getStride(),n=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,r);this.instructions.push([xa.DRAW_IMAGE,n,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([xa.DRAW_IMAGE,n,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t,e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),r=t.getSize(),n=t.getHitDetectionImage(1),o=t.getImage(1),s=t.getOrigin();this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroup_=e,this.hitDetectionImage_=n,this.image_=o,this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=r[0]},e}(Ra),Ia=function(t){function e(e,i,r,n,o,s){t.call(this,e,i,r,n,o,s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawFlatCoordinates_=function(t,e,i,r){var n=this.coordinates.length,o=this.appendFlatCoordinates(t,e,i,r,!1,!1),s=[xa.MOVE_TO_LINE_TO,n,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i},e.prototype.drawLineString=function(t,e){var i=this.state,r=i.strokeStyle,n=i.lineWidth;if(void 0!==r&&void 0!==n){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([xa.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],va);var o=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(o,0,o.length,s),this.hitDetectionInstructions.push(ya),this.endGeometry(t,e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state,r=i.strokeStyle,n=i.lineWidth;if(void 0!==r&&void 0!==n){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([xa.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],va);for(var o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),h=0,l=0,u=o.length;l<u;++l)h=this.drawFlatCoordinates_(s,h,o[l],a);this.hitDetectionInstructions.push(ya),this.endGeometry(t,e)}},e.prototype.finish=function(){var t=this.state;void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(ya),this.reverseHitDetectionInstructions(),this.state=null},e.prototype.applyStroke=function(e){void 0!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(ya),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(va)},e}(Ra),La=function(t){function e(e,i,r,n,o,s){t.call(this,e,i,r,n,o,s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawFlatCoordinatess_=function(t,e,i,r){var n=this.state,o=void 0!==n.fillStyle,s=void 0!=n.strokeStyle,a=i.length;this.instructions.push(va),this.hitDetectionInstructions.push(va);for(var h=0;h<a;++h){var l=i[h],u=this.coordinates.length,p=this.appendFlatCoordinates(t,e,l,r,!0,!s),c=[xa.MOVE_TO_LINE_TO,u,p];this.instructions.push(c),this.hitDetectionInstructions.push(c),s&&(this.instructions.push(ma),this.hitDetectionInstructions.push(ma)),e=l}return o&&(this.instructions.push(ga),this.hitDetectionInstructions.push(ga)),s&&(this.instructions.push(ya),this.hitDetectionInstructions.push(ya)),e},e.prototype.drawCircle=function(t,e){var i=this.state,r=i.fillStyle,n=i.strokeStyle;if(void 0!==r||void 0!==n){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([xa.SET_FILL_STYLE,dr(ws)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([xa.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(o,0,o.length,s,!1,!1);var h=[xa.CIRCLE,a];this.instructions.push(va,h),this.hitDetectionInstructions.push(va,h),this.hitDetectionInstructions.push(ga),void 0!==i.fillStyle&&this.instructions.push(ga),void 0!==i.strokeStyle&&(this.instructions.push(ya),this.hitDetectionInstructions.push(ya)),this.endGeometry(t,e)}},e.prototype.drawPolygon=function(t,e){var i=this.state,r=i.fillStyle,n=i.strokeStyle;if(void 0!==r||void 0!==n){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([xa.SET_FILL_STYLE,dr(ws)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([xa.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,o,a),this.endGeometry(t,e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state,r=i.fillStyle,n=i.strokeStyle;if(void 0!==r||void 0!==n){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([xa.SET_FILL_STYLE,dr(ws)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([xa.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),h=0,l=0,u=o.length;l<u;++l)h=this.drawFlatCoordinatess_(s,h,o[l],a);this.endGeometry(t,e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,i=0,r=e.length;i<r;++i)e[i]=hi(e[i],t)},e.prototype.setFillStrokeStyles_=function(t){var e=this.state;void 0!==e.fillStyle&&this.updateFillStyle(e,this.createFill,t),void 0!==e.strokeStyle&&this.updateStrokeStyle(e,this.applyStroke)},e}(Ra);function Oa(t,e,i,r,n){var o,s,a,h,l,u,p,c,d,f=i,_=i,g=0,y=0,v=i;for(o=i;o<r;o+=n){var m=e[o],x=e[o+1];void 0!==h&&(c=m-h,d=x-l,a=Math.sqrt(c*c+d*d),void 0!==u&&(y+=s,Math.acos((u*c+p*d)/(s*a))>t&&(y>g&&(g=y,f=v,_=o),y=0,v=o-n)),s=a,u=c,p=d),h=m,l=x}return(y+=a)>g?[v,o]:[f,_]}var Pa={Circle:La,Default:Ra,Image:wa,LineString:Ia,Polygon:La,Text:function(t){function e(e,i,r,n,o,s){t.call(this,e,i,r,n,o,s),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},Ps.prune()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText=function(t,e){var i=this.textFillState_,r=this.textStrokeState_,n=this.textState_;if(""!==this.text_&&n&&(i||r)){var o,s,a=this.coordinates.length,h=t.getType(),l=null,u=2,p=2;if(n.placement===Tr){if(!Pt(this.getBufferedMaxExtent(),t.getExtent()))return;var c;if(l=t.getFlatCoordinates(),p=t.getStride(),h==Nt.LINE_STRING)c=[l.length];else if(h==Nt.MULTI_LINE_STRING)c=t.getEnds();else if(h==Nt.POLYGON)c=t.getEnds().slice(0,1);else if(h==Nt.MULTI_POLYGON){var d=t.getEndss();for(c=[],o=0,s=d.length;o<s;++o)c.push(d[o][0])}this.beginGeometry(t,e);for(var f,_=n.textAlign,g=0,y=0,v=c.length;y<v;++y){if(void 0==_){var m=Oa(n.maxAngle,l,g,c[y],p);g=m[0],f=m[1]}else f=c[y];for(o=g;o<f;o+=p)this.coordinates.push(l[o],l[o+1]);u=this.coordinates.length,g=c[y],this.drawChars_(a,u,this.declutterGroup_),a=u}this.endGeometry(t,e)}else{var x=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),E=x.width/this.pixelRatio;switch(h){case Nt.POINT:case Nt.MULTI_POINT:u=(l=t.getFlatCoordinates()).length;break;case Nt.LINE_STRING:l=t.getFlatMidpoint();break;case Nt.CIRCLE:l=t.getCenter();break;case Nt.MULTI_LINE_STRING:u=(l=t.getFlatMidpoints()).length;break;case Nt.POLYGON:if(l=t.getFlatInteriorPoint(),!n.overflow&&l[2]/this.resolution<E)return;p=3;break;case Nt.MULTI_POLYGON:var S=t.getFlatInteriorPoints();for(l=[],o=0,s=S.length;o<s;o+=3)(n.overflow||S[o+2]/this.resolution>=E)&&l.push(S[o],S[o+1]);if(0==(u=l.length))return}u=this.appendFlatCoordinates(l,0,u,p,!1,!1),(n.backgroundFill||n.backgroundStroke)&&(this.setFillStrokeStyle(n.backgroundFill,n.backgroundStroke),n.backgroundFill&&(this.updateFillStyle(this.state,this.createFill,t),this.hitDetectionInstructions.push(this.createFill(this.state,t))),n.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e),this.drawTextImage_(x,a,u),this.endGeometry(t,e)}}},e.prototype.getImage=function(t,e,i,r){var n,o=r+e+t+i+this.pixelRatio;if(!Ps.containsKey(o)){var s=r?this.strokeStates[r]||this.textStrokeState_:null,a=i?this.fillStates[i]||this.textFillState_:null,h=this.textStates[e]||this.textState_,l=this.pixelRatio,u=h.scale*l,p=Sa[h.textAlign||"center"],c=r&&s.lineWidth?s.lineWidth:0,d=t.split("\n"),f=d.length,_=[],g=function(t,e,i){for(var r=e.length,n=0,o=0;o<r;++o){var s=Ds(t,e[o]);n=Math.max(n,s),i.push(s)}return n}(h.font,d,_),y=Gs(h.font),v=y*f,m=g+c,x=Jn(Math.ceil(m*u),Math.ceil((v+c)*u));n=x.canvas,Ps.set(o,n),1!=u&&x.scale(u,u),x.font=h.font,r&&(x.strokeStyle=s.strokeStyle,x.lineWidth=c,x.lineCap=s.lineCap,x.lineJoin=s.lineJoin,x.miterLimit=s.miterLimit,ki&&s.lineDash.length&&(x.setLineDash(s.lineDash),x.lineDashOffset=s.lineDashOffset)),i&&(x.fillStyle=a.fillStyle),x.textBaseline="middle",x.textAlign="center";var E,S=.5-p,T=p*n.width/u+S*c;if(r)for(E=0;E<f;++E)x.strokeText(d[E],T+S*_[E],.5*(c+y)+E*y);if(i)for(E=0;E<f;++E)x.fillText(d[E],T+S*_[E],.5*(c+y)+E*y)}return Ps.get(o)},e.prototype.drawTextImage_=function(t,e,i){var r=this.textState_,n=this.textStrokeState_,o=this.pixelRatio,s=Sa[r.textAlign||"center"],a=Sa[r.textBaseline],h=n&&n.lineWidth?n.lineWidth:0,l=s*t.width/o+2*(.5-s)*h,u=a*t.height/o+2*(.5-a)*h;this.instructions.push([xa.DRAW_IMAGE,e,i,t,(l-this.textOffsetX_)*o,(u-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,t.width,r.padding==Os?Os:r.padding.map(function(t){return t*o}),!!r.backgroundFill,!!r.backgroundStroke]),this.hitDetectionInstructions.push([xa.DRAW_IMAGE,e,i,t,(l-this.textOffsetX_)*o,(u-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/o,t.width,r.padding,!!r.backgroundFill,!!r.backgroundStroke])},e.prototype.drawChars_=function(t,e,i){var r=this.textStrokeState_,n=this.textState_,o=this.textFillState_,s=this.strokeKey_;r&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:r.strokeStyle,lineCap:r.lineCap,lineDashOffset:r.lineDashOffset,lineWidth:r.lineWidth,lineJoin:r.lineJoin,miterLimit:r.miterLimit,lineDash:r.lineDash}));var a=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:n.font,textAlign:n.textAlign||"center",scale:n.scale});var h=this.fillKey_;o&&(h in this.fillStates||(this.fillStates[h]={fillStyle:o.fillStyle}));var l=this.pixelRatio,u=Sa[n.textBaseline],p=this.textOffsetY_*l,c=this.text_,d=n.font,f=n.scale,_=r?r.lineWidth*f/2:0,g=this.widths_[d];g||(this.widths_[d]=g={}),this.instructions.push([xa.DRAW_CHARS,t,e,u,i,n.overflow,h,n.maxAngle,function(t){var e=g[t];return e||(e=g[t]=Ds(d,t)),e*f*l},p,s,_*l,c,a,1]),this.hitDetectionInstructions.push([xa.DRAW_CHARS,t,e,u,i,n.overflow,h,n.maxAngle,function(t){var e=g[t];return e||(e=g[t]=Ds(d,t)),e*f},p,s,_,c,a,1/l])},e.prototype.setTextStyle=function(t,e){var i,r,n;if(t){this.declutterGroup_=e;var s=t.getFill();s?((r=this.textFillState_)||(r=this.textFillState_={}),r.fillStyle=Ys(s.getColor()||ws)):r=this.textFillState_=null;var a=t.getStroke();if(a){(n=this.textStrokeState_)||(n=this.textStrokeState_={});var h=a.getLineDash(),l=a.getLineDashOffset(),u=a.getWidth(),p=a.getMiterLimit();n.lineCap=a.getLineCap()||"round",n.lineDash=h?h.slice():Is,n.lineDashOffset=void 0===l?0:l,n.lineJoin=a.getLineJoin()||"round",n.lineWidth=void 0===u?1:u,n.miterLimit=void 0===p?10:p,n.strokeStyle=Ys(a.getColor()||Ls)}else n=this.textStrokeState_=null;i=this.textState_;var c=t.getFont()||"10px sans-serif";As(c);var d=t.getScale();i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||"middle",i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Os,i.scale=void 0===d?1:d;var f=t.getOffsetX(),_=t.getOffsetY(),g=t.getRotateWithView(),y=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===f?0:f,this.textOffsetY_=void 0===_?0:_,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===y?0:y,this.strokeKey_=n?("string"==typeof n.strokeStyle?n.strokeStyle:o(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+o(r.fillStyle):""}else this.text_=""},e}(Ra)},ba=function(t){function e(e,i,r,n,o,s,a){t.call(this),this.declutterTree_=s,this.declutterGroup_=null,this.tolerance_=e,this.maxExtent_=i,this.overlaps_=o,this.pixelRatio_=n,this.resolution_=r,this.renderBuffer_=a,this.replaysByZIndex_={},this.hitDetectionContext_=Jn(1,1),this.hitDetectionTransform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addDeclutter=function(t){var e=null;return this.declutterTree_&&(t?(e=this.declutterGroup_)[4]++:(e=this.declutterGroup_=[1/0,1/0,-1/0,-1/0]).push(1)),e},e.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},e.prototype.hasReplays=function(t){for(var e in this.replaysByZIndex_)for(var i=this.replaysByZIndex_[e],r=0,n=t.length;r<n;++r)if(t[r]in i)return!0;return!1},e.prototype.finish=function(){for(var t in this.replaysByZIndex_){var e=this.replaysByZIndex_[t];for(var i in e)e[i].finish()}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,n,o,s){var a,h=2*(r=Math.round(r))+1,l=Ye(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-i,-t[0],-t[1]),u=this.hitDetectionContext_;u.canvas.width!==h||u.canvas.height!==h?(u.canvas.width=h,u.canvas.height=h):u.clearRect(0,0,h,h),void 0!==this.renderBuffer_&&(_t(a=[1/0,1/0,-1/0,-1/0],t),et(a,e*(this.renderBuffer_+r),a));var p,c,d=function(t){if(void 0!==Ma[t])return Ma[t];for(var e=2*t+1,i=new Array(e),r=0;r<e;r++)i[r]=new Array(e);var n=t,o=0,s=0;for(;n>=o;)Fa(i,t+n,t+o),Fa(i,t+o,t+n),Fa(i,t-o,t+n),Fa(i,t-n,t+o),Fa(i,t-n,t-o),Fa(i,t-o,t-n),Fa(i,t+o,t-n),Fa(i,t+n,t-o),2*((s+=1+2*++o)-n)+1>0&&(s+=1-2*(n-=1));return Ma[t]=i,i}(r);function f(t){for(var e=u.getImageData(0,0,h,h).data,i=0;i<h;i++)for(var r=0;r<h;r++)if(d[i][r]&&e[4*(r*h+i)+3]>0){var n=void 0;return(!p||c!=da.IMAGE&&c!=da.TEXT||-1!==p.indexOf(t))&&(n=o(t)),n||void u.clearRect(0,0,h,h)}}this.declutterTree_&&(p=this.declutterTree_.all().map(function(t){return t.value}));var _,g,y,v,m,x=Object.keys(this.replaysByZIndex_).map(Number);for(x.sort(V),_=x.length-1;_>=0;--_){var E=x[_].toString();for(y=this.replaysByZIndex_[E],g=Ea.length-1;g>=0;--g)if(void 0!==(v=y[c=Ea[g]]))if(!s||c!=da.IMAGE&&c!=da.TEXT){if(m=v.replayHitDetection(u,l,i,n,f,a))return m}else{var S=s[E];S?S.push(v,l.slice(0)):s[E]=[v,l.slice(0)]}}},e.prototype.getClipCoords=function(t){var e=this.maxExtent_,i=e[0],r=e[1],n=e[2],o=e[3],s=[i,r,i,o,n,o,n,r];return Gt(s,0,8,2,t,s),s},e.prototype.getReplay=function(t,e){var i=void 0!==t?t.toString():"0",r=this.replaysByZIndex_[i];void 0===r&&(r={},this.replaysByZIndex_[i]=r);var n=r[e];void 0===n&&(n=new(0,Pa[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),r[e]=n);return n},e.prototype.getReplays=function(){return this.replaysByZIndex_},e.prototype.isEmpty=function(){return d(this.replaysByZIndex_)},e.prototype.replay=function(t,e,i,r,n,o,s){var a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(V),t.save(),this.clip(t,e);var h,l,u,p,c,d,f=o||Ea;for(h=0,l=a.length;h<l;++h){var _=a[h].toString();for(c=this.replaysByZIndex_[_],u=0,p=f.length;u<p;++u){var g=f[u];if(d=c[g],void 0!==d)if(!s||g!=da.IMAGE&&g!=da.TEXT)d.replay(t,e,i,r,n);else{var y=s[_];y?y.push(d,e.slice(0)):s[_]=[d,e.slice(0)]}}}t.restore()},e}(ca),Ma={0:[[!0]]};function Fa(t,e,i){var r,n=Math.floor(t.length/2);if(e>=n)for(r=n;r<e;r++)t[r][i]=!0;else if(e<n)for(r=e+1;r<n;r++)t[r][i]=!0}var Aa=ba,Na=.5,Ga={Point:function(t,e,i,r){var n=i.getImage();if(n){if(n.getImageState()!=xs.LOADED)return;var o=t.getReplay(i.getZIndex(),da.IMAGE);o.setImageStyle(n,t.addDeclutter(!1)),o.drawPoint(e,r)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),da.TEXT);a.setTextStyle(s,t.addDeclutter(!!n)),a.drawText(e,r)}},LineString:function(t,e,i,r){var n=i.getStroke();if(n){var o=t.getReplay(i.getZIndex(),da.LINE_STRING);o.setFillStrokeStyle(null,n),o.drawLineString(e,r)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),da.TEXT);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,r)}},Polygon:function(t,e,i,r){var n=i.getFill(),o=i.getStroke();if(n||o){var s=t.getReplay(i.getZIndex(),da.POLYGON);s.setFillStrokeStyle(n,o),s.drawPolygon(e,r)}var a=i.getText();if(a){var h=t.getReplay(i.getZIndex(),da.TEXT);h.setTextStyle(a,t.addDeclutter(!1)),h.drawText(e,r)}},MultiPoint:function(t,e,i,r){var n=i.getImage();if(n){if(n.getImageState()!=xs.LOADED)return;var o=t.getReplay(i.getZIndex(),da.IMAGE);o.setImageStyle(n,t.addDeclutter(!1)),o.drawMultiPoint(e,r)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),da.TEXT);a.setTextStyle(s,t.addDeclutter(!!n)),a.drawText(e,r)}},MultiLineString:function(t,e,i,r){var n=i.getStroke();if(n){var o=t.getReplay(i.getZIndex(),da.LINE_STRING);o.setFillStrokeStyle(null,n),o.drawMultiLineString(e,r)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),da.TEXT);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,r)}},MultiPolygon:function(t,e,i,r){var n=i.getFill(),o=i.getStroke();if(o||n){var s=t.getReplay(i.getZIndex(),da.POLYGON);s.setFillStrokeStyle(n,o),s.drawMultiPolygon(e,r)}var a=i.getText();if(a){var h=t.getReplay(i.getZIndex(),da.TEXT);h.setTextStyle(a,t.addDeclutter(!1)),h.drawText(e,r)}},GeometryCollection:function(t,e,i,r){var n,o,s=e.getGeometriesArray();for(n=0,o=s.length;n<o;++n){var a=Ga[s[n].getType()];a(t,s[n],i,r)}},Circle:function(t,e,i,r){var n=i.getFill(),o=i.getStroke();if(n||o){var s=t.getReplay(i.getZIndex(),da.CIRCLE);s.setFillStrokeStyle(n,o),s.drawCircle(e,r)}var a=i.getText();if(a){var h=t.getReplay(i.getZIndex(),da.TEXT);h.setTextStyle(a,t.addDeclutter(!1)),h.drawText(e,r)}}};function Da(t,e){return parseInt(o(t),10)-parseInt(o(e),10)}function ka(t,e){var i=ja(t,e);return i*i}function ja(t,e){return Na*t/e}function Ua(t,e,i,r,n,o){var s=!1,a=i.getImage();if(a){var h=a.getImageState();h==xs.LOADED||h==xs.ERROR?a.unlistenImageChange(n,o):(h==xs.IDLE&&a.load(),h=a.getImageState(),a.listenImageChange(n,o),s=!0)}return function(t,e,i,r){var n=i.getGeometryFunction()(e);if(!n)return;var o=n.getSimplifiedGeometry(r);if(i.getRenderer())!function t(e,i,r,n){if(i.getType()==Nt.GEOMETRY_COLLECTION){for(var o=i.getGeometries(),s=0,a=o.length;s<a;++s)t(e,o[s],r,n);return}var h=e.getReplay(r.getZIndex(),da.DEFAULT);h.drawCustom(i,n,r.getRenderer())}(t,o,i,e);else{var s=Ga[o.getType()];s(t,o,i,e)}}(t,e,i,r),s}var Ya=function(t){function e(e){t.call(this,e),this.declutterTree_=e.getDeclutter()?ua()(9,void 0):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=Jn(),v(Ps,M.CLEAR,this.handleFontsChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){x(Ps,M.CLEAR,this.handleFontsChanged_,this),t.prototype.disposeInternal.call(this)},e.prototype.compose=function(t,e,i){var r=e.extent,n=e.pixelRatio,o=i.managed?e.skippedFeatureUids:{},s=e.viewState,a=s.projection,h=s.rotation,l=a.getExtent(),u=this.getLayer().getSource(),p=this.getTransform(e,0),c=i.extent,d=void 0!==c;d&&this.clip(t,e,c);var f=this.replayGroup_;if(f&&!f.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();var _,g=this.getLayer(),y=0,v=0,m=1!==i.opacity,x=g.hasListener(ur.RENDER);if(m||x){var E=t.canvas.width,S=t.canvas.height;if(h){var T=Math.round(Math.sqrt(E*E+S*S));y=(T-E)/2,v=(T-S)/2,E=S=T}this.context.canvas.width=E,this.context.canvas.height=S,_=this.context}else _=t;var C=_.globalAlpha;m||(_.globalAlpha=i.opacity),_!=t&&_.translate(y,v);var R=e.viewHints,w=!(R[kn]||R[jn]),I=e.size[0]*n,L=e.size[1]*n;if(ks(_,-h,I/2,L/2),f.replay(_,p,h,o,w),u.getWrapX()&&a.canWrapX()&&!ot(l,r)){for(var O,P=r[0],b=Ot(l),M=0;P<l[0];)O=b*--M,p=this.getTransform(e,O),f.replay(_,p,h,o,w),P+=b;for(M=0,P=r[2];P>l[2];)O=b*++M,p=this.getTransform(e,O),f.replay(_,p,h,o,w),P-=b}if(ks(_,h,I/2,L/2),x&&this.dispatchRenderEvent(_,e,p),_!=t){if(m){var F=t.globalAlpha;t.globalAlpha=i.opacity,t.drawImage(_.canvas,-y,-v),t.globalAlpha=F}else t.drawImage(_.canvas,-y,-v);_.translate(-y,-v)}m||(_.globalAlpha=C)}d&&t.restore()},e.prototype.composeFrame=function(t,e,i){var r=this.getTransform(t,0);this.preCompose(i,t,r),this.compose(i,t,e),this.postCompose(i,t,e,r)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,n){if(this.replayGroup_){var s=e.viewState.resolution,a=e.viewState.rotation,h=this.getLayer(),l={};return this.replayGroup_.forEachFeatureAtCoordinate(t,s,a,i,{},function(t){var e=o(t);if(!(e in l))return l[e]=!0,r.call(n,t,h)},null)}},e.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t,e){var i=this.getLayer(),r=i.getSource(),n=t.viewHints[kn],o=t.viewHints[jn],s=i.getUpdateWhileAnimating(),a=i.getUpdateWhileInteracting();if(!this.dirty_&&!s&&n||!a&&o)return!0;var h=t.extent,l=t.viewState,u=l.projection,p=l.resolution,c=t.pixelRatio,d=i.getRevision(),f=i.getRenderBuffer(),_=i.getRenderOrder();void 0===_&&(_=Da);var g=et(h,f*p),y=l.projection.getExtent();if(r.getWrapX()&&l.projection.canWrapX()&&!ot(y,t.extent)){var v=Ot(y),m=Math.max(Ot(g)/2,v);g[0]=y[0]-m,g[2]=y[2]+m}if(!this.dirty_&&this.renderedResolution_==p&&this.renderedRevision_==d&&this.renderedRenderOrder_==_&&ot(this.renderedExtent_,g))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var x=new Aa(ja(p,c),g,p,c,r.getOverlaps(),this.declutterTree_,i.getRenderBuffer());r.loadFeatures(g,p,u);var E=function(t){var e,r=t.getStyleFunction()||i.getStyleFunction();if(r&&(e=r(t,p)),e){var n=this.renderFeature(t,p,c,e,x);this.dirty_=this.dirty_||n}}.bind(this);if(_){var S=[];r.forEachFeatureInExtent(g,function(t){S.push(t)}),S.sort(_);for(var T=0,C=S.length;T<C;++T)E(S[T])}else r.forEachFeatureInExtent(g,E);return x.finish(),this.renderedResolution_=p,this.renderedRevision_=d,this.renderedRenderOrder_=_,this.renderedExtent_=g,this.replayGroup_=x,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,i,r,n){if(!r)return!1;var o=!1;if(Array.isArray(r))for(var s=0,a=r.length;s<a;++s)o=Ua(n,t,r[s],ka(e,i),this.handleStyleImageChange_,this)||o;else o=Ua(n,t,r,ka(e,i),this.handleStyleImageChange_,this);return o},e}(ta);Ya.handles=function(t){return t.getType()===Ss.VECTOR},Ya.create=function(t,e){return new Ya(e)};var Ba=Ya,Va={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"},Xa={image:[da.POLYGON,da.CIRCLE,da.LINE_STRING,da.IMAGE,da.TEXT],hybrid:[da.POLYGON,da.LINE_STRING]},za={image:[da.DEFAULT],hybrid:[da.IMAGE,da.TEXT,da.DEFAULT],vector:Ea},Wa=function(t){function e(e){t.call(this,e,!0),this.declutterTree_=e.getDeclutter()?ua()(9,void 0):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=[1,0,0,1,0,0];var i=e.getRenderMode();this.zDirection=i===Va.VECTOR?1:0,i!==Va.VECTOR&&(this.context=Jn()),v(Ps,M.CLEAR,this.handleFontsChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){x(Ps,M.CLEAR,this.handleFontsChanged_,this),t.prototype.disposeInternal.call(this)},e.prototype.getTile=function(e,i,r,n,o){var s=t.prototype.getTile.call(this,e,i,r,n,o);return s.getState()===On.LOADED&&(this.createReplayGroup_(s,n,o),this.context&&this.renderTileImage_(s,n,o)),s},e.prototype.getTileImage=function(t){var e=this.getLayer();return t.getImage(e)},e.prototype.prepareFrame=function(e,i){var r=this.getLayer().getRevision();return this.renderedLayerRevision_!=r&&(this.renderedTiles.length=0),this.renderedLayerRevision_=r,t.prototype.prepareFrame.call(this,e,i)},e.prototype.createReplayGroup_=function(t,e,i){var r=this,n=this.getLayer(),o=n.getRevision(),s=n.getRenderOrder()||null,a=t.getReplayState(n);if(a.dirty||a.renderedRevision!=o||a.renderedRenderOrder!=s){for(var h=n.getSource(),l=h.getTileGrid(),u=h.getTileGridForProjection(i).getResolution(t.tileCoord[0]),p=t.extent,c=function(o,c){var d=t.getTile(t.tileKeys[o]);if(d.getState()==On.LOADED){var f=d.tileCoord,_=l.getTileCoordExtent(f),g=wt(p,_),y=dt(_,g)?null:et(g,n.getRenderBuffer()*u,r.tmpExtent),v=d.getProjection(),m=!1;Ie(i,v)||(m=!0,d.setProjection(i)),a.dirty=!1;var x=new Aa(0,g,u,e,h.getOverlaps(),r.declutterTree_,n.getRenderBuffer()),E=ka(u,e),S=function(t){var e,i=t.getStyleFunction()||n.getStyleFunction();if(i&&(e=i(t,u)),e){var r=this.renderFeature(t,E,e,x);this.dirty_=this.dirty_||r,a.dirty=a.dirty||r}},T=d.getFeatures();s&&s!==a.renderedRenderOrder&&T.sort(s);for(var C=0,R=T.length;C<R;++C){var w=T[C];m&&(v.getUnits()==$t.TILE_PIXELS&&(v.setWorldExtent(_),v.setExtent(d.getExtent())),w.getGeometry().transform(v,i)),y&&!Pt(y,w.getGeometry().getExtent())||S.call(r,w)}x.finish(),d.setReplayGroup(n,t.tileCoord.toString(),x)}},d=0,f=t.tileKeys.length;d<f;++d)c(d);a.renderedRevision=o,a.renderedRenderOrder=s}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,n){var s=e.viewState.resolution,a=e.viewState.rotation;i=void 0==i?0:i;var h,l,u,p,c=this.getLayer(),d={},f=this.renderedTiles;for(u=0,p=f.length;u<p;++u){var _=f[u];if(nt(h=et(_.extent,i*s,h),t))for(var g=0,y=_.tileKeys.length;g<y;++g){var v=_.getTile(_.tileKeys[g]);if(v.getState()==On.LOADED){var m=v.getReplayGroup(c,_.tileCoord.toString());l=l||m.forEachFeatureAtCoordinate(t,s,a,i,{},function(t){var e=o(t);if(!(e in d))return d[e]=!0,r.call(n,t,c)},null)}}}return l},e.prototype.getReplayTransform_=function(t,e){var i=this.getLayer().getSource().getTileGrid(),r=t.tileCoord,n=i.getResolution(r[0]),o=e.viewState,s=e.pixelRatio,a=o.resolution/s,h=i.getTileCoordExtent(r,this.tmpExtent),l=o.center,u=It(h),p=e.size,c=Math.round(s*p[0]/2),d=Math.round(s*p[1]/2);return Ye(this.tmpTransform_,c,d,n/a,n/a,o.rotation,(u[0]-l[0])/n,(l[1]-u[1])/n)},e.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.postCompose=function(e,i,r){var n=this.getLayer(),o=n.getRenderMode();if(o!=Va.IMAGE){var s,a,h=n.getDeclutter()?{}:null,l=n.getSource(),u=za[o],p=i.pixelRatio,c=i.viewState.rotation,d=i.size;c&&ks(e,-c,s=Math.round(p*d[0]/2),a=Math.round(p*d[1]/2)),h&&this.declutterTree_.clear();for(var f=i.viewHints,_=!(f[kn]||f[jn]),g=this.renderedTiles,y=l.getTileGridForProjection(i.viewState.projection),v=[],m=[],x=g.length-1;x>=0;--x){var E=g[x];if(E.getState()!=On.ABORT)for(var S=E.tileCoord,T=y.getTileCoordExtent(S,this.tmpExtent)[0]-E.extent[0],C=void 0,R=0,w=E.tileKeys.length;R<w;++R){var I=E.getTile(E.tileKeys[R]);if(I.getState()==On.LOADED){var L=I.getReplayGroup(n,S.toString());if(L&&L.hasReplays(u)){C||(C=this.getTransform(i,T));var O=I.tileCoord[0],P=L.getClipCoords(C);e.save(),e.globalAlpha=r.opacity;for(var b=0,M=v.length;b<M;++b){var F=v[b];O<m[b]&&(e.beginPath(),e.moveTo(P[0],P[1]),e.lineTo(P[2],P[3]),e.lineTo(P[4],P[5]),e.lineTo(P[6],P[7]),e.moveTo(F[6],F[7]),e.lineTo(F[4],F[5]),e.lineTo(F[2],F[3]),e.lineTo(F[0],F[1]),e.clip())}L.replay(e,C,c,{},_,u,h),e.restore(),v.push(P),m.push(O)}}}}h&&function(t,e,i,r){for(var n=Object.keys(t).map(Number).sort(V),o={},s=0,a=n.length;s<a;++s)for(var h=t[n[s].toString()],l=0,u=h.length;l<u;){var p=h[l++],c=h[l++];p.replay(e,c,i,o,r)}}(h,e,c,_),c&&ks(e,c,s,a)}t.prototype.postCompose.call(this,e,i,r)},e.prototype.renderFeature=function(t,e,i,r){if(!i)return!1;var n=!1;if(Array.isArray(i))for(var o=0,s=i.length;o<s;++o)n=Ua(r,t,i[o],e,this.handleStyleImageChange_,this)||n;else n=Ua(r,t,i,e,this.handleStyleImageChange_,this);return n},e.prototype.renderTileImage_=function(t,e,i){var r=this.getLayer(),n=t.getReplayState(r),o=r.getRevision(),s=Xa[r.getRenderMode()];if(s&&n.renderedTileRevision!==o){n.renderedTileRevision=o;var a=t.wrappedTileCoord,h=a[0],l=r.getSource(),u=l.getTileGridForProjection(i),p=u.getResolution(h),c=t.getContext(r),d=l.getTilePixelSize(h,e,i);c.canvas.width=d[0],c.canvas.height=d[1];for(var f=u.getTileCoordExtent(a,this.tmpExtent),_=0,g=t.tileKeys.length;_<g;++_){var y=t.getTile(t.tileKeys[_]);if(y.getState()==On.LOADED){var v=e/p,m=Fe(this.tmpTransform_);je(m,v,-v),Ue(m,-f[0],-f[3]),y.getReplayGroup(r,t.tileCoord.toString()).replay(c,m,0,{},!0,s)}}}},e}(ha);Wa.handles=function(t){return t.getType()===Ss.VECTOR_TILE},Wa.create=function(t,e){return new Wa(e)};var Ka=Wa,Ha=function(t){function e(e){(e=u({},e)).controls||(e.controls=wo()),e.interactions||(e.interactions=ys()),t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){var t=new Qs(this);return t.registerLayerRenderers([ra,ha,Ba,Ka]),t},e}(lo),Za={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"},qa={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},Ja=function(t){function e(e){t.call(this),this.options=e,this.id=e.id,this.insertFirst=void 0===e.insertFirst||e.insertFirst,this.stopEvent=void 0===e.stopEvent||e.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==e.className?e.className:"ol-overlay-container "+co,this.element.style.position="absolute",this.autoPan=void 0!==e.autoPan&&e.autoPan,this.autoPanAnimation=e.autoPanAnimation||{},this.autoPanMargin=void 0!==e.autoPanMargin?e.autoPanMargin:20,this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},this.mapPostrenderListenerKey=null,v(this,G(qa.ELEMENT),this.handleElementChanged,this),v(this,G(qa.MAP),this.handleMapChanged,this),v(this,G(qa.OFFSET),this.handleOffsetChanged,this),v(this,G(qa.POSITION),this.handlePositionChanged,this),v(this,G(qa.POSITIONING),this.handlePositioningChanged,this),void 0!==e.element&&this.setElement(e.element),this.setOffset(void 0!==e.offset?e.offset:[0,0]),this.setPositioning(void 0!==e.positioning?e.positioning:Za.TOP_LEFT),void 0!==e.position&&this.setPosition(e.position)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getElement=function(){return this.get(qa.ELEMENT)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(qa.MAP)},e.prototype.getOffset=function(){return this.get(qa.OFFSET)},e.prototype.getPosition=function(){return this.get(qa.POSITION)},e.prototype.getPositioning=function(){return this.get(qa.POSITIONING)},e.prototype.handleElementChanged=function(){to(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&($n(this.element),E(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=v(t,Rn,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(qa.POSITION)&&this.autoPan&&this.panIntoView()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(qa.ELEMENT,t)},e.prototype.setMap=function(t){this.set(qa.MAP,t)},e.prototype.setOffset=function(t){this.set(qa.OFFSET,t)},e.prototype.setPosition=function(t){this.set(qa.POSITION,t)},e.prototype.panIntoView=function(){var t=this.getMap();if(t&&t.getTargetElement()){var e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),r=this.getRect(i,[function(t){var e=t.offsetWidth,i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)}(i),function(t){var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}(i)]),n=this.autoPanMargin;if(!ot(e,r)){var o=r[0]-e[0],s=e[2]-r[2],a=r[1]-e[1],h=e[3]-r[3],l=[0,0];if(o<0?l[0]=o-n:s<0&&(l[0]=Math.abs(s)+n),a<0?l[1]=a-n:h<0&&(l[1]=Math.abs(h)+n),0!==l[0]||0!==l[1]){var u=t.getView().getCenter(),p=t.getPixelFromCoordinate(u),c=[p[0]+l[0],p[1]+l[1]];t.getView().animate({center:t.getCoordinateFromPixel(c),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),r=i.left+window.pageXOffset,n=i.top+window.pageYOffset;return[r,n,r+e[0],n+e[1]]},e.prototype.setPositioning=function(t){this.set(qa.POSITIONING,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),r=t.getSize();this.updateRenderedPosition(i,r)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,r=this.getOffset(),n=this.getPositioning();this.setVisible(!0);var o=r[0],s=r[1];if(n==Za.BOTTOM_RIGHT||n==Za.CENTER_RIGHT||n==Za.TOP_RIGHT){""!==this.rendered.left_&&(this.rendered.left_=i.left="");var a=Math.round(e[0]-t[0]-o)+"px";this.rendered.right_!=a&&(this.rendered.right_=i.right=a)}else{""!==this.rendered.right_&&(this.rendered.right_=i.right=""),n!=Za.BOTTOM_CENTER&&n!=Za.CENTER_CENTER&&n!=Za.TOP_CENTER||(o-=this.element.offsetWidth/2);var h=Math.round(t[0]+o)+"px";this.rendered.left_!=h&&(this.rendered.left_=i.left=h)}if(n==Za.BOTTOM_LEFT||n==Za.BOTTOM_CENTER||n==Za.BOTTOM_RIGHT){""!==this.rendered.top_&&(this.rendered.top_=i.top="");var l=Math.round(e[1]-t[1]-s)+"px";this.rendered.bottom_!=l&&(this.rendered.bottom_=i.bottom=l)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=i.bottom=""),n!=Za.CENTER_LEFT&&n!=Za.CENTER_CENTER&&n!=Za.CENTER_RIGHT||(s-=this.element.offsetHeight/2);var u=Math.round(t[1]+s)+"px";this.rendered.top_!=u&&(this.rendered.top_=i.top=u)}},e.prototype.getOptions=function(){return this.options},e}(D),Qa=9729,$a=10242,th=10243,eh=3553,ih=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function rh(t,e){for(var i=ih.length,r=0;r<i;++r)try{var n=t.getContext(ih[r],e);if(n)return n}catch(t){}return null}var nh,oh;if("undefined"!=typeof window&&"WebGLRenderingContext"in window)try{var sh=rh(document.createElement("canvas"),{failIfMajorPerformanceCaveat:!0});sh&&(!0,nh=sh.getParameter(sh.MAX_TEXTURE_SIZE),oh=sh.getSupportedExtensions())}catch(t){}var ah=function(t){this.source_=t};ah.prototype.isAnimated=function(){return!1},ah.prototype.getType=function(){return r()},ah.prototype.getSource=function(){return this.source_};var hh=ah,lh=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return 35632},e}(hh),uh=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return 35633},e}(hh),ph=new lh("precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n"),ch=new uh("varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n"),dh=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,"u_projectionMatrix"),this.u_offsetScaleMatrix=t.getUniformLocation(e,"u_offsetScaleMatrix"),this.u_offsetRotateMatrix=t.getUniformLocation(e,"u_offsetRotateMatrix"),this.u_lineWidth=t.getUniformLocation(e,"u_lineWidth"),this.u_pixelRatio=t.getUniformLocation(e,"u_pixelRatio"),this.u_opacity=t.getUniformLocation(e,"u_opacity"),this.u_fillColor=t.getUniformLocation(e,"u_fillColor"),this.u_strokeColor=t.getUniformLocation(e,"u_strokeColor"),this.u_size=t.getUniformLocation(e,"u_size"),this.a_position=t.getAttribLocation(e,"a_position"),this.a_instruction=t.getAttribLocation(e,"a_instruction"),this.a_radius=t.getAttribLocation(e,"a_radius")};function fh(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}var _h=function(t){function e(e,i){t.call(this),this.tolerance=e,this.maxExtent=i,this.origin=Tt(i),this.projectionMatrix_=[1,0,0,1,0,0],this.offsetRotateMatrix_=[1,0,0,1,0,0],this.offsetScaleMatrix_=[1,0,0,1,0,0],this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.indices=[],this.indicesBuffer=null,this.startIndices=[],this.startIndicesFeature=[],this.vertices=[],this.verticesBuffer=null,this.lineStringReplay=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeleteResourcesFunction=function(t){return r()},e.prototype.finish=function(t){r()},e.prototype.setUpProgram=function(t,e,i,n){return r()},e.prototype.shutDownProgram=function(t,e){r()},e.prototype.drawReplay=function(t,e,i,n){r()},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,n,o){return r()},e.prototype.drawHitDetectionReplay=function(t,e,i,r,n,o){return n?this.drawHitDetectionReplayOneByOne(t,e,i,r,o):this.drawHitDetectionReplayAll(t,e,i,r)},e.prototype.drawHitDetectionReplayAll=function(t,e,i,r){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawReplay(t,e,i,!0);var n=r(null);return n||void 0},e.prototype.replay=function(t,e,i,r,n,o,s,a,h,l,u){var p,c,d,f,_,g,y,v,m=t.getGL();this.lineStringReplay&&(p=m.isEnabled(m.STENCIL_TEST),c=m.getParameter(m.STENCIL_FUNC),d=m.getParameter(m.STENCIL_VALUE_MASK),f=m.getParameter(m.STENCIL_REF),_=m.getParameter(m.STENCIL_WRITEMASK),g=m.getParameter(m.STENCIL_FAIL),y=m.getParameter(m.STENCIL_PASS_DEPTH_PASS),v=m.getParameter(m.STENCIL_PASS_DEPTH_FAIL),m.enable(m.STENCIL_TEST),m.clear(m.STENCIL_BUFFER_BIT),m.stencilMask(255),m.stencilFunc(m.ALWAYS,1,255),m.stencilOp(m.KEEP,m.KEEP,m.REPLACE),this.lineStringReplay.replay(t,e,i,r,n,o,s,a,h,l,u),m.stencilMask(0),m.stencilFunc(m.NOTEQUAL,1,255)),t.bindBuffer(34962,this.verticesBuffer),t.bindBuffer(34963,this.indicesBuffer);var x=this.setUpProgram(m,t,n,o),E=Fe(this.projectionMatrix_);je(E,2/(i*n[0]),2/(i*n[1])),ke(E,-r),Ue(E,-(e[0]-this.origin[0]),-(e[1]-this.origin[1]));var S=Fe(this.offsetScaleMatrix_);je(S,2/n[0],2/n[1]);var T,C=Fe(this.offsetRotateMatrix_);return 0!==r&&ke(C,-r),m.uniformMatrix4fv(x.u_projectionMatrix,!1,fh(this.tmpMat4_,E)),m.uniformMatrix4fv(x.u_offsetScaleMatrix,!1,fh(this.tmpMat4_,S)),m.uniformMatrix4fv(x.u_offsetRotateMatrix,!1,fh(this.tmpMat4_,C)),m.uniform1f(x.u_opacity,s),void 0===h?this.drawReplay(m,t,a,!1):T=this.drawHitDetectionReplay(m,t,a,h,l,u),this.shutDownProgram(m,x),this.lineStringReplay&&(p||m.disable(m.STENCIL_TEST),m.clear(m.STENCIL_BUFFER_BIT),m.stencilFunc(c,f,d),m.stencilMask(_),m.stencilOp(g,v,y)),T},e.prototype.drawElements=function(t,e,i,r){var n=e.hasOESElementIndexUint?5125:5123,o=r-i,s=i*(e.hasOESElementIndexUint?4:2);t.drawElements(4,o,n,s)},e}(Vs),gh=[0,0,0,1],yh=[],vh=[0,0,0,1],mh=Number.EPSILON||2.220446049250313e-16,xh=function(t,e,i,r,n,o){var s=(i-t)*(o-e)-(n-t)*(r-e);return s<=mh&&s>=-mh?void 0:s>0},Eh=35044,Sh=function(t,e){this.arr_=void 0!==t?t:[],this.usage_=void 0!==e?e:Eh};Sh.prototype.getArray=function(){return this.arr_},Sh.prototype.getUsage=function(){return this.usage_};var Th=Sh,Ch=function(t){function e(e,i){t.call(this,e,i),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.radius_=0,this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,r){var n,o,s=this.vertices.length,a=this.indices.length,h=s/4;for(n=e,o=i;n<o;n+=r)this.vertices[s++]=t[n],this.vertices[s++]=t[n+1],this.vertices[s++]=0,this.vertices[s++]=this.radius_,this.vertices[s++]=t[n],this.vertices[s++]=t[n+1],this.vertices[s++]=1,this.vertices[s++]=this.radius_,this.vertices[s++]=t[n],this.vertices[s++]=t[n+1],this.vertices[s++]=2,this.vertices[s++]=this.radius_,this.vertices[s++]=t[n],this.vertices[s++]=t[n+1],this.vertices[s++]=3,this.vertices[s++]=this.radius_,this.indices[a++]=h,this.indices[a++]=h+1,this.indices[a++]=h+2,this.indices[a++]=h+2,this.indices[a++]=h+3,this.indices[a++]=h,h+=4},e.prototype.drawCircle=function(t,e){var i=t.getRadius(),r=t.getStride();if(i){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=i;var n=t.getFlatCoordinates();n=Dt(n,0,2,r,-this.origin[0],-this.origin[1]),this.drawCoordinates_(n,0,2,r)}else if(this.state_.changed&&(this.styles_.pop(),this.styles_.length)){var o=this.styles_[this.styles_.length-1];this.state_.fillColor=o[0],this.state_.strokeColor=o[1],this.state_.lineWidth=o[2],this.state_.changed=!1}},e.prototype.finish=function(t){this.verticesBuffer=new Th(this.vertices),this.indicesBuffer=new Th(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},e.prototype.setUpProgram=function(t,e,i,r){var n,o=e.getProgram(ph,ch);return this.defaultLocations_?n=this.defaultLocations_:(n=new dh(t,o),this.defaultLocations_=n),e.useProgram(o),t.enableVertexAttribArray(n.a_position),t.vertexAttribPointer(n.a_position,2,5126,!1,16,0),t.enableVertexAttribArray(n.a_instruction),t.vertexAttribPointer(n.a_instruction,1,5126,!1,16,8),t.enableVertexAttribArray(n.a_radius),t.vertexAttribPointer(n.a_radius,1,5126,!1,16,12),t.uniform2fv(n.u_size,i),t.uniform1f(n.u_pixelRatio,r),n},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_instruction),t.disableVertexAttribArray(e.a_radius)},e.prototype.drawReplay=function(t,e,i,r){var n,o,s,a;if(d(i))for(s=this.startIndices[this.startIndices.length-1],n=this.styleIndices_.length-1;n>=0;--n)o=this.styleIndices_[n],a=this.styles_[n],this.setFillStyle_(t,a[0]),this.setStrokeStyle_(t,a[1],a[2]),this.drawElements(t,e,o,s),s=o;else this.drawReplaySkipping_(t,e,i)},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,n){var s,a,h,l,u,p,c;for(c=this.startIndices.length-2,h=this.startIndices[c+1],s=this.styleIndices_.length-1;s>=0;--s)for(l=this.styles_[s],this.setFillStyle_(t,l[0]),this.setStrokeStyle_(t,l[1],l[2]),u=this.styleIndices_[s];c>=0&&this.startIndices[c]>=u;){if(a=this.startIndices[c],void 0===i[o(p=this.startIndicesFeature[c])]&&p.getGeometry()&&(void 0===n||Pt(n,p.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,h);var d=r(p);if(d)return d}c--,h=a}},e.prototype.drawReplaySkipping_=function(t,e,i){var r,n,s,a,h,l,u;for(l=this.startIndices.length-2,s=n=this.startIndices[l+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setFillStyle_(t,a[0]),this.setStrokeStyle_(t,a[1],a[2]),h=this.styleIndices_[r];l>=0&&this.startIndices[l]>=h;)u=this.startIndices[l],i[o(this.startIndicesFeature[l])]&&(n!==s&&this.drawElements(t,e,n,s),s=u),l--,n=u;n!==s&&this.drawElements(t,e,n,s),n=s=h}},e.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_fillColor,e)},e.prototype.setStrokeStyle_=function(t,e,i){t.uniform4fv(this.defaultLocations_.u_strokeColor,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i)},e.prototype.setFillStrokeStyle=function(t,e){var i,r;if(e){var n=e.getLineDash();this.state_.lineDash=n||yh;var o=e.getLineDashOffset();this.state_.lineDashOffset=o||0,i=(i=e.getColor())instanceof CanvasGradient||i instanceof CanvasPattern?vh:_r(i).map(function(t,e){return 3!=e?t/255:t})||vh,r=void 0!==(r=e.getWidth())?r:1}else i=[0,0,0,0],r=0;var s=t?t.getColor():[0,0,0,0];s=s instanceof CanvasGradient||s instanceof CanvasPattern?gh:_r(s).map(function(t,e){return 3!=e?t/255:t})||gh,this.state_.strokeColor&&Z(this.state_.strokeColor,i)&&this.state_.fillColor&&Z(this.state_.fillColor,s)&&this.state_.lineWidth===r||(this.state_.changed=!0,this.state_.fillColor=s,this.state_.strokeColor=i,this.state_.lineWidth=r,this.styles_.push([s,i,r]))},e}(_h),Rh=new lh("precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n"),wh=new uh("varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n"),Ih=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,"u_projectionMatrix"),this.u_offsetScaleMatrix=t.getUniformLocation(e,"u_offsetScaleMatrix"),this.u_offsetRotateMatrix=t.getUniformLocation(e,"u_offsetRotateMatrix"),this.u_opacity=t.getUniformLocation(e,"u_opacity"),this.u_image=t.getUniformLocation(e,"u_image"),this.a_position=t.getAttribLocation(e,"a_position"),this.a_texCoord=t.getAttribLocation(e,"a_texCoord"),this.a_offsets=t.getAttribLocation(e,"a_offsets"),this.a_opacity=t.getAttribLocation(e,"a_opacity"),this.a_rotateWithView=t.getAttribLocation(e,"a_rotateWithView")},Lh={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};function Oh(t,e,i){var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),void 0!==e&&t.texParameteri(eh,$a,e),void 0!==i&&t.texParameteri(eh,th,i),r}function Ph(t,e,i,r,n){var o=Oh(t,r,n);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),o}function bh(t,e,i,r){var n=Oh(t,i,r);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),n}var Mh=function(t){function e(e,i){t.call(this),this.canvas_=e,this.gl_=i,this.bufferCache_={},this.shaderCache_={},this.programCache_={},this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null,this.hasOESElementIndexUint=X(oh,"OES_element_index_uint"),this.hasOESElementIndexUint&&i.getExtension("OES_element_index_uint"),v(this.canvas_,Lh.LOST,this.handleWebGLContextLost,this),v(this.canvas_,Lh.RESTORED,this.handleWebGLContextRestored,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bindBuffer=function(t,e){var i=this.getGL(),r=e.getArray(),n=o(e);if(n in this.bufferCache_){var s=this.bufferCache_[n];i.bindBuffer(t,s.buffer)}else{var a,h=i.createBuffer();i.bindBuffer(t,h),34962==t?a=new Float32Array(r):34963==t&&(a=this.hasOESElementIndexUint?new Uint32Array(r):new Uint16Array(r)),i.bufferData(t,a,e.getUsage()),this.bufferCache_[n]={buf:e,buffer:h}}},e.prototype.deleteBuffer=function(t){var e=this.getGL(),i=o(t),r=this.bufferCache_[i];e.isContextLost()||e.deleteBuffer(r.buffer),delete this.bufferCache_[i]},e.prototype.disposeInternal=function(){S(this.canvas_);var t=this.getGL();if(!t.isContextLost()){for(var e in this.bufferCache_)t.deleteBuffer(this.bufferCache_[e].buffer);for(var i in this.programCache_)t.deleteProgram(this.programCache_[i]);for(var r in this.shaderCache_)t.deleteShader(this.shaderCache_[r]);t.deleteFramebuffer(this.hitDetectionFramebuffer_),t.deleteRenderbuffer(this.hitDetectionRenderbuffer_),t.deleteTexture(this.hitDetectionTexture_)}},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.getHitDetectionFramebuffer=function(){return this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_(),this.hitDetectionFramebuffer_},e.prototype.getShader=function(t){var e=o(t);if(e in this.shaderCache_)return this.shaderCache_[e];var i=this.getGL(),r=i.createShader(t.getType());return i.shaderSource(r,t.getSource()),i.compileShader(r),this.shaderCache_[e]=r,r},e.prototype.getProgram=function(t,e){var i=o(t)+"/"+o(e);if(i in this.programCache_)return this.programCache_[i];var r=this.getGL(),n=r.createProgram();return r.attachShader(n,this.getShader(t)),r.attachShader(n,this.getShader(e)),r.linkProgram(n),this.programCache_[i]=n,n},e.prototype.handleWebGLContextLost=function(){p(this.bufferCache_),p(this.shaderCache_),p(this.programCache_),this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.initHitDetectionFramebuffer_=function(){var t=this.gl_,e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var i=Ph(t,1,1),r=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,1,1),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,r),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),this.hitDetectionFramebuffer_=e,this.hitDetectionTexture_=i,this.hitDetectionRenderbuffer_=r},e.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,!0)},e}(C),Fh=function(t){function e(e,i){t.call(this,e,i),this.anchorX=void 0,this.anchorY=void 0,this.groupIndices=[],this.hitDetectionGroupIndices=[],this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.defaultLocations=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.width=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,r=this.getTextures(!0),n=t.getGL();return function(){var o,s;if(!n.isContextLost())for(o=0,s=r.length;o<s;++o)n.deleteTexture(r[o]);t.deleteBuffer(e),t.deleteBuffer(i)}},e.prototype.drawCoordinates=function(t,e,i,r){var n,o,s,a,h,l,u=this.anchorX,p=this.anchorY,c=this.height,d=this.imageHeight,f=this.imageWidth,_=this.opacity,g=this.originX,y=this.originY,v=this.rotateWithView?1:0,m=-this.rotation,x=this.scale,E=this.width,S=Math.cos(m),T=Math.sin(m),C=this.indices.length,R=this.vertices.length;for(n=e;n<i;n+=r)h=t[n]-this.origin[0],l=t[n+1]-this.origin[1],o=R/8,s=-x*u,a=-x*(c-p),this.vertices[R++]=h,this.vertices[R++]=l,this.vertices[R++]=s*S-a*T,this.vertices[R++]=s*T+a*S,this.vertices[R++]=g/f,this.vertices[R++]=(y+c)/d,this.vertices[R++]=_,this.vertices[R++]=v,s=x*(E-u),a=-x*(c-p),this.vertices[R++]=h,this.vertices[R++]=l,this.vertices[R++]=s*S-a*T,this.vertices[R++]=s*T+a*S,this.vertices[R++]=(g+E)/f,this.vertices[R++]=(y+c)/d,this.vertices[R++]=_,this.vertices[R++]=v,s=x*(E-u),a=x*p,this.vertices[R++]=h,this.vertices[R++]=l,this.vertices[R++]=s*S-a*T,this.vertices[R++]=s*T+a*S,this.vertices[R++]=(g+E)/f,this.vertices[R++]=y/d,this.vertices[R++]=_,this.vertices[R++]=v,s=-x*u,a=x*p,this.vertices[R++]=h,this.vertices[R++]=l,this.vertices[R++]=s*S-a*T,this.vertices[R++]=s*T+a*S,this.vertices[R++]=g/f,this.vertices[R++]=y/d,this.vertices[R++]=_,this.vertices[R++]=v,this.indices[C++]=o,this.indices[C++]=o+1,this.indices[C++]=o+2,this.indices[C++]=o,this.indices[C++]=o+2,this.indices[C++]=o+3;return R},e.prototype.createTextures=function(t,e,i,r){var n,s,a,h,l=e.length;for(h=0;h<l;++h)(a=o(s=e[h]))in i?n=i[a]:(n=bh(r,s,33071,33071),i[a]=n),t[h]=n},e.prototype.setUpProgram=function(t,e,i,r){var n,o=e.getProgram(Rh,wh);return this.defaultLocations?n=this.defaultLocations:(n=new Ih(t,o),this.defaultLocations=n),e.useProgram(o),t.enableVertexAttribArray(n.a_position),t.vertexAttribPointer(n.a_position,2,5126,!1,32,0),t.enableVertexAttribArray(n.a_offsets),t.vertexAttribPointer(n.a_offsets,2,5126,!1,32,8),t.enableVertexAttribArray(n.a_texCoord),t.vertexAttribPointer(n.a_texCoord,2,5126,!1,32,16),t.enableVertexAttribArray(n.a_opacity),t.vertexAttribPointer(n.a_opacity,1,5126,!1,32,24),t.enableVertexAttribArray(n.a_rotateWithView),t.vertexAttribPointer(n.a_rotateWithView,1,5126,!1,32,28),n},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_offsets),t.disableVertexAttribArray(e.a_texCoord),t.disableVertexAttribArray(e.a_opacity),t.disableVertexAttribArray(e.a_rotateWithView)},e.prototype.drawReplay=function(t,e,i,r){var n,o,s,a=r?this.getHitDetectionTextures():this.getTextures(),h=r?this.hitDetectionGroupIndices:this.groupIndices;if(d(i))for(n=0,o=a.length,s=0;n<o;++n){t.bindTexture(eh,a[n]);var l=h[n];this.drawElements(t,e,s,l),s=l}else this.drawReplaySkipping(t,e,i,a,h)},e.prototype.drawReplaySkipping=function(t,e,i,r,n){var s,a,h=0;for(s=0,a=r.length;s<a;++s){t.bindTexture(eh,r[s]);for(var l=s>0?n[s-1]:0,u=n[s],p=l,c=l;h<this.startIndices.length&&this.startIndices[h]<=u;){void 0!==i[o(this.startIndicesFeature[h])]?(p!==c&&this.drawElements(t,e,p,c),c=p=h===this.startIndices.length-1?u:this.startIndices[h+1]):c=h===this.startIndices.length-1?u:this.startIndices[h+1],h++}p!==c&&this.drawElements(t,e,p,c)}},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,n){var s,a,h,l,u,p=this.startIndices.length-1,c=this.getHitDetectionTextures();for(s=c.length-1;s>=0;--s)for(t.bindTexture(eh,c[s]),a=s>0?this.hitDetectionGroupIndices[s-1]:0,l=this.hitDetectionGroupIndices[s];p>=0&&this.startIndices[p]>=a;){if(h=this.startIndices[p],void 0===i[o(u=this.startIndicesFeature[p])]&&u.getGeometry()&&(void 0===n||Pt(n,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,h,l);var d=r(u);if(d)return d}l=h,p--}},e.prototype.finish=function(t){this.anchorX=void 0,this.anchorY=void 0,this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.indices=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.vertices=null,this.width=void 0},e.prototype.getTextures=function(t){return r()},e.prototype.getHitDetectionTextures=function(){return r()},e}(_h),Ah=function(t){function e(e,i){t.call(this,e,i),this.images_=[],this.hitDetectionImages_=[],this.textures_=[],this.hitDetectionTextures_=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawMultiPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),r=t.getStride();this.drawCoordinates(i,0,i.length,r)},e.prototype.drawPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var i=t.getFlatCoordinates(),r=t.getStride();this.drawCoordinates(i,0,i.length,r)},e.prototype.finish=function(e){var i=e.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices.push(this.indices.length),this.verticesBuffer=new Th(this.vertices);var r=this.indices;this.indicesBuffer=new Th(r);var n={};this.createTextures(this.textures_,this.images_,n,i),this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,n,i),this.images_=null,this.hitDetectionImages_=null,t.prototype.finish.call(this,e)},e.prototype.setImageStyle=function(t){var e=t.getAnchor(),i=t.getImage(1),r=t.getImageSize(),n=t.getHitDetectionImage(1),s=t.getOpacity(),a=t.getOrigin(),h=t.getRotateWithView(),l=t.getRotation(),u=t.getSize(),p=t.getScale();0===this.images_.length?this.images_.push(i):o(this.images_[this.images_.length-1])!=o(i)&&(this.groupIndices.push(this.indices.length),this.images_.push(i)),0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(n):o(this.hitDetectionImages_[this.hitDetectionImages_.length-1])!=o(n)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(n)),this.anchorX=e[0],this.anchorY=e[1],this.height=u[1],this.imageHeight=r[1],this.imageWidth=r[0],this.opacity=s,this.originX=a[0],this.originY=a[1],this.rotation=l,this.rotateWithView=h,this.scale=p,this.width=u[0]},e.prototype.getTextures=function(t){return t?this.textures_.concat(this.hitDetectionTextures_):this.textures_},e.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_},e}(Fh);function Nh(t,e,i,r){var n=i-r;return t[e]===t[n]&&t[e+1]===t[n+1]&&(i-e)/r>3&&!!Ke(t,e,i,r)}var Gh=new lh("precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n"),Dh=new uh("varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n"),kh=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,"u_projectionMatrix"),this.u_offsetScaleMatrix=t.getUniformLocation(e,"u_offsetScaleMatrix"),this.u_offsetRotateMatrix=t.getUniformLocation(e,"u_offsetRotateMatrix"),this.u_lineWidth=t.getUniformLocation(e,"u_lineWidth"),this.u_miterLimit=t.getUniformLocation(e,"u_miterLimit"),this.u_opacity=t.getUniformLocation(e,"u_opacity"),this.u_color=t.getUniformLocation(e,"u_color"),this.u_size=t.getUniformLocation(e,"u_size"),this.u_pixelRatio=t.getUniformLocation(e,"u_pixelRatio"),this.a_lastPos=t.getAttribLocation(e,"a_lastPos"),this.a_position=t.getAttribLocation(e,"a_position"),this.a_nextPos=t.getAttribLocation(e,"a_nextPos"),this.a_direction=t.getAttribLocation(e,"a_direction")},jh=3,Uh=5,Yh=7,Bh=11,Vh=13,Xh=17,zh=19,Wh=23,Kh=function(t){function e(e,i){t.call(this,e,i),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,r){var n,o,s,a,h,l,u,p,c=this.vertices.length,d=this.indices.length,f="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,_="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,g=Nh(t,e,i,r),y=d,v=1;for(n=e,o=i;n<o;n+=r){if(h=c/7,l=u,u=p||[t[n],t[n+1]],n===e){if(p=[t[n+r],t[n+r+1]],i-e==2*r&&Z(u,p))break;if(!g){_&&(c=this.addVertices_([0,0],u,p,v*Yh*_,c),c=this.addVertices_([0,0],u,p,-v*Yh*_,c),this.indices[d++]=h+2,this.indices[d++]=h,this.indices[d++]=h+1,this.indices[d++]=h+1,this.indices[d++]=h+3,this.indices[d++]=h+2),c=this.addVertices_([0,0],u,p,v*jh*(_||1),c),y=(c=this.addVertices_([0,0],u,p,-v*jh*(_||1),c))/7-1;continue}l=[t[i-2*r],t[i-2*r+1]],s=p}else{if(n===i-r){if(g){p=s;break}l=l||[0,0],c=this.addVertices_(l,u,[0,0],v*Uh*(_||1),c),c=this.addVertices_(l,u,[0,0],-v*Uh*(_||1),c),this.indices[d++]=h,this.indices[d++]=y-1,this.indices[d++]=y,this.indices[d++]=y,this.indices[d++]=h+1,this.indices[d++]=h,_&&(c=this.addVertices_(l,u,[0,0],v*Bh*_,c),c=this.addVertices_(l,u,[0,0],-v*Bh*_,c),this.indices[d++]=h+2,this.indices[d++]=h,this.indices[d++]=h+1,this.indices[d++]=h+1,this.indices[d++]=h+3,this.indices[d++]=h+2);break}p=[t[n+r],t[n+r+1]]}a=xh(l[0],l[1],u[0],u[1],p[0],p[1])?-1:1,c=this.addVertices_(l,u,p,a*Vh*(f||1),c),c=this.addVertices_(l,u,p,a*Xh*(f||1),c),c=this.addVertices_(l,u,p,-a*zh*(f||1),c),n>e&&(this.indices[d++]=h,this.indices[d++]=y-1,this.indices[d++]=y,this.indices[d++]=h+2,this.indices[d++]=h,this.indices[d++]=v*a>0?y:y-1),this.indices[d++]=h,this.indices[d++]=h+2,this.indices[d++]=h+1,y=h+2,v=a,f&&(c=this.addVertices_(l,u,p,a*Wh*f,c),this.indices[d++]=h+1,this.indices[d++]=h+3,this.indices[d++]=h)}g&&(h=h||c/7,a=Si([l[0],l[1],u[0],u[1],p[0],p[1]],0,6,2)?1:-1,c=this.addVertices_(l,u,p,a*Vh*(f||1),c),c=this.addVertices_(l,u,p,-a*zh*(f||1),c),this.indices[d++]=h,this.indices[d++]=y-1,this.indices[d++]=y,this.indices[d++]=h+1,this.indices[d++]=h,this.indices[d++]=v*a>0?y:y-1)},e.prototype.addVertices_=function(t,e,i,r,n){return this.vertices[n++]=t[0],this.vertices[n++]=t[1],this.vertices[n++]=e[0],this.vertices[n++]=e[1],this.vertices[n++]=i[0],this.vertices[n++]=i[1],this.vertices[n++]=r,n},e.prototype.isValid_=function(t,e,i,r){var n=i-e;return!(n<2*r)&&(n!==2*r||!Z([t[e],t[e+1]],[t[e+r],t[e+r+1]]))},e.prototype.drawLineString=function(t,e){var i=t.getFlatCoordinates(),r=t.getStride();this.isValid_(i,0,i.length,r)&&(i=Dt(i,0,i.length,r,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.drawCoordinates_(i,0,i.length,r))},e.prototype.drawMultiLineString=function(t,e){var i=this.indices.length,r=t.getEnds();r.unshift(0);var n,o,s=t.getFlatCoordinates(),a=t.getStride();if(r.length>1)for(n=1,o=r.length;n<o;++n)if(this.isValid_(s,r[n-1],r[n],a)){var h=Dt(s,r[n-1],r[n],a,-this.origin[0],-this.origin[1]);this.drawCoordinates_(h,0,h.length,a)}this.indices.length>i&&(this.startIndices.push(i),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1))},e.prototype.drawPolygonCoordinates=function(t,e,i){var r,n;if(Nh(t,0,t.length,i)||(t.push(t[0]),t.push(t[1])),this.drawCoordinates_(t,0,t.length,i),e.length)for(r=0,n=e.length;r<n;++r)Nh(e[r],0,e[r].length,i)||(e[r].push(e[r][0]),e[r].push(e[r][1])),this.drawCoordinates_(e[r],0,e[r].length,i)},e.prototype.setPolygonStyle=function(t,e){var i=void 0===e?this.indices.length:e;this.startIndices.push(i),this.startIndicesFeature.push(t),this.state_.changed&&(this.styleIndices_.push(i),this.state_.changed=!1)},e.prototype.getCurrentIndex=function(){return this.indices.length},e.prototype.finish=function(t){this.verticesBuffer=new Th(this.vertices),this.indicesBuffer=new Th(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(i)}},e.prototype.setUpProgram=function(t,e,i,r){var n,o=e.getProgram(Gh,Dh);return this.defaultLocations_?n=this.defaultLocations_:(n=new kh(t,o),this.defaultLocations_=n),e.useProgram(o),t.enableVertexAttribArray(n.a_lastPos),t.vertexAttribPointer(n.a_lastPos,2,5126,!1,28,0),t.enableVertexAttribArray(n.a_position),t.vertexAttribPointer(n.a_position,2,5126,!1,28,8),t.enableVertexAttribArray(n.a_nextPos),t.vertexAttribPointer(n.a_nextPos,2,5126,!1,28,16),t.enableVertexAttribArray(n.a_direction),t.vertexAttribPointer(n.a_direction,1,5126,!1,28,24),t.uniform2fv(n.u_size,i),t.uniform1f(n.u_pixelRatio,r),n},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_lastPos),t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_nextPos),t.disableVertexAttribArray(e.a_direction)},e.prototype.drawReplay=function(t,e,i,r){var n,o,s,a,h=t.getParameter(t.DEPTH_FUNC),l=t.getParameter(t.DEPTH_WRITEMASK);if(r||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),d(i))for(s=this.startIndices[this.startIndices.length-1],n=this.styleIndices_.length-1;n>=0;--n)o=this.styleIndices_[n],a=this.styles_[n],this.setStrokeStyle_(t,a[0],a[1],a[2]),this.drawElements(t,e,o,s),t.clear(t.DEPTH_BUFFER_BIT),s=o;else this.drawReplaySkipping_(t,e,i);r||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(l),t.depthFunc(h))},e.prototype.drawReplaySkipping_=function(t,e,i){var r,n,s,a,h,l,u;for(l=this.startIndices.length-2,s=n=this.startIndices[l+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setStrokeStyle_(t,a[0],a[1],a[2]),h=this.styleIndices_[r];l>=0&&this.startIndices[l]>=h;)u=this.startIndices[l],i[o(this.startIndicesFeature[l])]&&(n!==s&&(this.drawElements(t,e,n,s),t.clear(t.DEPTH_BUFFER_BIT)),s=u),l--,n=u;n!==s&&(this.drawElements(t,e,n,s),t.clear(t.DEPTH_BUFFER_BIT)),n=s=h}},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,n){var s,a,h,l,u,p,c;for(c=this.startIndices.length-2,h=this.startIndices[c+1],s=this.styleIndices_.length-1;s>=0;--s)for(l=this.styles_[s],this.setStrokeStyle_(t,l[0],l[1],l[2]),u=this.styleIndices_[s];c>=0&&this.startIndices[c]>=u;){if(a=this.startIndices[c],void 0===i[o(p=this.startIndicesFeature[c])]&&p.getGeometry()&&(void 0===n||Pt(n,p.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,h);var d=r(p);if(d)return d}c--,h=a}},e.prototype.setStrokeStyle_=function(t,e,i,r){t.uniform4fv(this.defaultLocations_.u_color,e),t.uniform1f(this.defaultLocations_.u_lineWidth,i),t.uniform1f(this.defaultLocations_.u_miterLimit,r)},e.prototype.setFillStrokeStyle=function(t,e){var i=e.getLineCap();this.state_.lineCap=void 0!==i?i:"round";var r=e.getLineDash();this.state_.lineDash=r||yh;var n=e.getLineDashOffset();this.state_.lineDashOffset=n||0;var o=e.getLineJoin();this.state_.lineJoin=void 0!==o?o:"round";var s=e.getColor();s=s instanceof CanvasGradient||s instanceof CanvasPattern?vh:_r(s).map(function(t,e){return 3!=e?t/255:t})||vh;var a=e.getWidth();a=void 0!==a?a:1;var h=e.getMiterLimit();h=void 0!==h?h:10,this.state_.strokeColor&&Z(this.state_.strokeColor,s)&&this.state_.lineWidth===a&&this.state_.miterLimit===h||(this.state_.changed=!0,this.state_.strokeColor=s,this.state_.lineWidth=a,this.state_.miterLimit=h,this.styles_.push([s,a,h]))},e}(_h),Hh=new lh("precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n"),Zh=new uh("\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n"),qh=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,"u_projectionMatrix"),this.u_offsetScaleMatrix=t.getUniformLocation(e,"u_offsetScaleMatrix"),this.u_offsetRotateMatrix=t.getUniformLocation(e,"u_offsetRotateMatrix"),this.u_color=t.getUniformLocation(e,"u_color"),this.u_opacity=t.getUniformLocation(e,"u_opacity"),this.a_position=t.getAttribLocation(e,"a_position")},Jh=function(t){this.first_,this.last_,this.head_,this.circular_=void 0===t||t,this.length_=0};Jh.prototype.insertItem=function(t){var e={prev:void 0,next:void 0,data:t},i=this.head_;if(i){var r=i.next;e.prev=i,e.next=r,i.next=e,r&&(r.prev=e),i===this.last_&&(this.last_=e)}else this.first_=e,this.last_=e,this.circular_&&(e.next=e,e.prev=e);this.head_=e,this.length_++},Jh.prototype.removeItem=function(){var t=this.head_;if(t){var e=t.next,i=t.prev;e&&(e.prev=i),i&&(i.next=e),this.head_=e||i,this.first_===this.last_?(this.head_=void 0,this.first_=void 0,this.last_=void 0):this.first_===t?this.first_=this.head_:this.last_===t&&(this.last_=i?this.head_.prev:this.head_),this.length_--}},Jh.prototype.firstItem=function(){if(this.head_=this.first_,this.head_)return this.head_.data},Jh.prototype.lastItem=function(){if(this.head_=this.last_,this.head_)return this.head_.data},Jh.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data},Jh.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data},Jh.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data},Jh.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data},Jh.prototype.getCurrItem=function(){if(this.head_)return this.head_.data},Jh.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)},Jh.prototype.concat=function(t){if(t.head_){if(this.head_){var e=this.head_.next;this.head_.next=t.first_,t.first_.prev=this.head_,e.prev=t.last_,t.last_.next=e,this.length_+=t.length_}else this.head_=t.head_,this.first_=t.first_,this.last_=t.last_,this.length_=t.length_;t.head_=void 0,t.first_=void 0,t.last_=void 0,t.length_=0}},Jh.prototype.getLength=function(){return this.length_};var Qh=Jh,$h=function(t){this.rbush_=ua()(t,void 0),this.items_={}};$h.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[o(e)]=i},$h.prototype.load=function(t,e){for(var i=new Array(e.length),r=0,n=e.length;r<n;r++){var s=t[r],a=e[r],h={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:a};i[r]=h,this.items_[o(a)]=h}this.rbush_.load(i)},$h.prototype.remove=function(t){var e=o(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},$h.prototype.update=function(t,e){var i=this.items_[o(e)];dt([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},$h.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},$h.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},$h.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},$h.prototype.forEachInExtent=function(t,e,i){return this.forEach_(this.getInExtent(t),e,i)},$h.prototype.forEach_=function(t,e,i){for(var r,n=0,o=t.length;n<o;n++)if(r=e.call(i,t[n]))return r;return r},$h.prototype.isEmpty=function(){return d(this.items_)},$h.prototype.clear=function(){this.rbush_.clear(),this.items_={}},$h.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return lt(e.minX,e.minY,e.maxX,e.maxY,t)},$h.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]};var tl=$h,el=function(t){function e(e,i){t.call(this,e,i),this.lineStringReplay=new Kh(e,i),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={fillColor:null,changed:!1}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i){var r=new Qh,n=new tl;this.processFlatCoordinates_(t,i,r,n,!0);var o=this.getMaxCoords_(r);if(e.length){var s,a,h=[];for(s=0,a=e.length;s<a;++s){var l={list:new Qh,maxCoords:void 0,rtree:new tl};h.push(l),this.processFlatCoordinates_(e[s],i,l.list,l.rtree,!1),this.classifyPoints_(l.list,l.rtree,!0),l.maxCoords=this.getMaxCoords_(l.list)}for(h.sort(function(t,e){return e.maxCoords[0]===t.maxCoords[0]?t.maxCoords[1]-e.maxCoords[1]:e.maxCoords[0]-t.maxCoords[0]}),s=0;s<h.length;++s){var u=h[s].list,p=u.firstItem(),c=p,d=void 0;do{if(this.getIntersections_(c,n).length){d=!0;break}c=u.nextItem()}while(p!==c);d||this.bridgeHole_(u,h[s].maxCoords[0],r,o[0],n)&&(n.concat(h[s].rtree),this.classifyPoints_(r,n,!1))}}else this.classifyPoints_(r,n,!1);this.triangulate_(r,n)},e.prototype.processFlatCoordinates_=function(t,e,i,r,n){var o,s,a,h,l,u=Si(t,0,t.length,e),p=this.vertices.length/2,c=[],d=[];if(n===u){for(h=a=this.createPoint_(t[0],t[1],p++),o=e,s=t.length;o<s;o+=e)l=this.createPoint_(t[o],t[o+1],p++),d.push(this.insertItem_(h,l,i)),c.push([Math.min(h.x,l.x),Math.min(h.y,l.y),Math.max(h.x,l.x),Math.max(h.y,l.y)]),h=l;d.push(this.insertItem_(l,a,i)),c.push([Math.min(h.x,l.x),Math.min(h.y,l.y),Math.max(h.x,l.x),Math.max(h.y,l.y)])}else{var f=t.length-e;for(h=a=this.createPoint_(t[f],t[f+1],p++),o=f-e,s=0;o>=s;o-=e)l=this.createPoint_(t[o],t[o+1],p++),d.push(this.insertItem_(h,l,i)),c.push([Math.min(h.x,l.x),Math.min(h.y,l.y),Math.max(h.x,l.x),Math.max(h.y,l.y)]),h=l;d.push(this.insertItem_(l,a,i)),c.push([Math.min(h.x,l.x),Math.min(h.y,l.y),Math.max(h.x,l.x),Math.max(h.y,l.y)])}r.load(c,d)},e.prototype.getMaxCoords_=function(t){var e=t.firstItem(),i=e,r=[i.p0.x,i.p0.y];do{(i=t.nextItem()).p0.x>r[0]&&(r=[i.p0.x,i.p0.y])}while(i!==e);return r},e.prototype.classifyPoints_=function(t,e,i){var r=t.firstItem(),n=r,o=t.nextItem(),s=!1;do{var a=i?xh(o.p1.x,o.p1.y,n.p1.x,n.p1.y,n.p0.x,n.p0.y):xh(n.p0.x,n.p0.y,n.p1.x,n.p1.y,o.p1.x,o.p1.y);void 0===a?(this.removeItem_(n,o,t,e),s=!0,o===r&&(r=t.getNextItem()),o=n,t.prevItem()):n.p1.reflex!==a&&(n.p1.reflex=a,s=!0),n=o,o=t.nextItem()}while(n!==r);return s},e.prototype.bridgeHole_=function(t,e,i,r,n){for(var o=t.firstItem();o.p1.x!==e;)o=t.nextItem();var s,a,h,l,u=o.p1,p={x:r,y:u.y,i:-1},c=1/0,d=this.getIntersections_({p0:u,p1:p},n,!0);for(s=0,a=d.length;s<a;++s){var f=d[s],_=this.calculateIntersection_(u,p,f.p0,f.p1,!0),g=Math.abs(u.x-_[0]);g<c&&void 0!==xh(u.x,u.y,f.p0.x,f.p0.y,f.p1.x,f.p1.y)&&(c=g,l={x:_[0],y:_[1],i:-1},o=f)}if(c===1/0)return!1;if(h=o.p1,c>0){var y=this.getPointsInTriangle_(u,l,o.p1,n);if(y.length){var v=1/0;for(s=0,a=y.length;s<a;++s){var m=y[s],x=Math.atan2(u.y-m.y,p.x-m.x);(x<v||x===v&&m.x<h.x)&&(v=x,h=m)}}}for(o=i.firstItem();o.p1.x!==h.x||o.p1.y!==h.y;)o=i.nextItem();var E={x:u.x,y:u.y,i:u.i,reflex:void 0},S={x:o.p1.x,y:o.p1.y,i:o.p1.i,reflex:void 0};return t.getNextItem().p0=E,this.insertItem_(u,o.p1,t,n),this.insertItem_(S,E,t,n),o.p1=S,t.setFirstItem(),i.concat(t),!0},e.prototype.triangulate_=function(t,e){for(var i=!1,r=this.isSimple_(t,e);t.getLength()>3;)if(r){if(!this.clipEars_(t,e,r,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e,!0))break}else if(!this.clipEars_(t,e,r,i)&&!this.classifyPoints_(t,e,i)&&!this.resolveSelfIntersections_(t,e)){if(!(r=this.isSimple_(t,e))){this.splitPolygon_(t,e);break}i=!this.isClockwise_(t),this.classifyPoints_(t,e,i)}if(3===t.getLength()){var n=this.indices.length;this.indices[n++]=t.getPrevItem().p0.i,this.indices[n++]=t.getCurrItem().p0.i,this.indices[n++]=t.getNextItem().p0.i}},e.prototype.clipEars_=function(t,e,i,r){var n,o,s,a=this.indices.length,h=t.firstItem(),l=t.getPrevItem(),u=h,p=t.nextItem(),c=t.getNextItem(),d=!1;do{if(n=u.p0,o=u.p1,s=p.p1,!1===o.reflex){var f=void 0;f=i?0===this.getPointsInTriangle_(n,o,s,e,!0).length:r?this.diagonalIsInside_(c.p1,s,o,n,l.p0):this.diagonalIsInside_(l.p0,n,o,s,c.p1),(i||0===this.getIntersections_({p0:n,p1:s},e).length)&&f&&(i||!1===n.reflex||!1===s.reflex||Si([l.p0.x,l.p0.y,n.x,n.y,o.x,o.y,s.x,s.y,c.p1.x,c.p1.y],0,10,2)===!r)&&(this.indices[a++]=n.i,this.indices[a++]=o.i,this.indices[a++]=s.i,this.removeItem_(u,p,t,e),p===h&&(h=c),d=!0)}l=t.getPrevItem(),u=t.getCurrItem(),p=t.nextItem(),c=t.getNextItem()}while(u!==h&&t.getLength()>3);return d},e.prototype.resolveSelfIntersections_=function(t,e,i){var r=t.firstItem();t.nextItem();var n=r,o=t.nextItem(),s=!1;do{var a=this.calculateIntersection_(n.p0,n.p1,o.p0,o.p1,i);if(a){var h=!1,l=this.vertices.length,u=this.indices.length,p=l/2,c=t.prevItem();t.removeItem(),e.remove(c),h=c===r;var d=void 0;if(i?(a[0]===n.p0.x&&a[1]===n.p0.y?(t.prevItem(),d=n.p0,o.p0=d,e.remove(n),h=h||n===r):(d=o.p1,n.p1=d,e.remove(o),h=h||o===r),t.removeItem()):(d=this.createPoint_(a[0],a[1],p),n.p1=d,o.p0=d,e.update([Math.min(n.p0.x,n.p1.x),Math.min(n.p0.y,n.p1.y),Math.max(n.p0.x,n.p1.x),Math.max(n.p0.y,n.p1.y)],n),e.update([Math.min(o.p0.x,o.p1.x),Math.min(o.p0.y,o.p1.y),Math.max(o.p0.x,o.p1.x),Math.max(o.p0.y,o.p1.y)],o)),this.indices[u++]=c.p0.i,this.indices[u++]=c.p1.i,this.indices[u++]=d.i,s=!0,h)break}n=t.getPrevItem(),o=t.nextItem()}while(n!==r);return s},e.prototype.isSimple_=function(t,e){var i=t.firstItem(),r=i;do{if(this.getIntersections_(r,e).length)return!1;r=t.nextItem()}while(r!==i);return!0},e.prototype.isClockwise_=function(t){var e=2*t.getLength(),i=new Array(e),r=t.firstItem(),n=r,o=0;do{i[o++]=n.p0.x,i[o++]=n.p0.y,n=t.nextItem()}while(n!==r);return Si(i,0,e,2)},e.prototype.splitPolygon_=function(t,e){var i=t.firstItem(),r=i;do{var n=this.getIntersections_(r,e);if(n.length){var o=n[0],s=this.vertices.length/2,a=this.calculateIntersection_(r.p0,r.p1,o.p0,o.p1),h=this.createPoint_(a[0],a[1],s),l=new Qh,u=new tl;this.insertItem_(h,r.p1,l,u),r.p1=h,e.update([Math.min(r.p0.x,h.x),Math.min(r.p0.y,h.y),Math.max(r.p0.x,h.x),Math.max(r.p0.y,h.y)],r);for(var p=t.nextItem();p!==o;)this.insertItem_(p.p0,p.p1,l,u),e.remove(p),t.removeItem(),p=t.getCurrItem();this.insertItem_(o.p0,h,l,u),o.p0=h,e.update([Math.min(o.p1.x,h.x),Math.min(o.p1.y,h.y),Math.max(o.p1.x,h.x),Math.max(o.p1.y,h.y)],o),this.classifyPoints_(t,e,!1),this.triangulate_(t,e),this.classifyPoints_(l,u,!1),this.triangulate_(l,u);break}r=t.nextItem()}while(r!==i)},e.prototype.createPoint_=function(t,e,i){var r=this.vertices.length;return this.vertices[r++]=t,this.vertices[r++]=e,{x:t,y:e,i:i,reflex:void 0}},e.prototype.insertItem_=function(t,e,i,r){var n={p0:t,p1:e};return i.insertItem(n),r&&r.insert([Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.x,e.x),Math.max(t.y,e.y)],n),n},e.prototype.removeItem_=function(t,e,i,r){i.getCurrItem()===e&&(i.removeItem(),t.p1=e.p1,r.remove(e),r.update([Math.min(t.p0.x,t.p1.x),Math.min(t.p0.y,t.p1.y),Math.max(t.p0.x,t.p1.x),Math.max(t.p0.y,t.p1.y)],t))},e.prototype.getPointsInTriangle_=function(t,e,i,r,n){for(var o=[],s=r.getInExtent([Math.min(t.x,e.x,i.x),Math.min(t.y,e.y,i.y),Math.max(t.x,e.x,i.x),Math.max(t.y,e.y,i.y)]),a=0,h=s.length;a<h;++a)for(var l in s[a]){var u=s[a][l];"object"!=typeof u||n&&!u.reflex||u.x===t.x&&u.y===t.y||u.x===e.x&&u.y===e.y||u.x===i.x&&u.y===i.y||-1!==o.indexOf(u)||!fi([t.x,t.y,e.x,e.y,i.x,i.y],0,6,2,u.x,u.y)||o.push(u)}return o},e.prototype.getIntersections_=function(t,e,i){for(var r=t.p0,n=t.p1,o=e.getInExtent([Math.min(r.x,n.x),Math.min(r.y,n.y),Math.max(r.x,n.x),Math.max(r.y,n.y)]),s=[],a=0,h=o.length;a<h;++a){var l=o[a];t!==l&&(i||l.p0!==n||l.p1!==r)&&this.calculateIntersection_(r,n,l.p0,l.p1,i)&&s.push(l)}return s},e.prototype.calculateIntersection_=function(t,e,i,r,n){var o=(r.y-i.y)*(e.x-t.x)-(r.x-i.x)*(e.y-t.y);if(0!==o){var s=((r.x-i.x)*(t.y-i.y)-(r.y-i.y)*(t.x-i.x))/o,a=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/o;if(!n&&s>mh&&s<1-mh&&a>mh&&a<1-mh||n&&s>=0&&s<=1&&a>=0&&a<=1)return[t.x+s*(e.x-t.x),t.y+s*(e.y-t.y)]}},e.prototype.diagonalIsInside_=function(t,e,i,r,n){if(void 0===e.reflex||void 0===r.reflex)return!1;var o=(i.x-r.x)*(e.y-r.y)>(i.y-r.y)*(e.x-r.x),s=(n.x-r.x)*(e.y-r.y)<(n.y-r.y)*(e.x-r.x),a=(t.x-e.x)*(r.y-e.y)>(t.y-e.y)*(r.x-e.x),h=(i.x-e.x)*(r.y-e.y)<(i.y-e.y)*(r.x-e.x),l=r.reflex?s||o:s&&o,u=e.reflex?h||a:h&&a;return l&&u},e.prototype.drawMultiPolygon=function(t,e){var i,r,n,o,s=t.getEndss(),a=t.getStride(),h=this.indices.length,l=this.lineStringReplay.getCurrentIndex(),u=t.getFlatCoordinates(),p=0;for(i=0,r=s.length;i<r;++i){var c=s[i];if(c.length>0){var d=Dt(u,p,c[0],a,-this.origin[0],-this.origin[1]);if(d.length){var f=[],_=void 0;for(n=1,o=c.length;n<o;++n)c[n]!==c[n-1]&&(_=Dt(u,c[n-1],c[n],a,-this.origin[0],-this.origin[1]),f.push(_));this.lineStringReplay.drawPolygonCoordinates(d,f,a),this.drawCoordinates_(d,f,a)}}p=c[c.length-1]}this.indices.length>h&&(this.startIndices.push(h),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(h),this.state_.changed=!1)),this.lineStringReplay.getCurrentIndex()>l&&this.lineStringReplay.setPolygonStyle(e,l)},e.prototype.drawPolygon=function(t,e){var i=t.getEnds(),r=t.getStride();if(i.length>0){var n=t.getFlatCoordinates().map(Number),o=Dt(n,0,i[0],r,-this.origin[0],-this.origin[1]);if(o.length){var s,a,h,l=[];for(s=1,a=i.length;s<a;++s)i[s]!==i[s-1]&&(h=Dt(n,i[s-1],i[s],r,-this.origin[0],-this.origin[1]),l.push(h));this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.lineStringReplay.setPolygonStyle(e),this.lineStringReplay.drawPolygonCoordinates(o,l,r),this.drawCoordinates_(o,l,r)}}},e.prototype.finish=function(t){this.verticesBuffer=new Th(this.vertices),this.indicesBuffer=new Th(this.indices),this.startIndices.push(this.indices.length),this.lineStringReplay.finish(t),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},e.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,i=this.indicesBuffer,r=this.lineStringReplay.getDeleteResourcesFunction(t);return function(){t.deleteBuffer(e),t.deleteBuffer(i),r()}},e.prototype.setUpProgram=function(t,e,i,r){var n,o=e.getProgram(Hh,Zh);return this.defaultLocations_?n=this.defaultLocations_:(n=new qh(t,o),this.defaultLocations_=n),e.useProgram(o),t.enableVertexAttribArray(n.a_position),t.vertexAttribPointer(n.a_position,2,5126,!1,8,0),n},e.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position)},e.prototype.drawReplay=function(t,e,i,r){var n,o,s,a,h=t.getParameter(t.DEPTH_FUNC),l=t.getParameter(t.DEPTH_WRITEMASK);if(r||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),d(i))for(s=this.startIndices[this.startIndices.length-1],n=this.styleIndices_.length-1;n>=0;--n)o=this.styleIndices_[n],a=this.styles_[n],this.setFillStyle_(t,a),this.drawElements(t,e,o,s),s=o;else this.drawReplaySkipping_(t,e,i);r||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(l),t.depthFunc(h))},e.prototype.drawHitDetectionReplayOneByOne=function(t,e,i,r,n){var s,a,h,l,u,p,c;for(c=this.startIndices.length-2,h=this.startIndices[c+1],s=this.styleIndices_.length-1;s>=0;--s)for(l=this.styles_[s],this.setFillStyle_(t,l),u=this.styleIndices_[s];c>=0&&this.startIndices[c]>=u;){if(a=this.startIndices[c],void 0===i[o(p=this.startIndicesFeature[c])]&&p.getGeometry()&&(void 0===n||Pt(n,p.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,h);var d=r(p);if(d)return d}c--,h=a}},e.prototype.drawReplaySkipping_=function(t,e,i){var r,n,s,a,h,l,u;for(l=this.startIndices.length-2,s=n=this.startIndices[l+1],r=this.styleIndices_.length-1;r>=0;--r){for(a=this.styles_[r],this.setFillStyle_(t,a),h=this.styleIndices_[r];l>=0&&this.startIndices[l]>=h;)u=this.startIndices[l],i[o(this.startIndicesFeature[l])]&&(n!==s&&(this.drawElements(t,e,n,s),t.clear(t.DEPTH_BUFFER_BIT)),s=u),l--,n=u;n!==s&&(this.drawElements(t,e,n,s),t.clear(t.DEPTH_BUFFER_BIT)),n=s=h}},e.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_color,e)},e.prototype.setFillStrokeStyle=function(t,e){var i=t?t.getColor():[0,0,0,0];if(i=i instanceof CanvasGradient||i instanceof CanvasPattern?gh:_r(i).map(function(t,e){return 3!=e?t/255:t})||gh,this.state_.fillColor&&Z(i,this.state_.fillColor)||(this.state_.fillColor=i,this.state_.changed=!0,this.styles_.push(i)),e)this.lineStringReplay.setFillStrokeStyle(null,e);else{var r=new Er({color:[0,0,0,0],width:0});this.lineStringReplay.setFillStrokeStyle(null,r)}},e}(_h),il=function(t,e){this.space_=e,this.emptyBlocks_=[{x:0,y:0,width:t,height:t}],this.entries_={},this.context_=Jn(t,t),this.canvas_=this.context_.canvas};il.prototype.get=function(t){return this.entries_[t]||null},il.prototype.add=function(t,e,i,r,n){for(var o=0,s=this.emptyBlocks_.length;o<s;++o){var a=this.emptyBlocks_[o];if(a.width>=e+this.space_&&a.height>=i+this.space_){var h={offsetX:a.x+this.space_,offsetY:a.y+this.space_,image:this.canvas_};return this.entries_[t]=h,r.call(n,this.context_,a.x+this.space_,a.y+this.space_),this.split_(o,a,e+this.space_,i+this.space_),h}}return null},il.prototype.split_=function(t,e,i,r){var n,o;e.width-i>e.height-r?(n={x:e.x+i,y:e.y,width:e.width-i,height:e.height},o={x:e.x,y:e.y+r,width:i,height:e.height-r},this.updateBlocks_(t,n,o)):(n={x:e.x+i,y:e.y,width:e.width-i,height:r},o={x:e.x,y:e.y+r,width:e.width,height:e.height-r},this.updateBlocks_(t,n,o))},il.prototype.updateBlocks_=function(t,e,i){var r=[t,1];e.width>0&&e.height>0&&r.push(e),i.width>0&&i.height>0&&r.push(i),this.emptyBlocks_.splice.apply(this.emptyBlocks_,r)};var rl=il,nl=function(t){var e=t||{};this.currentSize_=void 0!==e.initialSize?e.initialSize:256,this.maxSize_=void 0!==e.maxSize?e.maxSize:void 0!==nh?nh:2048,this.space_=void 0!==e.space?e.space:1,this.atlases_=[new rl(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new rl(this.currentHitSize_,this.space_)]};nl.prototype.getInfo=function(t){var e=this.getInfo_(this.atlases_,t);if(!e)return null;var i=this.getInfo_(this.hitAtlases_,t);return this.mergeInfos_(e,i)},nl.prototype.getInfo_=function(t,e){for(var i=0,r=t.length;i<r;++i){var n=t[i].get(e);if(n)return n}return null},nl.prototype.mergeInfos_=function(t,e){return{offsetX:t.offsetX,offsetY:t.offsetY,image:t.image,hitImage:e.image}},nl.prototype.add=function(t,e,i,r,n,o){if(e+this.space_>this.maxSize_||i+this.space_>this.maxSize_)return null;var s=this.add_(!1,t,e,i,r,o);if(!s)return null;var a=void 0!==n?n:I,h=this.add_(!0,t,e,i,a,o);return this.mergeInfos_(s,h)},nl.prototype.add_=function(t,e,i,r,n,o){var s,a,h,l,u=t?this.hitAtlases_:this.atlases_;for(h=0,l=u.length;h<l;++h){if(a=(s=u[h]).add(e,i,r,n,o))return a;if(!a&&h===l-1){var p=void 0;t?(p=Math.min(2*this.currentHitSize_,this.maxSize_),this.currentHitSize_=p):(p=Math.min(2*this.currentSize_,this.maxSize_),this.currentSize_=p),s=new rl(p,this.space_),u.push(s),++l}}return null};var ol=nl,sl=function(t){function e(e,i){t.call(this,e,i),this.images_=[],this.textures_=[],this.measureCanvas_=Jn(0,0).canvas,this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.atlases_={},this.currAtlas_=void 0,this.scale=1,this.opacity=1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText=function(t,e){if(this.text_){var i=null,r=2,n=2;switch(t.getType()){case Nt.POINT:case Nt.MULTI_POINT:r=(i=t.getFlatCoordinates()).length,n=t.getStride();break;case Nt.CIRCLE:i=t.getCenter();break;case Nt.LINE_STRING:i=t.getFlatMidpoint();break;case Nt.MULTI_LINE_STRING:r=(i=t.getFlatMidpoints()).length;break;case Nt.POLYGON:i=t.getFlatInteriorPoint();break;case Nt.MULTI_POLYGON:r=(i=t.getFlatInteriorPoints()).length}this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var s,a,h,l,u,p,c,d,f=this.currAtlas_,_=this.text_.split("\n"),g=this.getTextSize_(_),y=Math.round(g[0]*this.textAlign_-this.offsetX_),v=Math.round(g[1]*this.textBaseline_-this.offsetY_),m=this.state_.lineWidth/2*this.state_.scale;for(s=0,a=_.length;s<a;++s)for(u=0,p=f.height*s,h=0,l=(c=_[s].split("")).length;h<l;++h){if(d=f.atlas.getInfo(c[h])){var x=d.image;if(this.anchorX=y-u,this.anchorY=v-p,this.originX=0===h?d.offsetX-m:d.offsetX,this.originY=d.offsetY,this.height=f.height,this.width=0===h||h===c.length-1?f.width[c[h]]+m:f.width[c[h]],this.imageHeight=x.height,this.imageWidth=x.width,0===this.images_.length)this.images_.push(x);else o(this.images_[this.images_.length-1])!=o(x)&&(this.groupIndices.push(this.indices.length),this.images_.push(x));this.drawText_(i,0,r,n)}u+=this.width}}},e.prototype.getTextSize_=function(t){var e=this,i=this.currAtlas_,r=t.length*i.height;return[t.map(function(t){for(var r=0,n=0,o=t.length;n<o;++n){var s=t[n];i.width[s]||e.addCharToAtlas_(s),r+=i.width[s]?i.width[s]:0}return r}).reduce(function(t,e){return Math.max(t,e)}),r]},e.prototype.drawText_=function(t,e,i,r){for(var n=e,o=i;n<o;n+=r)this.drawCoordinates(t,e,i,r)},e.prototype.addCharToAtlas_=function(t){if(1===t.length){var e=this.currAtlas_,i=this.state_,r=this.measureCanvas_.getContext("2d");r.font=i.font;var n=Math.ceil(r.measureText(t).width*i.scale);e.atlas.add(t,n,e.height,function(e,r,n){e.font=i.font,e.fillStyle=i.fillColor,e.strokeStyle=i.strokeColor,e.lineWidth=i.lineWidth,e.lineCap=i.lineCap,e.lineJoin=i.lineJoin,e.miterLimit=i.miterLimit,e.textAlign="left",e.textBaseline="top",ki&&i.lineDash&&(e.setLineDash(i.lineDash),e.lineDashOffset=i.lineDashOffset),1!==i.scale&&e.setTransform(i.scale,0,0,i.scale,0,0),i.strokeColor&&e.strokeText(t,r,n),i.fillColor&&e.fillText(t,r,n)})&&(e.width[t]=n)}},e.prototype.finish=function(e){var i=e.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices=this.groupIndices,this.verticesBuffer=new Th(this.vertices),this.indicesBuffer=new Th(this.indices);this.createTextures(this.textures_,this.images_,{},i),this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.images_=null,this.atlases_={},this.currAtlas_=void 0,t.prototype.finish.call(this,e)},e.prototype.setTextStyle=function(t){var e=this.state_,i=t.getFill(),r=t.getStroke();if(t&&t.getText()&&(i||r)){if(i){var n=i.getColor();e.fillColor=Ys(n||gh)}else e.fillColor=null;if(r){var o=r.getColor();e.strokeColor=Ys(o||vh),e.lineWidth=r.getWidth()||1,e.lineCap=r.getLineCap()||"round",e.lineDashOffset=r.getLineDashOffset()||0,e.lineJoin=r.getLineJoin()||"round",e.miterLimit=r.getMiterLimit()||10;var s=r.getLineDash();e.lineDash=s?s.slice():yh}else e.strokeColor=null,e.lineWidth=0;e.font=t.getFont()||"10px sans-serif",e.scale=t.getScale()||1,this.text_=t.getText();var a=Sa[t.getTextAlign()],h=Sa[t.getTextBaseline()];this.textAlign_=void 0===a?.5:a,this.textBaseline_=void 0===h?.5:h,this.offsetX_=t.getOffsetX()||0,this.offsetY_=t.getOffsetY()||0,this.rotateWithView=!!t.getRotateWithView(),this.rotation=t.getRotation()||0,this.currAtlas_=this.getAtlas_(e)}else this.text_=""},e.prototype.getAtlas_=function(t){var e=[];for(var i in t)(t[i]||0===t[i])&&(Array.isArray(t[i])?e=e.concat(t[i]):e.push(t[i]));var r=this.calculateHash_(e);if(!this.atlases_[r]){var n=this.measureCanvas_.getContext("2d");n.font=t.font;var o=Math.ceil((1.5*n.measureText("M").width+t.lineWidth/2)*t.scale);this.atlases_[r]={atlas:new ol({space:t.lineWidth+1}),width:{},height:o}}return this.atlases_[r]},e.prototype.calculateHash_=function(t){for(var e="",i=0,r=t.length;i<r;++i)e+=t[i];return e},e.prototype.getTextures=function(t){return this.textures_},e.prototype.getHitDetectionTextures=function(){return this.textures_},e}(Fh),al=[1,1],hl={Circle:Ch,Image:Ah,LineString:Kh,Polygon:el,Text:sl},ll=function(t){function e(e,i,r){t.call(this),this.maxExtent_=i,this.tolerance_=e,this.renderBuffer_=r,this.replaysByZIndex_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addDeclutter=function(t){return[]},e.prototype.getDeleteResourcesFunction=function(t){var e,i=[];for(e in this.replaysByZIndex_){var r=this.replaysByZIndex_[e];for(var n in r)i.push(r[n].getDeleteResourcesFunction(t))}return function(){for(var t,e=arguments,r=i.length,n=0;n<r;n++)t=i[n].apply(this,e);return t}},e.prototype.finish=function(t){var e;for(e in this.replaysByZIndex_){var i=this.replaysByZIndex_[e];for(var r in i)i[r].finish(t)}},e.prototype.getReplay=function(t,e){var i=void 0!==t?t.toString():"0",r=this.replaysByZIndex_[i];void 0===r&&(r={},this.replaysByZIndex_[i]=r);var n=r[e];void 0===n&&(n=new(0,hl[e])(this.tolerance_,this.maxExtent_),r[e]=n);return n},e.prototype.isEmpty=function(){return d(this.replaysByZIndex_)},e.prototype.replay=function(t,e,i,r,n,o,s,a){var h,l,u,p,c,d,f=Object.keys(this.replaysByZIndex_).map(Number);for(f.sort(V),h=0,l=f.length;h<l;++h)for(c=this.replaysByZIndex_[f[h].toString()],u=0,p=Ea.length;u<p;++u)d=c[Ea[u]],void 0!==d&&d.replay(t,e,i,r,n,o,s,a,void 0,!1)},e.prototype.replayHitDetection_=function(t,e,i,r,n,o,s,a,h,l,u){var p,c,d,f,_,g,y=Object.keys(this.replaysByZIndex_).map(Number);for(y.sort(function(t,e){return e-t}),p=0,c=y.length;p<c;++p)for(f=this.replaysByZIndex_[y[p].toString()],d=Ea.length-1;d>=0;--d)if(void 0!==(_=f[Ea[d]])&&(g=_.replay(t,e,i,r,n,o,s,a,h,l,u)))return g},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,n,o,s,a,h,l){var u,p=e.getGL();return p.bindFramebuffer(p.FRAMEBUFFER,e.getHitDetectionFramebuffer()),void 0!==this.renderBuffer_&&(u=et(pt(t),r*this.renderBuffer_)),this.replayHitDetection_(e,t,r,n,al,s,a,h,function(t){var e=new Uint8Array(4);if(p.readPixels(0,0,1,1,p.RGBA,p.UNSIGNED_BYTE,e),e[3]>0){var i=l(t);if(i)return i}},!0,u)},e.prototype.hasFeatureAtCoordinate=function(t,e,i,r,n,o,s,a,h){var l=e.getGL();return l.bindFramebuffer(l.FRAMEBUFFER,e.getHitDetectionFramebuffer()),void 0!==this.replayHitDetection_(e,t,r,n,al,s,a,h,function(t){var e=new Uint8Array(4);return l.readPixels(0,0,1,1,l.RGBA,l.UNSIGNED_BYTE,e),e[3]>0},!1)},e}(ca),ul=function(t){function e(e,i,r,n,o,s,a){t.call(this),this.context_=e,this.center_=i,this.extent_=s,this.pixelRatio_=a,this.size_=o,this.rotation_=n,this.resolution_=r,this.imageStyle_=null,this.fillStyle_=null,this.strokeStyle_=null,this.textStyle_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText_=function(t,e){var i=this.context_,r=t.getReplay(0,da.TEXT);r.setTextStyle(this.textStyle_),r.drawText(e,null),r.finish(i);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(i)()},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.drawGeometry=function(t){switch(t.getType()){case Nt.POINT:this.drawPoint(t,null);break;case Nt.LINE_STRING:this.drawLineString(t,null);break;case Nt.POLYGON:this.drawPolygon(t,null);break;case Nt.MULTI_POINT:this.drawMultiPoint(t,null);break;case Nt.MULTI_LINE_STRING:this.drawMultiLineString(t,null);break;case Nt.MULTI_POLYGON:this.drawMultiPolygon(t,null);break;case Nt.GEOMETRY_COLLECTION:this.drawGeometryCollection(t,null);break;case Nt.CIRCLE:this.drawCircle(t,null)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&Pt(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t,e){var i,r,n=t.getGeometriesArray();for(i=0,r=n.length;i<r;++i)this.drawGeometry(n[i])},e.prototype.drawPoint=function(t,e){var i=this.context_,r=new ll(1,this.extent_),n=r.getReplay(0,da.IMAGE);n.setImageStyle(this.imageStyle_),n.drawPoint(t,e),n.finish(i);n.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),n.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},e.prototype.drawMultiPoint=function(t,e){var i=this.context_,r=new ll(1,this.extent_),n=r.getReplay(0,da.IMAGE);n.setImageStyle(this.imageStyle_),n.drawMultiPoint(t,e),n.finish(i);n.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),n.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},e.prototype.drawLineString=function(t,e){var i=this.context_,r=new ll(1,this.extent_),n=r.getReplay(0,da.LINE_STRING);n.setFillStrokeStyle(null,this.strokeStyle_),n.drawLineString(t,e),n.finish(i);n.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),n.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},e.prototype.drawMultiLineString=function(t,e){var i=this.context_,r=new ll(1,this.extent_),n=r.getReplay(0,da.LINE_STRING);n.setFillStrokeStyle(null,this.strokeStyle_),n.drawMultiLineString(t,e),n.finish(i);n.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),n.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},e.prototype.drawPolygon=function(t,e){var i=this.context_,r=new ll(1,this.extent_),n=r.getReplay(0,da.POLYGON);n.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),n.drawPolygon(t,e),n.finish(i);n.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),n.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},e.prototype.drawMultiPolygon=function(t,e){var i=this.context_,r=new ll(1,this.extent_),n=r.getReplay(0,da.POLYGON);n.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),n.drawMultiPolygon(t,e),n.finish(i);n.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),n.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},e.prototype.drawCircle=function(t,e){var i=this.context_,r=new ll(1,this.extent_),n=r.getReplay(0,da.CIRCLE);n.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),n.drawCircle(t,e),n.finish(i);n.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),n.getDeleteResourcesFunction(i)(),this.textStyle_&&this.drawText_(r,t)},e.prototype.setImageStyle=function(t){this.imageStyle_=t},e.prototype.setFillStrokeStyle=function(t,e){this.fillStyle_=t,this.strokeStyle_=e},e.prototype.setTextStyle=function(t){this.textStyle_=t},e}(Vs),pl=new lh("precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n"),cl=new uh("varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n"),dl=function(t,e){this.u_texCoordMatrix=t.getUniformLocation(e,"u_texCoordMatrix"),this.u_projectionMatrix=t.getUniformLocation(e,"u_projectionMatrix"),this.u_opacity=t.getUniformLocation(e,"u_opacity"),this.u_texture=t.getUniformLocation(e,"u_texture"),this.a_position=t.getAttribLocation(e,"a_position"),this.a_texCoord=t.getAttribLocation(e,"a_texCoord")},fl=function(t){function e(e,i){t.call(this,i),this.mapRenderer=e,this.arrayBuffer_=new Th([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0,this.texCoordMatrix=[1,0,0,1,0,0],this.projectionMatrix=[1,0,0,1,0,0],this.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.defaultLocations_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bindFramebuffer=function(t,e){var i=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=e){var r=function(t,e,i){t.isContextLost()||(t.deleteFramebuffer(e),t.deleteTexture(i))}.bind(null,i,this.framebuffer,this.texture);t.postRenderFunctions.push(r);var n=Ph(i,e,e),o=i.createFramebuffer();i.bindFramebuffer(36160,o),i.framebufferTexture2D(36160,36064,eh,n,0),this.texture=n,this.framebuffer=o,this.framebufferDimension=e}else i.bindFramebuffer(36160,this.framebuffer)},e.prototype.composeFrame=function(t,e,i){this.dispatchComposeEvent_(ur.PRECOMPOSE,i,t),i.bindBuffer(34962,this.arrayBuffer_);var r,n=i.getGL(),o=i.getProgram(pl,cl);this.defaultLocations_?r=this.defaultLocations_:(r=new dl(n,o),this.defaultLocations_=r),i.useProgram(o)&&(n.enableVertexAttribArray(r.a_position),n.vertexAttribPointer(r.a_position,2,5126,!1,16,0),n.enableVertexAttribArray(r.a_texCoord),n.vertexAttribPointer(r.a_texCoord,2,5126,!1,16,8),n.uniform1i(r.u_texture,0)),n.uniformMatrix4fv(r.u_texCoordMatrix,!1,fh(this.tmpMat4_,this.getTexCoordMatrix())),n.uniformMatrix4fv(r.u_projectionMatrix,!1,fh(this.tmpMat4_,this.getProjectionMatrix())),n.uniform1f(r.u_opacity,e.opacity),n.bindTexture(eh,this.getTexture()),n.drawArrays(5,0,4),this.dispatchComposeEvent_(ur.POSTCOMPOSE,i,t)},e.prototype.dispatchComposeEvent_=function(t,e,i){var r=this.getLayer();if(r.hasListener(t)){var n=i.viewState,o=n.resolution,s=i.pixelRatio,a=i.extent,h=n.center,l=n.rotation,u=i.size,p=new ul(e,h,o,l,u,a,s),c=new Cs(t,p,i,null,e);r.dispatchEvent(c)}},e.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix},e.prototype.getTexture=function(){return this.texture},e.prototype.getProjectionMatrix=function(){return this.projectionMatrix},e.prototype.handleWebGLContextLost=function(){this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0},e.prototype.prepareFrame=function(t,e,i){return r()},e.prototype.forEachLayerAtPixel=function(t,e,i,n){return r()},e}($s),_l=function(t){function e(e,i){t.call(this,e,i),this.image_=null,this.hitCanvasContext_=null,this.hitTransformationMatrix_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createTexture_=function(t){var e=t.getImage();return bh(this.mapRenderer.getGL(),e,33071,33071)},e.prototype.prepareFrame=function(t,e,i){var r=this.mapRenderer.getGL(),n=t.pixelRatio,o=t.viewState,s=o.center,a=o.resolution,h=o.rotation,l=this.image_,u=this.texture,p=this.getLayer().getSource(),c=t.viewHints,d=t.extent;if(void 0!==e.extent&&(d=wt(d,e.extent)),!c[kn]&&!c[jn]&&!bt(d)){var f=o.projection,_=p.getImage(d,a,n,f);if(_)if(this.loadImage(_)&&(l=_,u=this.createTexture_(_),this.texture)){var g=function(t,e){t.isContextLost()||t.deleteTexture(e)}.bind(null,r,this.texture);t.postRenderFunctions.push(g)}}if(l){var y=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(y.width,y.height,n,s,a,h,l.getExtent()),this.hitTransformationMatrix_=null;var v=this.texCoordMatrix;Fe(v),je(v,1,-1),Ue(v,0,-1),this.image_=l,this.texture=u}return!!l},e.prototype.updateProjectionMatrix_=function(t,e,i,r,n,o,s){var a=t*n,h=e*n,l=this.projectionMatrix;Fe(l),je(l,2*i/a,2*i/h),ke(l,-o),Ue(l,s[0]-r[0],s[1]-r[1]),je(l,(s[2]-s[0])/2,(s[3]-s[1])/2),Ue(l,1,1)},e.prototype.forEachLayerAtPixel=function(t,e,i,r){if(this.image_&&this.image_.getImage()){var n=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(e.size,n));var o=De(this.hitTransformationMatrix_,t.slice());if(!(o[0]<0||o[0]>n[0]||o[1]<0||o[1]>n[1])){this.hitCanvasContext_||(this.hitCanvasContext_=Jn(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),o[0],o[1],1,1,0,0,1,1);var s=this.hitCanvasContext_.getImageData(0,0,1,1).data;return s[3]>0?i.call(r,this.getLayer(),s):void 0}}},e.prototype.getHitTransformationMatrix_=function(t,e){var i=[1,0,0,1,0,0];Ue(i,-1,-1),je(i,2/t[0],2/t[1]),Ue(i,0,t[1]),je(i,1,-1);var r=Be(this.projectionMatrix.slice()),n=[1,0,0,1,0,0];return Ue(n,0,e[1]),je(n,1,-1),je(n,e[0]/2,e[1]/2),Ue(n,1,1),Ae(n,r),Ae(n,i),n},e}(fl);_l.handles=function(t){return t.getType()===Ss.IMAGE},_l.create=function(t,e){return new _l(t,e)};var gl=_l,yl=function(t){function e(e){t.call(this,e);var i=e.getViewport();this.canvas_=document.createElement("canvas"),this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=fo,i.insertBefore(this.canvas_,i.childNodes[0]||null),this.clipTileCanvasWidth_=0,this.clipTileCanvasHeight_=0,this.clipTileContext_=Jn(),this.renderedVisible_=!0,this.gl_=rh(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0}),this.context_=new Mh(this.canvas_,this.gl_),v(this.canvas_,Lh.LOST,this.handleWebGLContextLost,this),v(this.canvas_,Lh.RESTORED,this.handleWebGLContextRestored,this),this.textureCache_=new Rs,this.focus_=null,this.tileTextureQueue_=new bn(function(t){var e=t[1],i=t[2],r=e[0]-this.focus_[0],n=e[1]-this.focus_[1];return 65536*Math.log(i)+Math.sqrt(r*r+n*n)/i}.bind(this),function(t){return t[0].getKey()}),this.loadNextTileTexture_=function(t,e){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();var i=this.tileTextureQueue_.dequeue(),r=i[0],n=i[3],o=i[4];this.bindTileTexture(r,n,o,Qa,Qa)}return!1}.bind(this),this.textureCacheFrameMarkerCount_=0,this.initializeGL_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bindTileTexture=function(t,e,i,r,n){var o=this.getGL(),s=t.getKey();if(this.textureCache_.containsKey(s)){var a=this.textureCache_.get(s);o.bindTexture(eh,a.texture),a.magFilter!=r&&(o.texParameteri(eh,10240,r),a.magFilter=r),a.minFilter!=n&&(o.texParameteri(eh,10241,n),a.minFilter=n)}else{var h=o.createTexture(),l=t;if(o.bindTexture(eh,h),i>0){var u=this.clipTileContext_.canvas,p=this.clipTileContext_;this.clipTileCanvasWidth_!==e[0]||this.clipTileCanvasHeight_!==e[1]?(u.width=e[0],u.height=e[1],this.clipTileCanvasWidth_=e[0],this.clipTileCanvasHeight_=e[1]):p.clearRect(0,0,e[0],e[1]),p.drawImage(l.getImage(),i,i,e[0],e[1],0,0,e[0],e[1]),o.texImage2D(eh,0,6408,6408,5121,u)}else o.texImage2D(eh,0,6408,6408,5121,l.getImage());o.texParameteri(eh,10240,r),o.texParameteri(eh,10241,n),o.texParameteri(eh,$a,33071),o.texParameteri(eh,th,33071),this.textureCache_.set(s,{texture:h,magFilter:r,minFilter:n})}},e.prototype.dispatchRenderEvent=function(t,e){var i=this.getMap();if(i.hasListener(t)){var r=this.context_,n=e.extent,o=e.size,s=e.viewState,a=e.pixelRatio,h=s.resolution,l=s.center,u=s.rotation,p=new ul(r,l,h,u,o,n,a),c=new Cs(t,p,e,null,r);i.dispatchEvent(c)}},e.prototype.disposeInternal=function(){var e=this.getGL();e.isContextLost()||this.textureCache_.forEach(function(t){t&&e.deleteTexture(t.texture)}),this.context_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.expireCache_=function(t,e){for(var i,r=this.getGL();this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>1024;){if(i=this.textureCache_.peekLast())r.deleteTexture(i.texture);else{if(+this.textureCache_.peekLastKey()==e.index)break;--this.textureCacheFrameMarkerCount_}this.textureCache_.pop()}},e.prototype.getContext=function(){return this.context_},e.prototype.getGL=function(){return this.gl_},e.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_},e.prototype.handleWebGLContextLost=function(t){t.preventDefault(),this.textureCache_.clear(),this.textureCacheFrameMarkerCount_=0;var e=this.getLayerRenderers();for(var i in e){e[i].handleWebGLContextLost()}},e.prototype.handleWebGLContextRestored=function(){this.initializeGL_(),this.getMap().render()},e.prototype.initializeGL_=function(){var t=this.gl_;t.activeTexture(33984),t.blendFuncSeparate(770,771,1,771),t.disable(2884),t.disable(2929),t.disable(3089),t.disable(2960)},e.prototype.isTileTextureLoaded=function(t){return this.textureCache_.containsKey(t.getKey())},e.prototype.renderFrame=function(t){var e=this.getContext(),i=this.getGL();if(i.isContextLost())return!1;if(!t)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=t.focus,this.textureCache_.set((-t.index).toString(),null),++this.textureCacheFrameMarkerCount_,this.dispatchRenderEvent(ur.PRECOMPOSE,t);var r=[],n=t.layerStatesArray;q(n,Zs);var o,s,a=t.viewState.resolution;for(o=0,s=n.length;o<s;++o){var h=n[o];if(mo(h,a)&&h.sourceState==ro.READY)this.getLayerRenderer(h.layer).prepareFrame(t,h,e)&&r.push(h)}var l=t.size[0]*t.pixelRatio,u=t.size[1]*t.pixelRatio;for(this.canvas_.width==l&&this.canvas_.height==u||(this.canvas_.width=l,this.canvas_.height=u),i.bindFramebuffer(36160,null),i.clearColor(0,0,0,0),i.clear(16384),i.enable(3042),i.viewport(0,0,this.canvas_.width,this.canvas_.height),o=0,s=r.length;o<s;++o){var p=r[o];this.getLayerRenderer(p.layer).composeFrame(t,p,e)}this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.calculateMatrices2D(t),this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>1024&&t.postRenderFunctions.push(this.expireCache_.bind(this)),this.tileTextureQueue_.isEmpty()||(t.postRenderFunctions.push(this.loadNextTileTexture_),t.animate=!0),this.dispatchRenderEvent(ur.POSTCOMPOSE,t),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,n,o,s){var a;if(this.getGL().isContextLost())return!1;var h,l=e.viewState,u=e.layerStatesArray;for(h=u.length-1;h>=0;--h){var p=u[h],c=p.layer;if(mo(p,l.resolution)&&o.call(s,c))if(a=this.getLayerRenderer(c).forEachFeatureAtCoordinate(t,e,i,r))return a}},e.prototype.hasFeatureAtCoordinate=function(t,e,i,r,n){var o=!1;if(this.getGL().isContextLost())return!1;var s,a=e.viewState,h=e.layerStatesArray;for(s=h.length-1;s>=0;--s){var l=h[s],u=l.layer;if(mo(l,a.resolution)&&r.call(n,u))if(o=this.getLayerRenderer(u).hasFeatureAtCoordinate(t,e))return!0}return o},e.prototype.forEachLayerAtPixel=function(t,e,i,r,n,o,s){if(this.getGL().isContextLost())return!1;var a,h,l=e.viewState,u=e.layerStatesArray;for(h=u.length-1;h>=0;--h){var p=u[h],c=p.layer;if(mo(p,l.resolution)&&o.call(n,c))if(a=this.getLayerRenderer(c).forEachLayerAtPixel(t,e,r,n))return a}},e}(qs),vl=function(t){function e(e,i,r){t.call(this);var n=r||{};this.tileCoord=e,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===n.transition?250:n.transition,this.transitionStarts_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(M.CHANGE)},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==On.LOADED)return t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==On.LOADED){t.interimTile=null;break}t.getState()==On.LOADING?e=t:t.getState()==On.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){this.state=t,this.changed()},e.prototype.load=function(){},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var r=e-i+1e3/60;return r>=this.transition_?1:Vn(r/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(b);function ml(){var t=Jn(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}var xl=function(t){function e(e,i,r,n,o,s){t.call(this,e,i,s),this.crossOrigin_=n,this.src_=r,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.imageListenerKeys_=null,this.tileLoadFunction_=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==On.LOADING&&(this.unlistenImage_(),this.image_=ml()),this.interimTile&&this.interimTile.dispose(),this.state=On.ABORT,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=On.ERROR,this.unlistenImage_(),this.image_=ml(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=On.LOADED:this.state=On.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==On.ERROR&&(this.state=On.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==On.IDLE&&(this.state=On.LOADING,this.changed(),this.imageListenerKeys_=[m(this.image_,M.ERROR,this.handleImageError_,this),m(this.image_,M.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(E),this.imageListenerKeys_=null},e}(vl);function El(t,e,i,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=i,r):[t,e,i]}function Sl(t,e,i){return t+"/"+e+"/"+i}function Tl(t){return Sl(t[0],t[1],t[2])}function Cl(t){return(t[1]<<t[0])+t[2]}var Rl=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.expireCache=function(t){for(;this.canExpireCache();){var e=this.peekLast(),i=e.tileCoord[0].toString();if(i in t&&t[i].contains(e.tileCoord))break;this.pop().dispose()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(Tl(e.tileCoord)),e.dispose())},this)}},e}(Rs);function wl(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var Il=function(t){function e(e){t.call(this),this.projection_=Ee(e.projection),this.attributions_=wl(e.attributions),this.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,this.loading=!1,this.state_=void 0!==e.state?e.state:ro.READY,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return r()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=wl(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(D),Ll=[0,0,0],Ol=function(t){var e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Y(function(t,e,i){var r=e||V;return t.every(function(e,n){if(0===n)return!0;var o=r(t[n-1],e);return!(o>0||i&&0===o)})}(this.resolutions_,function(t,e){return e-t},!0),17),!t.origins)for(var i=0,r=this.resolutions_.length-1;i<r;++i)if(e){if(this.resolutions_[i]/this.resolutions_[i+1]!==e){e=void 0;break}}else e=this.resolutions_[i]/this.resolutions_[i+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Y(this.origins_.length==this.resolutions_.length,20));var n=t.extent;void 0===n||this.origin_||this.origins_||(this.origin_=It(n)),Y(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Y(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:An,Y(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==n?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,e){return new sa(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):n&&this.calculateTileRanges_(n)};Ol.prototype.forEachTileCoord=function(t,e,i){for(var r=this.getTileRangeForExtentAndZ(t,e),n=r.minX,o=r.maxX;n<=o;++n)for(var s=r.minY,a=r.maxY;s<=a;++s)i([e,n,s])},Ol.prototype.forEachTileCoordParentTileRange=function(t,e,i,r,n){var o,s,a,h=null,l=t[0]-1;for(2===this.zoomFactor_?(s=t[1],a=t[2]):h=this.getTileCoordExtent(t,n);l>=this.minZoom;){if(o=2===this.zoomFactor_?oa(s=Math.floor(s/2),s,a=Math.floor(a/2),a,r):this.getTileRangeForExtentAndZ(h,l,r),e.call(i,l,o))return!0;--l}return!1},Ol.prototype.getExtent=function(){return this.extent_},Ol.prototype.getMaxZoom=function(){return this.maxZoom},Ol.prototype.getMinZoom=function(){return this.minZoom},Ol.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},Ol.prototype.getResolution=function(t){return this.resolutions_[t]},Ol.prototype.getResolutions=function(){return this.resolutions_},Ol.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*t[1],n=2*t[2];return oa(r,r+1,n,n+1,e)}var o=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},Ol.prototype.getTileRangeExtent=function(t,e,i){var r=this.getOrigin(t),n=this.getResolution(t),o=ho(this.getTileSize(t),this.tmpSize_),s=r[0]+e.minX*o[0]*n,a=r[0]+(e.maxX+1)*o[0]*n;return lt(s,r[1]+e.minY*o[1]*n,a,r[1]+(e.maxY+1)*o[1]*n,i)},Ol.prototype.getTileRangeForExtentAndZ=function(t,e,i){var r=Ll;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,r);var n=r[1],o=r[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,r),oa(n,r[1],o,r[2],i)},Ol.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=ho(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*i,e[1]+(t[2]+.5)*r[1]*i]},Ol.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),r=this.getResolution(t[0]),n=ho(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*n[0]*r,s=i[1]+t[2]*n[1]*r;return lt(o,s,o+n[0]*r,s+n[1]*r,e)},Ol.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},Ol.prototype.getTileCoordForXYAndResolution_=function(t,e,i,r,n){var o=this.getZForResolution(i),s=i/this.getResolution(o),a=this.getOrigin(o),h=ho(this.getTileSize(o),this.tmpSize_),l=r?.5:0,u=r?0:.5,p=Math.floor((t-a[0])/i+l),c=Math.floor((e-a[1])/i+u),d=s*p/h[0],f=s*c/h[1];return r?(d=Math.ceil(d)-1,f=Math.ceil(f)-1):(d=Math.floor(d),f=Math.floor(f)),El(o,d,f,n)},Ol.prototype.getTileCoordForXYAndZ_=function(t,e,i,r,n){var o=this.getOrigin(i),s=this.getResolution(i),a=ho(this.getTileSize(i),this.tmpSize_),h=r?.5:0,l=r?0:.5,u=Math.floor((t-o[0])/s+h),p=Math.floor((e-o[1])/s+l),c=u/a[0],d=p/a[1];return r?(c=Math.ceil(c)-1,d=Math.ceil(d)-1):(c=Math.floor(c),d=Math.floor(d)),El(i,c,d,n)},Ol.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},Ol.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},Ol.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},Ol.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},Ol.prototype.getZForResolution=function(t,e){return kt(z(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},Ol.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),r=this.minZoom;r<e;++r)i[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=i};var Pl=Ol;function bl(t){var e=t.getDefaultTileGrid();return e||(e=Nl(t),t.setDefaultTileGrid(e)),e}function Ml(t,e,i,r){var n=void 0!==r?r:Q.TOP_LEFT,o=Al(t,e,i);return new Pl({extent:t,origin:function(t,e){var i;return e===Q.BOTTOM_LEFT?i=Et(t):e===Q.BOTTOM_RIGHT?i=St(t):e===Q.TOP_LEFT?i=It(t):e===Q.TOP_RIGHT?i=Lt(t):Y(!1,13),i}(t,n),resolutions:o,tileSize:i})}function Fl(t){var e=t||{},i=e.extent||Ee("EPSG:3857").getExtent(),r={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Al(i,e.maxZoom,e.tileSize)};return new Pl(r)}function Al(t,e,i){for(var r=void 0!==e?e:Fn,n=Rt(t),o=Ot(t),s=ho(void 0!==i?i:An),a=Math.max(o/s[0],n/s[1]),h=r+1,l=new Array(h),u=0;u<h;++u)l[u]=a/Math.pow(2,u);return l}function Nl(t,e,i,r){return Ml(Gl(t),e,i,r)}function Gl(t){var e=(t=Ee(t)).getExtent();if(!e){var i=180*Qt[$t.DEGREES]/t.getMetersPerUnit();e=lt(-i,-i,i,i)}return e}var Dl=function(t){function e(e){t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new Rl(e.cacheSize),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,r){var n=this.getTileCacheForProjection(t);if(!n)return!1;for(var o,s,a,h=!0,l=i.minX;l<=i.maxX;++l)for(var u=i.minY;u<=i.maxY;++u)s=Sl(e,l,u),a=!1,n.containsKey(s)&&(a=(o=n.get(s)).getState()===On.LOADED)&&(a=!1!==r(o)),a||(h=!1);return h},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,i,n,o){return r()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:bl(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!Ie(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var r=this.getTileGridForProjection(i),n=this.getTilePixelRatio(e),o=ho(r.getTileSize(t),this.tmpSize);return 1==n?o:ao(o,n,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),r=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var r=e[0],n=t.getTileCoordCenter(e),o=Gl(i);if(nt(o,n))return e;var s=Ot(o),a=Math.ceil((o[0]-n[0])/s);return n[0]+=s*a,t.getTileCoordForCoordAndZ(n,r)}(r,t,i)),function(t,e){var i=t[0],r=t[1],n=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var o,s=e.getExtent();return!(o=s?e.getTileRangeForExtentAndZ(s,i):e.getFullTileRange(i))||o.containsXY(r,n)}(t,r)?t:null},e.prototype.refresh=function(){this.tileCache.clear(),this.changed()},e.prototype.useTile=function(t,e,i,r){},e}(Il),kl=function(t){function e(e,i){t.call(this,e),this.tile=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),jl=Dl,Ul=new lh("precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n"),Yl=new uh("varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n"),Bl=function(t,e){this.u_tileOffset=t.getUniformLocation(e,"u_tileOffset"),this.u_texture=t.getUniformLocation(e,"u_texture"),this.a_position=t.getAttribLocation(e,"a_position"),this.a_texCoord=t.getAttribLocation(e,"a_texCoord")},Vl=function(t){function e(e,i){t.call(this,e,i),this.fragmentShader_=Ul,this.vertexShader_=Yl,this.locations_=null,this.renderArrayBuffer_=new Th([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,this.tmpSize_=[0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_),t.prototype.disposeInternal.call(this)},e.prototype.createLoadedTileFinder=function(t,e,i){var r=this.mapRenderer;return function(n,o){return t.forEachLoadedTile(e,n,o,function(t){var e=r.isTileTextureLoaded(t);return e&&(i[n]||(i[n]={}),i[n][t.tileCoord.toString()]=t),e})}},e.prototype.handleWebGLContextLost=function(){t.prototype.handleWebGLContextLost.call(this),this.locations_=null},e.prototype.prepareFrame=function(t,e,i){var r=this.mapRenderer,n=i.getGL(),o=t.viewState,s=o.projection,a=this.getLayer(),h=a.getSource();if(!(h instanceof jl))return!0;var l,u=h.getTileGridForProjection(s),p=u.getZForResolution(o.resolution),c=u.getResolution(p),d=h.getTilePixelSize(p,t.pixelRatio,s),f=d[0]/ho(u.getTileSize(p),this.tmpSize_)[0],_=c/f,g=h.getTilePixelRatio(f)*h.getGutterForProjection(s),y=o.center,v=t.extent,m=u.getTileRangeForExtentAndZ(v,p);if(this.renderedTileRange_&&this.renderedTileRange_.equals(m)&&this.renderedRevision_==h.getRevision())l=this.renderedFramebufferExtent_;else{var x=m.getSize(),E=function(t){return Y(0<t,29),Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}(Math.max(x[0]*d[0],x[1]*d[1])),S=_*E,T=u.getOrigin(p),C=T[0]+m.minX*d[0]*_,R=T[1]+m.minY*d[1]*_;l=[C,R,C+S,R+S],this.bindFramebuffer(t,E),n.viewport(0,0,E,E),n.clearColor(0,0,0,0),n.clear(16384),n.disable(3042);var w=i.getProgram(this.fragmentShader_,this.vertexShader_);i.useProgram(w),this.locations_||(this.locations_=new Bl(n,w)),i.bindBuffer(34962,this.renderArrayBuffer_),n.enableVertexAttribArray(this.locations_.a_position),n.vertexAttribPointer(this.locations_.a_position,2,5126,!1,16,0),n.enableVertexAttribArray(this.locations_.a_texCoord),n.vertexAttribPointer(this.locations_.a_texCoord,2,5126,!1,16,8),n.uniform1i(this.locations_.u_texture,0);var I={};I[p]={};var L,O,P,b,M,F,A=this.createLoadedTileFinder(h,s,I),N=a.getUseInterimTilesOnError(),G=!0,D=[1/0,1/0,-1/0,-1/0],k=new sa(0,0,0,0);for(b=m.minX;b<=m.maxX;++b)for(M=m.minY;M<=m.maxY;++M)if(O=h.getTile(p,b,M,f,s),void 0===e.extent||Pt(F=u.getTileCoordExtent(O.tileCoord,D),e.extent)){if((P=O.getState())==On.LOADED||P==On.EMPTY||P==On.ERROR&&!N||(O=O.getInterimTile()),(P=O.getState())==On.LOADED){if(r.isTileTextureLoaded(O)){I[p][O.tileCoord.toString()]=O;continue}}else if(P==On.EMPTY||P==On.ERROR&&!N)continue;G=!1,u.forEachTileCoordParentTileRange(O.tileCoord,A,null,k,D)||(L=u.getTileCoordChildTileRange(O.tileCoord,k,D))&&A(p+1,L)}var j=Object.keys(I).map(Number);j.sort(V);for(var U=new Float32Array(4),B=0,X=j.length;B<X;++B){var z=I[j[B]];for(var W in z)(O=z[W])instanceof xl&&(F=u.getTileCoordExtent(O.tileCoord,D),U[0]=2*(F[2]-F[0])/S,U[1]=2*(F[3]-F[1])/S,U[2]=2*(F[0]-l[0])/S-1,U[3]=2*(F[1]-l[1])/S-1,n.uniform4fv(this.locations_.u_tileOffset,U),r.bindTileTexture(O,d,g*f,Qa,Qa),n.drawArrays(5,0,4))}G?(this.renderedTileRange_=m,this.renderedFramebufferExtent_=l,this.renderedRevision_=h.getRevision()):(this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,t.animate=!0)}this.updateUsedTiles(t.usedTiles,h,p,m);var K=r.getTileTextureQueue();this.manageTilePyramid(t,h,u,f,s,v,p,a.getPreload(),function(t){t.getState()!=On.LOADED||r.isTileTextureLoaded(t)||K.isKeyQueued(t.getKey())||K.enqueue([t,u.getTileCoordCenter(t.tileCoord),u.getResolution(t.tileCoord[0]),d,g*f])},this),this.scheduleExpireCache(t,h);var H=this.texCoordMatrix;return Fe(H),Ue(H,(Math.round(y[0]/c)*c-l[0])/(l[2]-l[0]),(Math.round(y[1]/c)*c-l[1])/(l[3]-l[1])),0!==o.rotation&&ke(H,o.rotation),je(H,t.size[0]*o.resolution/(l[2]-l[0]),t.size[1]*o.resolution/(l[3]-l[1])),Ue(H,-.5,-.5),!0},e.prototype.forEachLayerAtPixel=function(t,e,i,r){if(this.framebuffer){var n=[t[0]/e.size[0],(e.size[1]-t[1])/e.size[1]],o=De(this.texCoordMatrix,n.slice()),s=[o[0]*this.framebufferDimension,o[1]*this.framebufferDimension],a=this.mapRenderer.getContext().getGL();a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer);var h=new Uint8Array(4);return a.readPixels(s[0],s[1],1,1,a.RGBA,a.UNSIGNED_BYTE,h),h[3]>0?i.call(r,this.getLayer(),h):void 0}},e}(fl);Vl.handles=function(t){return t.getType()===Ss.TILE},Vl.create=function(t,e){return new Vl(t,e)};var Xl=Vl,zl=function(t){function e(e,i){t.call(this,e,i),this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRenderOrder_=null,this.replayGroup_=null,this.layerState_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.composeFrame=function(t,e,i){this.layerState_=e;var r=t.viewState,n=this.replayGroup_,o=t.size,s=t.pixelRatio,a=this.mapRenderer.getGL();n&&!n.isEmpty()&&(a.enable(a.SCISSOR_TEST),a.scissor(0,0,o[0]*s,o[1]*s),n.replay(i,r.center,r.resolution,r.rotation,o,s,e.opacity,e.managed?t.skippedFeatureUids:{}),a.disable(a.SCISSOR_TEST))},e.prototype.disposeInternal=function(){var e=this.replayGroup_;if(e){var i=this.mapRenderer.getContext();e.getDeleteResourcesFunction(i)(),this.replayGroup_=null}t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,n){if(this.replayGroup_&&this.layerState_){var s=this.mapRenderer.getContext(),a=e.viewState,h=this.getLayer(),l=this.layerState_,u={};return this.replayGroup_.forEachFeatureAtCoordinate(t,s,a.center,a.resolution,a.rotation,e.size,e.pixelRatio,l.opacity,{},function(t){var e=o(t);if(!(e in u))return u[e]=!0,r.call(n,t,h)})}},e.prototype.hasFeatureAtCoordinate=function(t,e){if(this.replayGroup_&&this.layerState_){var i=this.mapRenderer.getContext(),r=e.viewState,n=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(t,i,r.center,r.resolution,r.rotation,e.size,e.pixelRatio,n.opacity,e.skippedFeatureUids)}return!1},e.prototype.forEachLayerAtPixel=function(t,e,i,r){var n=De(e.pixelToCoordinateTransform,t.slice());return this.hasFeatureAtCoordinate(n,e)?i.call(r,this.getLayer(),null):void 0},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t,e,i){var r=this.getLayer(),n=r.getSource(),o=t.viewHints[kn],s=t.viewHints[jn],a=r.getUpdateWhileAnimating(),h=r.getUpdateWhileInteracting();if(!this.dirty_&&!a&&o||!h&&s)return!0;var l=t.extent,u=t.viewState,p=u.projection,c=u.resolution,d=t.pixelRatio,f=r.getRevision(),_=r.getRenderBuffer(),g=r.getRenderOrder();void 0===g&&(g=Da);var y=et(l,_*c);if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==f&&this.renderedRenderOrder_==g&&ot(this.renderedExtent_,y))return!0;this.replayGroup_&&t.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(i)),this.dirty_=!1;var v=new ll(ja(c,d),y,r.getRenderBuffer());n.loadFeatures(y,c,p);var m=function(t){var e,i=t.getStyleFunction()||r.getStyleFunction();if(i&&(e=i(t,c)),e){var n=this.renderFeature(t,c,d,e,v);this.dirty_=this.dirty_||n}}.bind(this);if(g){var x=[];n.forEachFeatureInExtent(y,function(t){x.push(t)}),x.sort(g),x.forEach(m.bind(this))}else n.forEachFeatureInExtent(y,m);return v.finish(i),this.renderedResolution_=c,this.renderedRevision_=f,this.renderedRenderOrder_=g,this.renderedExtent_=y,this.replayGroup_=v,!0},e.prototype.renderFeature=function(t,e,i,r,n){if(!r)return!1;var o=!1;if(Array.isArray(r))for(var s=r.length-1;s>=0;--s)o=Ua(n,t,r[s],ka(e,i),this.handleStyleImageChange_,this)||o;else o=Ua(n,t,r,ka(e,i),this.handleStyleImageChange_,this)||o;return o},e}(fl);zl.handles=function(t){return t.getType()===Ss.VECTOR},zl.create=function(t,e){return new zl(t,e)};var Wl=zl,Kl=function(t){function e(e){(e=u({},e)).controls||(e.controls=wo()),e.interactions||(e.interactions=ys()),t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){var t=new yl(this);return t.registerLayerRenderers([gl,Xl,Wl]),t},e}(lo),Hl={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};function Zl(t,e,i,r){return function(n,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(n,o,s):t,!0),e.getType()==Hl.ARRAY_BUFFER&&(a.responseType="arraybuffer"),a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var n,o=e.getType();o==Hl.JSON||o==Hl.TEXT?n=a.responseText:o==Hl.XML?(n=a.responseXML)||(n=(new DOMParser).parseFromString(a.responseText,"application/xml")):o==Hl.ARRAY_BUFFER&&(n=a.response),n?i.call(this,e.readFeatures(n,{featureProjection:s}),e.readProjection(n),e.getLastExtent()):r.call(this)}else r.call(this)}.bind(this),a.onerror=function(){r.call(this)}.bind(this),a.send()}}function ql(t,e){return Zl(t,e,function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)},I)}function Jl(t,e){return[[-1/0,-1/0,1/0,1/0]]}var Ql=document.implementation.createDocument("","",null),$l="http://www.w3.org/2001/XMLSchema-instance";function tu(t,e){return Ql.createElementNS(t,e)}function eu(t,e){return function t(e,i,r){if(e.nodeType==Node.CDATA_SECTION_NODE||e.nodeType==Node.TEXT_NODE)i?r.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):r.push(e.nodeValue);else{var n;for(n=e.firstChild;n;n=n.nextSibling)t(n,i,r)}return r}(t,e,[]).join("")}function iu(t){return"documentElement"in t}function ru(t){return(new DOMParser).parseFromString(t,"application/xml")}function nu(t,e){return function(i,r){var n=t.call(void 0!==e?e:this,i,r);void 0!==n&&K(r[r.length-1],n)}}function ou(t,e){return function(i,r){var n=t.call(void 0!==e?e:this,i,r);void 0!==n&&r[r.length-1].push(n)}}function su(t,e){return function(i,r){var n=t.call(void 0!==e?e:this,i,r);void 0!==n&&(r[r.length-1]=n)}}function au(t,e,i){return function(r,n){var o=t.call(void 0!==i?i:this,r,n);if(void 0!==o){var s=n[n.length-1],a=void 0!==e?e:r.localName;(a in s?s[a]:s[a]=[]).push(o)}}}function hu(t,e,i){return function(r,n){var o=t.call(void 0!==i?i:this,r,n);void 0!==o&&(n[n.length-1][void 0!==e?e:r.localName]=o)}}function lu(t,e){return function(i,r,n){t.call(void 0!==e?e:this,i,r,n),n[n.length-1].node.appendChild(i)}}function uu(t,e){var i,r;return function(e,n,o){if(void 0===i){i={};var s={};s[e.localName]=t,i[e.namespaceURI]=s,r=pu(e.localName)}yu(i,r,n,o)}}function pu(t,e){var i=t;return function(t,r,n){var o=r[r.length-1].node,s=i;return void 0===s&&(s=n),tu(void 0!==e?e:o.namespaceURI,s)}}var cu=pu();function du(t,e){for(var i=e.length,r=new Array(i),n=0;n<i;++n)r[n]=t[e[n]];return r}function fu(t,e,i){var r,n,o=void 0!==i?i:{};for(r=0,n=t.length;r<n;++r)o[t[r]]=e;return o}function _u(t,e,i,r){var n;for(n=e.firstElementChild;n;n=n.nextElementSibling){var o=t[n.namespaceURI];if(void 0!==o){var s=o[n.localName];void 0!==s&&s.call(r,n,i)}}}function gu(t,e,i,r,n){return r.push(t),_u(e,i,r,n),r.pop()}function yu(t,e,i,r,n,o){for(var s,a,h=(void 0!==n?n:i).length,l=0;l<h;++l)void 0!==(s=i[l])&&void 0!==(a=e.call(void 0!==o?o:this,s,r,void 0!==n?n[l]:void 0))&&t[a.namespaceURI][a.localName].call(o,a,s,r)}function vu(t,e,i,r,n,o,s){return n.push(t),yu(e,i,r,n,o,s),n.pop()}var mu=function(t){function e(e){t.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}),this.matrixIds_=e.matrixIds}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getMatrixId=function(t){return this.matrixIds_[t]},e.prototype.getMatrixIds=function(){return this.matrixIds_},e}(Pl),xu=mu;function Eu(t,e,i){var r=[],n=[],o=[],s=[],a=[],h=void 0!==i?i:[],l=t.SupportedCRS,u=Ee(l.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||Ee(l),p=u.getMetersPerUnit(),c="ne"==u.getAxisOrientation().substr(0,2);return t.TileMatrix.sort(function(t,e){return e.ScaleDenominator-t.ScaleDenominator}),t.TileMatrix.forEach(function(e){if(!(h.length>0)||H(h,function(i){return e.Identifier==i.TileMatrix||-1===e.Identifier.indexOf(":")&&t.Identifier+":"+e.Identifier===i.TileMatrix})){n.push(e.Identifier);var i=28e-5*e.ScaleDenominator/p,l=e.TileWidth,u=e.TileHeight;c?o.push([e.TopLeftCorner[1],e.TopLeftCorner[0]]):o.push(e.TopLeftCorner),r.push(i),s.push(l==u?l:[l,u]),a.push([e.MatrixWidth,-e.MatrixHeight])}}),new mu({extent:e,origins:o,resolutions:r,matrixIds:n,tileSizes:s,sizes:a})}var Su=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale};Su.prototype.clone=function(){return new Su({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},Su.prototype.getOpacity=function(){return this.opacity_},Su.prototype.getRotateWithView=function(){return this.rotateWithView_},Su.prototype.getRotation=function(){return this.rotation_},Su.prototype.getScale=function(){return this.scale_},Su.prototype.getSnapToPixel=function(){return!1},Su.prototype.getAnchor=function(){return r()},Su.prototype.getImage=function(t){return r()},Su.prototype.getHitDetectionImage=function(t){return r()},Su.prototype.getImageState=function(){return r()},Su.prototype.getImageSize=function(){return r()},Su.prototype.getHitDetectionImageSize=function(){return r()},Su.prototype.getOrigin=function(){return r()},Su.prototype.getSize=function(){return r()},Su.prototype.setOpacity=function(t){this.opacity_=t},Su.prototype.setRotateWithView=function(t){this.rotateWithView_=t},Su.prototype.setRotation=function(t){this.rotation_=t},Su.prototype.setScale=function(t){this.scale_=t},Su.prototype.setSnapToPixel=function(t){},Su.prototype.listenImageChange=function(t,e){return r()},Su.prototype.load=function(){r()},Su.prototype.unlistenImageChange=function(t,e){r()};var Tu=Su,Cu=function(t){function e(e){var i=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:i,rotation:void 0!==e.rotation?e.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return xs.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,i,r="",n="",o=0,s=null,a=0,h=0;this.stroke_&&(null===(i=this.stroke_.getColor())&&(i=Ls),i=Ys(i),void 0===(h=this.stroke_.getWidth())&&(h=1),s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),ki||(s=null,a=0),void 0===(n=this.stroke_.getLineJoin())&&(n="round"),void 0===(r=this.stroke_.getLineCap())&&(r="round"),void 0===(o=this.stroke_.getMiterLimit())&&(o=10));var l=2*(this.radius_+h)+1,u={strokeStyle:i,strokeWidth:h,size:l,lineCap:r,lineDash:s,lineDashOffset:a,lineJoin:n,miterLimit:o};if(void 0===t){var p=Jn(l,l);this.canvas_=p.canvas,e=l=this.canvas_.width,this.draw_(u,p,0,0),this.createHitDetectionCanvas_(u)}else{l=Math.round(l);var c,d=!this.fill_;d&&(c=this.drawHitDetectionCanvas_.bind(this,u));var f=this.getChecksum(),_=t.add(f,l,l,this.draw_.bind(this,u),c);this.canvas_=_.image,this.origin_=[_.offsetX,_.offsetY],e=_.image.width,d?(this.hitDetectionCanvas_=_.hitImage,this.hitDetectionImageSize_=[_.hitImage.width,_.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[l/2,l/2],this.size_=[l,l],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,i,r){var n,o,s;e.setTransform(1,0,0,1,0,0),e.translate(i,r),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(a*=2),n=0;n<=a;n++)o=2*n*Math.PI/a-Math.PI/2+this.angle_,s=n%2==0?this.radius_:h,e.lineTo(t.size/2+s*Math.cos(o),t.size/2+s*Math.sin(o))}if(this.fill_){var l=this.fill_.getColor();null===l&&(l=ws),e.fillStyle=Ys(l),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=Jn(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,r){e.setTransform(1,0,0,1,0,0),e.translate(i,r),e.beginPath();var n=this.points_;if(n===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,s,a,h=void 0!==this.radius2_?this.radius2_:this.radius_;for(h!==this.radius_&&(n*=2),o=0;o<=n;o++)a=2*o*Math.PI/n-Math.PI/2+this.angle_,s=o%2==0?this.radius_:h,e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}e.fillStyle=dr(ws),e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var i="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[i,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(Tu),Ru=function(t){function e(e){var i=e||{};t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,atlasManager:i.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(Cu),wu={FRACTION:"fraction",PIXELS:"pixels"},Iu=function(t){function e(e,i,r,n,o,s){t.call(this),this.hitDetectionImage_=null,this.image_=e||new Image,null!==n&&(this.image_.crossOrigin=n),this.canvas_=s?document.createElement("canvas"):null,this.color_=s,this.imageListenerKeys_=null,this.imageState_=o,this.size_=r,this.src_=i,this.tainted_}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===xs.LOADED){this.tainted_=!1;var t=Jn(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(t){this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(M.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=xs.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=xs.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],i=this.size_[1],r=Jn(e,i);r.fillRect(0,0,e,i),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==xs.IDLE){this.imageState_=xs.LOADING,this.imageListenerKeys_=[m(this.image_,M.ERROR,this.handleImageError_,this),m(this.image_,M.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(t){this.handleImageError_()}}},e.prototype.replaceColor_=function(){if(this.color_&&!this.isTainted_()){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var e=t.getImageData(0,0,this.image_.width,this.image_.height),i=e.data,r=this.color_[0]/255,n=this.color_[1]/255,o=this.color_[2]/255,s=0,a=i.length;s<a;s+=4)i[s]*=r,i[s+1]*=n,i[s+2]*=o;t.putImageData(e,0,0)}},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(E),this.imageListenerKeys_=null},e}(b);var Lu={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},Ou=function(t){function e(e){var i=e||{},r=void 0!==i.opacity?i.opacity:1,n=void 0!==i.rotation?i.rotation:0,s=void 0!==i.scale?i.scale:1,a=void 0!==i.rotateWithView&&i.rotateWithView;t.call(this,{opacity:r,rotation:n,scale:s,rotateWithView:a}),this.anchor_=void 0!==i.anchor?i.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==i.anchorOrigin?i.anchorOrigin:Lu.TOP_LEFT,this.anchorXUnits_=void 0!==i.anchorXUnits?i.anchorXUnits:wu.FRACTION,this.anchorYUnits_=void 0!==i.anchorYUnits?i.anchorYUnits:wu.FRACTION,this.crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null;var h=void 0!==i.img?i.img:null,l=void 0!==i.imgSize?i.imgSize:null,u=i.src;Y(!(void 0!==u&&h),4),Y(!h||h&&l,5),void 0!==u&&0!==u.length||!h||(u=h.src||o(h)),Y(void 0!==u&&u.length>0,6);var p=void 0!==i.src?xs.IDLE:xs.LOADED;this.color_=void 0!==i.color?_r(i.color):null,this.iconImage_=function(t,e,i,r,n,o){var s=Ks.get(e,r,o);return s||(s=new Iu(t,e,i,r,n,o),Ks.set(e,r,o,s)),s}(h,u,l,this.crossOrigin_,p,this.color_),this.offset_=void 0!==i.offset?i.offset:[0,0],this.offsetOrigin_=void 0!==i.offsetOrigin?i.offsetOrigin:Lu.TOP_LEFT,this.origin_=null,this.size_=void 0!==i.size?i.size:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==wu.FRACTION||this.anchorYUnits_==wu.FRACTION){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==wu.FRACTION&&(t[0]*=e[0]),this.anchorYUnits_==wu.FRACTION&&(t[1]*=e[1])}if(this.anchorOrigin_!=Lu.TOP_LEFT){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=Lu.TOP_RIGHT&&this.anchorOrigin_!=Lu.BOTTOM_RIGHT||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=Lu.BOTTOM_LEFT&&this.anchorOrigin_!=Lu.BOTTOM_RIGHT||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=Lu.TOP_LEFT){var e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),this.offsetOrigin_!=Lu.TOP_RIGHT&&this.offsetOrigin_!=Lu.BOTTOM_RIGHT||(t[0]=i[0]-e[0]-t[0]),this.offsetOrigin_!=Lu.BOTTOM_LEFT&&this.offsetOrigin_!=Lu.BOTTOM_RIGHT||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t,e){return v(this.iconImage_,M.CHANGE,t,e)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t,e){x(this.iconImage_,M.CHANGE,t,e)},e}(Tu),Pu=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Au,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};Pu.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Pu({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},Pu.prototype.getRenderer=function(){return this.renderer_},Pu.prototype.setRenderer=function(t){this.renderer_=t},Pu.prototype.getGeometry=function(){return this.geometry_},Pu.prototype.getGeometryFunction=function(){return this.geometryFunction_},Pu.prototype.getFill=function(){return this.fill_},Pu.prototype.setFill=function(t){this.fill_=t},Pu.prototype.getImage=function(){return this.image_},Pu.prototype.setImage=function(t){this.image_=t},Pu.prototype.getStroke=function(){return this.stroke_},Pu.prototype.setStroke=function(t){this.stroke_=t},Pu.prototype.getText=function(){return this.text_},Pu.prototype.setText=function(t){this.text_=t},Pu.prototype.getZIndex=function(){return this.zIndex_},Pu.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Au,this.geometry_=t},Pu.prototype.setZIndex=function(t){this.zIndex_=t};var bu=null;function Mu(t,e){if(!bu){var i=new mr({color:"rgba(255,255,255,0.4)"}),r=new Er({color:"#3399CC",width:1.25});bu=[new Pu({image:new Ru({fill:i,stroke:r,radius:5}),fill:i,stroke:r})]}return bu}function Fu(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t[Nt.POLYGON]=[new Pu({fill:new mr({color:[255,255,255,.5]})})],t[Nt.MULTI_POLYGON]=t[Nt.POLYGON],t[Nt.LINE_STRING]=[new Pu({stroke:new Er({color:e,width:5})}),new Pu({stroke:new Er({color:i,width:3})})],t[Nt.MULTI_LINE_STRING]=t[Nt.LINE_STRING],t[Nt.CIRCLE]=t[Nt.POLYGON].concat(t[Nt.LINE_STRING]),t[Nt.POINT]=[new Pu({image:new Ru({radius:6,fill:new mr({color:i}),stroke:new Er({color:e,width:1.5})}),zIndex:1/0})],t[Nt.MULTI_POINT]=t[Nt.POINT],t[Nt.GEOMETRY_COLLECTION]=t[Nt.POLYGON].concat(t[Nt.LINE_STRING],t[Nt.POINT]),t}function Au(t){return t.getGeometry()}var Nu=Pu;function Gu(t,e){var i=/\{z\}/g,r=/\{x\}/g,n=/\{y\}/g,o=/\{-y\}/g;return function(s,a,h){return s?t.replace(i,s[0].toString()).replace(r,s[1].toString()).replace(n,function(){return(-s[2]-1).toString()}).replace(o,function(){var t=s[0],i=e.getFullTileRange(t);return Y(i,55),(i.getHeight()+s[2]).toString()}):void 0}}function Du(t,e){for(var i=t.length,r=new Array(i),n=0;n<i;++n)r[n]=Gu(t[n],e);return ku(r)}function ku(t){return 1===t.length?t[0]:function(e,i,r){if(e){var n=Xt(Cl(e),t.length);return t[n](e,i,r)}}}function ju(t,e,i){}function Uu(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var r,n=i[1].charCodeAt(0),o=i[2].charCodeAt(0);for(r=n;r<=o;++r)e.push(t.replace(i[0],String.fromCharCode(r)));return e}if(i=i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}function Yu(t,e,i,r){var n=document.createElement("script"),s="olc_"+o(e);function a(){delete window[s],n.parentNode.removeChild(n)}n.async=!0,n.src=t+(-1==t.indexOf("?")?"?":"&")+(r||"callback")+"="+s;var h=setTimeout(function(){a(),i&&i()},1e4);window[s]=function(t){clearTimeout(h),a(),e(t)},document.getElementsByTagName("head")[0].appendChild(n)}function Bu(t,e,i,r){var n=Pe(i,e,t),o=Se(e,r,i),s=e.getMetersPerUnit();void 0!==s&&(o*=s);var a=t.getMetersPerUnit();void 0!==a&&(o/=a);var h=t.getExtent();if(!h||nt(h,n)){var l=Se(t,o,n)/o;isFinite(l)&&l>0&&(o/=l)}return o}function Vu(t,e,i,r){var n=i-t,o=r-e,s=Math.sqrt(n*n+o*o);return[Math.round(i+n/s),Math.round(r+o/s)]}function Xu(t,e,i,r,n,o,s,a,h,l,u){var p=Jn(Math.round(i*t),Math.round(i*e));if(0===h.length)return p.canvas;p.scale(i,i);var c=[1/0,1/0,-1/0,-1/0];h.forEach(function(t,e,i){ft(c,t.extent)});var d=Ot(c),f=Rt(c),_=Jn(Math.round(i*d/r),Math.round(i*f/r)),g=i/r;h.forEach(function(t,e,i){var r=t.extent[0]-c[0],n=-(t.extent[3]-c[3]),o=Ot(t.extent),s=Rt(t.extent);_.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,r*g,n*g,o*g,s*g)});var y=It(s);return a.getTriangles().forEach(function(t,e,n){var s=t.source,a=t.target,h=s[0][0],l=s[0][1],u=s[1][0],d=s[1][1],f=s[2][0],g=s[2][1],v=(a[0][0]-y[0])/o,m=-(a[0][1]-y[1])/o,x=(a[1][0]-y[0])/o,E=-(a[1][1]-y[1])/o,S=(a[2][0]-y[0])/o,T=-(a[2][1]-y[1])/o,C=h,R=l;h=0,l=0;var w=function(t){for(var e=t.length,i=0;i<e;i++){for(var r=i,n=Math.abs(t[i][i]),o=i+1;o<e;o++){var s=Math.abs(t[o][i]);s>n&&(n=s,r=o)}if(0===n)return null;var a=t[r];t[r]=t[i],t[i]=a;for(var h=i+1;h<e;h++)for(var l=-t[h][i]/t[i][i],u=i;u<e+1;u++)i==u?t[h][u]=0:t[h][u]+=l*t[i][u]}for(var p=new Array(e),c=e-1;c>=0;c--){p[c]=t[c][e]/t[c][c];for(var d=c-1;d>=0;d--)t[d][e]-=t[d][c]*p[c]}return p}([[u-=C,d-=R,0,0,x-v],[f-=C,g-=R,0,0,S-v],[0,0,u,d,E-m],[0,0,f,g,T-m]]);if(w){p.save(),p.beginPath();var I=(v+x+S)/3,L=(m+E+T)/3,O=Vu(I,L,v,m),P=Vu(I,L,x,E),b=Vu(I,L,S,T);p.moveTo(P[0],P[1]),p.lineTo(O[0],O[1]),p.lineTo(b[0],b[1]),p.clip(),p.transform(w[0],w[2],w[1],w[3],v,m),p.translate(c[0]-C,c[3]-R),p.scale(r/i,-r/i),p.drawImage(_.canvas,0,0),p.restore()}}),u&&(p.save(),p.strokeStyle="black",p.lineWidth=1,a.getTriangles().forEach(function(t,e,i){var r=t.target,n=(r[0][0]-y[0])/o,s=-(r[0][1]-y[1])/o,a=(r[1][0]-y[0])/o,h=-(r[1][1]-y[1])/o,l=(r[2][0]-y[0])/o,u=-(r[2][1]-y[1])/o;p.beginPath(),p.moveTo(a,h),p.lineTo(n,s),p.lineTo(l,u),p.closePath(),p.stroke()}),p.restore()),p.canvas}var zu=function(t,e,i,r,n){this.sourceProj_=t,this.targetProj_=e;var o={},s=Oe(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=s(t)),o[e]},this.maxSourceExtent_=r,this.errorThresholdSquared_=n*n,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&Ot(r)==Ot(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Ot(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Ot(this.targetProj_.getExtent()):null;var a=It(i),h=Lt(i),l=St(i),u=Et(i),p=this.transformInv_(a),c=this.transformInv_(h),d=this.transformInv_(l),f=this.transformInv_(u);if(this.addQuad_(a,h,l,u,p,c,d,f,10),this.wrapsXInSource_){var _=1/0;this.triangles_.forEach(function(t,e,i){_=Math.min(_,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-_>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-_>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-_>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-_>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}o={}};zu.prototype.addTriangle_=function(t,e,i,r,n,o){this.triangles_.push({source:[r,n,o],target:[t,e,i]})},zu.prototype.addQuad_=function(t,e,i,r,n,o,s,a,h){var l=tt([n,o,s,a]),u=this.sourceWorldWidth_?Ot(l)/this.sourceWorldWidth_:null,p=this.sourceWorldWidth_,c=this.sourceProj_.canWrapX()&&u>.5&&u<1,d=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)d=Ot(tt([t,e,i,r]))/this.targetWorldWidth_>.25||d;!c&&this.sourceProj_.isGlobal()&&u&&(d=u>.25||d)}if(d||!this.maxSourceExtent_||Pt(l,this.maxSourceExtent_)){if(!(d||isFinite(n[0])&&isFinite(n[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(h>0))return;d=!0}if(h>0){if(!d){var f,_=[(t[0]+i[0])/2,(t[1]+i[1])/2],g=this.transformInv_(_);if(c)f=(Xt(n[0],p)+Xt(s[0],p))/2-Xt(g[0],p);else f=(n[0]+s[0])/2-g[0];var y=(n[1]+s[1])/2-g[1];d=f*f+y*y>this.errorThresholdSquared_}if(d){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var v=[(e[0]+i[0])/2,(e[1]+i[1])/2],m=this.transformInv_(v),x=[(r[0]+t[0])/2,(r[1]+t[1])/2],E=this.transformInv_(x);this.addQuad_(t,e,v,x,n,o,m,E,h-1),this.addQuad_(x,v,i,r,E,m,s,a,h-1)}else{var S=[(t[0]+e[0])/2,(t[1]+e[1])/2],T=this.transformInv_(S),C=[(i[0]+r[0])/2,(i[1]+r[1])/2],R=this.transformInv_(C);this.addQuad_(t,S,C,r,n,T,R,a,h-1),this.addQuad_(S,e,i,C,T,o,s,R,h-1)}return}}if(c){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,r,n,s,a),this.addTriangle_(t,e,i,n,o,s)}},zu.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach(function(e,i,r){var n=e.source;_t(t,n[0]),_t(t,n[1]),_t(t,n[2])}),t},zu.prototype.getTriangles=function(){return this.triangles_};var Wu=zu,Ku=function(t){function e(e,i,r,n,o,s,a,h,l,u,p){t.call(this,o,On.IDLE),this.renderEdges_=void 0!==p&&p,this.pixelRatio_=a,this.gutter_=h,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=n,this.wrappedTileCoord_=s||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var c=n.getTileCoordExtent(this.wrappedTileCoord_),d=this.targetTileGrid_.getExtent(),f=this.sourceTileGrid_.getExtent(),_=d?wt(c,d):c;if(0!==xt(_)){var g=e.getExtent();g&&(f=f?wt(f,g):g);var y=n.getResolution(this.wrappedTileCoord_[0]),v=Bu(e,r,Tt(_),y);if(!isFinite(v)||v<=0)this.state=On.EMPTY;else{var m=void 0!==u?u:vs;if(this.triangulation_=new Wu(e,r,_,f,v*m),0!==this.triangulation_.getTriangles().length){this.sourceZ_=i.getZForResolution(v);var x=this.triangulation_.calculateSourceExtent();if(f&&(e.canWrapX()?(x[1]=kt(x[1],f[1],f[3]),x[3]=kt(x[3],f[1],f[3])):x=wt(x,f)),xt(x)){for(var E=i.getTileRangeForExtentAndZ(x,this.sourceZ_),S=E.minX;S<=E.maxX;S++)for(var T=E.minY;T<=E.maxY;T++){var C=l(this.sourceZ_,S,T,a);C&&this.sourceTiles_.push(C)}0===this.sourceTiles_.length&&(this.state=On.EMPTY)}else this.state=On.EMPTY}else this.state=On.EMPTY}}else this.state=On.EMPTY}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==On.LOADING&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,i,r){e&&e.getState()==On.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=On.ERROR;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),r="number"==typeof i?i:i[0],n="number"==typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Xu(r,n,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=On.LOADED}this.changed()},e.prototype.load=function(){if(this.state==On.IDLE){this.state=On.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,r){var n=e.getState();if(n==On.IDLE||n==On.LOADING){t++;var o=v(e,M.CHANGE,function(i){var r=e.getState();r!=On.LOADED&&r!=On.ERROR&&r!=On.EMPTY||(E(o),0===--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(o)}}.bind(this)),this.sourceTiles_.forEach(function(t,e,i){t.getState()==On.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(E),this.sourcesListenerKeys_=null},e}(vl),Hu="tileloadstart",Zu="tileloadend",qu="tileloaderror",Ju=function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.generateTileUrlFunction_=!e.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,this.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(this):ju,this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),e.tileUrlFunction&&this.setTileUrlFunction(e.tileUrlFunction,this.key_),this.tileLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,r=o(i),n=i.getState();n==On.LOADING?(this.tileLoadingKeys_[r]=!0,e=Hu):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],e=n==On.ERROR?qu:n==On.LOADED||n==On.ABORT?Zu:void 0),void 0!=e&&this.dispatchEvent(new kl(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=this.urls=Uu(t);this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(Du(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,i){var r=Sl(t,e,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)},e}(jl);function Qu(t,e){t.getImage().src=e}var $u=function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Qu,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:xl,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);for(var r in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var n=this.tileCacheForProjection[r];n.expireCache(n==i?e:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!Ie(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!Ie(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!Ie(e,t)){var i=o(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=bl(t)),this.tileGridForProjection[i]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||Ie(e,t))return this.tileCache;var i=o(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Rl(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},e.prototype.createTile_=function(t,e,i,r,n,o){var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,n),h=a?this.tileUrlFunction(a,r,n):void 0,l=new this.tileClass(s,void 0!==h?On.IDLE:On.EMPTY,void 0!==h?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=o,v(l,M.CHANGE,this.handleTileChange,this),l},e.prototype.getTile=function(t,e,i,r,n){var o=this.getProjection();if(o&&n&&!Ie(o,n)){var s,a=this.getTileCacheForProjection(n),h=[t,e,i],l=Tl(h);a.containsKey(l)&&(s=a.get(l));var u=this.getKey();if(s&&s.key==u)return s;var p=this.getTileGridForProjection(o),c=this.getTileGridForProjection(n),d=this.getTileCoordForTileUrlFunction(h,n),f=new Ku(o,p,n,c,h,d,this.getTilePixelRatio(r),this.getGutter(),function(t,e,i,r){return this.getTileInternal(t,e,i,r,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return f.key=u,s?(f.interimTile=s,f.refreshInterimChain(),a.replace(l,f)):a.set(l,f),f}return this.getTileInternal(t,e,i,r,o||n)},e.prototype.getTileInternal=function(t,e,i,r,n){var o=null,s=Sl(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)){if((o=this.tileCache.get(s)).key!=a){var h=o;o=this.createTile_(t,e,i,r,n,a),h.getState()==On.IDLE?o.interimTile=h.interimTile:o.interimTile=h,o.refreshInterimChain(),this.tileCache.replace(s,o)}}else o=this.createTile_(t,e,i,r,n,a),this.tileCache.set(s,o);return o},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var i=Ee(t);if(i){var r=o(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}},e}(Ju),tp=function(t){function e(e){var i=void 0!==e.hidpi&&e.hidpi;t.call(this,{cacheSize:e.cacheSize,crossOrigin:"anonymous",opaque:!0,projection:Ee("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:ro.LOADING,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:i?2:1,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition}),this.hidpi_=i,this.culture_=void 0!==e.culture?e.culture:"en-us",this.maxZoom_=void 0!==e.maxZoom?e.maxZoom:-1,this.apiKey_=e.key,this.imagerySet_=e.imagerySet,Yu("https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_,this.handleImageryMetadataResponse.bind(this),void 0,"jsonp")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getApiKey=function(){return this.apiKey_},e.prototype.getImagerySet=function(){return this.imagerySet_},e.prototype.handleImageryMetadataResponse=function(t){if(200==t.statusCode&&"OK"==t.statusDescription&&"ValidCredentials"==t.authenticationResultCode&&1==t.resourceSets.length&&1==t.resourceSets[0].resources.length){var e=t.resourceSets[0].resources[0],i=-1==this.maxZoom_?e.zoomMax:this.maxZoom_,r=Gl(this.getProjection()),n=this.hidpi_?2:1,o=e.imageWidth==e.imageHeight?e.imageWidth/n:[e.imageWidth/n,e.imageHeight/n],s=Fl({extent:r,minZoom:e.zoomMin,maxZoom:i,tileSize:o});this.tileGrid=s;var a=this.culture_,h=this.hidpi_;if(this.tileUrlFunction=ku(e.imageUrlSubdomains.map(function(t){var i=[0,0,0],r=e.imageUrl.replace("{subdomain}",t).replace("{culture}",a);return function(t,e,n){if(t){El(t[0],t[1],-t[2]-1,i);var o=r;return h&&(o+="&dpi=d1&device=mobile"),o.replace("{quadkey}",function(t){var e,i,r=t[0],n=new Array(r),o=1<<r-1;for(e=0;e<r;++e)i=48,t[1]&o&&(i+=1),t[2]&o&&(i+=2),n[e]=String.fromCharCode(i),o>>=1;return n.join("")}(i))}}})),e.imageryProviders){var l=Le(Ee("EPSG:4326"),this.getProjection());this.setAttributions(function(t){var i=[],r=t.viewState,n=this.getTileGrid().getTileCoordForCoordAndResolution(r.center,r.resolution)[0];return e.imageryProviders.map(function(e){for(var r=!1,o=e.coverageAreas,s=0,a=o.length;s<a;++s){var h=o[s];if(n>=h.zoomMin&&n<=h.zoomMax){var u=h.bbox;if(Pt(Ft([u[1],u[0],u[3],u[2]],l),t.extent)){r=!0;break}}}r&&i.push(e.attribution)}),i.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html">Terms of Use</a>'),i}.bind(this))}this.setState(ro.READY)}else this.setState(ro.ERROR)},e}($u),ep=function(t){function e(e){var i=e||{},r=void 0!==i.projection?i.projection:"EPSG:3857",n=void 0!==i.tileGrid?i.tileGrid:Fl({extent:Gl(r),maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:r,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition,attributionsCollapsible:i.attributionsCollapsible})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}($u),ip=function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,maxZoom:void 0!==e.maxZoom?e.maxZoom:18,minZoom:e.minZoom,projection:e.projection,wrapX:e.wrapX}),this.account_=e.account,this.mapId_=e.map||"",this.config_=e.config||{},this.templateCache_={},this.initializeMap_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getConfig=function(){return this.config_},e.prototype.updateConfig=function(t){u(this.config_,t),this.initializeMap_()},e.prototype.setConfig=function(t){this.config_=t||{},this.initializeMap_()},e.prototype.initializeMap_=function(){var t=JSON.stringify(this.config_);if(this.templateCache_[t])this.applyTemplate_(this.templateCache_[t]);else{var e="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(e+="/named/"+this.mapId_);var i=new XMLHttpRequest;i.addEventListener("load",this.handleInitResponse_.bind(this,t)),i.addEventListener("error",this.handleInitError_.bind(this)),i.open("POST",e),i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(this.config_))}},e.prototype.handleInitResponse_=function(t,e){var i=e.target;if(!i.status||i.status>=200&&i.status<300){var r;try{r=JSON.parse(i.responseText)}catch(t){return void this.setState(ro.ERROR)}this.applyTemplate_(r),this.templateCache_[t]=r,this.setState(ro.READY)}else this.setState(ro.ERROR)},e.prototype.handleInitError_=function(t){this.setState(ro.ERROR)},e.prototype.applyTemplate_=function(t){var e="https://"+t.cdn_url.https+"/"+this.account_+"/api/v1/map/"+t.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(e)},e}(ep),rp={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"},np=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),op=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:void 0,state:ro.READY,wrapX:void 0===i.wrapX||i.wrapX}),this.loader_=I,this.format_=i.format,this.overlaps_=void 0==i.overlaps||i.overlaps,this.url_=i.url,void 0!==i.loader?this.loader_=i.loader:void 0!==this.url_&&(Y(this.format_,7),this.loader_=ql(this.url_,this.format_)),this.strategy_=void 0!==i.strategy?i.strategy:Jl;var r,n,o=void 0===i.useSpatialIndex||i.useSpatialIndex;this.featuresRtree_=o?new tl:null,this.loadedExtentsRtree_=new tl,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(i.features)?n=i.features:i.features&&(n=(r=i.features).getArray()),o||void 0!==r||(r=new U(n)),void 0!==n&&this.addFeaturesInternal(n),void 0!==r&&this.bindFeaturesCollection_(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=o(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new np(rp.ADDFEATURE,t))}},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[v(e,M.CHANGE,this.handleFeatureChange_,this),v(e,l,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,r=e.getId();return void 0!==r?r.toString()in this.idIndex_?i=!1:this.idIndex_[r.toString()]=e:(Y(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],r=[],n=0,s=t.length;n<s;n++){var a=t[n],h=o(a);this.addToIndex_(h,a)&&i.push(a)}for(var l=0,u=i.length;l<u;l++){var p=i[l],c=o(p);this.setupChangeEvents_(c,p);var d=p.getGeometry();if(d){var f=d.getExtent();e.push(f),r.push(p)}else this.nullGeometryFeatures_[c]=p}this.featuresRtree_&&this.featuresRtree_.load(e,r);for(var _=0,g=i.length;_<g;_++)this.dispatchEvent(new np(rp.ADDFEATURE,i[_]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;v(this,rp.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),v(this,rp.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),v(t,h.ADD,function(t){e||(e=!0,this.addFeature(t.element),e=!1)},this),v(t,h.REMOVE,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)},this),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(E)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var r=new np(rp.CLEAR);this.dispatchEvent(r),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0})},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,function(i){if(i.getGeometry().intersectsExtent(t)){var r=e(i);if(r)return r}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),d(this.nullGeometryFeatures_)||K(t,c(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],r=t[1],n=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],h=e||R;return this.featuresRtree_.forEachInExtent(a,function(t){if(h(t)){var e=t.getGeometry(),l=s;if((s=e.closestPointXY(i,r,o,s))<l){n=t;var u=Math.sqrt(s);a[0]=i-u,a[1]=r-u,a[2]=i+u,a[3]=r+u}}}),n},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=o(e),r=e.getGeometry();if(r){var n=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(n,e)):this.featuresRtree_&&this.featuresRtree_.update(n,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var s=e.getId();if(void 0!==s){var a=s.toString();i in this.undefIdIndex_?(delete this.undefIdIndex_[i],this.idIndex_[a]=e):this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else i in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[i]=e);this.changed(),this.dispatchEvent(new np(rp.CHANGEFEATURE,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:o(t)in this.undefIdIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&d(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var r=this,n=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var s=function(t,s){var a=o[t];n.forEachInExtent(a,function(t){return ot(t.extent,a)})||(r.loader_.call(r,a,e,i),n.insert(a,{extent:a.slice()}),r.loading=r.loader_!==I)},a=0,h=o.length;a<h;++a)s(a)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,function(i){if(dt(i.extent,t))return e=i,!0}),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=o(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=o(t);this.featureChangeKeys_[e].forEach(E),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i?delete this.idIndex_[i.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new np(rp.REMOVEFEATURE,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e}(Il),sp=function(t){function e(e){t.call(this,{attributions:e.attributions,wrapX:e.wrapX}),this.resolution=void 0,this.distance=void 0!==e.distance?e.distance:20,this.features=[],this.geometryFunction=e.geometryFunction||function(t){var e=t.getGeometry();return Y(e.getType()==Nt.POINT,10),e},this.source=e.source,v(this.source,M.CHANGE,this.refresh,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDistance=function(){return this.distance},e.prototype.getSource=function(){return this.source},e.prototype.loadFeatures=function(t,e,i){this.source.loadFeatures(t,e,i),e!==this.resolution&&(this.clear(),this.resolution=e,this.cluster(),this.addFeatures(this.features))},e.prototype.setDistance=function(t){this.distance=t,this.refresh()},e.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features),t.prototype.refresh.call(this)},e.prototype.cluster=function(){if(void 0!==this.resolution){this.features.length=0;for(var t=[1/0,1/0,-1/0,-1/0],e=this.distance*this.resolution,i=this.source.getFeatures(),r={},n=0,s=i.length;n<s;n++){var a=i[n];if(!(o(a)in r)){var h=this.geometryFunction(a);if(h){pt(h.getCoordinates(),t),et(t,e,t);var l=this.source.getFeaturesInExtent(t);l=l.filter(function(t){var e=o(t);return!(e in r)&&(r[e]=!0,!0)}),this.features.push(this.createCluster(l))}}}}},e.prototype.createCluster=function(t){for(var e=[0,0],i=t.length-1;i>=0;--i){var r=this.geometryFunction(t[i]);r?Hi(e,r.getCoordinates()):t.splice(i,1)}tr(e,1/t.length);var n=new B(new ci(e));return n.set("features",t),n},e}(op),ap=function(t){function e(e,i,r,n,o,s){var a=e.getExtent(),h=i.getExtent(),l=h?wt(r,h):r,u=Bu(e,i,Tt(l),n),p=new Wu(e,i,l,a,u*vs),c=s(p.calculateSourceExtent(),u,o),d=xs.LOADED;c&&(d=xs.IDLE);var f=c?c.getPixelRatio():1;t.call(this,r,n,f,d),this.targetProj_=i,this.maxSourceExtent_=a,this.triangulation_=p,this.targetResolution_=n,this.targetExtent_=r,this.sourceImage_=c,this.sourcePixelRatio_=f,this.canvas_=null,this.sourceListenerKey_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==xs.LOADING&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==xs.LOADED){var e=Ot(this.targetExtent_)/this.targetResolution_,i=Rt(this.targetExtent_)/this.targetResolution_;this.canvas_=Xu(e,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==xs.IDLE){this.state=xs.LOADING,this.changed();var t=this.sourceImage_.getState();t==xs.LOADED||t==xs.ERROR?this.reproject_():(this.sourceListenerKey_=v(this.sourceImage_,M.CHANGE,function(t){var e=this.sourceImage_.getState();e!=xs.LOADED&&e!=xs.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){E(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(ms),hp="imageloadstart",lp="imageloadend",up="imageloaderror",pp=function(t){function e(e,i){t.call(this,e),this.image=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P);function cp(t,e){t.getImage().src=e}var dp=function(t){function e(e){t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state}),this.resolutions_=void 0!==e.resolutions?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=z(this.resolutions_,t,0);t=this.resolutions_[e]}return t},e.prototype.getImage=function(t,e,i,r){var n=this.getProjection();if(n&&r&&!Ie(n,r)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Ie(this.reprojectedImage_.getProjection(),r)&&this.reprojectedImage_.getResolution()==e&&dt(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new ap(n,r,t,e,i,function(t,e,i){return this.getImageInternal(t,e,i,n)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return n&&(r=n),this.getImageInternal(t,e,i,r)},e.prototype.getImageInternal=function(t,e,i,n){return r()},e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case xs.LOADING:this.loading=!0,this.dispatchEvent(new pp(hp,e));break;case xs.LOADED:this.loading=!1,this.dispatchEvent(new pp(lp,e));break;case xs.ERROR:this.loading=!1,this.dispatchEvent(new pp(up,e))}},e}(Il),fp=function(t){function e(e,i,r,n,o,s){t.call(this,e,i,r,xs.IDLE),this.src_=n,this.image_=new Image,null!==o&&(this.image_.crossOrigin=o),this.imageListenerKeys_=null,this.state=xs.IDLE,this.imageLoadFunction_=s}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=xs.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Rt(this.extent)/this.image_.height),this.state=xs.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=xs.IDLE&&this.state!=xs.ERROR||(this.state=xs.LOADING,this.changed(),this.imageListenerKeys_=[m(this.image_,M.ERROR,this.handleImageError_,this),m(this.image_,M.LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(E),this.imageListenerKeys_=null},e}(ms);function _p(t,e){var i=[];Object.keys(e).forEach(function(t){null!==e[t]&&void 0!==e[t]&&i.push(t+"="+encodeURIComponent(e[t]))});var r=i.join("&");return(t=-1===(t=t.replace(/[?&]$/,"")).indexOf("?")?t+"?":t+"&")+r}var gp=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions}),this.crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null,this.hidpi_=void 0===i.hidpi||i.hidpi,this.url_=i.url,this.imageLoadFunction_=void 0!==i.imageLoadFunction?i.imageLoadFunction:cp,this.params_=i.params||{},this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==i.ratio?i.ratio:1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getParams=function(){return this.params_},e.prototype.getImageInternal=function(t,e,i,r){if(void 0===this.url_)return null;e=this.findNearestResolution(e),i=this.hidpi_?i:1;var n=this.image_;if(n&&this.renderedRevision_==this.getRevision()&&n.getResolution()==e&&n.getPixelRatio()==i&&ot(n.getExtent(),t))return n;var o={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};u(o,this.params_);var s=((t=t.slice())[0]+t[2])/2,a=(t[1]+t[3])/2;if(1!=this.ratio_){var h=this.ratio_*Ot(t)/2,l=this.ratio_*Rt(t)/2;t[0]=s-h,t[1]=a-l,t[2]=s+h,t[3]=a+l}var p=e/i,c=Math.ceil(Ot(t)/p),d=Math.ceil(Rt(t)/p);t[0]=s-p*c/2,t[2]=s+p*c/2,t[1]=a-p*d/2,t[3]=a+p*d/2,this.imageSize_[0]=c,this.imageSize_[1]=d;var f=this.getRequestUrl_(t,this.imageSize_,i,r,o);return this.image_=new fp(t,e,i,f,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),v(this.image_,M.CHANGE,this.handleImageChange,this),this.image_},e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},e.prototype.getRequestUrl_=function(t,e,i,r,n){var o=r.getCode().split(":").pop();n.SIZE=e[0]+","+e[1],n.BBOX=t.join(","),n.BBOXSR=o,n.IMAGESR=o,n.DPI=Math.round(90*i);var s=this.url_,a=s.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return a==s&&Y(!1,50),_p(a,n)},e.prototype.getUrl=function(){return this.url_},e.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},e.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},e.prototype.updateParams=function(t){u(this.params_,t),this.image_=null,this.changed()},e}(dp),yp=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions,state:i.state}),this.canvasFunction_=i.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==i.ratio?i.ratio:1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImageInternal=function(t,e,i,r){e=this.findNearestResolution(e);var n=this.canvas_;if(n&&this.renderedRevision_==this.getRevision()&&n.getResolution()==e&&n.getPixelRatio()==i&&ot(n.getExtent(),t))return n;Mt(t=t.slice(),this.ratio_);var o=[Ot(t)/e*i,Rt(t)/e*i],s=this.canvasFunction_.call(this,t,e,i,o,r);return s&&(n=new Es(t,e,i,s)),this.canvas_=n,this.renderedRevision_=this.getRevision(),n},e}(dp);var vp=function(t){function e(e){t.call(this,{projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,this.displayDpi_=void 0!==e.displayDpi?e.displayDpi:96,this.params_=e.params||{},this.url_=e.url,this.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:cp,this.hidpi_=void 0===e.hidpi||e.hidpi,this.metersPerUnit_=void 0!==e.metersPerUnit?e.metersPerUnit:1,this.ratio_=void 0!==e.ratio?e.ratio:1,this.useOverlay_=void 0!==e.useOverlay&&e.useOverlay,this.image_=null,this.renderedRevision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getParams=function(){return this.params_},e.prototype.getImageInternal=function(t,e,i,r){e=this.findNearestResolution(e),i=this.hidpi_?i:1;var n=this.image_;if(n&&this.renderedRevision_==this.getRevision()&&n.getResolution()==e&&n.getPixelRatio()==i&&ot(n.getExtent(),t))return n;1!=this.ratio_&&Mt(t=t.slice(),this.ratio_);var o=[Ot(t)/e*i,Rt(t)/e*i];if(void 0!==this.url_){var s=this.getUrl(this.url_,this.params_,t,o,r);v(n=new fp(t,e,i,s,this.crossOrigin_,this.imageLoadFunction_),M.CHANGE,this.handleImageChange,this)}else n=null;return this.image_=n,this.renderedRevision_=this.getRevision(),n},e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},e.prototype.updateParams=function(t){u(this.params_,t),this.changed()},e.prototype.getUrl=function(t,e,i,r,n){var o=function(t,e,i,r){var n=Ot(t),o=Rt(t),s=e[0],a=e[1],h=.0254/r;return a*n>s*o?n*i/(s*h):o*i/(a*h)}(i,r,this.metersPerUnit_,this.displayDpi_),s=Tt(i),a={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(r[0]),SETDISPLAYHEIGHT:Math.round(r[1]),SETVIEWSCALE:o,SETVIEWCENTERX:s[0],SETVIEWCENTERY:s[1]};return u(a,e),_p(t,a)},e.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},e}(dp),mp=function(t){function e(e){var i=void 0!==e.crossOrigin?e.crossOrigin:null,r=void 0!==e.imageLoadFunction?e.imageLoadFunction:cp;t.call(this,{attributions:e.attributions,projection:Ee(e.projection)}),this.url_=e.url,this.imageExtent_=e.imageExtent,this.image_=new fp(this.imageExtent_,void 0,1,this.url_,i,r),this.imageSize_=e.imageSize?e.imageSize:null,v(this.image_,M.CHANGE,this.handleImageChange,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImageExtent=function(){return this.imageExtent_},e.prototype.getImageInternal=function(t,e,i,r){return Pt(t,this.image_.getExtent())?this.image_:null},e.prototype.getUrl=function(){return this.url_},e.prototype.handleImageChange=function(e){if(this.image_.getState()==xs.LOADED){var i,r,n=this.image_.getExtent(),o=this.image_.getImage();this.imageSize_?(i=this.imageSize_[0],r=this.imageSize_[1]):(i=o.width,r=o.height);var s=Rt(n)/r,a=Math.ceil(Ot(n)/s);if(a!=i){var h=Jn(a,r),l=h.canvas;h.drawImage(o,0,0,i,r,0,0,l.width,l.height),this.image_.setImage(l)}}t.prototype.handleImageChange.call(this,e)},e}(dp),xp="1.3.0",Ep="carmentaserver",Sp="geoserver",Tp="mapserver",Cp="qgis",Rp=[101,101],wp=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions}),this.crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null,this.url_=i.url,this.imageLoadFunction_=void 0!==i.imageLoadFunction?i.imageLoadFunction:cp,this.params_=i.params||{},this.v13_=!0,this.updateV13_(),this.serverType_=i.serverType,this.hidpi_=void 0===i.hidpi||i.hidpi,this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==i.ratio?i.ratio:1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getGetFeatureInfoUrl=function(t,e,i,r){if(void 0!==this.url_){var n=Ee(i),o=this.getProjection();o&&o!==n&&(e=Bu(o,n,t,e),t=Pe(t,n,o));var s=Ct(t,e,0,Rp),a={SERVICE:"WMS",VERSION:xp,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};u(a,this.params_,r);var h=Math.floor((t[0]-s[0])/e),l=Math.floor((s[3]-t[1])/e);return a[this.v13_?"I":"X"]=h,a[this.v13_?"J":"Y"]=l,this.getRequestUrl_(s,Rp,1,o||n,a)}},e.prototype.getParams=function(){return this.params_},e.prototype.getImageInternal=function(t,e,i,r){if(void 0===this.url_)return null;e=this.findNearestResolution(e),1==i||this.hidpi_&&void 0!==this.serverType_||(i=1);var n=e/i,o=Tt(t),s=Ct(o,n,0,[Math.ceil(Ot(t)/n),Math.ceil(Rt(t)/n)]),a=Ct(o,n,0,[Math.ceil(this.ratio_*Ot(t)/n),Math.ceil(this.ratio_*Rt(t)/n)]),h=this.image_;if(h&&this.renderedRevision_==this.getRevision()&&h.getResolution()==e&&h.getPixelRatio()==i&&ot(h.getExtent(),s))return h;var l={SERVICE:"WMS",VERSION:xp,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};u(l,this.params_),this.imageSize_[0]=Math.round(Ot(a)/n),this.imageSize_[1]=Math.round(Rt(a)/n);var p=this.getRequestUrl_(a,this.imageSize_,i,r,l);return this.image_=new fp(a,e,i,p,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),v(this.image_,M.CHANGE,this.handleImageChange,this),this.image_},e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},e.prototype.getRequestUrl_=function(t,e,i,r,n){if(Y(void 0!==this.url_,9),n[this.v13_?"CRS":"SRS"]=r.getCode(),"STYLES"in this.params_||(n.STYLES=""),1!=i)switch(this.serverType_){case Sp:var o=90*i+.5|0;"FORMAT_OPTIONS"in n?n.FORMAT_OPTIONS+=";dpi:"+o:n.FORMAT_OPTIONS="dpi:"+o;break;case Tp:n.MAP_RESOLUTION=90*i;break;case Ep:case Cp:n.DPI=90*i;break;default:Y(!1,8)}n.WIDTH=e[0],n.HEIGHT=e[1];var s,a=r.getAxisOrientation();return s=this.v13_&&"ne"==a.substr(0,2)?[t[1],t[0],t[3],t[2]]:t,n.BBOX=s.join(","),_p(this.url_,n)},e.prototype.getUrl=function(){return this.url_},e.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},e.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},e.prototype.updateParams=function(t){u(this.params_,t),this.updateV13_(),this.image_=null,this.changed()},e.prototype.updateV13_=function(){var t=this.params_.VERSION||xp;this.v13_=Ki(t,"1.3")>=0},e}(dp),Ip='&#169; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.',Lp=function(t){function e(e){var i,r=e||{};i=void 0!==r.attributions?r.attributions:[Ip];var n=void 0!==r.crossOrigin?r.crossOrigin:"anonymous",o=void 0!==r.url?r.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";t.call(this,{attributions:i,cacheSize:r.cacheSize,crossOrigin:n,opaque:void 0===r.opaque||r.opaque,maxZoom:void 0!==r.maxZoom?r.maxZoom:19,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileLoadFunction:r.tileLoadFunction,url:o,wrapX:r.wrapX,attributionsCollapsible:!1})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ep),Op=i(2),Pp=function(t){function e(e){var i=e||{};t.call(this,i),this.type=Ss.IMAGE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(xo);Pp.prototype.getSource;var bp=Pp,Mp="preload",Fp="useInterimTilesOnError",Ap=function(t){function e(e){var i=e||{},r=u({},i);delete r.preload,delete r.useInterimTilesOnError,t.call(this,r),this.setPreload(void 0!==i.preload?i.preload:0),this.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),this.type=Ss.TILE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPreload=function(){return this.get(Mp)},e.prototype.setPreload=function(t){this.set(Mp,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Fp)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Fp,t)},e}(xo);Ap.prototype.getSource;var Np=Ap,Gp="beforeoperations",Dp="afteroperations",kp={PIXEL:"pixel",IMAGE:"image"},jp=function(t){function e(e,i,r){t.call(this,e),this.extent=i.extent,this.resolution=i.viewState.resolution/i.pixelRatio,this.data=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),Up=null;function Yp(t,e,i){if(!t.prepareFrame(e,i))return null;var r=e.size[0],n=e.size[1];if(Up){var o=Up.canvas;o.width!==r||o.height!==n?Up=Jn(r,n):Up.clearRect(0,0,r,n)}else Up=Jn(r,n);return t.composeFrame(e,i,Up),Up.getImageData(0,0,r,n)}function Bp(t){var e=t,i=t,r=t,n=null;return"function"==typeof e.getTile?n=function(t){var e=new Np({source:t});return new ha(e)}(e):"function"==typeof i.getImage?n=function(t){var e=new bp({source:t});return new ra(e)}(i):r.getType()===Ss.TILE?n=new ha(r):r.getType()!=Ss.IMAGE&&r.getType()!=Ss.VECTOR||(n=new ra(r)),n}var Vp=function(t){function e(e){t.call(this,{projection:null}),this.worker_=null,this.operationType_=void 0!==e.operationType?e.operationType:kp.PIXEL,this.threads_=void 0!==e.threads?e.threads:1,this.renderers_=function(t){for(var e=t.length,i=new Array(e),r=0;r<e;++r)i[r]=Bp(t[r]);return i}(e.sources);for(var i=0,r=this.renderers_.length;i<r;++i)v(this.renderers_[i],M.CHANGE,this.changed,this);this.tileQueue_=new Mn(function(){return 1},this.changed.bind(this));for(var n=function(t){return t.map(function(t){return t.getLayer().getLayerState()})}(this.renderers_),s={},a=0,h=n.length;a<h;++a)s[o(n[a].layer)]=n[a];this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:[1,0,0,1,0,0],extent:null,focus:null,index:0,layerStates:s,layerStatesArray:n,pixelRatio:1,pixelToCoordinateTransform:[1,0,0,1,0,0],postRenderFunctions:[],size:[0,0],skippedFeatureUids:{},tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{}},void 0!==e.operation&&this.setOperation(e.operation,e.lib)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setOperation=function(t,e){this.worker_=new Op.Processor({operation:t,imageOps:this.operationType_===kp.IMAGE,queue:1,lib:e,threads:this.threads_}),this.changed()},e.prototype.updateFrameState_=function(t,e,i){var r=u({},this.frameState_);r.viewState=u({},r.viewState);var n=Tt(t);r.extent=t.slice(),r.focus=n,r.size[0]=Math.round(Ot(t)/e),r.size[1]=Math.round(Rt(t)/e),r.time=Date.now(),r.animate=!1;var o=r.viewState;return o.center=n,o.projection=i,o.resolution=e,r},e.prototype.allSourcesReady_=function(){for(var t=!0,e=0,i=this.renderers_.length;e<i;++e)if(this.renderers_[e].getLayer().getSource().getState()!==ro.READY){t=!1;break}return t},e.prototype.getImage=function(t,e,i,r){if(!this.allSourcesReady_())return null;var n=this.updateFrameState_(t,e,r);if(this.requestedFrameState_=n,this.renderedImageCanvas_){var o=this.renderedImageCanvas_.getResolution(),s=this.renderedImageCanvas_.getExtent();e===o&&dt(t,s)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),n.tileQueue.loadMoreTiles(16,16),n.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},e.prototype.processSources_=function(){for(var t=this.requestedFrameState_,e=this.renderers_.length,i=new Array(e),r=0;r<e;++r){var n=Yp(this.renderers_[r],t,t.layerStatesArray[r]);if(!n)return;i[r]=n}var o={};this.dispatchEvent(new jp(Gp,t,o)),this.worker_.process(i,o,this.onWorkerComplete_.bind(this,t))},e.prototype.onWorkerComplete_=function(t,e,i,r){if(!e&&i){var n=t.extent,o=t.viewState.resolution;if(o===this.requestedFrameState_.viewState.resolution&&dt(n,this.requestedFrameState_.extent)){var s;if(this.renderedImageCanvas_)s=this.renderedImageCanvas_.getImage().getContext("2d");else s=Jn(Math.round(Ot(n)/o),Math.round(Rt(n)/o)),this.renderedImageCanvas_=new Es(n,o,1,s.canvas);s.putImageData(i,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new jp(Dp,t,r))}}},e.prototype.getImageInternal=function(){return null},e}(dp),Xp=['Map tiles by <a href="https://stamen.com/">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.',Ip],zp={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},Wp={terrain:{minZoom:4,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:1,maxZoom:16}},Kp=function(t){function e(e){var i=e.layer.indexOf("-"),r=-1==i?e.layer:e.layer.slice(0,i),n=Wp[r],o=zp[e.layer],s=void 0!==e.url?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+o.extension;t.call(this,{attributions:Xp,cacheSize:e.cacheSize,crossOrigin:"anonymous",maxZoom:void 0!=e.maxZoom?e.maxZoom:n.maxZoom,minZoom:void 0!=e.minZoom?e.minZoom:n.minZoom,opaque:o.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:s,wrapX:e.wrapX})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ep);function Hp(t,e,i){var r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),!(r.getResolutions().length<=t[0])){var n=r.getTileCoordExtent(t,this.tmpExtent_),o=ho(r.getTileSize(t[0]),this.tmpSize);1!=e&&(o=ao(o,e,this.tmpSize));var s={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return u(s,this.params_),this.getRequestUrl_(t,o,n,e,i,s)}}var Zp=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction,tileUrlFunction:Hp,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition}),this.params_=i.params||{},this.tmpExtent_=[1/0,1/0,-1/0,-1/0],this.setKey(this.getKeyForParams_())}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getKeyForParams_=function(){var t=0,e=[];for(var i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")},e.prototype.getParams=function(){return this.params_},e.prototype.getRequestUrl_=function(t,e,i,r,n,o){var s=this.urls;if(s){var a,h=n.getCode().split(":").pop();if(o.SIZE=e[0]+","+e[1],o.BBOX=i.join(","),o.BBOXSR=h,o.IMAGESR=h,o.DPI=Math.round(o.DPI?o.DPI*r:90*r),1==s.length)a=s[0];else a=s[Xt(Cl(t),s.length)];return _p(a.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),o)}},e.prototype.getTilePixelRatio=function(t){return t},e.prototype.updateParams=function(t){u(this.params_,t),this.setKey(this.getKeyForParams_())},e}($u),qp=function(t){function e(e,i,r){t.call(this,e,On.LOADED),this.tileSize_=i,this.text_=r,this.canvas_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImage=function(){if(this.canvas_)return this.canvas_;var t=this.tileSize_,e=Jn(t[0],t[1]);return e.strokeStyle="black",e.strokeRect(.5,.5,t[0]+.5,t[1]+.5),e.fillStyle="black",e.textAlign="center",e.textBaseline="middle",e.font="24px sans-serif",e.fillText(this.text_,t[0]/2,t[1]/2),this.canvas_=e.canvas,e.canvas},e.prototype.load=function(){},e}(vl),Jp=function(t){function e(e){t.call(this,{opaque:!1,projection:e.projection,tileGrid:e.tileGrid,wrapX:void 0===e.wrapX||e.wrapX})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getTile=function(t,e,i){var r=Sl(t,e,i);if(this.tileCache.containsKey(r))return this.tileCache.get(r);var n=ho(this.tileGrid.getTileSize(t)),o=[t,e,i],s=this.getTileCoordForTileUrlFunction(o),a=s?this.getTileCoordForTileUrlFunction(s).toString():"",h=new qp(o,n,a);return this.tileCache.set(r,h),h},e}(jl),Qp=function(t){function e(e){if(t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,projection:Ee("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:ro.LOADING,tileLoadFunction:e.tileLoadFunction,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition}),this.tileJSON_=null,e.url)if(e.jsonp)Yu(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{var i=new XMLHttpRequest;i.addEventListener("load",this.onXHRLoad_.bind(this)),i.addEventListener("error",this.onXHRError_.bind(this)),i.open("GET",e.url),i.send()}else e.tileJSON?this.handleTileJSONResponse(e.tileJSON):Y(!1,51)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var i;try{i=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()},e.prototype.onXHRError_=function(t){this.handleTileJSONError()},e.prototype.getTileJSON=function(){return this.tileJSON_},e.prototype.handleTileJSONResponse=function(t){var e,i=Ee("EPSG:4326"),r=this.getProjection();if(void 0!==t.bounds){var n=Le(i,r);e=Ft(t.bounds,n)}var o=t.minzoom||0,s=t.maxzoom||22,a=Fl({extent:Gl(r),maxZoom:s,minZoom:o});if(this.tileGrid=a,this.tileUrlFunction=Du(t.tiles,a),void 0!==t.attribution&&!this.getAttributions()){var h=void 0!==e?e:i.getExtent();this.setAttributions(function(e){return Pt(h,e.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState(ro.READY)},e.prototype.handleTileJSONError=function(){this.setState(ro.ERROR)},e}($u);function $p(t,e,i){var r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),!(r.getResolutions().length<=t[0])){1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);var n=r.getResolution(t[0]),o=r.getTileCoordExtent(t,this.tmpExtent_),s=ho(r.getTileSize(t[0]),this.tmpSize),a=this.gutter_;0!==a&&(s=so(s,a,this.tmpSize),o=et(o,n*a,o)),1!=e&&(s=ao(s,e,this.tmpSize));var h={SERVICE:"WMS",VERSION:xp,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return u(h,this.params_),this.getRequestUrl_(t,s,o,e,i,h)}}var tc=function(t){function e(e){var i=e||{},r=i.params||{},n=!("TRANSPARENT"in r)||r.TRANSPARENT;t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:!n,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:i.tileClass,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction,tileUrlFunction:$p,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition}),this.gutter_=void 0!==i.gutter?i.gutter:0,this.params_=r,this.v13_=!0,this.serverType_=i.serverType,this.hidpi_=void 0===i.hidpi||i.hidpi,this.tmpExtent_=[1/0,1/0,-1/0,-1/0],this.updateV13_(),this.setKey(this.getKeyForParams_())}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getGetFeatureInfoUrl=function(t,e,i,r){var n=Ee(i),o=this.getProjection(),s=this.getTileGrid();s||(s=this.getTileGridForProjection(n));var a=s.getTileCoordForCoordAndResolution(t,e);if(!(s.getResolutions().length<=a[0])){var h=s.getResolution(a[0]),l=s.getTileCoordExtent(a,this.tmpExtent_),p=ho(s.getTileSize(a[0]),this.tmpSize),c=this.gutter_;0!==c&&(p=so(p,c,this.tmpSize),l=et(l,h*c,l)),o&&o!==n&&(h=Bu(o,n,t,h),l=be(l,n,o),t=Pe(t,n,o));var d={SERVICE:"WMS",VERSION:xp,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};u(d,this.params_,r);var f=Math.floor((t[0]-l[0])/h),_=Math.floor((l[3]-t[1])/h);return d[this.v13_?"I":"X"]=f,d[this.v13_?"J":"Y"]=_,this.getRequestUrl_(a,p,l,1,o||n,d)}},e.prototype.getGutter=function(){return this.gutter_},e.prototype.getParams=function(){return this.params_},e.prototype.getRequestUrl_=function(t,e,i,r,n,o){var s=this.urls;if(s){if(o.WIDTH=e[0],o.HEIGHT=e[1],o[this.v13_?"CRS":"SRS"]=n.getCode(),"STYLES"in this.params_||(o.STYLES=""),1!=r)switch(this.serverType_){case Sp:var a=90*r+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+a:o.FORMAT_OPTIONS="dpi:"+a;break;case Tp:o.MAP_RESOLUTION=90*r;break;case Ep:case Cp:o.DPI=90*r;break;default:Y(!1,52)}var h,l,u=n.getAxisOrientation(),p=i;if(this.v13_&&"ne"==u.substr(0,2))h=i[0],p[0]=i[1],p[1]=h,h=i[2],p[2]=i[3],p[3]=h;if(o.BBOX=p.join(","),1==s.length)l=s[0];else l=s[Xt(Cl(t),s.length)];return _p(l,o)}},e.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},e.prototype.getKeyForParams_=function(){var t=0,e=[];for(var i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")},e.prototype.updateParams=function(t){u(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())},e.prototype.updateV13_=function(){var t=this.params_.VERSION||xp;this.v13_=Ki(t,"1.3")>=0},e}($u),ec=function(t){function e(e,i,r,n,o,s){t.call(this,e,i),this.src_=r,this.extent_=n,this.preemptive_=o,this.grid_=null,this.keys_=null,this.data_=null,this.jsonp_=s}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImage=function(){return null},e.prototype.getData=function(t){if(!this.grid_||!this.keys_)return null;var e=(t[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),i=(t[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),r=this.grid_[Math.floor((1-i)*this.grid_.length)];if("string"!=typeof r)return null;var n=r.charCodeAt(Math.floor(e*r.length));n>=93&&n--,n>=35&&n--;var o=null;if((n-=32)in this.keys_){var s=this.keys_[n];o=this.data_&&s in this.data_?this.data_[s]:s}return o},e.prototype.forDataAtCoordinate=function(t,e,i,r){this.state==On.IDLE&&!0===r?(m(this,M.CHANGE,function(r){e.call(i,this.getData(t))},this),this.loadInternal_()):!0===r?setTimeout(function(){e.call(i,this.getData(t))}.bind(this),0):e.call(i,this.getData(t))},e.prototype.getKey=function(){return this.src_},e.prototype.handleError_=function(){this.state=On.ERROR,this.changed()},e.prototype.handleLoad_=function(t){this.grid_=t.grid,this.keys_=t.keys,this.data_=t.data,this.state=On.EMPTY,this.changed()},e.prototype.loadInternal_=function(){if(this.state==On.IDLE)if(this.state=On.LOADING,this.jsonp_)Yu(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{var t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",this.src_),t.send()}},e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var i;try{i=JSON.parse(e.responseText)}catch(t){return void this.handleError_()}this.handleLoad_(i)}else this.handleError_()},e.prototype.onXHRError_=function(t){this.handleError_()},e.prototype.load=function(){this.preemptive_&&this.loadInternal_()},e}(vl),ic=function(t){function e(e){if(t.call(this,{projection:Ee("EPSG:3857"),state:ro.LOADING}),this.preemptive_=void 0===e.preemptive||e.preemptive,this.tileUrlFunction_=ju,this.template_=void 0,this.jsonp_=e.jsonp||!1,e.url)if(this.jsonp_)Yu(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{var i=new XMLHttpRequest;i.addEventListener("load",this.onXHRLoad_.bind(this)),i.addEventListener("error",this.onXHRError_.bind(this)),i.open("GET",e.url),i.send()}else e.tileJSON?this.handleTileJSONResponse(e.tileJSON):Y(!1,51)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var i;try{i=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()},e.prototype.onXHRError_=function(t){this.handleTileJSONError()},e.prototype.getTemplate=function(){return this.template_},e.prototype.forDataAtCoordinateAndResolution=function(t,e,i,r){if(this.tileGrid){var n=this.tileGrid.getTileCoordForCoordAndResolution(t,e);this.getTile(n[0],n[1],n[2],1,this.getProjection()).forDataAtCoordinate(t,i,null,r)}else!0===r?setTimeout(function(){i(null)},0):i(null)},e.prototype.handleTileJSONError=function(){this.setState(ro.ERROR)},e.prototype.handleTileJSONResponse=function(t){var e,i=Ee("EPSG:4326"),r=this.getProjection();if(void 0!==t.bounds){var n=Le(i,r);e=Ft(t.bounds,n)}var o=t.minzoom||0,s=t.maxzoom||22,a=Fl({extent:Gl(r),maxZoom:s,minZoom:o});this.tileGrid=a,this.template_=t.template;var h=t.grids;if(h){if(this.tileUrlFunction_=Du(h,a),void 0!==t.attribution){var l=void 0!==e?e:i.getExtent();this.setAttributions(function(e){return Pt(l,e.extent)?[t.attribution]:null})}this.setState(ro.READY)}else this.setState(ro.ERROR)},e.prototype.getTile=function(t,e,i,r,n){var o=Sl(t,e,i);if(this.tileCache.containsKey(o))return this.tileCache.get(o);var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,n),h=this.tileUrlFunction_(a,r,n),l=new ec(s,void 0!==h?On.IDLE:On.EMPTY,void 0!==h?h:"",this.tileGrid.getTileCoordExtent(s),this.preemptive_,this.jsonp_);return this.tileCache.set(o,l),l},e.prototype.useTile=function(t,e,i){var r=Sl(t,e,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)},e}(jl),rc=function(t){function e(i,r,n,o,s,a,h,l,u,p,c,d,f,_,g){if(t.call(this,i,r,{transition:0}),this.context_={},this.loader_,this.replayState_={},this.sourceTiles_=p,this.tileKeys=[],this.extent=null,this.sourceRevision_=n,this.wrappedTileCoord=a,this.loadListenerKeys_=[],this.sourceTileListenerKeys_=[],a){var y=this.extent=u.getTileCoordExtent(a),m=u.getResolution(g),x=l.getZForResolution(m),E=g!=i[0],S=0;if(l.forEachTileCoord(y,x,function(t){var e=wt(y,l.getTileCoordExtent(t)),i=l.getExtent();if(i&&(e=wt(e,i,e)),Ot(e)/m>=.5&&Rt(e)/m>=.5){++S;var r=t.toString(),n=p[r];if(!n&&!E){var a=h(t,c,d);n=p[r]=new f(t,void 0==a?On.EMPTY:On.IDLE,void 0==a?"":a,o,s),this.sourceTileListenerKeys_.push(v(n,M.CHANGE,_))}!n||E&&n.getState()!=On.LOADED||(n.consumers++,this.tileKeys.push(r))}}.bind(this)),E&&S==this.tileKeys.length&&this.finishLoading_(),g<=i[0]&&this.state!=On.LOADED)for(;g>u.getMinZoom();){var T=new e(i,r,n,o,s,a,h,l,u,p,c,d,f,I,--g);if(T.state==On.LOADED){this.interimTile=T;break}}}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state=On.ABORT,this.changed(),this.interimTile&&this.interimTile.dispose();for(var e=0,i=this.tileKeys.length;e<i;++e){var r=this.tileKeys[e],n=this.getTile(r);n.consumers--,0==n.consumers&&(delete this.sourceTiles_[r],n.dispose())}this.tileKeys.length=0,this.sourceTiles_=null,this.loadListenerKeys_.forEach(E),this.loadListenerKeys_.length=0,this.sourceTileListenerKeys_.forEach(E),this.sourceTileListenerKeys_.length=0,t.prototype.disposeInternal.call(this)},e.prototype.getContext=function(t){var e=o(t);return e in this.context_||(this.context_[e]=Jn()),this.context_[e]},e.prototype.getImage=function(t){return-1==this.getReplayState(t).renderedTileRevision?null:this.getContext(t).canvas},e.prototype.getReplayState=function(t){var e=o(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedRevision:-1,renderedTileRevision:-1}),this.replayState_[e]},e.prototype.getKey=function(){return this.tileKeys.join("/")+"-"+this.sourceRevision_},e.prototype.getTile=function(t){return this.sourceTiles_[t]},e.prototype.load=function(){var t=0,e={};this.state==On.IDLE&&this.setState(On.LOADING),this.state==On.LOADING&&this.tileKeys.forEach(function(i){var r=this.getTile(i);if(r.state==On.IDLE&&(r.setLoader(this.loader_),r.load()),r.state==On.LOADING){var n=v(r,M.CHANGE,function(i){var n=r.getState();if(n==On.LOADED||n==On.ERROR){var s=o(r);n==On.ERROR?e[s]=!0:(--t,delete e[s]),t-Object.keys(e).length==0&&this.finishLoading_()}}.bind(this));this.loadListenerKeys_.push(n),++t}}.bind(this)),t-Object.keys(e).length==0&&setTimeout(this.finishLoading_.bind(this),0)},e.prototype.finishLoading_=function(){for(var t=this.tileKeys.length,e=0,i=t-1;i>=0;--i){var r=this.getTile(this.tileKeys[i]).getState();r!=On.LOADED&&--t,r==On.EMPTY&&++e}t==this.tileKeys.length?(this.loadListenerKeys_.forEach(E),this.loadListenerKeys_.length=0,this.setState(On.LOADED)):this.setState(e==this.tileKeys.length?On.EMPTY:On.ERROR)},e}(vl);function nc(t,e){var i=Zl(e,t.getFormat(),t.onLoad.bind(t),t.onError.bind(t));t.setLoader(i)}var oc=[0,0,4096,4096],sc=function(t){function e(e,i,r,n,o,s){t.call(this,e,i,s),this.consumers=0,this.extent_=null,this.format_=n,this.features_=null,this.loader_,this.projection_=null,this.replayGroups_={},this.tileLoadFunction_=o,this.url_=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.features_=null,this.replayGroups_={},this.state=On.ABORT,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getExtent=function(){return this.extent_||oc},e.prototype.getFormat=function(){return this.format_},e.prototype.getFeatures=function(){return this.features_},e.prototype.getKey=function(){return this.url_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getReplayGroup=function(t,e){return this.replayGroups_[o(t)+","+e]},e.prototype.load=function(){this.state==On.IDLE&&(this.setState(On.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_(null,NaN,null))},e.prototype.onLoad=function(t,e,i){this.setProjection(e),this.setFeatures(t),this.setExtent(i)},e.prototype.onError=function(){this.setState(On.ERROR)},e.prototype.setExtent=function(t){this.extent_=t},e.prototype.setFeatures=function(t){this.features_=t,this.setState(On.LOADED)},e.prototype.setProjection=function(t){this.projection_=t},e.prototype.setReplayGroup=function(t,e,i){this.replayGroups_[o(t)+","+e]=i},e.prototype.setLoader=function(t){this.loader_=t},e}(vl),ac=function(t){function e(e){var i=e.projection||"EPSG:3857",r=e.extent||Gl(i),n=e.tileGrid||Fl({extent:r,maxZoom:e.maxZoom||22,minZoom:e.minZoom,tileSize:e.tileSize||512});t.call(this,{attributions:e.attributions,cacheSize:void 0!==e.cacheSize?e.cacheSize:128,opaque:!1,projection:i,state:e.state,tileGrid:n,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:nc,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition}),this.format_=e.format?e.format:null,this.sourceTiles_={},this.overlaps_=void 0==e.overlaps||e.overlaps,this.tileClass=e.tileClass?e.tileClass:sc,this.tileGrids_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.clear=function(){this.tileCache.clear(),this.sourceTiles_={}},e.prototype.getTile=function(t,e,i,r,n){var o=Sl(t,e,i);if(this.tileCache.containsKey(o))return this.tileCache.get(o);var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,n),h=new rc(s,null!==a?On.IDLE:On.EMPTY,this.getRevision(),this.format_,this.tileLoadFunction,a,this.tileUrlFunction,this.tileGrid,this.getTileGridForProjection(n),this.sourceTiles_,r,n,this.tileClass,this.handleTileChange.bind(this),s[0]);return this.tileCache.set(o,h),h},e.prototype.getTileGridForProjection=function(t){var e=t.getCode(),i=this.tileGrids_[e];if(!i){var r=this.tileGrid;i=this.tileGrids_[e]=Nl(t,void 0,r?r.getTileSize(r.getMinZoom()):void 0)}return i},e.prototype.getTilePixelRatio=function(t){return t},e.prototype.getTilePixelSize=function(t,e,i){var r=ho(this.getTileGridForProjection(i).getTileSize(t),this.tmpSize);return[Math.round(r[0]*e),Math.round(r[1]*e)]},e}(Ju),hc={KVP:"KVP",REST:"REST"},lc=function(t){function e(e){var i=void 0!==e.requestEncoding?e.requestEncoding:hc.KVP,r=e.tileGrid,n=e.urls;void 0===n&&void 0!==e.url&&(n=Uu(e.url)),t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:ju,urls:n,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition}),this.version_=void 0!==e.version?e.version:"1.0.0",this.format_=void 0!==e.format?e.format:"image/jpeg",this.dimensions_=void 0!==e.dimensions?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=i,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=ku(n.map(uc.bind(this))))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(ku(t.map(uc.bind(this))),e)},e.prototype.getDimensions=function(){return this.dimensions_},e.prototype.getFormat=function(){return this.format_},e.prototype.getLayer=function(){return this.layer_},e.prototype.getMatrixSet=function(){return this.matrixSet_},e.prototype.getRequestEncoding=function(){return this.requestEncoding_},e.prototype.getStyle=function(){return this.style_},e.prototype.getVersion=function(){return this.version_},e.prototype.getKeyForDimensions_=function(){var t=0,e=[];for(var i in this.dimensions_)e[t++]=i+"-"+this.dimensions_[i];return e.join("/")},e.prototype.updateDimensions=function(t){u(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())},e}($u);function uc(t){var e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};e==hc.KVP&&u(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t=e==hc.KVP?_p(t,i):t.replace(/\{(\w+?)\}/g,function(t,e){return e.toLowerCase()in i?i[e.toLowerCase()]:t});var r=this.tileGrid,n=this.dimensions_;return function(i,o,s){if(i){var a={TileMatrix:r.getMatrixId(i[0]),TileCol:i[1],TileRow:-i[2]-1};u(a,n);var h=t;return h=e==hc.KVP?_p(h,a):h.replace(/\{(\w+?)\}/g,function(t,e){return a[e]})}}}var pc={DEFAULT:"default",TRUNCATED:"truncated"},cc=function(t){function e(e,i,r,n,o,s,a){t.call(this,i,r,n,o,s,a),this.zoomifyImage_=null,this.tileSize_=ho(e.getTileSize(i[0]))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var e=t.prototype.getImage.call(this);if(this.state==On.LOADED){var i=this.tileSize_;if(e.width==i[0]&&e.height==i[1])return this.zoomifyImage_=e,e;var r=Jn(i[0],i[1]);return r.drawImage(e,0,0),this.zoomifyImage_=r.canvas,r.canvas}return e},e}(xl),dc=function(t){function e(e){var i=e||{},r=i.size,n=void 0!==i.tierSizeCalculation?i.tierSizeCalculation:pc.DEFAULT,o=r[0],s=r[1],a=i.extent||[0,-r[1],r[0],0],h=[],l=i.tileSize||An,u=l;switch(n){case pc.DEFAULT:for(;o>u||s>u;)h.push([Math.ceil(o/u),Math.ceil(s/u)]),u+=u;break;case pc.TRUNCATED:for(var p=o,c=s;p>u||c>u;)h.push([Math.ceil(p/u),Math.ceil(c/u)]),p>>=1,c>>=1;break;default:Y(!1,53)}h.push([1,1]),h.reverse();for(var d=[1],f=[0],_=1,g=h.length;_<g;_++)d.push(1<<_),f.push(h[_-1][0]*h[_-1][1]+f[_-1]);d.reverse();var y=new Pl({tileSize:l,extent:a,origin:It(a),resolutions:d}),v=i.url;v&&-1==v.indexOf("{TileGroup}")&&-1==v.indexOf("{tileIndex}")&&(v+="{TileGroup}/{z}-{x}-{y}.jpg");var m=ku(Uu(v).map(function(t){return function(e,i,r){if(e){var n=e[0],o=e[1],s=-e[2]-1,a=o+s*h[n][0],l=y.getTileSize(n),u=Array.isArray(l)?l[0]:l,p={z:n,x:o,y:s,tileIndex:a,TileGroup:"TileGroup"+((a+f[n])/u|0)};return t.replace(/\{(\w+?)\}/g,function(t,e){return p[e]})}}})),x=cc.bind(null,y);t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:x,tileGrid:y,tileUrlFunction:m,transition:i.transition})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}($u);var fc="renderOrder",_c=function(t){function e(e){var i=e||{},r=u({},i);delete r.style,delete r.renderBuffer,delete r.updateWhileAnimating,delete r.updateWhileInteracting,t.call(this,r),this.declutter_=void 0!==i.declutter&&i.declutter,this.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(i.style),this.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,this.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,this.renderMode_=i.renderMode||Ts.VECTOR,this.type=Ss.VECTOR}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(fc)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(fc,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:Mu,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var i;Array.isArray(t)?i=t:(Y("function"==typeof t.getZIndex,41),i=[t]),e=function(){return i}}return e}(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(xo);_c.prototype.getSource;var gc=_c,yc={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},vc=["#00f","#0ff","#0f0","#ff0","#f00"];var mc=function(t){function e(e){var i=e||{},r=u({},i);delete r.gradient,delete r.radius,delete r.blur,delete r.shadow,delete r.weight,t.call(this,r),this.gradient_=null,this.shadow_=void 0!==i.shadow?i.shadow:250,this.circleImage_=void 0,this.styleCache_=null,v(this,G(yc.GRADIENT),this.handleGradientChanged_,this),this.setGradient(i.gradient?i.gradient:vc),this.setBlur(void 0!==i.blur?i.blur:15),this.setRadius(void 0!==i.radius?i.radius:8),v(this,G(yc.BLUR),this.handleStyleChanged_,this),v(this,G(yc.RADIUS),this.handleStyleChanged_,this),this.handleStyleChanged_();var n,o=i.weight?i.weight:"weight";n="string"==typeof o?function(t){return t.get(o)}:o,this.setStyle(function(t,e){var i=n(t),r=void 0!==i?kt(i,0,1):1,o=255*r|0,s=this.styleCache_[o];return s||(s=[new Nu({image:new Ou({opacity:r,src:this.circleImage_})})],this.styleCache_[o]=s),s}.bind(this)),this.setRenderOrder(null),v(this,ur.RENDER,this.handleRender_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createCircle_=function(){var t=this.getRadius(),e=this.getBlur(),i=t+e+1,r=2*i,n=Jn(r,r);n.shadowOffsetX=n.shadowOffsetY=this.shadow_,n.shadowBlur=e,n.shadowColor="#000",n.beginPath();var o=i-this.shadow_;return n.arc(o,o,t,0,2*Math.PI,!0),n.fill(),n.canvas.toDataURL()},e.prototype.getBlur=function(){return this.get(yc.BLUR)},e.prototype.getGradient=function(){return this.get(yc.GRADIENT)},e.prototype.getRadius=function(){return this.get(yc.RADIUS)},e.prototype.handleGradientChanged_=function(){this.gradient_=function(t){for(var e=Jn(1,256),i=e.createLinearGradient(0,0,1,256),r=1/(t.length-1),n=0,o=t.length;n<o;++n)i.addColorStop(n*r,t[n]);return e.fillStyle=i,e.fillRect(0,0,1,256),e.getImageData(0,0,1,256).data}(this.getGradient())},e.prototype.handleStyleChanged_=function(){this.circleImage_=this.createCircle_(),this.styleCache_=new Array(256),this.changed()},e.prototype.handleRender_=function(t){for(var e=t.context,i=e.canvas,r=e.getImageData(0,0,i.width,i.height),n=r.data,o=0,s=n.length;o<s;o+=4){var a=4*n[o+3];a&&(n[o]=this.gradient_[a],n[o+1]=this.gradient_[a+1],n[o+2]=this.gradient_[a+2])}e.putImageData(r,0,0)},e.prototype.setBlur=function(t){this.set(yc.BLUR,t)},e.prototype.setGradient=function(t){this.set(yc.GRADIENT,t)},e.prototype.setRadius=function(t){this.set(yc.RADIUS,t)},e}(gc),xc=function(t){function e(e){var i=e||{},r=i.renderMode||Va.HYBRID;Y(void 0==r||r==Va.IMAGE||r==Va.HYBRID||r==Va.VECTOR,28),i.declutter&&r==Va.IMAGE&&(r=Va.HYBRID),i.renderMode=r;var n=u({},i);delete n.preload,delete n.useInterimTilesOnError,t.call(this,n),this.setPreload(i.preload?i.preload:0),this.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),this.type=Ss.VECTOR_TILE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPreload=function(){return this.get(Mp)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Fp)},e.prototype.setPreload=function(t){this.set(Mp,t)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Fp,t)},e}(gc);xc.prototype.getSource;var Ec=xc,Sc="addfeatures",Tc=function(t){function e(e,i,r,n){t.call(this,e),this.features=r,this.file=i,this.projection=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P);function Cc(t){for(var e=t.dataTransfer.files,i=0,r=e.length;i<r;++i){var n=e.item(i),o=new FileReader;o.addEventListener(M.LOAD,this.handleResult_.bind(this,n)),o.readAsText(n)}}function Rc(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}var wc=function(t){function e(e){var i=e||{};t.call(this,{handleEvent:R}),this.formatConstructors_=i.formatConstructors?i.formatConstructors:[],this.projection_=i.projection?Ee(i.projection):null,this.dropListenKeys_=null,this.source_=i.source||null,this.target=i.target?i.target:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleResult_=function(t,e){var i=e.target.result,r=this.getMap(),n=this.projection_;n||(n=r.getView().getProjection());for(var o=this.formatConstructors_,s=[],a=0,h=o.length;a<h;++a){var l=new o[a];if((s=this.tryReadFeatures_(l,i,{featureProjection:n}))&&s.length>0)break}this.source_&&(this.source_.clear(),this.source_.addFeatures(s)),this.dispatchEvent(new Tc(Sc,t,s,n))},e.prototype.registerListeners_=function(){var t=this.getMap();if(t){var e=this.target?this.target:t.getViewport();this.dropListenKeys_=[v(e,M.DROP,Cc,this),v(e,M.DRAGENTER,Rc,this),v(e,M.DRAGOVER,Rc,this),v(e,M.DROP,Rc,this)]}},e.prototype.setActive=function(e){t.prototype.setActive.call(this,e),e?this.registerListeners_():this.unregisterListeners_()},e.prototype.setMap=function(e){this.unregisterListeners_(),t.prototype.setMap.call(this,e),this.getActive()&&this.registerListeners_()},e.prototype.tryReadFeatures_=function(t,e,i){try{return t.readFeatures(e,i)}catch(t){return null}},e.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(E),this.dropListenKeys_=null)},e}(Fo),Ic=function(t){function e(e){var i=e||{};t.call(this,i),this.condition_=i.condition?i.condition:zo,this.lastAngle_=void 0,this.lastMagnitude_=void 0,this.lastScaleDelta_=0,this.duration_=void 0!==i.duration?i.duration:400}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){if(Ko(t)){var e=t.map,i=e.getSize(),r=t.pixel,n=r[0]-i[0]/2,o=i[1]/2-r[1],s=Math.atan2(o,n),a=Math.sqrt(n*n+o*o),h=e.getView();if(h.getConstraints().rotation!==Gn&&void 0!==this.lastAngle_){var l=s-this.lastAngle_;Oo(h,h.getRotation()-l)}if(this.lastAngle_=s,void 0!==this.lastMagnitude_)Mo(h,this.lastMagnitude_*(h.getResolution()/a));void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/a),this.lastMagnitude_=a}},e.prototype.handleUpEvent=function(t){if(!Ko(t))return!0;var e=t.map.getView();e.setHint(jn,-1);var i=this.lastScaleDelta_-1;return Lo(e,e.getRotation()),Po(e,e.getResolution(),void 0,this.duration_,i),this.lastScaleDelta_=0,!1},e.prototype.handleDownEvent=function(t){return!!Ko(t)&&(!!this.condition_(t)&&(t.map.getView().setHint(jn,1),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0))},e}(qo),Lc=function(t){function e(e,i,r){if(t.call(this),void 0!==r&&void 0===i)this.setFlatCoordinates(r,e);else{var n=i||0;this.setCenterAndRadius(e,n,r)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,i,r){var n=this.flatCoordinates,o=t-n[0],s=e-n[1],a=o*o+s*s;if(a<r){if(0===a)for(var h=0;h<this.stride;++h)i[h]=n[h];else{var l=this.getRadius()/Math.sqrt(a);i[0]=n[0]+l*o,i[1]=n[1]+l*s;for(var u=2;u<this.stride;++u)i[u]=n[u]}return i.length=this.stride,a}return r},e.prototype.containsXY=function(t,e){var i=this.flatCoordinates,r=t-i[0],n=e-i[1];return r*r+n*n<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,i=e[this.stride]-e[0];return lt(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return Nt.CIRCLE},e.prototype.intersectsExtent=function(t){if(Pt(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||(t[1]<=e[1]&&t[3]>=e[1]||mt(t,this.intersectsCoordinate,this))}return!1},e.prototype.setCenter=function(t){var e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],r=t.slice();r[e]=r[0]+i;for(var n=1;n<e;++n)r[e+n]=t[n];this.setFlatCoordinates(this.layout,r),this.changed()},e.prototype.setCenterAndRadius=function(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var r=this.flatCoordinates,n=ti(r,0,t,this.stride);r[n++]=r[0]+e;for(var o=1,s=this.stride;o<s;++o)r[n++]=r[o];r.length=n,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e}(We);Lc.prototype.transform;var Oc=Lc,Pc=function(t){function e(e,i,r){if(t.call(this),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,i);else if(void 0!==i&&r)this.setFlatCoordinates(i,e),this.ends_=r;else{for(var n=this.getLayout(),o=e,s=[],a=[],h=0,l=o.length;h<l;++h){var u=o[h];0===h&&(n=u.getLayout()),K(s,u.getFlatCoordinates()),a.push(s.length)}this.setFlatCoordinates(n,s),this.ends_=a}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLineString=function(t){this.flatCoordinates?K(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,r){return r<rt(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Je(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$e(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,r))},e.prototype.getCoordinateAtM=function(t,e,i){if(this.layout!=At.XYM&&this.layout!=At.XYZM||0===this.flatCoordinates.length)return null;var r=void 0!==e&&e,n=void 0!==i&&i;return function(t,e,i,r,n,o,s){if(s)return sr(t,e,i[i.length-1],r,n,o);var a;if(n<t[r-1])return o?((a=t.slice(0,r))[r-1]=n,a):null;if(t[t.length-1]<n)return o?((a=t.slice(t.length-r))[r-1]=n,a):null;for(var h=0,l=i.length;h<l;++h){var u=i[h];if(e!=u){if(n<t[e+r-1])return null;if(n<=t[u-1])return sr(t,e,u,r,n,!1);e=u}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,r,n)},e.prototype.getCoordinates=function(){return ni(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new hr(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,r=[],n=0,o=0,s=e.length;o<s;++o){var a=e[o],h=new hr(t.slice(n,a),i);r.push(h),n=a}return r},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,r=this.ends_,n=this.stride,o=0,s=r.length;o<s;++o){var a=r[o];K(t,or(e,i,a,n,.5)),i=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=ai(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,r),new e(i,At.XY,r)},e.prototype.getType=function(){return Nt.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return function(t,e,i,r,n){for(var o=0,s=i.length;o<s;++o){if(mi(t,e,i[o],r,n))return!0;e=i[o]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=ii(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(We),bc=function(t){function e(e,i){t.call(this),i&&!Array.isArray(e[0])?this.setFlatCoordinates(i,e):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendPoint=function(t){this.flatCoordinates?K(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,r){if(r<rt(this.getExtent(),t,e))return r;for(var n=this.flatCoordinates,o=this.stride,s=0,a=n.length;s<a;s+=o){var h=Yt(t,e,n[s],n[s+1]);if(h<r){r=h;for(var l=0;l<o;++l)i[l]=n[s+l];i.length=o}}return r},e.prototype.getCoordinates=function(){return ri(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new ci(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,r=[],n=0,o=t.length;n<o;n+=i){var s=new ci(t.slice(n,n+i),e);r.push(s)}return r},e.prototype.getType=function(){return Nt.MULTI_POINT},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,r=0,n=e.length;r<n;r+=i){if(st(t,e[r],e[r+1]))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ei(this.flatCoordinates,0,t,this.stride),this.changed()},e}(We);function Mc(t,e,i,r){for(var n=[],o=[1/0,1/0,-1/0,-1/0],s=0,a=i.length;s<a;++s){var h=i[s];o=ct(t,e,h[0],r),n.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=h[h.length-1]}return n}var Fc=function(t){function e(e,i,r){if(t.call(this),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){for(var n=this.getLayout(),o=e,s=[],a=[],h=0,l=o.length;h<l;++h){var u=o[h];0===h&&(n=u.getLayout());for(var p=s.length,c=u.getEnds(),d=0,f=c.length;d<f;++d)c[d]+=p;K(s,u.getFlatCoordinates()),a.push(c)}i=n,e=s,r=a}void 0!==i&&r?(this.setFlatCoordinates(i,e),this.endss_=r):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;K(this.flatCoordinates,t.getFlatCoordinates());for(var r=0,n=(e=t.getEnds().slice()).length;r<n;++r)e[r]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),r=0;r<t;++r)i[r]=this.endss_[r].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,r){return r<rt(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,r,n){for(var o=0,s=i.length;o<s;++o){var a=i[o];n=Je(t,e,a,r,n),e=a[a.length-1]}return n}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,r,n,o,s,a,h,l,u){for(var p=u||[NaN,NaN],c=0,d=i.length;c<d;++c){var f=i[c];l=$e(t,e,f,r,n,o,s,a,h,l,p),e=f[f.length-1]}return l}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))},e.prototype.containsXY=function(t,e){return function(t,e,i,r,n,o){if(0===i.length)return!1;for(var s=0,a=i.length;s<a;++s){var h=i[s];if(_i(t,e,h,r,n,o))return!0;e=h[h.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,i,r){for(var n=0,o=0,s=i.length;o<s;++o){var a=i[o];n+=He(t,e,a,r),e=a[a.length-1]}return n}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Ri(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,oi(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=Mc(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=yi(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new bc(this.getFlatInteriorPoints().slice(),At.XYM)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,i,r,n){for(var o=0,s=i.length;o<s;++o)if(!Ti(t,e,i[o],r,n))return!1;return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ri(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=function(t,e,i,r,n,o,s,a){for(var h=0,l=i.length;h<l;++h){var u=i[h],p=[];s=ui(t,e,u,r,n,o,s,p),a.push(p),e=u[u.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,r),new e(i,At.XY,r)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var r=this.endss_[t].slice(),n=r[r.length-1];if(0!==e)for(var o=0,s=r.length;o<s;++o)r[o]-=e;return new Ii(this.flatCoordinates.slice(e,n),this.layout,r)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[],n=0,o=0,s=i.length;o<s;++o){var a=i[o].slice(),h=a[a.length-1];if(0!==n)for(var l=0,u=a.length;l<u;++l)a[l]-=n;var p=new Ii(e.slice(n,h),t,a);r.push(p),n=h}return r},e.prototype.getType=function(){return Nt.MULTI_POLYGON},e.prototype.intersectsExtent=function(t){return function(t,e,i,r,n){for(var o=0,s=i.length;o<s;++o){var a=i[o];if(xi(t,e,a,r,n))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=function(t,e,i,r,n){for(var o=n||[],s=0,a=0,h=i.length;a<h;++a){var l=ii(t,e,i[a],r,o[s]);o[s++]=l,e=l[l.length-1]}return o.length=s,o}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()},e}(We),Ac={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},Nc="drawstart",Gc="drawend",Dc=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P);var kc=function(t){function e(e){var i=e;i.stopDown||(i.stopDown=w),t.call(this,i),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=function(t){var e;t===Nt.POINT||t===Nt.MULTI_POINT?e=Ac.POINT:t===Nt.LINE_STRING||t===Nt.MULTI_LINE_STRING?e=Ac.LINE_STRING:t===Nt.POLYGON||t===Nt.MULTI_POLYGON?e=Ac.POLYGON:t===Nt.CIRCLE&&(e=Ac.CIRCLE);return e}(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_===Ac.POLYGON?3:2,this.maxPoints_=e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:R;var r=e.geometryFunction;if(!r)if(this.type_===Nt.CIRCLE)r=function(t,e){var i=e||new Oc([NaN,NaN]),r=er(t[0],t[1]);return i.setCenterAndRadius(t[0],Math.sqrt(r)),i};else{var n,o=this.mode_;o===Ac.POINT?n=ci:o===Ac.LINE_STRING?n=hr:o===Ac.POLYGON&&(n=Ii),r=function(t,e){var i=e;return i?o===Ac.POLYGON?t[0].length?i.setCoordinates([t[0].concat([t[0][0]])]):i.setCoordinates([]):i.setCoordinates(t):i=new n(t),i}}this.geometryFunction_=r,this.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new gc({source:new op({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:function(){var t=Fu();return function(e,i){return t[e.getGeometry().getType()]}}(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:Xo,this.freehandCondition_,e.freehand?this.freehandCondition_=jo:this.freehandCondition_=e.freehandCondition?e.freehandCondition:zo,v(this,G(Io.ACTIVE),this.updateState_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),this.updateState_()},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleEvent=function(e){e.originalEvent.type===M.CONTEXTMENU&&e.preventDefault(),this.freehand_=this.mode_!==Ac.POINT&&this.freehandCondition_(e);var i=e.type===Ar.POINTERMOVE,r=!0;!this.freehand_&&this.lastDragTime_&&e.type===Ar.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&e.type===Ar.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e),r=!1):this.freehand_&&e.type===Ar.POINTERDOWN?r=!1:i?(r=e.type===Ar.POINTERMOVE)&&this.freehand_?r=this.handlePointerMove_(e):(e.pointerEvent.pointerType==Ur||e.type===Ar.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===Ar.DBLCLICK&&(r=!1),t.prototype.handleEvent.call(this,e)&&r},e.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):!!this.condition_(t)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Nr(Ar.POINTERMOVE,t.map,t.pointerEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0)},e.prototype.handleUpEvent=function(t){var e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);var i=this.mode_===Ac.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t):(this.startDrawing_(t),this.mode_===Ac.POINT&&this.finishDrawing()),e=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!e&&this.stopClick_&&t.stopPropagation(),e},e.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,i=t.pixel,r=e[0]-i[0],n=e[1]-i[1],o=r*r+n*n;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0},e.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var i=!1,r=[this.finishCoordinate_];if(this.mode_===Ac.LINE_STRING)i=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===Ac.POLYGON){var n=this.sketchCoords_;i=n[0].length>this.minPoints_,r=[n[0][0],n[0][n[0].length-2]]}if(i)for(var o=t.map,s=0,a=r.length;s<a;s++){var h=r[s],l=o.getPixelFromCoordinate(h),u=t.pixel,p=u[0]-l[0],c=u[1]-l[1],d=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(p*p+c*c)<=d){this.finishCoordinate_=h;break}}}return e},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new B(new ci(e)),this.updateSketchFeatures_())},e.prototype.startDrawing_=function(t){var e=t.coordinate;this.finishCoordinate_=e,this.mode_===Ac.POINT?this.sketchCoords_=e.slice():this.mode_===Ac.POLYGON?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new B(new hr(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new B,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new Dc(Nc,this.sketchFeature_))},e.prototype.modifyDrawing_=function(t){var e,i,r,n=t.coordinate,o=this.sketchFeature_.getGeometry();(this.mode_===Ac.POINT?i=this.sketchCoords_:this.mode_===Ac.POLYGON?(i=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(t)&&(n=this.finishCoordinate_.slice())):i=(e=this.sketchCoords_)[e.length-1],i[0]=n[0],i[1]=n[1],this.geometryFunction_(this.sketchCoords_,o),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(n);if(o.getType()==Nt.POLYGON&&this.mode_!==Ac.POLYGON){this.sketchLine_||(this.sketchLine_=new B);var s=o.getLinearRing(0);(r=this.sketchLine_.getGeometry())?(r.setFlatCoordinates(s.getLayout(),s.getFlatCoordinates()),r.changed()):(r=new hr(s.getFlatCoordinates(),s.getLayout()),this.sketchLine_.setGeometry(r))}else this.sketchLineCoords_&&(r=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},e.prototype.addToDrawing_=function(t){var e,i,r=t.coordinate,n=this.sketchFeature_.getGeometry();this.mode_===Ac.LINE_STRING?(this.finishCoordinate_=r.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(r.slice()),this.geometryFunction_(i,n)):this.mode_===Ac.POLYGON&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(r.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,n)),this.updateSketchFeatures_(),e&&this.finishDrawing()},e.prototype.removeLastPoint=function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry();this.mode_===Ac.LINE_STRING?((t=this.sketchCoords_).splice(-2,1),this.geometryFunction_(t,e),t.length>=2&&(this.finishCoordinate_=t[t.length-2].slice())):this.mode_===Ac.POLYGON&&((t=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e)),0===t.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},e.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,i=t.getGeometry();this.mode_===Ac.LINE_STRING?(e.pop(),this.geometryFunction_(e,i)):this.mode_===Ac.POLYGON&&(e[0].pop(),this.geometryFunction_(e,i),e=i.getCoordinates()),this.type_===Nt.MULTI_POINT?t.setGeometry(new bc([e])):this.type_===Nt.MULTI_LINE_STRING?t.setGeometry(new Pc([e])):this.type_===Nt.MULTI_POLYGON&&t.setGeometry(new Fc([e])),this.dispatchEvent(new Dc(Gc,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},e.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return t&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),t},e.prototype.extend=function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new Dc(Nc,this.sketchFeature_))},e.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},e.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing_(),this.overlay_.setMap(e?t:null)},e}(qo),jc={EXTENTCHANGED:"extentchanged"},Uc=function(t){function e(e){t.call(this,jc.EXTENTCHANGED),this.extent=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P);function Yc(t){return function(e){return tt([t,e])}}function Bc(t,e){return t[0]==e[0]?function(i){return tt([t,[i[0],e[1]]])}:t[1]==e[1]?function(i){return tt([t,[e[0],i[1]]])}:null}var Vc=function(t){function e(e){var i=e||{};t.call(this,i),this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==i.pixelTolerance?i.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),this.extentOverlay_=new gc({source:new op({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:function(){var t=Fu();return function(e,i){return t[Nt.POLYGON]}}(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new gc({source:new op({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:function(){var t=Fu();return function(e,i){return t[Nt.POINT]}}(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapToVertex_=function(t,e){var i=e.getCoordinateFromPixel(t),r=this.getExtent();if(r){var n=function(t){return[[[t[0],t[1]],[t[0],t[3]]],[[t[0],t[3]],[t[2],t[3]]],[[t[2],t[3]],[t[2],t[1]]],[[t[2],t[1]],[t[0],t[1]]]]}(r);n.sort(function(t,e){return rr(i,t)-rr(i,e)});var o=n[0],s=Zi(i,o),a=e.getPixelFromCoordinate(s);if(ir(t,a)<=this.pixelTolerance_){var h=e.getPixelFromCoordinate(o[0]),l=e.getPixelFromCoordinate(o[1]),u=er(a,h),p=er(a,l),c=Math.sqrt(Math.min(u,p));return this.snappedToVertex_=c<=this.pixelTolerance_,this.snappedToVertex_&&(s=u>p?o[1]:o[0]),s}}return null},e.prototype.handlePointerMove_=function(t){var e=t.pixel,i=t.map,r=this.snapToVertex_(e,i);r||(r=i.getCoordinateFromPixel(e)),this.createOrUpdatePointerFeature_(r)},e.prototype.createOrUpdateExtentFeature_=function(t){var e=this.extentFeature_;return e?t?e.setGeometry(Oi(t)):e.setGeometry(void 0):(e=new B(t?Oi(t):{}),this.extentFeature_=e,this.extentOverlay_.getSource().addFeature(e)),e},e.prototype.createOrUpdatePointerFeature_=function(t){var e=this.vertexFeature_;e?e.getGeometry().setCoordinates(t):(e=new B(new ci(t)),this.vertexFeature_=e,this.vertexOverlay_.getSource().addFeature(e));return e},e.prototype.handleEvent=function(e){return!e.pointerEvent||(e.type!=Ar.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),t.prototype.handleEvent.call(this,e),!1)},e.prototype.handleDownEvent=function(t){var e=t.pixel,i=t.map,r=this.getExtent(),n=this.snapToVertex_(e,i),o=function(t){var e=null,i=null;return t[0]==r[0]?e=r[2]:t[0]==r[2]&&(e=r[0]),t[1]==r[1]?i=r[3]:t[1]==r[3]&&(i=r[1]),null!==e&&null!==i?[e,i]:null};if(n&&r){var s=n[0]==r[0]||n[0]==r[2]?n[0]:null,a=n[1]==r[1]||n[1]==r[3]?n[1]:null;null!==s&&null!==a?this.pointerHandler_=Yc(o(n)):null!==s?this.pointerHandler_=Bc(o([s,r[1]]),o([s,r[3]])):null!==a&&(this.pointerHandler_=Bc(o([r[0],a]),o([r[2],a])))}else n=i.getCoordinateFromPixel(e),this.setExtent([n[0],n[1],n[0],n[1]]),this.pointerHandler_=Yc(n);return!0},e.prototype.handleDragEvent=function(t){if(this.pointerHandler_){var e=t.coordinate;this.setExtent(this.pointerHandler_(e)),this.createOrUpdatePointerFeature_(e)}return!0},e.prototype.handleUpEvent=function(t){this.pointerHandler_=null;var e=this.getExtent();return e&&0!==xt(e)||this.setExtent(null),!1},e.prototype.setMap=function(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getExtent=function(){return this.extent_},e.prototype.setExtent=function(t){this.extent_=t||null,this.createOrUpdateExtentFeature_(t),this.dispatchEvent(new Uc(this.extent_))},e}(qo),Xc=1,zc="modifystart",Wc="modifyend",Kc=function(t){function e(e,i,r){t.call(this,e),this.features=i,this.mapBrowserEvent=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P);function Hc(t,e){return t.index-e.index}function Zc(t,e){var i=e.geometry;if(i.getType()===Nt.CIRCLE){var r=i;if(e.index===Xc){var n=er(r.getCenter(),t),o=Math.sqrt(n)-r.getRadius();return o*o}}return rr(t,e.segment)}function qc(t,e){var i=e.geometry;return i.getType()===Nt.CIRCLE&&e.index===Xc?i.getClosestPoint(t):Zi(t,e.segment)}var Jc=function(t){function e(e){var i;if(t.call(this,e),this.condition_=e.condition?e.condition:Ho,this.defaultDeleteCondition_=function(t){return Go(t)&&Vo(t)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:jo,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new tl,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new gc({source:new op({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:function(){var t=Fu();return function(e,i){return t[Nt.POINT]}}(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,i=new U(this.source_.getFeatures()),v(this.source_,rp.ADDFEATURE,this.handleSourceAdd_,this),v(this.source_,rp.REMOVEFEATURE,this.handleSourceRemove_,this)):i=e.features,!i)throw new Error("The modify interaction requires features or a source");this.features_=i,this.features_.forEach(this.addFeature_.bind(this)),v(this.features_,h.ADD,this.handleFeatureAdd_,this),v(this.features_,h.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature_=function(t){var e=t.getGeometry();e&&e.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[e.getType()].call(this,t,e);var i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),v(t,M.CHANGE,this.handleFeatureChange_,this)},e.prototype.willModifyFeatures_=function(t){this.modified_||(this.modified_=!0,this.dispatchEvent(new Kc(zc,this.features_,t)))},e.prototype.removeFeature_=function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),x(t,M.CHANGE,this.handleFeatureChange_,this)},e.prototype.removeFeatureSegmentData_=function(t){var e=this.rBush_,i=[];e.forEach(function(e){t===e.feature&&i.push(e)});for(var r=i.length-1;r>=0;--r)e.remove(i[r])},e.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.overlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleSourceAdd_=function(t){t.feature&&this.features_.push(t.feature)},e.prototype.handleSourceRemove_=function(t){t.feature&&this.features_.remove(t.feature)},e.prototype.handleFeatureAdd_=function(t){this.addFeature_(t.element)},e.prototype.handleFeatureChange_=function(t){if(!this.changingFeature_){var e=t.target;this.removeFeature_(e),this.addFeature_(e)}},e.prototype.handleFeatureRemove_=function(t){var e=t.element;this.removeFeature_(e)},e.prototype.writePointGeometry_=function(t,e){var i=e.getCoordinates(),r={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),r)},e.prototype.writeMultiPointGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length;r<n;++r){var o=i[r],s={feature:t,geometry:e,depth:[r],index:r,segment:[o,o]};this.rBush_.insert(e.getExtent(),s)}},e.prototype.writeLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length-1;r<n;++r){var o=i.slice(r,r+2),s={feature:t,geometry:e,index:r,segment:o};this.rBush_.insert(tt(o),s)}},e.prototype.writeMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length;r<n;++r)for(var o=i[r],s=0,a=o.length-1;s<a;++s){var h=o.slice(s,s+2),l={feature:t,geometry:e,depth:[r],index:s,segment:h};this.rBush_.insert(tt(h),l)}},e.prototype.writePolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length;r<n;++r)for(var o=i[r],s=0,a=o.length-1;s<a;++s){var h=o.slice(s,s+2),l={feature:t,geometry:e,depth:[r],index:s,segment:h};this.rBush_.insert(tt(h),l)}},e.prototype.writeMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length;r<n;++r)for(var o=i[r],s=0,a=o.length;s<a;++s)for(var h=o[s],l=0,u=h.length-1;l<u;++l){var p=h.slice(l,l+2),c={feature:t,geometry:e,depth:[s,r],index:l,segment:p};this.rBush_.insert(tt(p),c)}},e.prototype.writeCircleGeometry_=function(t,e){var i=e.getCenter(),r={feature:t,geometry:e,index:0,segment:[i,i]},n={feature:t,geometry:e,index:Xc,segment:[i,i]},o=[r,n];r.featureSegments=n.featureSegments=o,this.rBush_.insert(pt(i),r),this.rBush_.insert(e.getExtent(),n)},e.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),r=0;r<i.length;++r)this.SEGMENT_WRITERS_[i[r].getType()].call(this,t,i[r])},e.prototype.createOrUpdateVertexFeature_=function(t){var e=this.vertexFeature_;e?e.getGeometry().setCoordinates(t):(e=new B(new ci(t)),this.vertexFeature_=e,this.overlay_.getSource().addFeature(e));return e},e.prototype.handleEvent=function(e){return!e.pointerEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=Ar.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(i=!(e.type!=Ar.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==Ar.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),t.prototype.handleEvent.call(this,e)&&!i);var i},e.prototype.handleDragEvent=function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t);for(var e=t.coordinate,i=0,r=this.dragSegments_.length;i<r;++i){for(var n=this.dragSegments_[i],o=n[0],s=o.depth,a=o.geometry,h=void 0,l=o.segment,u=n[1];e.length<a.getStride();)e.push(l[u][e.length]);switch(a.getType()){case Nt.POINT:h=e,l[0]=l[1]=e;break;case Nt.MULTI_POINT:(h=a.getCoordinates())[o.index]=e,l[0]=l[1]=e;break;case Nt.LINE_STRING:(h=a.getCoordinates())[o.index+u]=e,l[u]=e;break;case Nt.MULTI_LINE_STRING:case Nt.POLYGON:(h=a.getCoordinates())[s[0]][o.index+u]=e,l[u]=e;break;case Nt.MULTI_POLYGON:(h=a.getCoordinates())[s[1]][s[0]][o.index+u]=e,l[u]=e;break;case Nt.CIRCLE:l[0]=l[1]=e,0===o.index?(this.changingFeature_=!0,a.setCenter(e),this.changingFeature_=!1):(this.changingFeature_=!0,a.setRadius(ir(a.getCenter(),e)),this.changingFeature_=!1)}h&&this.setGeometryCoordinates_(a,h)}this.createOrUpdateVertexFeature_(e)},e.prototype.handleDownEvent=function(t){if(!this.condition_(t))return!1;this.handlePointerAtPixel_(t.pixel,t.map);var e=t.map.getCoordinateFromPixel(t.pixel);this.dragSegments_.length=0,this.modified_=!1;var i=this.vertexFeature_;if(i){var r=[],n=i.getGeometry().getCoordinates(),s=tt([n]),a=this.rBush_.getInExtent(s),h={};a.sort(Hc);for(var l=0,u=a.length;l<u;++l){var p=a[l],c=p.segment,d=o(p.feature),f=p.depth;if(f&&(d+="-"+f.join("-")),h[d]||(h[d]=new Array(2)),p.geometry.getType()===Nt.CIRCLE&&p.index===Xc)Qi(qc(e,p),n)&&!h[d][0]&&(this.dragSegments_.push([p,0]),h[d][0]=p);else if(Qi(c[0],n)&&!h[d][0])this.dragSegments_.push([p,0]),h[d][0]=p;else if(Qi(c[1],n)&&!h[d][1]){if((p.geometry.getType()===Nt.LINE_STRING||p.geometry.getType()===Nt.MULTI_LINE_STRING)&&h[d][0]&&0===h[d][0].index)continue;this.dragSegments_.push([p,1]),h[d][1]=p}else this.insertVertexCondition_(t)&&o(c)in this.vertexSegments_&&!h[d][0]&&!h[d][1]&&r.push([p,n])}r.length&&this.willModifyFeatures_(t);for(var _=r.length-1;_>=0;--_)this.insertVertex_.apply(this,r[_])}return!!this.vertexFeature_},e.prototype.handleUpEvent=function(t){for(var e=this.dragSegments_.length-1;e>=0;--e){var i=this.dragSegments_[e][0],r=i.geometry;if(r.getType()===Nt.CIRCLE){var n=r.getCenter(),o=i.featureSegments[0],s=i.featureSegments[1];o.segment[0]=o.segment[1]=n,s.segment[0]=s.segment[1]=n,this.rBush_.update(pt(n),o),this.rBush_.update(r.getExtent(),s)}else this.rBush_.update(tt(i.segment),i)}return this.modified_&&(this.dispatchEvent(new Kc(Wc,this.features_,t)),this.modified_=!1),!1},e.prototype.handlePointerMove_=function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map)},e.prototype.handlePointerAtPixel_=function(t,e){var i=e.getCoordinateFromPixel(t),r=et(pt(i),e.getView().getResolution()*this.pixelTolerance_),n=this.rBush_.getInExtent(r);if(n.length>0){n.sort(function(t,e){return Zc(i,t)-Zc(i,e)});var s=n[0],a=s.segment,h=qc(i,s),l=e.getPixelFromCoordinate(h),u=ir(t,l);if(u<=this.pixelTolerance_){var p={};if(s.geometry.getType()===Nt.CIRCLE&&s.index===Xc)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(h);else{var c=e.getPixelFromCoordinate(a[0]),d=e.getPixelFromCoordinate(a[1]),f=er(l,c),_=er(l,d);u=Math.sqrt(Math.min(f,_)),this.snappedToVertex_=u<=this.pixelTolerance_,this.snappedToVertex_&&(h=f>_?a[1]:a[0]),this.createOrUpdateVertexFeature_(h);for(var g=1,y=n.length;g<y;++g){var v=n[g].segment;if(!(Qi(a[0],v[0])&&Qi(a[1],v[1])||Qi(a[0],v[1])&&Qi(a[1],v[0])))break;p[o(v)]=!0}}return p[o(a)]=!0,void(this.vertexSegments_=p)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},e.prototype.insertVertex_=function(t,e){for(var i,r=t.segment,n=t.feature,o=t.geometry,s=t.depth,a=t.index;e.length<o.getStride();)e.push(0);switch(o.getType()){case Nt.MULTI_LINE_STRING:case Nt.POLYGON:(i=o.getCoordinates())[s[0]].splice(a+1,0,e);break;case Nt.MULTI_POLYGON:(i=o.getCoordinates())[s[1]][s[0]].splice(a+1,0,e);break;case Nt.LINE_STRING:(i=o.getCoordinates()).splice(a+1,0,e);break;default:return}this.setGeometryCoordinates_(o,i);var h=this.rBush_;h.remove(t),this.updateSegmentIndices_(o,a,s,1);var l={segment:[r[0],e],feature:n,geometry:o,depth:s,index:a};h.insert(tt(l.segment),l),this.dragSegments_.push([l,1]);var u={segment:[e,r[1]],feature:n,geometry:o,depth:s,index:a+1};h.insert(tt(u.segment),u),this.dragSegments_.push([u,0]),this.ignoreNextSingleClick_=!0},e.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Ar.POINTERDRAG){var t=this.lastPointerEvent_;return this.willModifyFeatures_(t),this.removeVertex_(),this.dispatchEvent(new Kc(Wc,this.features_,t)),this.modified_=!1,!0}return!1},e.prototype.removeVertex_=function(){var t,e,i,r,n,s,a,h,l,u,p,c=this.dragSegments_,d={},f=!1;for(n=c.length-1;n>=0;--n)p=o((u=(i=c[n])[0]).feature),u.depth&&(p+="-"+u.depth.join("-")),p in d||(d[p]={}),0===i[1]?(d[p].right=u,d[p].index=u.index):1==i[1]&&(d[p].left=u,d[p].index=u.index+1);for(p in d){switch(l=d[p].right,a=d[p].left,h=(s=d[p].index)-1,u=void 0!==a?a:l,h<0&&(h=0),t=e=(r=u.geometry).getCoordinates(),f=!1,r.getType()){case Nt.MULTI_LINE_STRING:e[u.depth[0]].length>2&&(e[u.depth[0]].splice(s,1),f=!0);break;case Nt.LINE_STRING:e.length>2&&(e.splice(s,1),f=!0);break;case Nt.MULTI_POLYGON:t=t[u.depth[1]];case Nt.POLYGON:(t=t[u.depth[0]]).length>4&&(s==t.length-1&&(s=0),t.splice(s,1),f=!0,0===s&&(t.pop(),t.push(t[0]),h=t.length-1))}if(f){this.setGeometryCoordinates_(r,e);var _=[];if(void 0!==a&&(this.rBush_.remove(a),_.push(a.segment[0])),void 0!==l&&(this.rBush_.remove(l),_.push(l.segment[1])),void 0!==a&&void 0!==l){var g={depth:u.depth,feature:u.feature,geometry:u.geometry,index:h,segment:_};this.rBush_.insert(tt(g.segment),g)}this.updateSegmentIndices_(r,s,u.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),c.length=0}}return f},e.prototype.setGeometryCoordinates_=function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1},e.prototype.updateSegmentIndices_=function(t,e,i,r){this.rBush_.forEachInExtent(t.getExtent(),function(n){n.geometry===t&&(void 0===i||void 0===n.depth||Z(n.depth,i))&&n.index>e&&(n.index+=r)})},e}(qo),Qc={SELECT:"select"},$c=function(t){function e(e,i,r,n){t.call(this,e),this.selected=i,this.deselected=r,this.mapBrowserEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P);function td(t){if(!this.condition_(t))return!0;var e=this.addCondition_(t),i=this.removeCondition_(t),r=this.toggleCondition_(t),n=!e&&!i&&!r,o=t.map,s=this.getFeatures(),a=[],h=[];if(n){p(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.filter_(t,e))return h.push(t),this.addFeatureLayerAssociation_(t,e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var l=s.getLength()-1;l>=0;--l){var u=s.item(l),c=h.indexOf(u);c>-1?h.splice(c,1):(s.remove(u),a.push(u))}0!==h.length&&s.extend(h)}else{o.forEachFeatureAtPixel(t.pixel,function(t,n){if(this.filter_(t,n))return!e&&!r||X(s.getArray(),t)?(i||r)&&X(s.getArray(),t)&&(a.push(t),this.removeFeatureLayerAssociation_(t)):(h.push(t),this.addFeatureLayerAssociation_(t,n)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var d=a.length-1;d>=0;--d)s.remove(a[d]);s.extend(h)}return(h.length>0||a.length>0)&&this.dispatchEvent(new $c(Qc.SELECT,h,a,t)),Bo(t)}var ed=function(t){function e(e){t.call(this,{handleEvent:td});var i=e||{};this.condition_=i.condition?i.condition:Vo,this.addCondition_=i.addCondition?i.addCondition:Yo,this.removeCondition_=i.removeCondition?i.removeCondition:Yo,this.toggleCondition_=i.toggleCondition?i.toggleCondition:zo,this.multi_=!!i.multi&&i.multi,this.filter_=i.filter?i.filter:R,this.hitTolerance_=i.hitTolerance?i.hitTolerance:0;var r,n=new gc({source:new op({useSpatialIndex:!1,features:i.features,wrapX:i.wrapX}),style:i.style?i.style:function(){var t=Fu();return K(t[Nt.POLYGON],t[Nt.LINE_STRING]),K(t[Nt.GEOMETRY_COLLECTION],t[Nt.LINE_STRING]),function(e,i){return e.getGeometry()?t[e.getGeometry().getType()]:null}}(),updateWhileAnimating:!0,updateWhileInteracting:!0});if(this.featureOverlay_=n,i.layers)if("function"==typeof i.layers)r=i.layers;else{var o=i.layers;r=function(t){return X(o,t)}}else r=R;this.layerFilter_=r,this.featureLayerAssociation_={};var s=this.getFeatures();v(s,h.ADD,this.addFeature_,this),v(s,h.REMOVE,this.removeFeature_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeatureLayerAssociation_=function(t,e){this.featureLayerAssociation_[o(t)]=e},e.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.getLayer=function(t){return this.featureLayerAssociation_[o(t)]},e.prototype.getOverlay=function(){return this.featureOverlay_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var i=this.getMap(),r=this.getFeatures();i&&r.forEach(i.unskipFeature.bind(i)),t.prototype.setMap.call(this,e),this.featureOverlay_.setMap(e),e&&r.forEach(e.skipFeature.bind(e))},e.prototype.addFeature_=function(t){var e=this.getMap();e&&e.skipFeature(t.element)},e.prototype.removeFeature_=function(t){var e=this.getMap();e&&e.unskipFeature(t.element)},e.prototype.removeFeatureLayerAssociation_=function(t){delete this.featureLayerAssociation_[o(t)]},e}(Fo);function id(t){return t.feature?t.feature:t.element?t.element:void 0}var rd=function(t){function e(e){var i=e||{},r=i;r.handleDownEvent||(r.handleDownEvent=R),r.stopDown||(r.stopDown=w),t.call(this,r),this.source_=i.source?i.source:null,this.vertex_=void 0===i.vertex||i.vertex,this.edge_=void 0===i.edge||i.edge,this.features_=i.features?i.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelCoordinate_=null,this.pixelTolerance_=void 0!==i.pixelTolerance?i.pixelTolerance:10,this.sortByDistance_=function(t,e){var i=rr(this.pixelCoordinate_,t.segment),r=rr(this.pixelCoordinate_,e.segment);return i-r}.bind(this),this.rBush_=new tl,this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_,Circle:this.writeCircleGeometry_}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t,e){var i=void 0===e||e,r=o(t),n=t.getGeometry();if(n){var s=this.SEGMENT_WRITERS_[n.getType()];s&&(this.indexedFeaturesExtents_[r]=n.getExtent([1/0,1/0,-1/0,-1/0]),s.call(this,t,n))}i&&(this.featureChangeListenerKeys_[r]=v(t,M.CHANGE,this.handleFeatureChange_,this))},e.prototype.forEachFeatureAdd_=function(t){this.addFeature(t)},e.prototype.forEachFeatureRemove_=function(t){this.removeFeature(t)},e.prototype.getFeatures_=function(){var t;return this.features_?t=this.features_:this.source_&&(t=this.source_.getFeatures()),t},e.prototype.handleEvent=function(e){var i=this.snapTo(e.pixel,e.coordinate,e.map);return i.snapped&&(e.coordinate=i.vertex.slice(0,2),e.pixel=i.vertexPixel),t.prototype.handleEvent.call(this,e)},e.prototype.handleFeatureAdd_=function(t){var e=id(t);this.addFeature(e)},e.prototype.handleFeatureRemove_=function(t){var e=id(t);this.removeFeature(e)},e.prototype.handleFeatureChange_=function(t){var e=t.target;if(this.handlingDownUpSequence){var i=o(e);i in this.pendingFeatures_||(this.pendingFeatures_[i]=e)}else this.updateFeature_(e)},e.prototype.handleUpEvent=function(t){var e=c(this.pendingFeatures_);return e.length&&(e.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},e.prototype.removeFeature=function(t,e){var i=void 0===e||e,r=o(t),n=this.indexedFeaturesExtents_[r];if(n){var s=this.rBush_,a=[];s.forEachInExtent(n,function(e){t===e.feature&&a.push(e)});for(var h=a.length-1;h>=0;--h)s.remove(a[h])}i&&(E(this.featureChangeListenerKeys_[r]),delete this.featureChangeListenerKeys_[r])},e.prototype.setMap=function(e){var i=this.getMap(),r=this.featuresListenerKeys_,n=this.getFeatures_();i&&(r.forEach(E),r.length=0,n.forEach(this.forEachFeatureRemove_.bind(this))),t.prototype.setMap.call(this,e),e&&(this.features_?r.push(v(this.features_,h.ADD,this.handleFeatureAdd_,this),v(this.features_,h.REMOVE,this.handleFeatureRemove_,this)):this.source_&&r.push(v(this.source_,rp.ADDFEATURE,this.handleFeatureAdd_,this),v(this.source_,rp.REMOVEFEATURE,this.handleFeatureRemove_,this)),n.forEach(this.forEachFeatureAdd_.bind(this)))},e.prototype.snapTo=function(t,e,i){var r=tt([i.getCoordinateFromPixel([t[0]-this.pixelTolerance_,t[1]+this.pixelTolerance_]),i.getCoordinateFromPixel([t[0]+this.pixelTolerance_,t[1]-this.pixelTolerance_])]),n=this.rBush_.getInExtent(r);this.vertex_&&!this.edge_&&(n=n.filter(function(t){return t.feature.getGeometry().getType()!==Nt.CIRCLE}));var o,s,a,h,l=!1,u=null,p=null;if(n.length>0){this.pixelCoordinate_=e,n.sort(this.sortByDistance_);var c=n[0].segment,d=n[0].feature.getGeometry().getType()===Nt.CIRCLE;this.vertex_&&!this.edge_?(o=i.getPixelFromCoordinate(c[0]),s=i.getPixelFromCoordinate(c[1]),a=er(t,o),h=er(t,s),Math.sqrt(Math.min(a,h))<=this.pixelTolerance_&&(l=!0,u=a>h?c[1]:c[0],p=i.getPixelFromCoordinate(u))):this.edge_&&(u=d?function(t,e){var i=e.getRadius(),r=e.getCenter(),n=r[0],o=r[1],s=t[0]-n,a=t[1]-o;0===s&&0===a&&(s=1);var h=Math.sqrt(s*s+a*a);return[n+i*s/h,o+i*a/h]}(e,n[0].feature.getGeometry()):Zi(e,c),ir(t,p=i.getPixelFromCoordinate(u))<=this.pixelTolerance_&&(l=!0,this.vertex_&&!d&&(o=i.getPixelFromCoordinate(c[0]),s=i.getPixelFromCoordinate(c[1]),a=er(p,o),h=er(p,s),Math.sqrt(Math.min(a,h))<=this.pixelTolerance_&&(u=a>h?c[1]:c[0],p=i.getPixelFromCoordinate(u))))),l&&(p=[Math.round(p[0]),Math.round(p[1])])}return{snapped:l,vertex:u,vertexPixel:p}},e.prototype.updateFeature_=function(t){this.removeFeature(t,!1),this.addFeature(t,!1)},e.prototype.writeCircleGeometry_=function(t,e){for(var i=Pi(e).getCoordinates()[0],r=0,n=i.length-1;r<n;++r){var o=i.slice(r,r+2),s={feature:t,segment:o};this.rBush_.insert(tt(o),s)}},e.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),r=0;r<i.length;++r){var n=this.SEGMENT_WRITERS_[i[r].getType()];n&&n.call(this,t,i[r])}},e.prototype.writeLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length-1;r<n;++r){var o=i.slice(r,r+2),s={feature:t,segment:o};this.rBush_.insert(tt(o),s)}},e.prototype.writeMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length;r<n;++r)for(var o=i[r],s=0,a=o.length-1;s<a;++s){var h=o.slice(s,s+2),l={feature:t,segment:h};this.rBush_.insert(tt(h),l)}},e.prototype.writeMultiPointGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length;r<n;++r){var o=i[r],s={feature:t,segment:[o,o]};this.rBush_.insert(e.getExtent(),s)}},e.prototype.writeMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length;r<n;++r)for(var o=i[r],s=0,a=o.length;s<a;++s)for(var h=o[s],l=0,u=h.length-1;l<u;++l){var p=h.slice(l,l+2),c={feature:t,segment:p};this.rBush_.insert(tt(p),c)}},e.prototype.writePointGeometry_=function(t,e){var i=e.getCoordinates(),r={feature:t,segment:[i,i]};this.rBush_.insert(e.getExtent(),r)},e.prototype.writePolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,n=i.length;r<n;++r)for(var o=i[r],s=0,a=o.length-1;s<a;++s){var h=o.slice(s,s+2),l={feature:t,segment:h};this.rBush_.insert(tt(h),l)}},e}(qo),nd="translatestart",od="translating",sd="translateend",ad=function(t){function e(e,i,r){t.call(this,e),this.features=i,this.coordinate=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(P),hd=function(t){function e(e){var i,r=e||{};if(t.call(this,r),this.lastCoordinate_=null,this.features_=void 0!==r.features?r.features:null,r.layers)if("function"==typeof r.layers)i=r.layers;else{var n=r.layers;i=function(t){return X(n,t)}}else i=R;this.layerFilter_=i,this.hitTolerance_=r.hitTolerance?r.hitTolerance:0,this.lastFeature_=null,v(this,G(Io.ACTIVE),this.handleActiveChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDownEvent=function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new U([this.lastFeature_]);return this.dispatchEvent(new ad(nd,e,t.coordinate)),!0}return!1},e.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new U([this.lastFeature_]);return this.dispatchEvent(new ad(sd,e,t.coordinate)),!0}return!1},e.prototype.handleDragEvent=function(t){if(this.lastCoordinate_){var e=t.coordinate,i=e[0]-this.lastCoordinate_[0],r=e[1]-this.lastCoordinate_[1],n=this.features_||new U([this.lastFeature_]);n.forEach(function(t){var e=t.getGeometry();e.translate(i,r),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new ad(od,n,e))}},e.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},e.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t){if(!this.features_||X(this.features_.getArray(),t))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var i=this.getMap();t.prototype.setMap.call(this,e),this.updateState_(i)},e.prototype.handleActiveChanged_=function(){this.updateState_(null)},e.prototype.updateState_=function(t){var e=this.getMap(),i=this.getActive();e&&i||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},e}(qo);function ld(t){for(var e=[],i=0,r=t.length;i<r;++i)e.push(t[i].clone());return e}var ud=function(t){function e(e){t.call(this),this.geometries_=e||null,this.listenGeometriesChange_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.unlistenGeometriesChange_=function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)x(this.geometries_[t],M.CHANGE,this.changed,this)},e.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)v(this.geometries_[t],M.CHANGE,this.changed,this)},e.prototype.clone=function(){var t=new e(null);return t.setGeometries(this.geometries_),t},e.prototype.closestPointXY=function(t,e,i,r){if(r<rt(this.getExtent(),t,e))return r;for(var n=this.geometries_,o=0,s=n.length;o<s;++o)r=n[o].closestPointXY(t,e,i,r);return r},e.prototype.containsXY=function(t,e){for(var i=this.geometries_,r=0,n=i.length;r<n;++r)if(i[r].containsXY(t,e))return!0;return!1},e.prototype.computeExtent=function(t){ut(t);for(var e=this.geometries_,i=0,r=e.length;i<r;++i)ft(t,e[i].getExtent());return t},e.prototype.getGeometries=function(){return ld(this.geometries_)},e.prototype.getGeometriesArray=function(){return this.geometries_},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(p(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;var i=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(i))return this.simplifiedGeometryCache[i];for(var r=[],n=this.geometries_,o=!1,s=0,a=n.length;s<a;++s){var h=n[s],l=h.getSimplifiedGeometry(t);r.push(l),l!==h&&(o=!0)}if(o){var u=new e(null);return u.setGeometriesArray(r),this.simplifiedGeometryCache[i]=u,u}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},e.prototype.getType=function(){return Nt.GEOMETRY_COLLECTION},e.prototype.intersectsExtent=function(t){for(var e=this.geometries_,i=0,r=e.length;i<r;++i)if(e[i].intersectsExtent(t))return!0;return!1},e.prototype.isEmpty=function(){return 0===this.geometries_.length},e.prototype.rotate=function(t,e){for(var i=this.geometries_,r=0,n=i.length;r<n;++r)i[r].rotate(t,e);this.changed()},e.prototype.scale=function(t,e,i){var r=i;r||(r=Tt(this.getExtent()));for(var n=this.geometries_,o=0,s=n.length;o<s;++o)n[o].scale(t,e,r);this.changed()},e.prototype.setGeometries=function(t){this.setGeometriesArray(ld(t))},e.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},e.prototype.applyTransform=function(t){for(var e=this.geometries_,i=0,r=e.length;i<r;++i)e[i].applyTransform(t);this.changed()},e.prototype.translate=function(t,e){for(var i=this.geometries_,r=0,n=i.length;r<n;++r)i[r].translate(t,e);this.changed()},e.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),t.prototype.disposeInternal.call(this)},e}(Xe),pd=function(){this.dataProjection=null,this.defaultFeatureProjection=null};pd.prototype.getReadOptions=function(t,e){var i;return e&&(i={dataProjection:e.dataProjection?e.dataProjection:this.readProjection(t),featureProjection:e.featureProjection}),this.adaptOptions(i)},pd.prototype.adaptOptions=function(t){return u({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},pd.prototype.getLastExtent=function(){return null},pd.prototype.getType=function(){return r()},pd.prototype.readFeature=function(t,e){return r()},pd.prototype.readFeatures=function(t,e){return r()},pd.prototype.readGeometry=function(t,e){return r()},pd.prototype.readProjection=function(t){return r()},pd.prototype.writeFeature=function(t,e){return r()},pd.prototype.writeFeatures=function(t,e){return r()},pd.prototype.writeGeometry=function(t,e){return r()};var cd=pd;function dd(t,e,i){var r,n=i?Ee(i.featureProjection):null,o=i?Ee(i.dataProjection):null;if(r=n&&o&&!Ie(n,o)?Array.isArray(t)?be(t,o,n):(e?t.clone():t).transform(e?n:o,e?o:n):t,e&&i&&void 0!==i.decimals&&!Array.isArray(r)){var s=Math.pow(10,i.decimals);r===t&&(r=t.clone()),r.applyTransform(function(t){for(var e=0,i=t.length;e<i;++e)t[e]=Math.round(t[e]*s)/s;return t})}return r}function fd(t){if("string"==typeof t){var e=JSON.parse(t);return e||null}return null!==t?t:null}var _d=function(t){function e(){t.call(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return Hl.JSON},e.prototype.readFeature=function(t,e){return this.readFeatureFromObject(fd(t),this.getReadOptions(t,e))},e.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(fd(t),this.getReadOptions(t,e))},e.prototype.readFeatureFromObject=function(t,e){return r()},e.prototype.readFeaturesFromObject=function(t,e){return r()},e.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(fd(t),this.getReadOptions(t,e))},e.prototype.readGeometryFromObject=function(t,e){return r()},e.prototype.readProjection=function(t){return this.readProjectionFromObject(fd(t))},e.prototype.readProjectionFromObject=function(t){return r()},e.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))},e.prototype.writeFeatureObject=function(t,e){return r()},e.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))},e.prototype.writeFeaturesObject=function(t,e){return r()},e.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))},e.prototype.writeGeometryObject=function(t,e){return r()},e}(cd),gd={};gd[Nt.POINT]=function(t){var e;e=void 0!==t.m&&void 0!==t.z?new ci([t.x,t.y,t.z,t.m],At.XYZM):void 0!==t.z?new ci([t.x,t.y,t.z],At.XYZ):void 0!==t.m?new ci([t.x,t.y,t.m],At.XYM):new ci([t.x,t.y]);return e},gd[Nt.LINE_STRING]=function(t){var e=md(t);return new hr(t.paths[0],e)},gd[Nt.POLYGON]=function(t){var e=md(t);return new Ii(t.rings,e)},gd[Nt.MULTI_POINT]=function(t){var e=md(t);return new bc(t.points,e)},gd[Nt.MULTI_LINE_STRING]=function(t){var e=md(t);return new Pc(t.paths,e)},gd[Nt.MULTI_POLYGON]=function(t){var e=md(t);return new Fc(t.rings,e)};var yd={};function vd(t,e){if(!t)return null;var i;if("number"==typeof t.x&&"number"==typeof t.y)i=Nt.POINT;else if(t.points)i=Nt.MULTI_POINT;else if(t.paths){i=1===t.paths.length?Nt.LINE_STRING:Nt.MULTI_LINE_STRING}else if(t.rings){var r=t,n=md(r),o=function(t,e){var i,r,n=[],o=[],s=[];for(i=0,r=t.length;i<r;++i){n.length=0,ei(n,0,t[i],e.length);var a=Si(n,0,n.length,e.length);a?o.push([t[i]]):s.push(t[i])}for(;s.length;){var h=s.shift(),l=!1;for(i=o.length-1;i>=0;i--){var u=o[i][0],p=ot(new pi(u).getExtent(),new pi(h).getExtent());if(p){o[i].push(h),l=!0;break}}l||o.push([h.reverse()])}return o}(r.rings,n);1===o.length?(i=Nt.POLYGON,t.rings=o[0]):(i=Nt.MULTI_POLYGON,t.rings=o)}return dd((0,gd[i])(t),!1,e)}function md(t){var e=At.XY;return!0===t.hasZ&&!0===t.hasM?e=At.XYZM:!0===t.hasZ?e=At.XYZ:!0===t.hasM&&(e=At.XYM),e}function xd(t){var e=t.getLayout();return{hasZ:e===At.XYZ||e===At.XYZM,hasM:e===At.XYM||e===At.XYZM}}function Ed(t,e){return(0,yd[t.getType()])(dd(t,!0,e),e)}yd[Nt.POINT]=function(t,e){var i,r=t.getCoordinates(),n=t.getLayout();n===At.XYZ?i={x:r[0],y:r[1],z:r[2]}:n===At.XYM?i={x:r[0],y:r[1],m:r[2]}:n===At.XYZM?i={x:r[0],y:r[1],z:r[2],m:r[3]}:n===At.XY?i={x:r[0],y:r[1]}:Y(!1,34);return i},yd[Nt.LINE_STRING]=function(t,e){var i=t,r=xd(i);return{hasZ:r.hasZ,hasM:r.hasM,paths:[i.getCoordinates()]}},yd[Nt.POLYGON]=function(t,e){var i=t,r=xd(i);return{hasZ:r.hasZ,hasM:r.hasM,rings:i.getCoordinates(!1)}},yd[Nt.MULTI_POINT]=function(t,e){var i=t,r=xd(i);return{hasZ:r.hasZ,hasM:r.hasM,points:i.getCoordinates()}},yd[Nt.MULTI_LINE_STRING]=function(t,e){var i=t,r=xd(i);return{hasZ:r.hasZ,hasM:r.hasM,paths:i.getCoordinates()}},yd[Nt.MULTI_POLYGON]=function(t,e){for(var i=xd(t),r=t.getCoordinates(!1),n=[],o=0;o<r.length;o++)for(var s=r[o].length-1;s>=0;s--)n.push(r[o][s]);return{hasZ:i.hasZ,hasM:i.hasM,rings:n}};var Sd=function(t){function e(e){var i=e||{};t.call(this),this.geometryName_=i.geometryName}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFeatureFromObject=function(t,e){var i=t,r=vd(i.geometry,e),n=new B;return this.geometryName_&&n.setGeometryName(this.geometryName_),n.setGeometry(r),e&&e.idField&&i.attributes[e.idField]&&n.setId(i.attributes[e.idField]),i.attributes&&n.setProperties(i.attributes),n},e.prototype.readFeaturesFromObject=function(t,e){var i=e||{};if(t.features){var r=[],n=t.features;i.idField=t.objectIdFieldName;for(var o=0,s=n.length;o<s;++o)r.push(this.readFeatureFromObject(n[o],i));return r}return[this.readFeatureFromObject(t,i)]},e.prototype.readGeometryFromObject=function(t,e){return vd(t,e)},e.prototype.readProjectionFromObject=function(t){return t.spatialReference&&void 0!==t.spatialReference.wkid?Ee("EPSG:"+t.spatialReference.wkid):null},e.prototype.writeGeometryObject=function(t,e){return Ed(t,this.adaptOptions(e))},e.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var i={},r=t.getGeometry();r&&(i.geometry=Ed(r,e),e&&e.featureProjection&&(i.geometry.spatialReference={wkid:Number(Ee(e.featureProjection).getCode().split(":").pop())}));var n=t.getProperties();return delete n[t.getGeometryName()],d(n)?i.attributes={}:i.attributes=n,i},e.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var i=[],r=0,n=t.length;r<n;++r)i.push(this.writeFeatureObject(t[r],e));return{features:i}},e}(_d),Td=function(t){function e(){t.call(this),this.xmlSerializer_=new XMLSerializer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return Hl.XML},e.prototype.readFeature=function(t,e){if(t){if("string"==typeof t){var i=ru(t);return this.readFeatureFromDocument(i,e)}return iu(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e)}return null},e.prototype.readFeatureFromDocument=function(t,e){var i=this.readFeaturesFromDocument(t,e);return i.length>0?i[0]:null},e.prototype.readFeatureFromNode=function(t,e){return null},e.prototype.readFeatures=function(t,e){if(t){if("string"==typeof t){var i=ru(t);return this.readFeaturesFromDocument(i,e)}return iu(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e)}return[]},e.prototype.readFeaturesFromDocument=function(t,e){for(var i=[],r=t.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&K(i,this.readFeaturesFromNode(r,e));return i},e.prototype.readFeaturesFromNode=function(t,e){return r()},e.prototype.readGeometry=function(t,e){if(t){if("string"==typeof t){var i=ru(t);return this.readGeometryFromDocument(i,e)}return iu(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e)}return null},e.prototype.readGeometryFromDocument=function(t,e){return null},e.prototype.readGeometryFromNode=function(t,e){return null},e.prototype.readProjection=function(t){if(t){if("string"==typeof t){var e=ru(t);return this.readProjectionFromDocument(e)}return iu(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}return null},e.prototype.readProjectionFromDocument=function(t){return this.dataProjection},e.prototype.readProjectionFromNode=function(t){return this.dataProjection},e.prototype.writeFeature=function(t,e){var i=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(i)},e.prototype.writeFeatureNode=function(t,e){return null},e.prototype.writeFeatures=function(t,e){var i=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(i)},e.prototype.writeFeaturesNode=function(t,e){return null},e.prototype.writeGeometry=function(t,e){var i=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(i)},e.prototype.writeGeometryNode=function(t,e){return null},e}(cd),Cd="http://www.opengis.net/gml",Rd=/^[\s\xa0]*$/,wd=function(t){function e(e){t.call(this);var i=e||{};this.featureType=i.featureType,this.featureNS=i.featureNS,this.srsName=i.srsName,this.schemaLocation="",this.FEATURE_COLLECTION_PARSERS={},this.FEATURE_COLLECTION_PARSERS[this.namespace]={featureMember:ou(this.readFeaturesInternal),featureMembers:su(this.readFeaturesInternal)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFeaturesInternal=function(t,e){var i=t.localName,r=null;if("FeatureCollection"==i)r=gu([],this.FEATURE_COLLECTION_PARSERS,t,e,this);else if("featureMembers"==i||"featureMember"==i){var n=e[0],o=n.featureType,s=n.featureNS;if(!o&&t.childNodes){o=[],s={};for(var a=0,h=t.childNodes.length;a<h;++a){var l=t.childNodes[a];if(1===l.nodeType){var u=l.nodeName.split(":").pop();if(-1===o.indexOf(u)){var p="",c=0,d=l.namespaceURI;for(var f in s){if(s[f]===d){p=f;break}++c}p||(s[p="p"+c]=d),o.push(p+":"+u)}}}"featureMember"!=i&&(n.featureType=o,n.featureNS=s)}if("string"==typeof s){var _=s;(s={}).p0=_}var g={},y=Array.isArray(o)?o:[o];for(var v in s){for(var m={},x=0,E=y.length;x<E;++x){(-1===y[x].indexOf(":")?"p0":y[x].split(":")[0])===v&&(m[y[x].split(":").pop()]="featureMembers"==i?ou(this.readFeatureElement,this):su(this.readFeatureElement,this))}g[s[v]]=m}r=gu("featureMember"==i?void 0:[],g,t,e)}return null===r&&(r=[]),r},e.prototype.readGeometryElement=function(t,e){var i=e[0];i.srsName=t.firstElementChild.getAttribute("srsName"),i.srsDimension=t.firstElementChild.getAttribute("srsDimension");var r=gu(null,this.GEOMETRY_PARSERS,t,e,this);return r?dd(r,!1,i):void 0},e.prototype.readFeatureElementInternal=function(t,e,i){for(var r,n={},o=t.firstElementChild;o;o=o.nextElementSibling){var s=void 0,a=o.localName;0===o.childNodes.length||1===o.childNodes.length&&(3===o.firstChild.nodeType||4===o.firstChild.nodeType)?(s=eu(o,!1),Rd.test(s)&&(s=void 0)):(i&&(s=this.readGeometryElement(o,e)),s?"boundedBy"!==a&&(r=a):s=this.readFeatureElementInternal(o,e,!1)),n[a]?(n[a]instanceof Array||(n[a]=[n[a]]),n[a].push(s)):n[a]=s;var h=o.attributes.length;if(h>0){n[a]={_content_:n[a]};for(var l=0;l<h;l++){var u=o.attributes[l].name;n[a][u]=o.attributes[l].value}}}if(i){var p=new B(n);r&&p.setGeometryName(r);var c=t.getAttribute("fid")||function(t,e,i){return t.getAttributeNS(e,i)||""}(t,this.namespace,"id");return c&&p.setId(c),p}return n},e.prototype.readFeatureElement=function(t,e){return this.readFeatureElementInternal(t,e,!0)},e.prototype.readPoint=function(t,e){var i=this.readFlatCoordinatesFromNode_(t,e);if(i)return new ci(i,At.XYZ)},e.prototype.readMultiPoint=function(t,e){var i=gu([],this.MULTIPOINT_PARSERS_,t,e,this);return i?new bc(i):void 0},e.prototype.readMultiLineString=function(t,e){var i=gu([],this.MULTILINESTRING_PARSERS_,t,e,this);if(i)return new Pc(i)},e.prototype.readMultiPolygon=function(t,e){var i=gu([],this.MULTIPOLYGON_PARSERS_,t,e,this);if(i)return new Fc(i)},e.prototype.pointMemberParser_=function(t,e){_u(this.POINTMEMBER_PARSERS_,t,e,this)},e.prototype.lineStringMemberParser_=function(t,e){_u(this.LINESTRINGMEMBER_PARSERS_,t,e,this)},e.prototype.polygonMemberParser_=function(t,e){_u(this.POLYGONMEMBER_PARSERS_,t,e,this)},e.prototype.readLineString=function(t,e){var i=this.readFlatCoordinatesFromNode_(t,e);return i?new hr(i,At.XYZ):void 0},e.prototype.readFlatLinearRing_=function(t,e){var i=gu(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this);return i||void 0},e.prototype.readLinearRing=function(t,e){var i=this.readFlatCoordinatesFromNode_(t,e);if(i)return new pi(i,At.XYZ)},e.prototype.readPolygon=function(t,e){var i=gu([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this);if(i&&i[0]){var r,n,o=i[0],s=[o.length];for(r=1,n=i.length;r<n;++r)K(o,i[r]),s.push(o.length);return new Ii(o,At.XYZ,s)}},e.prototype.readFlatCoordinatesFromNode_=function(t,e){return gu(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},e.prototype.readGeometryFromNode=function(t,e){var i=this.readGeometryElement(t,[this.getReadOptions(t,e||{})]);return i||null},e.prototype.readFeaturesFromNode=function(t,e){var i={featureType:this.featureType,featureNS:this.featureNS};return e&&u(i,this.getReadOptions(t,e)),this.readFeaturesInternal(t,[i])||[]},e.prototype.readProjectionFromNode=function(t){return Ee(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))},e}(Td);wd.prototype.namespace=Cd,wd.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},wd.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},wd.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},wd.prototype.MULTIPOINT_PARSERS_={"http://www.opengis.net/gml":{pointMember:ou(wd.prototype.pointMemberParser_),pointMembers:ou(wd.prototype.pointMemberParser_)}},wd.prototype.MULTILINESTRING_PARSERS_={"http://www.opengis.net/gml":{lineStringMember:ou(wd.prototype.lineStringMemberParser_),lineStringMembers:ou(wd.prototype.lineStringMemberParser_)}},wd.prototype.MULTIPOLYGON_PARSERS_={"http://www.opengis.net/gml":{polygonMember:ou(wd.prototype.polygonMemberParser_),polygonMembers:ou(wd.prototype.polygonMemberParser_)}},wd.prototype.POINTMEMBER_PARSERS_={"http://www.opengis.net/gml":{Point:ou(wd.prototype.readFlatCoordinatesFromNode_)}},wd.prototype.LINESTRINGMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:ou(wd.prototype.readLineString)}},wd.prototype.POLYGONMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:ou(wd.prototype.readPolygon)}},wd.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:su(wd.prototype.readFlatLinearRing_)}};var Id=wd;function Ld(t){return Od(eu(t,!1))}function Od(t){var e=/^\s*(true|1)|(false|0)\s*$/.exec(t);return e?void 0!==e[1]||!1:void 0}function Pd(t){var e=eu(t,!1),i=Date.parse(e);return isNaN(i)?void 0:i/1e3}function bd(t){return Md(eu(t,!1))}function Md(t){var e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);return e?parseFloat(e[1]):void 0}function Fd(t){return Ad(eu(t,!1))}function Ad(t){var e=/^\s*(\d+)\s*$/.exec(t);return e?parseInt(e[1],10):void 0}function Nd(t){return eu(t,!1).trim()}function Gd(t,e){jd(t,e?"1":"0")}function Dd(t,e){var i=e.toPrecision();t.appendChild(Ql.createTextNode(i))}function kd(t,e){var i=e.toString();t.appendChild(Ql.createTextNode(i))}function jd(t,e){t.appendChild(Ql.createTextNode(e))}var Ud=Cd+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",Yd={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},Bd=function(t){function e(e){var i=e||{};t.call(this,i),this.surface_=void 0!==i.surface&&i.surface,this.curve_=void 0!==i.curve&&i.curve,this.multiCurve_=void 0===i.multiCurve||i.multiCurve,this.multiSurface_=void 0===i.multiSurface||i.multiSurface,this.schemaLocation=i.schemaLocation?i.schemaLocation:Ud,this.hasZ=void 0!==i.hasZ&&i.hasZ}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readMultiCurve_=function(t,e){var i=gu([],this.MULTICURVE_PARSERS_,t,e,this);return i?new Pc(i):void 0},e.prototype.readMultiSurface_=function(t,e){var i=gu([],this.MULTISURFACE_PARSERS_,t,e,this);if(i)return new Fc(i)},e.prototype.curveMemberParser_=function(t,e){_u(this.CURVEMEMBER_PARSERS_,t,e,this)},e.prototype.surfaceMemberParser_=function(t,e){_u(this.SURFACEMEMBER_PARSERS_,t,e,this)},e.prototype.readPatch_=function(t,e){return gu([null],this.PATCHES_PARSERS_,t,e,this)},e.prototype.readSegment_=function(t,e){return gu([null],this.SEGMENTS_PARSERS_,t,e,this)},e.prototype.readPolygonPatch_=function(t,e){return gu([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this)},e.prototype.readLineStringSegment_=function(t,e){return gu([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},e.prototype.interiorParser_=function(t,e){var i=gu(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)},e.prototype.exteriorParser_=function(t,e){var i=gu(void 0,this.RING_PARSERS,t,e,this);i&&(e[e.length-1][0]=i)},e.prototype.readSurface_=function(t,e){var i=gu([null],this.SURFACE_PARSERS_,t,e,this);if(i&&i[0]){var r,n,o=i[0],s=[o.length];for(r=1,n=i.length;r<n;++r)K(o,i[r]),s.push(o.length);return new Ii(o,At.XYZ,s)}},e.prototype.readCurve_=function(t,e){var i=gu([null],this.CURVE_PARSERS_,t,e,this);return i?new hr(i,At.XYZ):void 0},e.prototype.readEnvelope_=function(t,e){var i=gu([null],this.ENVELOPE_PARSERS_,t,e,this);return lt(i[1][0],i[1][1],i[2][0],i[2][1])},e.prototype.readFlatPos_=function(t,e){for(var i,r=eu(t,!1),n=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,o=[];i=n.exec(r);)o.push(parseFloat(i[1])),r=r.substr(i[0].length);if(""===r){var s,a,h=e[0].srsName,l="enu";if(h)l=Ee(h).getAxisOrientation();if("neu"===l)for(s=0,a=o.length;s<a;s+=3){var u=o[s],p=o[s+1];o[s]=p,o[s+1]=u}var c=o.length;if(2==c&&o.push(0),0!==c)return o}},e.prototype.readFlatPosList_=function(t,e){var i=eu(t,!1).replace(/^\s*|\s*$/g,""),r=e[0],n=r.srsName,o=r.srsDimension,s="enu";n&&(s=Ee(n).getAxisOrientation());var a,h,l,u=i.split(/\s+/),p=2;t.getAttribute("srsDimension")?p=Ad(t.getAttribute("srsDimension")):t.getAttribute("dimension")?p=Ad(t.getAttribute("dimension")):t.parentNode.getAttribute("srsDimension")?p=Ad(t.parentNode.getAttribute("srsDimension")):o&&(p=Ad(o));for(var c=[],d=0,f=u.length;d<f;d+=p)a=parseFloat(u[d]),h=parseFloat(u[d+1]),l=3===p?parseFloat(u[d+2]):0,"en"===s.substr(0,2)?c.push(a,h,l):c.push(h,a,l);return c},e.prototype.writePos_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=n?"3":"2";t.setAttribute("srsDimension",o);var s=r.srsName,a="enu";s&&(a=Ee(s).getAxisOrientation());var h,l=e.getCoordinates();(h="en"===a.substr(0,2)?l[0]+" "+l[1]:l[1]+" "+l[0],n)&&(h+=" "+(l[2]||0));jd(t,h)},e.prototype.getCoords_=function(t,e,i){var r="enu";e&&(r=Ee(e).getAxisOrientation());var n="en"===r.substr(0,2)?t[0]+" "+t[1]:t[1]+" "+t[0];i&&(n+=" "+(t[2]||0));return n},e.prototype.writePosList_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=n?"3":"2";t.setAttribute("srsDimension",o);for(var s,a=r.srsName,h=e.getCoordinates(),l=h.length,u=new Array(l),p=0;p<l;++p)s=h[p],u[p]=this.getCoords_(s,a,n);jd(t,u.join(" "))},e.prototype.writePoint_=function(t,e,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var n=tu(t.namespaceURI,"pos");t.appendChild(n),this.writePos_(n,e,i)},e.prototype.writeEnvelope=function(t,e,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var n=[e[0]+" "+e[1],e[2]+" "+e[3]];vu({node:t},this.ENVELOPE_SERIALIZERS_,cu,n,i,["lowerCorner","upperCorner"],this)},e.prototype.writeLinearRing_=function(t,e,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var n=tu(t.namespaceURI,"posList");t.appendChild(n),this.writePosList_(n,e,i)},e.prototype.RING_NODE_FACTORY_=function(t,e,i){var r=e[e.length-1],n=r.node,o=r.exteriorWritten;return void 0===o&&(r.exteriorWritten=!0),tu(n.namespaceURI,void 0!==o?"interior":"exterior")},e.prototype.writeSurfaceOrPolygon_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=r.srsName;if("PolygonPatch"!==t.nodeName&&o&&t.setAttribute("srsName",o),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){var s=e.getLinearRings();vu({node:t,hasZ:n,srsName:o},this.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,s,i,void 0,this)}else if("Surface"===t.nodeName){var a=tu(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,i)}},e.prototype.writeCurveOrLineString_=function(t,e,i){var r=i[i.length-1].srsName;if("LineStringSegment"!==t.nodeName&&r&&t.setAttribute("srsName",r),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){var n=tu(t.namespaceURI,"posList");t.appendChild(n),this.writePosList_(n,e,i)}else if("Curve"===t.nodeName){var o=tu(t.namespaceURI,"segments");t.appendChild(o),this.writeCurveSegments_(o,e,i)}},e.prototype.writeMultiSurfaceOrPolygon_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=r.srsName,s=r.surface;o&&t.setAttribute("srsName",o);var a=e.getPolygons();vu({node:t,hasZ:n,srsName:o,surface:s},this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},e.prototype.writeMultiPoint_=function(t,e,i){var r=i[i.length-1],n=r.srsName,o=r.hasZ;n&&t.setAttribute("srsName",n);var s=e.getPoints();vu({node:t,hasZ:o,srsName:n},this.POINTMEMBER_SERIALIZERS_,pu("pointMember"),s,i,void 0,this)},e.prototype.writeMultiCurveOrLineString_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=r.srsName,s=r.curve;o&&t.setAttribute("srsName",o);var a=e.getLineStrings();vu({node:t,hasZ:n,srsName:o,curve:s},this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},e.prototype.writeRing_=function(t,e,i){var r=tu(t.namespaceURI,"LinearRing");t.appendChild(r),this.writeLinearRing_(r,e,i)},e.prototype.writeSurfaceOrPolygonMember_=function(t,e,i){var r=this.GEOMETRY_NODE_FACTORY_(e,i);r&&(t.appendChild(r),this.writeSurfaceOrPolygon_(r,e,i))},e.prototype.writePointMember_=function(t,e,i){var r=tu(t.namespaceURI,"Point");t.appendChild(r),this.writePoint_(r,e,i)},e.prototype.writeLineStringOrCurveMember_=function(t,e,i){var r=this.GEOMETRY_NODE_FACTORY_(e,i);r&&(t.appendChild(r),this.writeCurveOrLineString_(r,e,i))},e.prototype.writeSurfacePatches_=function(t,e,i){var r=tu(t.namespaceURI,"PolygonPatch");t.appendChild(r),this.writeSurfaceOrPolygon_(r,e,i)},e.prototype.writeCurveSegments_=function(t,e,i){var r=tu(t.namespaceURI,"LineStringSegment");t.appendChild(r),this.writeCurveOrLineString_(r,e,i)},e.prototype.writeGeometryElement=function(t,e,i){var r,n=i[i.length-1],o=u({},n);o.node=t,r=Array.isArray(e)?n.dataProjection?be(e,n.featureProjection,n.dataProjection):e:dd(e,!0,n),vu(o,this.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[r],i,void 0,this)},e.prototype.writeFeatureElement=function(t,e,i){var r=e.getId();r&&t.setAttribute("fid",r);var n=i[i.length-1],o=n.featureNS,s=e.getGeometryName();n.serializers||(n.serializers={},n.serializers[o]={});var a=e.getProperties(),h=[],l=[];for(var p in a){var c=a[p];null!==c&&(h.push(p),l.push(c),p==s||"function"==typeof c.getSimplifiedGeometry?p in n.serializers[o]||(n.serializers[o][p]=lu(this.writeGeometryElement,this)):p in n.serializers[o]||(n.serializers[o][p]=lu(jd)))}var d=u({},n);d.node=t,vu(d,n.serializers,pu(void 0,o),l,i,h)},e.prototype.writeFeatureMembers_=function(t,e,i){var r=i[i.length-1],n=r.featureType,o=r.featureNS,s={};s[o]={},s[o][n]=lu(this.writeFeatureElement,this);var a=u({},r);a.node=t,vu(a,s,pu(n,o),e,i)},e.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,i){var r=e[e.length-1].node;return tu(this.namespace,Yd[r.nodeName])},e.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,i){var r,n=e[e.length-1],o=n.multiSurface,s=n.surface,a=n.curve,h=n.multiCurve;return Array.isArray(t)?r="Envelope":"MultiPolygon"===(r=t.getType())&&!0===o?r="MultiSurface":"Polygon"===r&&!0===s?r="Surface":"LineString"===r&&!0===a?r="Curve":"MultiLineString"===r&&!0===h&&(r="MultiCurve"),tu(this.namespace,r)},e.prototype.writeGeometryNode=function(t,e){e=this.adaptOptions(e);var i=tu(this.namespace,"geom"),r={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return e&&u(r,e),this.writeGeometryElement(i,t,[r]),i},e.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var i=tu(this.namespace,"featureMembers");i.setAttributeNS($l,"xsi:schemaLocation",this.schemaLocation);var r={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return e&&u(r,e),this.writeFeatureMembers_(i,t,[r]),i},e}(Id);Bd.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:su(Bd.prototype.readFlatPos_),posList:su(Bd.prototype.readFlatPosList_)}},Bd.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:Bd.prototype.interiorParser_,exterior:Bd.prototype.exteriorParser_}},Bd.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:su(Id.prototype.readPoint),MultiPoint:su(Id.prototype.readMultiPoint),LineString:su(Id.prototype.readLineString),MultiLineString:su(Id.prototype.readMultiLineString),LinearRing:su(Id.prototype.readLinearRing),Polygon:su(Id.prototype.readPolygon),MultiPolygon:su(Id.prototype.readMultiPolygon),Surface:su(Bd.prototype.readSurface_),MultiSurface:su(Bd.prototype.readMultiSurface_),Curve:su(Bd.prototype.readCurve_),MultiCurve:su(Bd.prototype.readMultiCurve_),Envelope:su(Bd.prototype.readEnvelope_)}},Bd.prototype.MULTICURVE_PARSERS_={"http://www.opengis.net/gml":{curveMember:ou(Bd.prototype.curveMemberParser_),curveMembers:ou(Bd.prototype.curveMemberParser_)}},Bd.prototype.MULTISURFACE_PARSERS_={"http://www.opengis.net/gml":{surfaceMember:ou(Bd.prototype.surfaceMemberParser_),surfaceMembers:ou(Bd.prototype.surfaceMemberParser_)}},Bd.prototype.CURVEMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:ou(Id.prototype.readLineString),Curve:ou(Bd.prototype.readCurve_)}},Bd.prototype.SURFACEMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:ou(Id.prototype.readPolygon),Surface:ou(Bd.prototype.readSurface_)}},Bd.prototype.SURFACE_PARSERS_={"http://www.opengis.net/gml":{patches:su(Bd.prototype.readPatch_)}},Bd.prototype.CURVE_PARSERS_={"http://www.opengis.net/gml":{segments:su(Bd.prototype.readSegment_)}},Bd.prototype.ENVELOPE_PARSERS_={"http://www.opengis.net/gml":{lowerCorner:ou(Bd.prototype.readFlatPosList_),upperCorner:ou(Bd.prototype.readFlatPosList_)}},Bd.prototype.PATCHES_PARSERS_={"http://www.opengis.net/gml":{PolygonPatch:su(Bd.prototype.readPolygonPatch_)}},Bd.prototype.SEGMENTS_PARSERS_={"http://www.opengis.net/gml":{LineStringSegment:su(Bd.prototype.readLineStringSegment_)}},Bd.prototype.writeFeatures,Bd.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml":{exterior:lu(Bd.prototype.writeRing_),interior:lu(Bd.prototype.writeRing_)}},Bd.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:lu(jd),upperCorner:lu(jd)}},Bd.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:lu(Bd.prototype.writeSurfaceOrPolygonMember_),polygonMember:lu(Bd.prototype.writeSurfaceOrPolygonMember_)}},Bd.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:lu(Bd.prototype.writePointMember_)}},Bd.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:lu(Bd.prototype.writeLineStringOrCurveMember_),curveMember:lu(Bd.prototype.writeLineStringOrCurveMember_)}},Bd.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:lu(Bd.prototype.writeCurveOrLineString_),MultiCurve:lu(Bd.prototype.writeMultiCurveOrLineString_),Point:lu(Bd.prototype.writePoint_),MultiPoint:lu(Bd.prototype.writeMultiPoint_),LineString:lu(Bd.prototype.writeCurveOrLineString_),MultiLineString:lu(Bd.prototype.writeMultiCurveOrLineString_),LinearRing:lu(Bd.prototype.writeLinearRing_),Polygon:lu(Bd.prototype.writeSurfaceOrPolygon_),MultiPolygon:lu(Bd.prototype.writeMultiSurfaceOrPolygon_),Surface:lu(Bd.prototype.writeSurfaceOrPolygon_),MultiSurface:lu(Bd.prototype.writeMultiSurfaceOrPolygon_),Envelope:lu(Bd.prototype.writeEnvelope)}};var Vd=Bd,Xd=Vd;Xd.prototype.writeFeatures,Xd.prototype.writeFeaturesNode;var zd=Xd,Wd=Cd+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",Kd={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},Hd=function(t){function e(e){var i=e||{};t.call(this,i),this.FEATURE_COLLECTION_PARSERS[Cd].featureMember=ou(this.readFeaturesInternal),this.schemaLocation=i.schemaLocation?i.schemaLocation:Wd}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFlatCoordinates_=function(t,e){var i=eu(t,!1).replace(/^\s*|\s*$/g,""),r=e[0].srsName,n="enu";if(r){var o=Ee(r);o&&(n=o.getAxisOrientation())}for(var s=i.trim().split(/\s+/),a=[],h=0,l=s.length;h<l;h++){var u=s[h].split(/,+/),p=parseFloat(u[0]),c=parseFloat(u[1]),d=3===u.length?parseFloat(u[2]):0;"en"===n.substr(0,2)?a.push(p,c,d):a.push(c,p,d)}return a},e.prototype.readBox_=function(t,e){var i=gu([null],this.BOX_PARSERS_,t,e,this);return lt(i[1][0],i[1][1],i[1][3],i[1][4])},e.prototype.innerBoundaryIsParser_=function(t,e){var i=gu(void 0,this.RING_PARSERS,t,e,this);i&&e[e.length-1].push(i)},e.prototype.outerBoundaryIsParser_=function(t,e){var i=gu(void 0,this.RING_PARSERS,t,e,this);i&&(e[e.length-1][0]=i)},e.prototype.GEOMETRY_NODE_FACTORY_=function(t,e,i){var r,n=e[e.length-1],o=n.multiSurface,s=n.surface,a=n.multiCurve;return Array.isArray(t)?r="Envelope":"MultiPolygon"===(r=t.getType())&&!0===o?r="MultiSurface":"Polygon"===r&&!0===s?r="Surface":"MultiLineString"===r&&!0===a&&(r="MultiCurve"),tu("http://www.opengis.net/gml",r)},e.prototype.writeFeatureElement=function(t,e,i){var r=e.getId();r&&t.setAttribute("fid",r);var n=i[i.length-1],o=n.featureNS,s=e.getGeometryName();n.serializers||(n.serializers={},n.serializers[o]={});var a=e.getProperties(),h=[],l=[];for(var p in a){var c=a[p];null!==c&&(h.push(p),l.push(c),p==s||"function"==typeof c.getSimplifiedGeometry?p in n.serializers[o]||(n.serializers[o][p]=lu(this.writeGeometryElement,this)):p in n.serializers[o]||(n.serializers[o][p]=lu(jd)))}var d=u({},n);d.node=t,vu(d,n.serializers,pu(void 0,o),l,i,h)},e.prototype.writeCurveOrLineString_=function(t,e,i){var r=i[i.length-1].srsName;if("LineStringSegment"!==t.nodeName&&r&&t.setAttribute("srsName",r),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){var n=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(n),this.writeCoordinates_(n,e,i)}else if("Curve"===t.nodeName){var o=tu(t.namespaceURI,"segments");t.appendChild(o),this.writeCurveSegments_(o,e,i)}},e.prototype.writeLineStringOrCurveMember_=function(t,e,i){var r=this.GEOMETRY_NODE_FACTORY_(e,i);r&&(t.appendChild(r),this.writeCurveOrLineString_(r,e,i))},e.prototype.writeMultiCurveOrLineString_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=r.srsName,s=r.curve;o&&t.setAttribute("srsName",o);var a=e.getLineStrings();vu({node:t,hasZ:n,srsName:o,curve:s},this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},e.prototype.writeGeometryElement=function(t,e,i){var r,n=i[i.length-1],o=u({},n);o.node=t,r=Array.isArray(e)?n.dataProjection?be(e,n.featureProjection,n.dataProjection):e:dd(e,!0,n),vu(o,this.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[r],i,void 0,this)},e.prototype.createCoordinatesNode_=function(t){var e=tu(t,"coordinates");return e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," "),e},e.prototype.writeCoordinates_=function(t,e,i){for(var r=i[i.length-1],n=r.hasZ,o=r.srsName,s=e.getCoordinates(),a=s.length,h=new Array(a),l=0;l<a;++l){var u=s[l];h[l]=this.getCoords_(u,o,n)}jd(t,h.join(" "))},e.prototype.writeCurveSegments_=function(t,e,i){var r=tu(t.namespaceURI,"LineStringSegment");t.appendChild(r),this.writeCurveOrLineString_(r,e,i)},e.prototype.writeSurfaceOrPolygon_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=r.srsName;if("PolygonPatch"!==t.nodeName&&o&&t.setAttribute("srsName",o),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){var s=e.getLinearRings();vu({node:t,hasZ:n,srsName:o},this.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,s,i,void 0,this)}else if("Surface"===t.nodeName){var a=tu(t.namespaceURI,"patches");t.appendChild(a),this.writeSurfacePatches_(a,e,i)}},e.prototype.RING_NODE_FACTORY_=function(t,e,i){var r=e[e.length-1],n=r.node,o=r.exteriorWritten;return void 0===o&&(r.exteriorWritten=!0),tu(n.namespaceURI,void 0!==o?"innerBoundaryIs":"outerBoundaryIs")},e.prototype.writeSurfacePatches_=function(t,e,i){var r=tu(t.namespaceURI,"PolygonPatch");t.appendChild(r),this.writeSurfaceOrPolygon_(r,e,i)},e.prototype.writeRing_=function(t,e,i){var r=tu(t.namespaceURI,"LinearRing");t.appendChild(r),this.writeLinearRing_(r,e,i)},e.prototype.getCoords_=function(t,e,i){var r="enu";e&&(r=Ee(e).getAxisOrientation());var n="en"===r.substr(0,2)?t[0]+","+t[1]:t[1]+","+t[0];i&&(n+=","+(t[2]||0));return n},e.prototype.writePoint_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=r.srsName;o&&t.setAttribute("srsName",o);var s=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(s);var a=e.getCoordinates();jd(s,this.getCoords_(a,o,n))},e.prototype.writeMultiPoint_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=r.srsName;o&&t.setAttribute("srsName",o);var s=e.getPoints();vu({node:t,hasZ:n,srsName:o},this.POINTMEMBER_SERIALIZERS_,pu("pointMember"),s,i,void 0,this)},e.prototype.writePointMember_=function(t,e,i){var r=tu(t.namespaceURI,"Point");t.appendChild(r),this.writePoint_(r,e,i)},e.prototype.writeLinearRing_=function(t,e,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var n=this.createCoordinatesNode_(t.namespaceURI);t.appendChild(n),this.writeCoordinates_(n,e,i)},e.prototype.writeMultiSurfaceOrPolygon_=function(t,e,i){var r=i[i.length-1],n=r.hasZ,o=r.srsName,s=r.surface;o&&t.setAttribute("srsName",o);var a=e.getPolygons();vu({node:t,hasZ:n,srsName:o,surface:s},this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,i,void 0,this)},e.prototype.writeSurfaceOrPolygonMember_=function(t,e,i){var r=this.GEOMETRY_NODE_FACTORY_(e,i);r&&(t.appendChild(r),this.writeSurfaceOrPolygon_(r,e,i))},e.prototype.writeEnvelope=function(t,e,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var n=[e[0]+" "+e[1],e[2]+" "+e[3]];vu({node:t},this.ENVELOPE_SERIALIZERS_,cu,n,i,["lowerCorner","upperCorner"],this)},e.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(t,e,i){var r=e[e.length-1].node;return tu("http://www.opengis.net/gml",Kd[r.nodeName])},e}(Id);Hd.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:su(Hd.prototype.readFlatCoordinates_)}},Hd.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:Hd.prototype.innerBoundaryIsParser_,outerBoundaryIs:Hd.prototype.outerBoundaryIsParser_}},Hd.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:ou(Hd.prototype.readFlatCoordinates_)}},Hd.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:su(Id.prototype.readPoint),MultiPoint:su(Id.prototype.readMultiPoint),LineString:su(Id.prototype.readLineString),MultiLineString:su(Id.prototype.readMultiLineString),LinearRing:su(Id.prototype.readLinearRing),Polygon:su(Id.prototype.readPolygon),MultiPolygon:su(Id.prototype.readMultiPolygon),Box:su(Hd.prototype.readBox_)}},Hd.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:lu(Hd.prototype.writeCurveOrLineString_),MultiCurve:lu(Hd.prototype.writeMultiCurveOrLineString_),Point:lu(Hd.prototype.writePoint_),MultiPoint:lu(Hd.prototype.writeMultiPoint_),LineString:lu(Hd.prototype.writeCurveOrLineString_),MultiLineString:lu(Hd.prototype.writeMultiCurveOrLineString_),LinearRing:lu(Hd.prototype.writeLinearRing_),Polygon:lu(Hd.prototype.writeSurfaceOrPolygon_),MultiPolygon:lu(Hd.prototype.writeMultiSurfaceOrPolygon_),Surface:lu(Hd.prototype.writeSurfaceOrPolygon_),MultiSurface:lu(Hd.prototype.writeMultiSurfaceOrPolygon_),Envelope:lu(Hd.prototype.writeEnvelope)}},Hd.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:lu(Hd.prototype.writeLineStringOrCurveMember_),curveMember:lu(Hd.prototype.writeLineStringOrCurveMember_)}},Hd.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml":{outerBoundaryIs:lu(Hd.prototype.writeRing_),innerBoundaryIs:lu(Hd.prototype.writeRing_)}},Hd.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:lu(Hd.prototype.writePointMember_)}},Hd.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:lu(Hd.prototype.writeSurfaceOrPolygonMember_),polygonMember:lu(Hd.prototype.writeSurfaceOrPolygonMember_)}},Hd.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:lu(jd),upperCorner:lu(jd)}};var Zd=Hd,qd=function(t){function e(e){var i=e||{};t.call(this,i),this.schemaLocation=i.schemaLocation?i.schemaLocation:this.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Vd);qd.prototype.namespace="http://www.opengis.net/gml/3.2",qd.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:su(Vd.prototype.readFlatPos_),posList:su(Vd.prototype.readFlatPosList_)}},qd.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:Vd.prototype.interiorParser_,exterior:Vd.prototype.exteriorParser_}},qd.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:su(Id.prototype.readPoint),MultiPoint:su(Id.prototype.readMultiPoint),LineString:su(Id.prototype.readLineString),MultiLineString:su(Id.prototype.readMultiLineString),LinearRing:su(Id.prototype.readLinearRing),Polygon:su(Id.prototype.readPolygon),MultiPolygon:su(Id.prototype.readMultiPolygon),Surface:su(qd.prototype.readSurface_),MultiSurface:su(Vd.prototype.readMultiSurface_),Curve:su(qd.prototype.readCurve_),MultiCurve:su(Vd.prototype.readMultiCurve_),Envelope:su(qd.prototype.readEnvelope_)}},qd.prototype.MULTICURVE_PARSERS_={"http://www.opengis.net/gml/3.2":{curveMember:ou(Vd.prototype.curveMemberParser_),curveMembers:ou(Vd.prototype.curveMemberParser_)}},qd.prototype.MULTISURFACE_PARSERS_={"http://www.opengis.net/gml/3.2":{surfaceMember:ou(Vd.prototype.surfaceMemberParser_),surfaceMembers:ou(Vd.prototype.surfaceMemberParser_)}},qd.prototype.CURVEMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{LineString:ou(Id.prototype.readLineString),Curve:ou(Vd.prototype.readCurve_)}},qd.prototype.SURFACEMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{Polygon:ou(Id.prototype.readPolygon),Surface:ou(Vd.prototype.readSurface_)}},qd.prototype.SURFACE_PARSERS_={"http://www.opengis.net/gml/3.2":{patches:su(Vd.prototype.readPatch_)}},qd.prototype.CURVE_PARSERS_={"http://www.opengis.net/gml/3.2":{segments:su(Vd.prototype.readSegment_)}},qd.prototype.ENVELOPE_PARSERS_={"http://www.opengis.net/gml/3.2":{lowerCorner:ou(Vd.prototype.readFlatPosList_),upperCorner:ou(Vd.prototype.readFlatPosList_)}},qd.prototype.PATCHES_PARSERS_={"http://www.opengis.net/gml/3.2":{PolygonPatch:su(Vd.prototype.readPolygonPatch_)}},qd.prototype.SEGMENTS_PARSERS_={"http://www.opengis.net/gml/3.2":{LineStringSegment:su(Vd.prototype.readLineStringSegment_)}},qd.prototype.MULTIPOINT_PARSERS_={"http://www.opengis.net/gml/3.2":{pointMember:ou(Id.prototype.pointMemberParser_),pointMembers:ou(Id.prototype.pointMemberParser_)}},qd.prototype.MULTILINESTRING_PARSERS_={"http://www.opengis.net/gml/3.2":{lineStringMember:ou(Id.prototype.lineStringMemberParser_),lineStringMembers:ou(Id.prototype.lineStringMemberParser_)}},qd.prototype.MULTIPOLYGON_PARSERS_={"http://www.opengis.net/gml/3.2":{polygonMember:ou(Id.prototype.polygonMemberParser_),polygonMembers:ou(Id.prototype.polygonMemberParser_)}},qd.prototype.POINTMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{Point:ou(Id.prototype.readFlatCoordinatesFromNode_)}},qd.prototype.LINESTRINGMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{LineString:ou(Id.prototype.readLineString)}},qd.prototype.POLYGONMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{Polygon:ou(Id.prototype.readPolygon)}},qd.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:su(Id.prototype.readFlatLinearRing_)}},qd.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{exterior:lu(Vd.prototype.writeRing_),interior:lu(Vd.prototype.writeRing_)}},qd.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{lowerCorner:lu(jd),upperCorner:lu(jd)}},qd.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{surfaceMember:lu(Vd.prototype.writeSurfaceOrPolygonMember_),polygonMember:lu(Vd.prototype.writeSurfaceOrPolygonMember_)}},qd.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{pointMember:lu(Vd.prototype.writePointMember_)}},qd.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{lineStringMember:lu(Vd.prototype.writeLineStringOrCurveMember_),curveMember:lu(Vd.prototype.writeLineStringOrCurveMember_)}},qd.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{Curve:lu(Vd.prototype.writeCurveOrLineString_),MultiCurve:lu(Vd.prototype.writeMultiCurveOrLineString_),Point:lu(qd.prototype.writePoint_),MultiPoint:lu(Vd.prototype.writeMultiPoint_),LineString:lu(Vd.prototype.writeCurveOrLineString_),MultiLineString:lu(Vd.prototype.writeMultiCurveOrLineString_),LinearRing:lu(Vd.prototype.writeLinearRing_),Polygon:lu(Vd.prototype.writeSurfaceOrPolygon_),MultiPolygon:lu(Vd.prototype.writeMultiSurfaceOrPolygon_),Surface:lu(Vd.prototype.writeSurfaceOrPolygon_),MultiSurface:lu(Vd.prototype.writeMultiSurfaceOrPolygon_),Envelope:lu(Vd.prototype.writeEnvelope)}};var Jd=qd,Qd=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],$d={rte:Lf,trk:Of,wpt:Pf},tf=fu(Qd,{rte:ou(Lf),trk:ou(Of),wpt:ou(Pf)}),ef=fu(Qd,{text:hu(Nd,"linkText"),type:hu(Nd,"linkType")}),rf=fu(Qd,{rte:lu(function(t,e,i){var r=i[0],n=e.getProperties(),o={node:t};o.properties=n;var s=e.getGeometry();if(s.getType()==Nt.LINE_STRING){var a=dd(s,!0,r);o.geometryLayout=a.getLayout(),n.rtept=a.getCoordinates()}var h=i[i.length-1].node,l=df[h.namespaceURI],u=du(n,l);vu(o,ff,cu,u,i,l)}),trk:lu(function(t,e,i){var r=i[0],n=e.getProperties(),o={node:t};o.properties=n;var s=e.getGeometry();if(s.getType()==Nt.MULTI_LINE_STRING){var a=dd(s,!0,r);n.trkseg=a.getLineStrings()}var h=i[i.length-1].node,l=gf[h.namespaceURI],u=du(n,l);vu(o,yf,cu,u,i,l)}),wpt:lu(function(t,e,i){var r=i[0],n=i[i.length-1];n.properties=e.getProperties();var o=e.getGeometry();if(o.getType()==Nt.POINT){var s=dd(o,!0,r);n.geometryLayout=s.getLayout(),Mf(t,s.getCoordinates(),i)}})}),nf=function(t){function e(e){t.call(this);var i=e||{};this.dataProjection=Ee("EPSG:4326"),this.readExtensions_=i.readExtensions}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleReadExtensions_=function(t){t||(t=[]);for(var e=0,i=t.length;e<i;++e){var r=t[e];if(this.readExtensions_){var n=r.get("extensionsNode_")||null;this.readExtensions_(r,n)}r.set("extensionsNode_",void 0)}},e.prototype.readFeatureFromNode=function(t,e){if(!X(Qd,t.namespaceURI))return null;var i=$d[t.localName];if(!i)return null;var r=i(t,[this.getReadOptions(t,e)]);return r?(this.handleReadExtensions_([r]),r):null},e.prototype.readFeaturesFromNode=function(t,e){if(!X(Qd,t.namespaceURI))return[];if("gpx"==t.localName){var i=gu([],tf,t,[this.getReadOptions(t,e)]);return i?(this.handleReadExtensions_(i),i):[]}return[]},e.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var i=tu("http://www.topografix.com/GPX/1/1","gpx");return i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",$l),i.setAttributeNS($l,"xsi:schemaLocation","http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"),i.setAttribute("version","1.1"),i.setAttribute("creator","OpenLayers"),vu({node:i},rf,Tf,t,[e]),i},e}(Td),of=fu(Qd,{name:hu(Nd),cmt:hu(Nd),desc:hu(Nd),src:hu(Nd),link:wf,number:hu(Fd),extensions:If,type:hu(Nd),rtept:function(t,e){var i=gu({},sf,t,e);if(i){var r=e[e.length-1],n=r.flatCoordinates,o=r.layoutOptions;Cf(n,o,t,i)}}}),sf=fu(Qd,{ele:hu(bd),time:hu(Pd)}),af=fu(Qd,{name:hu(Nd),cmt:hu(Nd),desc:hu(Nd),src:hu(Nd),link:wf,number:hu(Fd),type:hu(Nd),extensions:If,trkseg:function(t,e){var i=e[e.length-1];_u(hf,t,e);var r=i.flatCoordinates;i.ends.push(r.length)}}),hf=fu(Qd,{trkpt:function(t,e){var i=gu({},lf,t,e);if(i){var r=e[e.length-1],n=r.flatCoordinates,o=r.layoutOptions;Cf(n,o,t,i)}}}),lf=fu(Qd,{ele:hu(bd),time:hu(Pd)}),uf=fu(Qd,{ele:hu(bd),time:hu(Pd),magvar:hu(bd),geoidheight:hu(bd),name:hu(Nd),cmt:hu(Nd),desc:hu(Nd),src:hu(Nd),link:wf,sym:hu(Nd),type:hu(Nd),fix:hu(Nd),sat:hu(Fd),hdop:hu(bd),vdop:hu(bd),pdop:hu(bd),ageofdgpsdata:hu(bd),dgpsid:hu(Fd),extensions:If}),pf=["text","type"],cf=fu(Qd,{text:lu(jd),type:lu(jd)}),df=fu(Qd,["name","cmt","desc","src","link","number","type","rtept"]),ff=fu(Qd,{name:lu(jd),cmt:lu(jd),desc:lu(jd),src:lu(jd),link:lu(bf),number:lu(kd),type:lu(jd),rtept:uu(lu(Mf))}),_f=fu(Qd,["ele","time"]),gf=fu(Qd,["name","cmt","desc","src","link","number","type","trkseg"]),yf=fu(Qd,{name:lu(jd),cmt:lu(jd),desc:lu(jd),src:lu(jd),link:lu(bf),number:lu(kd),type:lu(jd),trkseg:uu(lu(function(t,e,i){var r={node:t};r.geometryLayout=e.getLayout(),r.properties={},vu(r,mf,vf,e.getCoordinates(),i)}))}),vf=pu("trkpt"),mf=fu(Qd,{trkpt:lu(Mf)}),xf=fu(Qd,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Ef=fu(Qd,{ele:lu(Dd),time:lu(function(t,e){var i=new Date(1e3*e),r=i.getUTCFullYear()+"-"+Wi(i.getUTCMonth()+1,2)+"-"+Wi(i.getUTCDate(),2)+"T"+Wi(i.getUTCHours(),2)+":"+Wi(i.getUTCMinutes(),2)+":"+Wi(i.getUTCSeconds(),2)+"Z";t.appendChild(Ql.createTextNode(r))}),magvar:lu(Dd),geoidheight:lu(Dd),name:lu(jd),cmt:lu(jd),desc:lu(jd),src:lu(jd),link:lu(bf),sym:lu(jd),type:lu(jd),fix:lu(jd),sat:lu(kd),hdop:lu(Dd),vdop:lu(Dd),pdop:lu(Dd),ageofdgpsdata:lu(Dd),dgpsid:lu(kd)}),Sf={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Tf(t,e,i){var r=t.getGeometry();if(r){var n=Sf[r.getType()];if(n)return tu(e[e.length-1].node.namespaceURI,n)}}function Cf(t,e,i,r){return t.push(parseFloat(i.getAttribute("lon")),parseFloat(i.getAttribute("lat"))),"ele"in r?(t.push(r.ele),delete r.ele,e.hasZ=!0):t.push(0),"time"in r?(t.push(r.time),delete r.time,e.hasM=!0):t.push(0),t}function Rf(t,e,i){var r=At.XY,n=2;if(t.hasZ&&t.hasM?(r=At.XYZM,n=4):t.hasZ?(r=At.XYZ,n=3):t.hasM&&(r=At.XYM,n=3),4!==n){for(var o=0,s=e.length/4;o<s;o++)e[o*n]=e[4*o],e[o*n+1]=e[4*o+1],t.hasZ&&(e[o*n+2]=e[4*o+2]),t.hasM&&(e[o*n+2]=e[4*o+3]);if(e.length=e.length/4*n,i)for(var a=0,h=i.length;a<h;a++)i[a]=i[a]/4*n}return r}function wf(t,e){var i=e[e.length-1],r=t.getAttribute("href");null!==r&&(i.link=r),_u(ef,t,e)}function If(t,e){e[e.length-1].extensionsNode_=t}function Lf(t,e){var i=e[0],r=gu({flatCoordinates:[],layoutOptions:{}},of,t,e);if(r){var n=r.flatCoordinates;delete r.flatCoordinates;var o=r.layoutOptions;delete r.layoutOptions;var s=Rf(o,n),a=new hr(n,s);dd(a,!1,i);var h=new B(a);return h.setProperties(r),h}}function Of(t,e){var i=e[0],r=gu({flatCoordinates:[],ends:[],layoutOptions:{}},af,t,e);if(r){var n=r.flatCoordinates;delete r.flatCoordinates;var o=r.ends;delete r.ends;var s=r.layoutOptions;delete r.layoutOptions;var a=Rf(s,n,o),h=new Pc(n,a,o);dd(h,!1,i);var l=new B(h);return l.setProperties(r),l}}function Pf(t,e){var i=e[0],r=gu({},uf,t,e);if(r){var n={},o=Cf([],n,t,r),s=Rf(n,o),a=new ci(o,s);dd(a,!1,i);var h=new B(a);return h.setProperties(r),h}}function bf(t,e,i){t.setAttribute("href",e);var r=i[i.length-1].properties,n=[r.linkText,r.linkType];vu({node:t},cf,cu,n,i,pf)}function Mf(t,e,i){var r=i[i.length-1],n=r.node.namespaceURI,o=r.properties;switch(t.setAttributeNS(null,"lat",String(e[1])),t.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case At.XYZM:0!==e[3]&&(o.time=e[3]);case At.XYZ:0!==e[2]&&(o.ele=e[2]);break;case At.XYM:0!==e[2]&&(o.time=e[2])}var s="rtept"==t.nodeName?_f[n]:xf[n],a=du(o,s);vu({node:t,properties:o},Ef,cu,a,i,s)}var Ff=nf;function Af(t,e){if(!t)return null;var i;switch(t.type){case Nt.POINT:i=function(t){return new ci(t.coordinates)}(t);break;case Nt.LINE_STRING:i=function(t){return new hr(t.coordinates)}(t);break;case Nt.POLYGON:i=function(t){return new Ii(t.coordinates)}(t);break;case Nt.MULTI_POINT:i=function(t){return new bc(t.coordinates)}(t);break;case Nt.MULTI_LINE_STRING:i=function(t){return new Pc(t.coordinates)}(t);break;case Nt.MULTI_POLYGON:i=function(t){return new Fc(t.coordinates)}(t);break;case Nt.GEOMETRY_COLLECTION:i=function(t,e){var i=t.geometries.map(function(t){return Af(t,e)});return new ud(i)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return dd(i,!1,e)}function Nf(t,e){var i,r=(t=dd(t,!0,e)).getType();switch(r){case Nt.POINT:i=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case Nt.LINE_STRING:i=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case Nt.POLYGON:i=function(t,e){var i;e&&(i=e.rightHanded);return{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,e);break;case Nt.MULTI_POINT:i=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case Nt.MULTI_LINE_STRING:i=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case Nt.MULTI_POLYGON:i=function(t,e){var i;e&&(i=e.rightHanded);return{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,e);break;case Nt.GEOMETRY_COLLECTION:i=function(t,e){return{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(t){var i=u({},e);return delete i.featureProjection,Nf(t,i)})}}(t,e);break;case Nt.CIRCLE:i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+r)}return i}var Gf=function(t){function e(e){var i=e||{};t.call(this),this.dataProjection=Ee(i.dataProjection?i.dataProjection:"EPSG:4326"),i.featureProjection&&(this.defaultFeatureProjection=Ee(i.featureProjection)),this.geometryName_=i.geometryName,this.extractGeometryName_=i.extractGeometryName}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFeatureFromObject=function(t,e){var i=null,r=Af((i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null}).geometry,e),n=new B;return this.geometryName_?n.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&n.setGeometryName(i.geometry_name),n.setGeometry(r),"id"in i&&n.setId(i.id),i.properties&&n.setProperties(i.properties),n},e.prototype.readFeaturesFromObject=function(t,e){var i=null;if("FeatureCollection"===t.type){i=[];for(var r=t.features,n=0,o=r.length;n<o;++n)i.push(this.readFeatureFromObject(r[n],e))}else i=[this.readFeatureFromObject(t,e)];return i},e.prototype.readGeometryFromObject=function(t,e){return Af(t,e)},e.prototype.readProjectionFromObject=function(t){var e,i=t.crs;return i?"name"==i.type?e=Ee(i.properties.name):Y(!1,36):e=this.dataProjection,e},e.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var i={type:"Feature",geometry:null,properties:null},r=t.getId();void 0!==r&&(i.id=r);var n=t.getGeometry();n&&(i.geometry=Nf(n,e));var o=t.getProperties();return delete o[t.getGeometryName()],d(o)||(i.properties=o),i},e.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var i=[],r=0,n=t.length;r<n;++r)i.push(this.writeFeatureObject(t[r],e));return{type:"FeatureCollection",features:i}},e.prototype.writeGeometryObject=function(t,e){return Nf(t,this.adaptOptions(e))},e}(_d);function Df(t){return"string"==typeof t?t:""}var kf,jf,Uf,Yf,Bf,Vf,Xf,zf=function(t){function e(){t.call(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return Hl.TEXT},e.prototype.readFeature=function(t,e){return this.readFeatureFromText(Df(t),this.adaptOptions(e))},e.prototype.readFeatureFromText=function(t,e){return r()},e.prototype.readFeatures=function(t,e){return this.readFeaturesFromText(Df(t),this.adaptOptions(e))},e.prototype.readFeaturesFromText=function(t,e){return r()},e.prototype.readGeometry=function(t,e){return this.readGeometryFromText(Df(t),this.adaptOptions(e))},e.prototype.readGeometryFromText=function(t,e){return r()},e.prototype.readProjection=function(t){return this.readProjectionFromText(Df(t))},e.prototype.readProjectionFromText=function(t){return this.dataProjection},e.prototype.writeFeature=function(t,e){return this.writeFeatureText(t,this.adaptOptions(e))},e.prototype.writeFeatureText=function(t,e){return r()},e.prototype.writeFeatures=function(t,e){return this.writeFeaturesText(t,this.adaptOptions(e))},e.prototype.writeFeaturesText=function(t,e){return r()},e.prototype.writeGeometry=function(t,e){return this.writeGeometryText(t,this.adaptOptions(e))},e.prototype.writeGeometryText=function(t,e){return r()},e}(cd),Wf={BAROMETRIC:"barometric",GPS:"gps",NONE:"none"},Kf=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,Hf=/^H.([A-Z]{3}).*?:(.*)/,Zf=/^HFDTE(\d{2})(\d{2})(\d{2})/,qf=/\r\n|\r|\n/,Jf=function(t){function e(e){t.call(this);var i=e||{};this.dataProjection=Ee("EPSG:4326"),this.altitudeMode_=i.altitudeMode?i.altitudeMode:Wf.NONE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFeatureFromText=function(t,e){var i,r,n=this.altitudeMode_,o=t.split(qf),s={},a=[],h=2e3,l=0,u=1,p=-1;for(i=0,r=o.length;i<r;++i){var c=o[i],d=void 0;if("B"==c.charAt(0)){if(d=Kf.exec(c)){var f=parseInt(d[1],10),_=parseInt(d[2],10),g=parseInt(d[3],10),y=parseInt(d[4],10)+parseInt(d[5],10)/6e4;"S"==d[6]&&(y=-y);var v=parseInt(d[7],10)+parseInt(d[8],10)/6e4;if("W"==d[9]&&(v=-v),a.push(v,y),n!=Wf.NONE){var m=void 0;m=n==Wf.GPS?parseInt(d[11],10):n==Wf.BAROMETRIC?parseInt(d[12],10):0,a.push(m)}var x=Date.UTC(h,l,u,f,_,g);x<p&&(x=Date.UTC(h,l,u+1,f,_,g)),a.push(x/1e3),p=x}}else"H"==c.charAt(0)&&((d=Zf.exec(c))?(u=parseInt(d[1],10),l=parseInt(d[2],10)-1,h=2e3+parseInt(d[3],10)):(d=Hf.exec(c))&&(s[d[1]]=d[2].trim()))}if(0===a.length)return null;var E=n==Wf.NONE?At.XYM:At.XYZM,S=new hr(a,E),T=new B(dd(S,!1,e));return T.setProperties(s),T},e.prototype.readFeaturesFromText=function(t,e){var i=this.readFeatureFromText(t,e);return i?[i]:[]},e}(zf),Qf=["http://www.google.com/kml/ext/2.2"],$f=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],t_={fraction:wu.FRACTION,pixels:wu.PIXELS,insetPixels:wu.PIXELS},e_=fu($f,{ExtendedData:H_,Region:Z_,MultiGeometry:hu(j_,"geometry"),LineString:hu(G_,"geometry"),LinearRing:hu(D_,"geometry"),Point:hu(U_,"geometry"),Polygon:hu(B_,"geometry"),Style:hu(X_),StyleMap:function(t,e){var i=S_(t,e);if(!i)return;var r=e[e.length-1];Array.isArray(i)?r.Style=i:"string"==typeof i?r.styleUrl=i:Y(!1,38)},address:hu(Nd),description:hu(Nd),name:hu(Nd),open:hu(Ld),phoneNumber:hu(Nd),styleUrl:hu(m_),visibility:hu(Ld)},fu(Qf,{MultiTrack:hu(function(t,e){var i=gu([],O_,t,e);if(!i)return;return new Pc(i)},"geometry"),Track:hu(b_,"geometry")})),i_=fu($f,{ExtendedData:H_,Region:Z_,Link:function(t,e){_u(r_,t,e)},address:hu(Nd),description:hu(Nd),name:hu(Nd),open:hu(Ld),phoneNumber:hu(Nd),visibility:hu(Ld)}),r_=fu($f,{href:hu(m_)}),n_=fu($f,{LatLonAltBox:function(t,e){var i=gu({},Q_,t,e);if(!i)return;var r=e[e.length-1],n=[parseFloat(i.west),parseFloat(i.south),parseFloat(i.east),parseFloat(i.north)];r.extent=n,r.altitudeMode=i.altitudeMode,r.minAltitude=parseFloat(i.minAltitude),r.maxAltitude=parseFloat(i.maxAltitude)},Lod:function(t,e){var i=gu({},$_,t,e);if(!i)return;var r=e[e.length-1];r.minLodPixels=parseFloat(i.minLodPixels),r.maxLodPixels=parseFloat(i.maxLodPixels),r.minFadeExtent=parseFloat(i.minFadeExtent),r.maxFadeExtent=parseFloat(i.maxFadeExtent)}}),o_=fu($f,["Document","Placemark"]),s_=fu($f,{Document:lu(function(t,e,i){vu({node:t},ng,og,e,i,void 0,this)}),Placemark:lu(Og)}),a_=null;var h_,l_=null;var u_,p_=null;var c_=null;var d_=null;var f_=null;var __=function(t){function e(e){t.call(this);var i=e||{};f_||(a_=new mr({color:kf=[255,255,255,1]}),jf=[20,2],Uf=wu.PIXELS,Yf=wu.PIXELS,Bf=[64,64],Vf="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",Xf=.5,l_=new Ou({anchor:jf,anchorOrigin:Lu.BOTTOM_LEFT,anchorXUnits:Uf,anchorYUnits:Yf,crossOrigin:"anonymous",rotation:0,scale:Xf,size:Bf,src:Vf}),h_="NO_IMAGE",p_=new Er({color:kf,width:1}),u_=new Er({color:[51,51,51,1],width:2}),c_=new Rr({font:"bold 16px Helvetica",fill:a_,stroke:u_,scale:.8}),d_=new Nu({fill:a_,image:l_,text:c_,stroke:p_,zIndex:0}),f_=[d_]),this.dataProjection=Ee("EPSG:4326"),this.defaultStyle_=i.defaultStyle?i.defaultStyle:f_,this.extractStyles_=void 0===i.extractStyles||i.extractStyles,this.writeStyles_=void 0===i.writeStyles||i.writeStyles,this.sharedStyles_={},this.showPointNames_=void 0===i.showPointNames||i.showPointNames}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readDocumentOrFolder_=function(t,e){var i=gu([],fu($f,{Document:nu(this.readDocumentOrFolder_,this),Folder:nu(this.readDocumentOrFolder_,this),Placemark:ou(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),t,e,this);return i||void 0},e.prototype.readPlacemark_=function(t,e){var i=gu({geometry:null},e_,t,e);if(i){var r=new B,n=t.getAttribute("id");null!==n&&r.setId(n);var o=e[0],s=i.geometry;if(s&&dd(s,!1,o),r.setGeometry(s),delete i.geometry,this.extractStyles_){var a=function(t,e,i,r,n){return function(o,s){var a,h=n,l="";if(h){var u=o.getGeometry();u&&(h=u.getType()===Nt.POINT)}if(h&&(l=o.get("name"),h=h&&!!l),t)return h?(a=g_(t[0],l),t.concat(a)):t;if(e){var p=function t(e,i,r){return Array.isArray(e)?e:"string"==typeof e?(!(e in r)&&"#"+e in r&&(e="#"+e),t(r[e],i,r)):i}(e,i,r);return h?(a=g_(p[0],l),p.concat(a)):p}return h?(a=g_(i[0],l),i.concat(a)):i}}(i.Style,i.styleUrl,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);r.setStyle(a)}return delete i.Style,r.setProperties(i),r}},e.prototype.readSharedStyle_=function(t,e){var i=t.getAttribute("id");if(null!==i){var r=X_(t,e);if(r){var n,o=t.baseURI;if(o&&"about:blank"!=o||(o=window.location.href),o)n=new URL("#"+i,o).href;else n="#"+i;this.sharedStyles_[n]=r}}},e.prototype.readSharedStyleMap_=function(t,e){var i=t.getAttribute("id");if(null!==i){var r=S_(t,e);if(r){var n,o=t.baseURI;if(o&&"about:blank"!=o||(o=window.location.href),o)n=new URL("#"+i,o).href;else n="#"+i;this.sharedStyles_[n]=r}}},e.prototype.readFeatureFromNode=function(t,e){if(!X($f,t.namespaceURI))return null;var i=this.readPlacemark_(t,[this.getReadOptions(t,e)]);return i||null},e.prototype.readFeaturesFromNode=function(t,e){var i;if(!X($f,t.namespaceURI))return[];var r=t.localName;if("Document"==r||"Folder"==r)return(i=this.readDocumentOrFolder_(t,[this.getReadOptions(t,e)]))||[];if("Placemark"==r){var n=this.readPlacemark_(t,[this.getReadOptions(t,e)]);return n?[n]:[]}if("kml"==r){i=[];for(var o=t.firstElementChild;o;o=o.nextElementSibling){var s=this.readFeaturesFromNode(o,e);s&&K(i,s)}return i}return[]},e.prototype.readName=function(t){if(t){if("string"==typeof t){var e=ru(t);return this.readNameFromDocument(e)}return iu(t)?this.readNameFromDocument(t):this.readNameFromNode(t)}},e.prototype.readNameFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE){var i=this.readNameFromNode(e);if(i)return i}},e.prototype.readNameFromNode=function(t){for(var e=t.firstElementChild;e;e=e.nextElementSibling)if(X($f,e.namespaceURI)&&"name"==e.localName)return Nd(e);for(var i=t.firstElementChild;i;i=i.nextElementSibling){var r=i.localName;if(X($f,i.namespaceURI)&&("Document"==r||"Folder"==r||"Placemark"==r||"kml"==r)){var n=this.readNameFromNode(i);if(n)return n}}},e.prototype.readNetworkLinks=function(t){var e=[];if("string"==typeof t){var i=ru(t);K(e,this.readNetworkLinksFromDocument(i))}else iu(t)?K(e,this.readNetworkLinksFromDocument(t)):K(e,this.readNetworkLinksFromNode(t));return e},e.prototype.readNetworkLinksFromDocument=function(t){for(var e=[],i=t.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&K(e,this.readNetworkLinksFromNode(i));return e},e.prototype.readNetworkLinksFromNode=function(t){for(var e=[],i=t.firstElementChild;i;i=i.nextElementSibling)if(X($f,i.namespaceURI)&&"NetworkLink"==i.localName){var r=gu({},i_,i,[]);e.push(r)}for(var n=t.firstElementChild;n;n=n.nextElementSibling){var o=n.localName;!X($f,n.namespaceURI)||"Document"!=o&&"Folder"!=o&&"kml"!=o||K(e,this.readNetworkLinksFromNode(n))}return e},e.prototype.readRegion=function(t){var e=[];if("string"==typeof t){var i=ru(t);K(e,this.readRegionFromDocument(i))}else iu(t)?K(e,this.readRegionFromDocument(t)):K(e,this.readRegionFromNode(t));return e},e.prototype.readRegionFromDocument=function(t){for(var e=[],i=t.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&K(e,this.readRegionFromNode(i));return e},e.prototype.readRegionFromNode=function(t){for(var e=[],i=t.firstElementChild;i;i=i.nextElementSibling)if(X($f,i.namespaceURI)&&"Region"==i.localName){var r=gu({},n_,i,[]);e.push(r)}for(var n=t.firstElementChild;n;n=n.nextElementSibling){var o=n.localName;!X($f,n.namespaceURI)||"Document"!=o&&"Folder"!=o&&"kml"!=o||K(e,this.readRegionFromNode(n))}return e},e.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var i=tu($f[4],"kml"),r="http://www.w3.org/2000/xmlns/";i.setAttributeNS(r,"xmlns:gx",Qf[0]),i.setAttributeNS(r,"xmlns:xsi",$l),i.setAttributeNS($l,"xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd");var n={node:i},o={};t.length>1?o.Document=t:1==t.length&&(o.Placemark=t[0]);var s=o_[i.namespaceURI],a=du(o,s);return vu(n,s_,cu,a,[e],s,this),i},e}(Td);function g_(t,e){var i=null,r=[0,0],n="start";if(t.getImage()){var o=t.getImage().getImageSize();if(null===o&&(o=Bf),2==o.length){var s=t.getImage().getScale();r[0]=s*o[0]/2,r[1]=-s*o[1]/2,n="left"}}if(null!==t.getText()){var a=t.getText();(i=a.clone()).setFont(a.getFont()||c_.getFont()),i.setScale(a.getScale()||c_.getScale()),i.setFill(a.getFill()||c_.getFill()),i.setStroke(a.getStroke()||u_)}else i=c_.clone();return i.setText(e),i.setOffsetX(r[0]),i.setOffsetY(r[1]),i.setTextAlign(n),new Nu({text:i})}function y_(t){var e=eu(t,!1),i=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(i){var r=i[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function v_(t){for(var e,i=eu(t,!1),r=[],n=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i;e=n.exec(i);){var o=parseFloat(e[1]),s=parseFloat(e[2]),a=e[3]?parseFloat(e[3]):0;r.push(o,s,a),i=i.substr(e[0].length)}if(""===i)return r}function m_(t){var e=eu(t,!1).trim(),i=t.baseURI;return i&&"about:blank"!=i||(i=window.location.href),i?new URL(e,i).href:e}function x_(t){return bd(t)}var E_=fu($f,{Pair:function(t,e){var i=gu({},q_,t,e);if(!i)return;var r=i.key;if(r&&"normal"==r){var n=i.styleUrl;n&&(e[e.length-1]=n);var o=i.Style;o&&(e[e.length-1]=o)}}});function S_(t,e){return gu(void 0,E_,t,e)}var T_=fu($f,{Icon:hu(function(t,e){var i=gu({},M_,t,e);return i||null}),heading:hu(bd),hotSpot:hu(function(t){var e,i=t.getAttribute("xunits"),r=t.getAttribute("yunits");return e="insetPixels"!==i?"insetPixels"!==r?Lu.BOTTOM_LEFT:Lu.TOP_LEFT:"insetPixels"!==r?Lu.BOTTOM_RIGHT:Lu.TOP_RIGHT,{x:parseFloat(t.getAttribute("x")),xunits:t_[i],y:parseFloat(t.getAttribute("y")),yunits:t_[r],origin:e}}),scale:hu(x_)});var C_=fu($f,{color:hu(y_),scale:hu(x_)});var R_=fu($f,{color:hu(y_),width:hu(bd)});var w_=fu($f,{color:hu(y_),fill:hu(Ld),outline:hu(Ld)});var I_=fu($f,{coordinates:su(v_)});function L_(t,e){return gu(null,I_,t,e)}var O_=fu(Qf,{Track:ou(b_)});var P_=fu($f,{when:function(t,e){var i=e[e.length-1].whens,r=eu(t,!1),n=Date.parse(r);i.push(isNaN(n)?0:n)}},fu(Qf,{coord:function(t,e){var i=e[e.length-1].flatCoordinates,r=eu(t,!1),n=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(r);if(n){var o=parseFloat(n[1]),s=parseFloat(n[2]),a=parseFloat(n[3]);i.push(o,s,a,0)}else i.push(0,0,0,0)}}));function b_(t,e){var i=gu({flatCoordinates:[],whens:[]},P_,t,e);if(i){for(var r=i.flatCoordinates,n=i.whens,o=0,s=Math.min(r.length,n.length);o<s;++o)r[4*o+3]=n[o];return new hr(r,At.XYZM)}}var M_=fu($f,{href:hu(m_)},fu(Qf,{x:hu(bd),y:hu(bd),w:hu(bd),h:hu(bd)}));var F_=fu($f,{coordinates:su(v_)});function A_(t,e){return gu(null,F_,t,e)}var N_=fu($f,{extrude:hu(Ld),tessellate:hu(Ld),altitudeMode:hu(Nd)});function G_(t,e){var i=gu({},N_,t,e),r=A_(t,e);if(r){var n=new hr(r,At.XYZ);return n.setProperties(i),n}}function D_(t,e){var i=gu({},N_,t,e),r=A_(t,e);if(r){var n=new Ii(r,At.XYZ,[r.length]);return n.setProperties(i),n}}var k_=fu($f,{LineString:ou(G_),LinearRing:ou(D_),MultiGeometry:ou(j_),Point:ou(U_),Polygon:ou(B_)});function j_(t,e){var i,r=gu([],k_,t,e);if(!r)return null;if(0===r.length)return new ud(r);for(var n,o,s=!0,a=r[0].getType(),h=1,l=r.length;h<l;++h)if(r[h].getType()!=a){s=!1;break}if(s)if(a==Nt.POINT){var u=r[0];n=u.getLayout(),o=u.getFlatCoordinates();for(var p=1,c=r.length;p<c;++p)K(o,r[p].getFlatCoordinates());z_(i=new bc(o,n),r)}else a==Nt.LINE_STRING?z_(i=new Pc(r),r):a==Nt.POLYGON?z_(i=new Fc(r),r):a==Nt.GEOMETRY_COLLECTION?i=new ud(r):Y(!1,37);else i=new ud(r);return i}function U_(t,e){var i=gu({},N_,t,e),r=A_(t,e);if(r){var n=new ci(r,At.XYZ);return n.setProperties(i),n}}var Y_=fu($f,{innerBoundaryIs:function(t,e){var i=gu(void 0,tg,t,e);if(i){var r=e[e.length-1];r.push(i)}},outerBoundaryIs:function(t,e){var i=gu(void 0,eg,t,e);if(i){var r=e[e.length-1];r[0]=i}}});function B_(t,e){var i=gu({},N_,t,e),r=gu([null],Y_,t,e);if(r&&r[0]){for(var n=r[0],o=[n.length],s=1,a=r.length;s<a;++s)K(n,r[s]),o.push(n.length);var h=new Ii(n,At.XYZ,o);return h.setProperties(i),h}}var V_=fu($f,{IconStyle:function(t,e){var i=gu({},T_,t,e);if(i){var r,n,o,s,a=e[e.length-1],h="Icon"in i?i.Icon:{},l=!("Icon"in i)||Object.keys(h).length>0,u=h.href;u?r=u:l&&(r=Vf);var p,c=Lu.BOTTOM_LEFT,d=i.hotSpot;d?(n=[d.x,d.y],o=d.xunits,s=d.yunits,c=d.origin):r===Vf?(n=jf,o=Uf,s=Yf):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(r)&&(n=[.5,0],o=wu.FRACTION,s=wu.FRACTION);var f,_=h.x,g=h.y;void 0!==_&&void 0!==g&&(p=[_,g]);var y,v=h.w,m=h.h;void 0!==v&&void 0!==m&&(f=[v,m]);var x=i.heading;void 0!==x&&(y=Vt(x));var E=i.scale;if(l){r==Vf&&(f=Bf,void 0===E&&(E=Xf));var S=new Ou({anchor:n,anchorOrigin:c,anchorXUnits:o,anchorYUnits:s,crossOrigin:"anonymous",offset:p,offsetOrigin:Lu.BOTTOM_LEFT,rotation:y,scale:E,size:f,src:r});a.imageStyle=S}else a.imageStyle=h_}},LabelStyle:function(t,e){var i=gu({},C_,t,e);if(i){var r=e[e.length-1],n=new Rr({fill:new mr({color:"color"in i?i.color:kf}),scale:i.scale});r.textStyle=n}},LineStyle:function(t,e){var i=gu({},R_,t,e);if(i){var r=e[e.length-1],n=new Er({color:"color"in i?i.color:kf,width:"width"in i?i.width:1});r.strokeStyle=n}},PolyStyle:function(t,e){var i=gu({},w_,t,e);if(i){var r=e[e.length-1],n=new mr({color:"color"in i?i.color:kf});r.fillStyle=n;var o=i.fill;void 0!==o&&(r.fill=o);var s=i.outline;void 0!==s&&(r.outline=s)}}});function X_(t,e){var i=gu({},V_,t,e);if(!i)return null;var r,n="fillStyle"in i?i.fillStyle:a_,o=i.fill;void 0===o||o||(n=null),"imageStyle"in i?i.imageStyle!=h_&&(r=i.imageStyle):r=l_;var s="textStyle"in i?i.textStyle:c_,a="strokeStyle"in i?i.strokeStyle:p_,h=i.outline;return void 0===h||h||(a=null),[new Nu({fill:n,image:r,stroke:a,text:s,zIndex:void 0})]}function z_(t,e){var i,r,n,o=e.length,s=new Array(e.length),a=new Array(e.length),h=new Array(e.length);i=r=n=!1;for(var l=0;l<o;++l){var u=e[l];s[l]=u.get("extrude"),a[l]=u.get("tessellate"),h[l]=u.get("altitudeMode"),i=i||void 0!==s[l],r=r||void 0!==a[l],n=n||h[l]}i&&t.set("extrude",s),r&&t.set("tessellate",a),n&&t.set("altitudeMode",h)}var W_=fu($f,{displayName:hu(Nd),value:hu(Nd)});var K_=fu($f,{Data:function(t,e){var i=t.getAttribute("name");_u(W_,t,e);var r=e[e.length-1];null!==i?r[i]=r.value:null!==r.displayName&&(r[r.displayName]=r.value),delete r.value},SchemaData:function(t,e){_u(J_,t,e)}});function H_(t,e){_u(K_,t,e)}function Z_(t,e){_u(n_,t,e)}var q_=fu($f,{Style:hu(X_),key:hu(Nd),styleUrl:hu(m_)});var J_=fu($f,{SimpleData:function(t,e){var i=t.getAttribute("name");if(null!==i){var r=Nd(t),n=e[e.length-1];n[i]=r}}});var Q_=fu($f,{altitudeMode:hu(Nd),minAltitude:hu(bd),maxAltitude:hu(bd),north:hu(bd),south:hu(bd),east:hu(bd),west:hu(bd)});var $_=fu($f,{minLodPixels:hu(bd),maxLodPixels:hu(bd),minFadeExtent:hu(bd),maxFadeExtent:hu(bd)});var tg=fu($f,{LinearRing:su(L_)});var eg=fu($f,{LinearRing:su(L_)});function ig(t,e){for(var i=_r(e),r=[255*(4==i.length?i[3]:1),i[2],i[1],i[0]],n=0;n<4;++n){var o=Math.floor(r[n]).toString(16);r[n]=1==o.length?"0"+o:o}jd(t,r.join(""))}var rg=fu($f,{Data:lu(function(t,e,i){t.setAttribute("name",e.name);var r={node:t},n=e.value;"object"==typeof n?(null!==n&&n.displayName&&vu(r,rg,cu,[n.displayName],i,["displayName"]),null!==n&&n.value&&vu(r,rg,cu,[n.value],i,["value"])):vu(r,rg,cu,[n],i,["value"])}),value:lu(function(t,e){jd(t,e)}),displayName:lu(function(t,e){!function(t,e){t.appendChild(Ql.createCDATASection(e))}(t,e)})});var ng=fu($f,{Placemark:lu(Og)}),og=function(t,e,i){return tu(e[e.length-1].node.namespaceURI,"Placemark")};var sg=pu("Data");var ag=fu($f,["href"],fu(Qf,["x","y","w","h"])),hg=fu($f,{href:lu(jd)},fu(Qf,{x:lu(Dd),y:lu(Dd),w:lu(Dd),h:lu(Dd)})),lg=function(t,e,i){return tu(Qf[0],"gx:"+i)};var ug=fu($f,["scale","heading","Icon","hotSpot"]),pg=fu($f,{Icon:lu(function(t,e,i){var r={node:t},n=i[i.length-1].node,o=ag[n.namespaceURI],s=du(e,o);vu(r,hg,cu,s,i,o),s=du(e,o=ag[Qf[0]]),vu(r,hg,lg,s,i,o)}),heading:lu(Dd),hotSpot:lu(function(t,e){t.setAttribute("x",String(e.x)),t.setAttribute("y",String(e.y)),t.setAttribute("xunits",e.xunits),t.setAttribute("yunits",e.yunits)}),scale:lu(jg)});var cg=fu($f,["color","scale"]),dg=fu($f,{color:lu(ig),scale:lu(jg)});var fg=fu($f,["color","width"]),_g=fu($f,{color:lu(ig),width:lu(Dd)});var gg={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},yg=function(t,e,i){if(t)return tu(e[e.length-1].node.namespaceURI,gg[t.getType()])},vg=pu("Point"),mg=pu("LineString"),xg=pu("LinearRing"),Eg=pu("Polygon"),Sg=fu($f,{LineString:lu(Mg),Point:lu(Mg),Polygon:lu(Gg),GeometryCollection:lu(Tg)});function Tg(t,e,i){var r,n,o={node:t},s=e.getType();s==Nt.GEOMETRY_COLLECTION?(r=e.getGeometries(),n=yg):s==Nt.MULTI_POINT?(r=e.getPoints(),n=vg):s==Nt.MULTI_LINE_STRING?(r=e.getLineStrings(),n=mg):s==Nt.MULTI_POLYGON?(r=e.getPolygons(),n=Eg):Y(!1,39),vu(o,Sg,n,r,i)}var Cg=fu($f,{LinearRing:lu(Mg)});function Rg(t,e,i){vu({node:t},Cg,xg,[e],i)}var wg=fu($f,{ExtendedData:lu(function(t,e,i){for(var r={node:t},n=e.names,o=e.values,s=n.length,a=0;a<s;a++)vu(r,rg,sg,[{name:n[a],value:o[a]}],i)}),MultiGeometry:lu(Tg),LineString:lu(Mg),LinearRing:lu(Mg),Point:lu(Mg),Polygon:lu(Gg),Style:lu(function(t,e,i){var r={node:t},n={},o=e.getFill(),s=e.getStroke(),a=e.getImage(),h=e.getText();a&&"function"==typeof a.getSrc&&(n.IconStyle=a);h&&(n.LabelStyle=h);s&&(n.LineStyle=s);o&&(n.PolyStyle=o);var l=i[i.length-1].node,u=Ug[l.namespaceURI],p=du(n,u);vu(r,Yg,cu,p,i,u)}),address:lu(jd),description:lu(jd),name:lu(jd),open:lu(Gd),phoneNumber:lu(jd),styleUrl:lu(jd),visibility:lu(Gd)}),Ig=fu($f,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),Lg=pu("ExtendedData");function Og(t,e,i){var r={node:t};e.getId()&&t.setAttribute("id",e.getId());var n=e.getProperties(),o={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};o[e.getGeometryName()]=1;var s=Object.keys(n||{}).sort().filter(function(t){return!o[t]});if(s.length>0){var a=du(n,s);vu(r,wg,Lg,[{names:s,values:a}],i)}var h=e.getStyleFunction();if(h){var l=h(e,0);if(l){var u=Array.isArray(l)?l[0]:l;this.writeStyles_&&(n.Style=u);var p=u.getText();p&&(n.name=p.getText())}}var c=i[i.length-1].node,d=Ig[c.namespaceURI],f=du(n,d);vu(r,wg,cu,f,i,d);var _=i[0],g=e.getGeometry();g&&(g=dd(g,!0,_)),vu(r,wg,yg,[g],i)}var Pg=fu($f,["extrude","tessellate","altitudeMode","coordinates"]),bg=fu($f,{extrude:lu(Gd),tessellate:lu(Gd),altitudeMode:lu(jd),coordinates:lu(function(t,e,i){var r,n=i[i.length-1],o=n.layout,s=n.stride;o==At.XY||o==At.XYM?r=2:o==At.XYZ||o==At.XYZM?r=3:Y(!1,34);var a=e.length,h="";if(a>0){h+=e[0];for(var l=1;l<r;++l)h+=","+e[l];for(var u=s;u<a;u+=s){h+=" "+e[u];for(var p=1;p<r;++p)h+=","+e[u+p]}}jd(t,h)})});function Mg(t,e,i){var r=e.getFlatCoordinates(),n={node:t};n.layout=e.getLayout(),n.stride=e.getStride();var o=e.getProperties();o.coordinates=r;var s=i[i.length-1].node,a=Pg[s.namespaceURI],h=du(o,a);vu(n,bg,cu,h,i,a)}var Fg=fu($f,{outerBoundaryIs:lu(Rg),innerBoundaryIs:lu(Rg)}),Ag=pu("innerBoundaryIs"),Ng=pu("outerBoundaryIs");function Gg(t,e,i){var r=e.getLinearRings(),n=r.shift(),o={node:t};vu(o,Fg,Ag,r,i),vu(o,Fg,Ng,[n],i)}var Dg=fu($f,{color:lu(ig)}),kg=pu("color");function jg(t,e){Dd(t,Math.round(1e6*e)/1e6)}var Ug=fu($f,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Yg=fu($f,{IconStyle:lu(function(t,e,i){var r={node:t},n={},o=e.getSrc(),s=e.getSize(),a=e.getImageSize(),h={href:o};if(s){h.w=s[0],h.h=s[1];var l=e.getAnchor(),u=e.getOrigin();if(u&&a&&0!==u[0]&&u[1]!==s[1]&&(h.x=u[0],h.y=a[1]-(u[1]+s[1])),l&&(l[0]!==s[0]/2||l[1]!==s[1]/2)){var p={x:l[0],xunits:wu.PIXELS,y:s[1]-l[1],yunits:wu.PIXELS};n.hotSpot=p}}n.Icon=h;var c=e.getScale();1!==c&&(n.scale=c);var d=e.getRotation();0!==d&&(n.heading=d);var f=i[i.length-1].node,_=ug[f.namespaceURI],g=du(n,_);vu(r,pg,cu,g,i,_)}),LabelStyle:lu(function(t,e,i){var r={node:t},n={},o=e.getFill();o&&(n.color=o.getColor());var s=e.getScale();s&&1!==s&&(n.scale=s);var a=i[i.length-1].node,h=cg[a.namespaceURI],l=du(n,h);vu(r,dg,cu,l,i,h)}),LineStyle:lu(function(t,e,i){var r={node:t},n={color:e.getColor(),width:e.getWidth()},o=i[i.length-1].node,s=fg[o.namespaceURI],a=du(n,s);vu(r,_g,cu,a,i,s)}),PolyStyle:lu(function(t,e,i){vu({node:t},Dg,kg,[e.getColor()],i)})});var Bg=__,Vg=i(1),Xg=i.n(Vg),zg=[1,0,0,1,0,0],Wg=function(t,e,i,r,n){this.extent_,this.id_=n,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=r};Wg.prototype.get=function(t){return this.properties_[t]},Wg.prototype.getExtent=function(){return this.extent_||(this.extent_=this.type_===Nt.POINT?pt(this.flatCoordinates_):ct(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_},Wg.prototype.getFlatInteriorPoint=function(){if(!this.flatInteriorPoints_){var t=Tt(this.getExtent());this.flatInteriorPoints_=gi(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_},Wg.prototype.getFlatInteriorPoints=function(){if(!this.flatInteriorPoints_){var t=Mc(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=yi(this.flatCoordinates_,0,this.ends_,2,t)}return this.flatInteriorPoints_},Wg.prototype.getFlatMidpoint=function(){return this.flatMidpoints_||(this.flatMidpoints_=or(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_},Wg.prototype.getFlatMidpoints=function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var t=this.flatCoordinates_,e=0,i=this.ends_,r=0,n=i.length;r<n;++r){var o=i[r],s=or(t,e,o,2,.5);K(this.flatMidpoints_,s),e=o}}return this.flatMidpoints_},Wg.prototype.getId=function(){return this.id_},Wg.prototype.getOrientedFlatCoordinates=function(){return this.flatCoordinates_},Wg.prototype.getGeometry=function(){return this},Wg.prototype.getSimplifiedGeometry=function(t){return this},Wg.prototype.getProperties=function(){return this.properties_},Wg.prototype.getStride=function(){return 2},Wg.prototype.getStyleFunction=function(){},Wg.prototype.getType=function(){return this.type_},Wg.prototype.transform=function(t,e){var i=(t=Ee(t)).getExtent(),r=t.getWorldExtent(),n=Rt(r)/Rt(i);Ye(zg,r[0],r[3],n,-n,0,0,0),Gt(this.flatCoordinates_,0,this.flatCoordinates_.length,2,zg,this.flatCoordinates_)},Wg.prototype.getEnds=Wg.prototype.getEndss=function(){return this.ends_},Wg.prototype.getFlatCoordinates=Wg.prototype.getOrientedFlatCoordinates;var Kg=Wg;function Hg(t,e,i){if(3===t){var r={keys:[],values:[],features:[]},n=i.readVarint()+i.pos;i.readFields(Zg,r,n),r.length=r.features.length,r.length&&(e[r.name]=r)}}function Zg(t,e,i){if(15===t)e.version=i.readVarint();else if(1===t)e.name=i.readString();else if(5===t)e.extent=i.readVarint();else if(2===t)e.features.push(i.pos);else if(3===t)e.keys.push(i.readString());else if(4===t){for(var r=null,n=i.readVarint()+i.pos;i.pos<n;)r=1===(t=i.readVarint()>>3)?i.readString():2===t?i.readFloat():3===t?i.readDouble():4===t?i.readVarint64():5===t?i.readVarint():6===t?i.readSVarint():7===t?i.readBoolean():null;e.values.push(r)}}function qg(t,e,i){if(1==t)e.id=i.readVarint();else if(2==t)for(var r=i.readVarint()+i.pos;i.pos<r;){var n=e.layer.keys[i.readVarint()],o=e.layer.values[i.readVarint()];e.properties[n]=o}else 3==t?e.type=i.readVarint():4==t&&(e.geometry=i.pos)}function Jg(t,e,i){t.pos=e.features[i];var r=t.readVarint()+t.pos,n={layer:e,type:0,properties:{}};return t.readFields(qg,n,r),n}var Qg=function(t){function e(e){t.call(this);var i=e||{};this.dataProjection=new ee({code:"",units:$t.TILE_PIXELS}),this.featureClass_=i.featureClass?i.featureClass:Kg,this.geometryName_=i.geometryName,this.layerName_=i.layerName?i.layerName:"layer",this.layers_=i.layers?i.layers:null,this.extent_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readRawGeometry_=function(t,e,i,r){t.pos=e.geometry;for(var n=t.readVarint()+t.pos,o=1,s=0,a=0,h=0,l=0,u=0;t.pos<n;){if(!s){var p=t.readVarint();o=7&p,s=p>>3}s--,1===o||2===o?(a+=t.readSVarint(),h+=t.readSVarint(),1===o&&l>u&&(r.push(l),u=l),i.push(a,h),l+=2):7===o?l>u&&(i.push(i[u],i[u+1]),l+=2):Y(!1,59)}l>u&&(r.push(l),u=l)},e.prototype.createFeature_=function(t,e,i){var r,n=e.type;if(0===n)return null;var o=e.id,s=e.properties;s[this.layerName_]=e.layer.name;var a=[],h=[];this.readRawGeometry_(t,e,a,h);var l=function(t,e){var i;1===t?i=1===e?Nt.POINT:Nt.MULTI_POINT:2===t?i=1===e?Nt.LINE_STRING:Nt.MULTI_LINE_STRING:3===t&&(i=Nt.POLYGON);return i}(n,h.length);if(this.featureClass_===Kg)r=new this.featureClass_(l,a,h,s,o);else{var u;if(l==Nt.POLYGON){for(var p=[],c=0,d=0,f=0,_=h.length;f<_;++f){var g=h[f];Si(a,c,g,2)||(p.push(h.slice(d,f)),d=f),c=g}u=p.length>1?new Fc(a,At.XY,p):new Ii(a,At.XY,h)}else u=l===Nt.POINT?new ci(a,At.XY):l===Nt.LINE_STRING?new hr(a,At.XY):l===Nt.POLYGON?new Ii(a,At.XY,h):l===Nt.MULTI_POINT?new bc(a,At.XY):l===Nt.MULTI_LINE_STRING?new Pc(a,At.XY,h):null;r=new(0,this.featureClass_),this.geometryName_&&r.setGeometryName(this.geometryName_);var y=dd(u,!1,this.adaptOptions(i));r.setGeometry(y),r.setId(o),r.setProperties(s)}return r},e.prototype.getLastExtent=function(){return this.extent_},e.prototype.getType=function(){return Hl.ARRAY_BUFFER},e.prototype.readFeatures=function(t,e){var i=this.layers_,r=new Xg.a(t),n=r.readFields(Hg,{}),o=[];for(var s in n)if(!i||-1!=i.indexOf(s)){for(var a=n[s],h=0,l=a.length;h<l;++h){var u=Jg(r,a,h);o.push(this.createFeature_(r,u))}this.extent_=a?[0,0,a.extent,a.extent]:null}return o},e.prototype.readProjection=function(t){return this.dataProjection},e.prototype.setLayers=function(t){this.layers_=t},e}(cd),$g=[null],ty=fu($g,{nd:function(t,e){e[e.length-1].ndrefs.push(t.getAttribute("ref"))},tag:ny}),ey=fu($g,{node:function(t,e){var i=e[0],r=e[e.length-1],n=t.getAttribute("id"),o=[parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))];r.nodes[n]=o;var s=gu({tags:{}},ry,t,e);if(!d(s.tags)){var a=new ci(o);dd(a,!1,i);var h=new B(a);h.setId(n),h.setProperties(s.tags),r.features.push(h)}},way:function(t,e){var i=gu({id:t.getAttribute("id"),ndrefs:[],tags:{}},ty,t,e);e[e.length-1].ways.push(i)}}),iy=function(t){function e(){t.call(this),this.dataProjection=Ee("EPSG:4326")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFeaturesFromNode=function(t,e){var i=this.getReadOptions(t,e);if("osm"==t.localName){for(var r=gu({nodes:{},ways:[],features:[]},ey,t,[i]),n=0;n<r.ways.length;n++){for(var o=r.ways[n],s=[],a=0,h=o.ndrefs.length;a<h;a++){K(s,r.nodes[o.ndrefs[a]])}var l=void 0;dd(l=o.ndrefs[0]==o.ndrefs[o.ndrefs.length-1]?new Ii(s,At.XY,[s.length]):new hr(s,At.XY),!1,i);var u=new B(l);u.setId(o.id),u.setProperties(o.tags),r.features.push(u)}if(r.features)return r.features}return[]},e}(Td),ry=fu($g,{tag:ny});function ny(t,e){e[e.length-1].tags[t.getAttribute("k")]=t.getAttribute("v")}var oy=iy;function sy(t,e,i,r,n,o){var s,a;void 0!==n?(s=n,a=void 0!==o?o:0):(s=[],a=0);for(var h=e;h<i;){var l=t[h++];s[a++]=t[h++],s[a++]=l;for(var u=2;u<r;++u)s[a++]=t[h++]}return s.length=a,s}function ay(t,e,i){var r,n=i||1e5,o=new Array(e);for(r=0;r<e;++r)o[r]=0;for(var s=0,a=t.length;s<a;)for(r=0;r<e;++r,++s){var h=t[s],l=h-o[r];o[r]=h,t[s]=l}return ly(t,n)}function hy(t,e,i){var r,n=i||1e5,o=new Array(e);for(r=0;r<e;++r)o[r]=0;for(var s=uy(t,n),a=0,h=s.length;a<h;)for(r=0;r<e;++r,++a)o[r]+=s[a],s[a]=o[r];return s}function ly(t,e){for(var i=e||1e5,r=0,n=t.length;r<n;++r)t[r]=Math.round(t[r]*i);return function(t){for(var e=0,i=t.length;e<i;++e){var r=t[e];t[e]=r<0?~(r<<1):r<<1}return function(t){for(var e="",i=0,r=t.length;i<r;++i)e+=py(t[i]);return e}(t)}(t)}function uy(t,e){for(var i=e||1e5,r=function(t){for(var e=function(t){for(var e=[],i=0,r=0,n=0,o=t.length;n<o;++n){var s=t.charCodeAt(n)-63;i|=(31&s)<<r,s<32?(e.push(i),i=0,r=0):r+=5}return e}(t),i=0,r=e.length;i<r;++i){var n=e[i];e[i]=1&n?~(n>>1):n>>1}return e}(t),n=0,o=r.length;n<o;++n)r[n]/=i;return r}function py(t){for(var e,i="";t>=32;)e=63+(32|31&t),i+=String.fromCharCode(e),t>>=5;return e=t+63,i+=String.fromCharCode(e)}var cy=function(t){function e(e){t.call(this);var i=e||{};this.dataProjection=Ee("EPSG:4326"),this.factor_=i.factor?i.factor:1e5,this.geometryLayout_=i.geometryLayout?i.geometryLayout:At.XY}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFeatureFromText=function(t,e){var i=this.readGeometryFromText(t,e);return new B(i)},e.prototype.readFeaturesFromText=function(t,e){return[this.readFeatureFromText(t,e)]},e.prototype.readGeometryFromText=function(t,e){var i=ze(this.geometryLayout_),r=hy(t,i,this.factor_);sy(r,0,r.length,i,r);var n=ri(r,0,r.length,i);return dd(new hr(n,this.geometryLayout_),!1,this.adaptOptions(e))},e.prototype.writeFeatureText=function(t,e){var i=t.getGeometry();return i?this.writeGeometryText(i,e):(Y(!1,40),"")},e.prototype.writeFeaturesText=function(t,e){return this.writeFeatureText(t[0],e)},e.prototype.writeGeometryText=function(t,e){var i=(t=dd(t,!0,this.adaptOptions(e))).getFlatCoordinates(),r=t.getStride();return sy(i,0,i.length,r,i),ay(i,r,this.factor_)},e}(zf),dy={Point:function(t,e,i){var r=t.coordinates;e&&i&&vy(r,e,i);return new ci(r)},LineString:function(t,e){var i=fy(t.arcs,e);return new hr(i)},Polygon:function(t,e){for(var i=[],r=0,n=t.arcs.length;r<n;++r)i[r]=fy(t.arcs[r],e);return new Ii(i)},MultiPoint:function(t,e,i){var r=t.coordinates;if(e&&i)for(var n=0,o=r.length;n<o;++n)vy(r[n],e,i);return new bc(r)},MultiLineString:function(t,e){for(var i=[],r=0,n=t.arcs.length;r<n;++r)i[r]=fy(t.arcs[r],e);return new Pc(i)},MultiPolygon:function(t,e){for(var i=[],r=0,n=t.arcs.length;r<n;++r){for(var o=t.arcs[r],s=[],a=0,h=o.length;a<h;++a)s[a]=fy(o[a],e);i[r]=s}return new Fc(i)}};function fy(t,e){for(var i,r,n=[],o=0,s=t.length;o<s;++o)i=t[o],o>0&&n.pop(),r=i>=0?e[i]:e[~i].slice().reverse(),n.push.apply(n,r);for(var a=0,h=n.length;a<h;++a)n[a]=n[a].slice();return n}function _y(t,e,i,r,n,o,s){for(var a=t.geometries,h=[],l=0,u=a.length;l<u;++l)h[l]=gy(a[l],e,i,r,n,o,s);return h}function gy(t,e,i,r,n,o,s){var a,h=t.type,l=dy[h];a="Point"===h||"MultiPoint"===h?l(t,i,r):l(t,e);var u=new B;u.setGeometry(dd(a,!1,s)),void 0!==t.id&&u.setId(t.id);var p=t.properties;return n&&(p||(p={}),p[n]=o),p&&u.setProperties(p),u}function yy(t,e,i){for(var r=0,n=0,o=0,s=t.length;o<s;++o){var a=t[o];r+=a[0],n+=a[1],a[0]=r,a[1]=n,vy(a,e,i)}}function vy(t,e,i){t[0]=t[0]*e[0]+i[0],t[1]=t[1]*e[1]+i[1]}var my=function(t){function e(e){t.call(this);var i=e||{};this.layerName_=i.layerName,this.layers_=i.layers?i.layers:null,this.dataProjection=Ee(i.dataProjection?i.dataProjection:"EPSG:4326")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFeaturesFromObject=function(t,e){if("Topology"==t.type){var i,r=t,n=null,o=null;r.transform&&(n=(i=r.transform).scale,o=i.translate);var s=r.arcs;i&&function(t,e,i){for(var r=0,n=t.length;r<n;++r)yy(t[r],e,i)}(s,n,o);var a,h=[],l=r.objects,u=this.layerName_;for(var p in l)this.layers_&&-1==this.layers_.indexOf(p)||("GeometryCollection"===l[p].type?(a=l[p],h.push.apply(h,_y(a,s,n,o,u,p,e))):(a=l[p],h.push(gy(a,s,n,o,u,p,e))));return h}return[]},e.prototype.readProjectionFromObject=function(t){return this.dataProjection},e}(_d),xy=function(t){this.tagName_=t};xy.prototype.getTagName=function(){return this.tagName_};var Ey=xy,Sy=function(t){function e(e,i){t.call(this,e),this.conditions=i,Y(this.conditions.length>=2,57)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ey),Ty=function(t){function e(e){t.call(this,"And",Array.prototype.slice.call(arguments))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Sy),Cy=function(t){function e(e,i,r){t.call(this,"BBOX"),this.geometryName=e,this.extent=i,this.srsName=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ey),Ry=function(t){function e(e,i,r,n){t.call(this,e),this.geometryName=i||"the_geom",this.geometry=r,this.srsName=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ey),wy=function(t){function e(e,i,r){t.call(this,"Contains",e,i,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ry),Iy=function(t){function e(e,i){t.call(this,e),this.propertyName=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ey),Ly=function(t){function e(e,i,r){t.call(this,"During",e),this.begin=i,this.end=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Iy),Oy=function(t){function e(e,i,r,n){t.call(this,e,i),this.expression=r,this.matchCase=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Iy),Py=function(t){function e(e,i,r){t.call(this,"PropertyIsEqualTo",e,i,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Oy),by=function(t){function e(e,i){t.call(this,"PropertyIsGreaterThan",e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Oy),My=function(t){function e(e,i){t.call(this,"PropertyIsGreaterThanOrEqualTo",e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Oy),Fy=function(t){function e(e,i,r){t.call(this,"Intersects",e,i,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ry),Ay=function(t){function e(e,i,r){t.call(this,"PropertyIsBetween",e),this.lowerBoundary=i,this.upperBoundary=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Iy),Ny=function(t){function e(e,i,r,n,o,s){t.call(this,"PropertyIsLike",e),this.pattern=i,this.wildCard=void 0!==r?r:"*",this.singleChar=void 0!==n?n:".",this.escapeChar=void 0!==o?o:"!",this.matchCase=s}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Iy),Gy=function(t){function e(e){t.call(this,"PropertyIsNull",e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Iy),Dy=function(t){function e(e,i){t.call(this,"PropertyIsLessThan",e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Oy),ky=function(t){function e(e,i){t.call(this,"PropertyIsLessThanOrEqualTo",e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Oy),jy=function(t){function e(e){t.call(this,"Not"),this.condition=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ey),Uy=function(t){function e(e,i,r){t.call(this,"PropertyIsNotEqualTo",e,i,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Oy),Yy=function(t){function e(e){t.call(this,"Or",Array.prototype.slice.call(arguments))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Sy),By=function(t){function e(e,i,r){t.call(this,"Within",e,i,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ry);function Vy(t){var e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Ty,e))}function Xy(t,e,i){return new Cy(t,e,i)}var zy={"http://www.opengis.net/gml":{boundedBy:hu(Id.prototype.readGeometryElement,"bounds")}},Wy={"http://www.opengis.net/wfs":{totalInserted:hu(Fd),totalUpdated:hu(Fd),totalDeleted:hu(Fd)}},Ky={"http://www.opengis.net/wfs":{TransactionSummary:hu(function(t,e){return gu({},Wy,t,e)},"transactionSummary"),InsertResults:hu(function(t,e){return gu([],ov,t,e)},"insertIds")}},Hy={"http://www.opengis.net/wfs":{PropertyName:lu(jd)}},Zy={"http://www.opengis.net/wfs":{Insert:lu(function(t,e,i){var r=i[i.length-1],n=r.featureType,o=r.featureNS,s=r.gmlVersion,a=tu(o,n);t.appendChild(a),2===s?Zd.prototype.writeFeatureElement(a,e,i):Vd.prototype.writeFeatureElement(a,e,i)}),Update:lu(function(t,e,i){var r=i[i.length-1];Y(void 0!==e.getId(),27);var n=r.featureType,o=r.featurePrefix,s=r.featureNS,a=av(o,n),h=e.getGeometryName();t.setAttribute("typeName",a),t.setAttributeNS(Jy,"xmlns:"+o,s);var l=e.getId();if(void 0!==l){for(var u=e.getKeys(),p=[],c=0,d=u.length;c<d;c++){var f=e.get(u[c]);if(void 0!==f){var _=u[c];f&&"function"==typeof f.getSimplifiedGeometry&&(_=h),p.push({name:_,value:f})}}vu({gmlVersion:r.gmlVersion,node:t,hasZ:r.hasZ,srsName:r.srsName},Zy,pu("Property"),p,i),sv(t,l,i)}}),Delete:lu(function(t,e,i){var r=i[i.length-1];Y(void 0!==e.getId(),26);var n=r.featureType,o=r.featurePrefix,s=r.featureNS,a=av(o,n);t.setAttribute("typeName",a),t.setAttributeNS(Jy,"xmlns:"+o,s);var h=e.getId();void 0!==h&&sv(t,h,i)}),Property:lu(function(t,e,i){var r=tu($y,"Name"),n=i[i.length-1].gmlVersion;if(t.appendChild(r),jd(r,e.name),void 0!==e.value&&null!==e.value){var o=tu($y,"Value");t.appendChild(o),e.value&&"function"==typeof e.value.getSimplifiedGeometry?2===n?Zd.prototype.writeGeometryElement(o,e.value,i):Vd.prototype.writeGeometryElement(o,e.value,i):jd(o,e.value)}}),Native:lu(function(t,e,i){e.vendorId&&t.setAttribute("vendorId",e.vendorId);void 0!==e.safeToIgnore&&t.setAttribute("safeToIgnore",String(e.safeToIgnore));void 0!==e.value&&jd(t,e.value)})}},qy="feature",Jy="http://www.w3.org/2000/xmlns/",Qy="http://www.opengis.net/ogc",$y="http://www.opengis.net/wfs",tv="http://www.opengis.net/fes",ev={"1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},iv="1.1.0",rv=function(t){function e(e){t.call(this);var i=e||{};this.featureType_=i.featureType,this.featureNS_=i.featureNS,this.gmlFormat_=i.gmlFormat?i.gmlFormat:new Vd,this.schemaLocation_=i.schemaLocation?i.schemaLocation:ev[iv]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getFeatureType=function(){return this.featureType_},e.prototype.setFeatureType=function(t){this.featureType_=t},e.prototype.readFeaturesFromNode=function(t,e){var i={node:t};u(i,{featureType:this.featureType_,featureNS:this.featureNS_}),u(i,this.getReadOptions(t,e||{}));var r=[i];this.gmlFormat_.FEATURE_COLLECTION_PARSERS[Cd].featureMember=ou(Id.prototype.readFeaturesInternal);var n=gu([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,t,r,this.gmlFormat_);return n||(n=[]),n},e.prototype.readTransactionResponse=function(t){if(t){if("string"==typeof t){var e=ru(t);return this.readTransactionResponseFromDocument(e)}return iu(t)?this.readTransactionResponseFromDocument(t):this.readTransactionResponseFromNode(t)}},e.prototype.readFeatureCollectionMetadata=function(t){if(t){if("string"==typeof t){var e=ru(t);return this.readFeatureCollectionMetadataFromDocument(e)}return iu(t)?this.readFeatureCollectionMetadataFromDocument(t):this.readFeatureCollectionMetadataFromNode(t)}},e.prototype.readFeatureCollectionMetadataFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(e)},e.prototype.readFeatureCollectionMetadataFromNode=function(t){var e={},i=Ad(t.getAttribute("numberOfFeatures"));return e.numberOfFeatures=i,gu(e,zy,t,[],this.gmlFormat_)},e.prototype.readTransactionResponseFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(e)},e.prototype.readTransactionResponseFromNode=function(t){return gu({},Ky,t,[])},e.prototype.writeGetFeature=function(t){var e,i=tu($y,"GetFeature");if(i.setAttribute("service","WFS"),i.setAttribute("version","1.1.0"),t&&(t.handle&&i.setAttribute("handle",t.handle),t.outputFormat&&i.setAttribute("outputFormat",t.outputFormat),void 0!==t.maxFeatures&&i.setAttribute("maxFeatures",String(t.maxFeatures)),t.resultType&&i.setAttribute("resultType",t.resultType),void 0!==t.startIndex&&i.setAttribute("startIndex",String(t.startIndex)),void 0!==t.count&&i.setAttribute("count",String(t.count)),void 0!==t.viewParams&&i.setAttribute("viewParams ",t.viewParams),e=t.filter,t.bbox)){Y(t.geometryName,12);var r=Xy(t.geometryName,t.bbox,t.srsName);e=e?Vy(e,r):r}i.setAttributeNS($l,"xsi:schemaLocation",this.schemaLocation_);var n={node:i};return u(n,{srsName:t.srsName,featureNS:t.featureNS?t.featureNS:this.featureNS_,featurePrefix:t.featurePrefix,geometryName:t.geometryName,filter:e,propertyNames:t.propertyNames?t.propertyNames:[]}),Y(Array.isArray(t.featureTypes),11),function(t,e,i){var r=i[i.length-1],n=u({},r);n.node=t,vu(n,hv,pu("Query"),e,i)}(i,t.featureTypes,[n]),i},e.prototype.writeTransaction=function(t,e,i,r){var n,o,s=[],a=tu($y,"Transaction"),h=r.version?r.version:iv,l="1.0.0"===h?2:3;a.setAttribute("service","WFS"),a.setAttribute("version",h),r&&(n=r.gmlOptions?r.gmlOptions:{},r.handle&&a.setAttribute("handle",r.handle));var p=ev[h];a.setAttributeNS($l,"xsi:schemaLocation",p);var c=r.featurePrefix?r.featurePrefix:qy;return t&&(o=u({node:a},{featureNS:r.featureNS,featureType:r.featureType,featurePrefix:c,gmlVersion:l,hasZ:r.hasZ,srsName:r.srsName}),u(o,n),vu(o,Zy,pu("Insert"),t,s)),e&&(o=u({node:a},{featureNS:r.featureNS,featureType:r.featureType,featurePrefix:c,gmlVersion:l,hasZ:r.hasZ,srsName:r.srsName}),u(o,n),vu(o,Zy,pu("Update"),e,s)),i&&vu({node:a,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:c,gmlVersion:l,srsName:r.srsName},Zy,pu("Delete"),i,s),r.nativeElements&&vu({node:a,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:c,gmlVersion:l,srsName:r.srsName},Zy,pu("Native"),r.nativeElements,s),a},e.prototype.readProjectionFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(e);return null},e.prototype.readProjectionFromNode=function(t){if(t.firstElementChild&&t.firstElementChild.firstElementChild)for(var e=(t=t.firstElementChild.firstElementChild).firstElementChild;e;e=e.nextElementSibling)if(0!==e.childNodes.length&&(1!==e.childNodes.length||3!==e.firstChild.nodeType)){var i=[{}];return this.gmlFormat_.readGeometryElement(e,i),Ee(i.pop().srsName)}return null},e}(Td);var nv={"http://www.opengis.net/ogc":{FeatureId:ou(function(t,e){return t.getAttribute("fid")})}};var ov={"http://www.opengis.net/wfs":{Feature:function(t,e){_u(nv,t,e)}}};function sv(t,e,i){var r=tu(Qy,"Filter"),n=tu(Qy,"FeatureId");r.appendChild(n),n.setAttribute("fid",e),t.appendChild(r)}function av(t,e){var i=(t=t||qy)+":";return 0===e.indexOf(i)?e:i+e}var hv={"http://www.opengis.net/wfs":{Query:lu(function(t,e,i){var r,n=i[i.length-1],o=n.featurePrefix,s=n.featureNS,a=n.propertyNames,h=n.srsName;r=o?av(o,e):e;t.setAttribute("typeName",r),h&&t.setAttribute("srsName",h);s&&t.setAttributeNS(Jy,"xmlns:"+o,s);var l=u({},n);l.node=t,vu(l,Hy,pu("PropertyName"),a,i);var p=n.filter;if(p){var c=tu(Qy,"Filter");t.appendChild(c),lv(c,p,i)}})},"http://www.opengis.net/ogc":{During:lu(function(t,e,i){var r=tu(tv,"ValueReference");jd(r,e.propertyName),t.appendChild(r);var n=tu(Cd,"TimePeriod");t.appendChild(n);var o=tu(Cd,"begin");n.appendChild(o),_v(o,e.begin);var s=tu(Cd,"end");n.appendChild(s),_v(s,e.end)}),And:lu(uv),Or:lu(uv),Not:lu(function(t,e,i){var r={node:t},n=e.condition;vu(r,hv,pu(n.getTagName()),[n],i)}),BBOX:lu(function(t,e,i){i[i.length-1].srsName=e.srsName,dv(t,e.geometryName),Vd.prototype.writeGeometryElement(t,e.extent,i)}),Contains:lu(function(t,e,i){i[i.length-1].srsName=e.srsName,dv(t,e.geometryName),Vd.prototype.writeGeometryElement(t,e.geometry,i)}),Intersects:lu(function(t,e,i){i[i.length-1].srsName=e.srsName,dv(t,e.geometryName),Vd.prototype.writeGeometryElement(t,e.geometry,i)}),Within:lu(function(t,e,i){i[i.length-1].srsName=e.srsName,dv(t,e.geometryName),Vd.prototype.writeGeometryElement(t,e.geometry,i)}),PropertyIsEqualTo:lu(pv),PropertyIsNotEqualTo:lu(pv),PropertyIsLessThan:lu(pv),PropertyIsLessThanOrEqualTo:lu(pv),PropertyIsGreaterThan:lu(pv),PropertyIsGreaterThanOrEqualTo:lu(pv),PropertyIsNull:lu(function(t,e,i){dv(t,e.propertyName)}),PropertyIsBetween:lu(function(t,e,i){dv(t,e.propertyName);var r=tu(Qy,"LowerBoundary");t.appendChild(r),fv(r,""+e.lowerBoundary);var n=tu(Qy,"UpperBoundary");t.appendChild(n),fv(n,""+e.upperBoundary)}),PropertyIsLike:lu(function(t,e,i){t.setAttribute("wildCard",e.wildCard),t.setAttribute("singleChar",e.singleChar),t.setAttribute("escapeChar",e.escapeChar),void 0!==e.matchCase&&t.setAttribute("matchCase",e.matchCase.toString());dv(t,e.propertyName),fv(t,""+e.pattern)})}};function lv(t,e,i){vu({node:t},hv,pu(e.getTagName()),[e],i)}function uv(t,e,i){for(var r={node:t},n=e.conditions,o=0,s=n.length;o<s;++o){var a=n[o];vu(r,hv,pu(a.getTagName()),[a],i)}}function pv(t,e,i){void 0!==e.matchCase&&t.setAttribute("matchCase",e.matchCase.toString()),dv(t,e.propertyName),fv(t,""+e.expression)}function cv(t,e,i){var r=tu(Qy,t);jd(r,i),e.appendChild(r)}function dv(t,e){cv("PropertyName",t,e)}function fv(t,e){cv("Literal",t,e)}function _v(t,e){var i=tu(Cd,"TimeInstant");t.appendChild(i);var r=tu(Cd,"timePosition");i.appendChild(r),jd(r,e)}var gv=rv,yv={POINT:ci,LINESTRING:hr,POLYGON:Ii,MULTIPOINT:bc,MULTILINESTRING:Pc,MULTIPOLYGON:Fc},vv="EMPTY",mv="Z",xv="M",Ev=1,Sv=2,Tv=3,Cv=4,Rv=5,wv=6,Iv={};for(var Lv in Nt)Iv[Lv]=Nt[Lv].toUpperCase();var Ov=function(t){this.wkt=t,this.index_=-1};Ov.prototype.isAlpha_=function(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"},Ov.prototype.isNumeric_=function(t,e){return t>="0"&&t<="9"||"."==t&&!(void 0!==e&&e)},Ov.prototype.isWhiteSpace_=function(t){return" "==t||"\t"==t||"\r"==t||"\n"==t},Ov.prototype.nextChar_=function(){return this.wkt.charAt(++this.index_)},Ov.prototype.nextToken=function(){var t,e=this.nextChar_(),i=this.index_,r=e;if("("==e)t=Sv;else if(","==e)t=Rv;else if(")"==e)t=Tv;else if(this.isNumeric_(e)||"-"==e)t=Cv,r=this.readNumber_();else if(this.isAlpha_(e))t=Ev,r=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(""!==e)throw new Error("Unexpected character: "+e);t=wv}return{position:i,value:r,type:t}},Ov.prototype.readNumber_=function(){var t,e=this.index_,i=!1,r=!1;do{"."==t?i=!0:"e"!=t&&"E"!=t||(r=!0),t=this.nextChar_()}while(this.isNumeric_(t,i)||!r&&("e"==t||"E"==t)||r&&("-"==t||"+"==t));return parseFloat(this.wkt.substring(e,this.index_--))},Ov.prototype.readText_=function(){var t,e=this.index_;do{t=this.nextChar_()}while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()};var Pv=function(t){this.lexer_=t,this.token_,this.layout_=At.XY};function bv(t){var e=t.getCoordinates();return 0===e.length?"":e.join(" ")}function Mv(t){for(var e=t.getCoordinates(),i=[],r=0,n=e.length;r<n;++r)i.push(e[r].join(" "));return i.join(",")}function Fv(t){for(var e=[],i=t.getLinearRings(),r=0,n=i.length;r<n;++r)e.push("("+Mv(i[r])+")");return e.join(",")}Pv.prototype.consume_=function(){this.token_=this.lexer_.nextToken()},Pv.prototype.isTokenType=function(t){return this.token_.type==t},Pv.prototype.match=function(t){var e=this.isTokenType(t);return e&&this.consume_(),e},Pv.prototype.parse=function(){return this.consume_(),this.parseGeometry_()},Pv.prototype.parseGeometryLayout_=function(){var t=At.XY,e=this.token_;if(this.isTokenType(Ev)){var i=e.value;i===mv?t=At.XYZ:i===xv?t=At.XYM:"ZM"===i&&(t=At.XYZM),t!==At.XY&&this.consume_()}return t},Pv.prototype.parseGeometryCollectionText_=function(){if(this.match(Sv)){var t=[];do{t.push(this.parseGeometry_())}while(this.match(Rv));if(this.match(Tv))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},Pv.prototype.parsePointText_=function(){if(this.match(Sv)){var t=this.parsePoint_();if(this.match(Tv))return t}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())},Pv.prototype.parseLineStringText_=function(){if(this.match(Sv)){var t=this.parsePointList_();if(this.match(Tv))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},Pv.prototype.parsePolygonText_=function(){if(this.match(Sv)){var t=this.parseLineStringTextList_();if(this.match(Tv))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},Pv.prototype.parseMultiPointText_=function(){var t;if(this.match(Sv)){if(t=this.token_.type==Sv?this.parsePointTextList_():this.parsePointList_(),this.match(Tv))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},Pv.prototype.parseMultiLineStringText_=function(){if(this.match(Sv)){var t=this.parseLineStringTextList_();if(this.match(Tv))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},Pv.prototype.parseMultiPolygonText_=function(){if(this.match(Sv)){var t=this.parsePolygonTextList_();if(this.match(Tv))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},Pv.prototype.parsePoint_=function(){for(var t=[],e=this.layout_.length,i=0;i<e;++i){var r=this.token_;if(!this.match(Cv))break;t.push(r.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())},Pv.prototype.parsePointList_=function(){for(var t=[this.parsePoint_()];this.match(Rv);)t.push(this.parsePoint_());return t},Pv.prototype.parsePointTextList_=function(){for(var t=[this.parsePointText_()];this.match(Rv);)t.push(this.parsePointText_());return t},Pv.prototype.parseLineStringTextList_=function(){for(var t=[this.parseLineStringText_()];this.match(Rv);)t.push(this.parseLineStringText_());return t},Pv.prototype.parsePolygonTextList_=function(){for(var t=[this.parsePolygonText_()];this.match(Rv);)t.push(this.parsePolygonText_());return t},Pv.prototype.isEmptyGeometry_=function(){var t=this.isTokenType(Ev)&&this.token_.value==vv;return t&&this.consume_(),t},Pv.prototype.formatErrorMessage_=function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"},Pv.prototype.parseGeometry_=function(){var t=this.token_;if(this.match(Ev)){var e=t.value;if(this.layout_=this.parseGeometryLayout_(),"GEOMETRYCOLLECTION"==e){var i=this.parseGeometryCollectionText_();return new ud(i)}var r,n=yv[e];if(!n)throw new Error("Invalid geometry type: "+e);switch(e){case"POINT":r=this.parsePointText_();break;case"LINESTRING":r=this.parseLineStringText_();break;case"POLYGON":r=this.parsePolygonText_();break;case"MULTIPOINT":r=this.parseMultiPointText_();break;case"MULTILINESTRING":r=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":r=this.parseMultiPolygonText_();break;default:throw new Error("Invalid geometry type: "+e)}return r||(r=n===yv.POINT?[NaN,NaN]:[]),new n(r,this.layout_)}throw new Error(this.formatErrorMessage_())};var Av={Point:bv,LineString:Mv,Polygon:Fv,MultiPoint:function(t){for(var e=[],i=t.getPoints(),r=0,n=i.length;r<n;++r)e.push("("+bv(i[r])+")");return e.join(",")},MultiLineString:function(t){for(var e=[],i=t.getLineStrings(),r=0,n=i.length;r<n;++r)e.push("("+Mv(i[r])+")");return e.join(",")},MultiPolygon:function(t){for(var e=[],i=t.getPolygons(),r=0,n=i.length;r<n;++r)e.push("("+Fv(i[r])+")");return e.join(",")},GeometryCollection:function(t){for(var e=[],i=t.getGeometries(),r=0,n=i.length;r<n;++r)e.push(Nv(i[r]));return e.join(",")}};function Nv(t){var e=t.getType(),i=(0,Av[e])(t);if(e=e.toUpperCase(),"function"==typeof t.getFlatCoordinates){var r=function(t){var e=t.getLayout(),i="";return e!==At.XYZ&&e!==At.XYZM||(i+=mv),e!==At.XYM&&e!==At.XYZM||(i+=xv),i}(t);r.length>0&&(e+=" "+r)}return 0===i.length?e+" "+vv:e+"("+i+")"}var Gv=function(t){function e(e){t.call(this);var i=e||{};this.splitCollection_=void 0!==i.splitCollection&&i.splitCollection}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parse_=function(t){var e=new Ov(t);return new Pv(e).parse()},e.prototype.readFeatureFromText=function(t,e){var i=this.readGeometryFromText(t,e);if(i){var r=new B;return r.setGeometry(i),r}return null},e.prototype.readFeaturesFromText=function(t,e){for(var i=[],r=this.readGeometryFromText(t,e),n=[],o=0,s=(i=this.splitCollection_&&r.getType()==Nt.GEOMETRY_COLLECTION?r.getGeometriesArray():[r]).length;o<s;++o){var a=new B;a.setGeometry(i[o]),n.push(a)}return n},e.prototype.readGeometryFromText=function(t,e){var i=this.parse_(t);return i?dd(i,!1,e):null},e.prototype.writeFeatureText=function(t,e){var i=t.getGeometry();return i?this.writeGeometryText(i,e):""},e.prototype.writeFeaturesText=function(t,e){if(1==t.length)return this.writeFeatureText(t[0],e);for(var i=[],r=0,n=t.length;r<n;++r)i.push(t[r].getGeometry());var o=new ud(i);return this.writeGeometryText(o,e)},e.prototype.writeGeometryText=function(t,e){return Nv(dd(t,!0,e))},e}(zf),Dv="http://www.w3.org/1999/xlink";function kv(t){return t.getAttributeNS(Dv,"href")}var jv=function(){};jv.prototype.read=function(t){if(t){if("string"==typeof t){var e=ru(t);return this.readFromDocument(e)}return iu(t)?this.readFromDocument(t):this.readFromNode(t)}return null},jv.prototype.readFromDocument=function(t){},jv.prototype.readFromNode=function(t){};var Uv=jv,Yv=[null,"http://www.opengis.net/wms"],Bv=fu(Yv,{Service:hu(function(t,e){return gu({},zv,t,e)}),Capability:hu(function(t,e){return gu({},Vv,t,e)})}),Vv=fu(Yv,{Request:hu(function(t,e){return gu({},$v,t,e)}),Exception:hu(function(t,e){return gu([],Zv,t,e)}),Layer:hu(function(t,e){return gu({},qv,t,e)})}),Xv=function(t){function e(){t.call(this),this.version=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},e.prototype.readFromNode=function(t){this.version=t.getAttribute("version").trim();var e=gu({version:this.version},Bv,t,[]);return e||null},e}(Uv),zv=fu(Yv,{Name:hu(Nd),Title:hu(Nd),Abstract:hu(Nd),KeywordList:hu(lm),OnlineResource:hu(kv),ContactInformation:hu(function(t,e){return gu({},Wv,t,e)}),Fees:hu(Nd),AccessConstraints:hu(Nd),LayerLimit:hu(Fd),MaxWidth:hu(Fd),MaxHeight:hu(Fd)}),Wv=fu(Yv,{ContactPersonPrimary:hu(function(t,e){return gu({},Kv,t,e)}),ContactPosition:hu(Nd),ContactAddress:hu(function(t,e){return gu({},Hv,t,e)}),ContactVoiceTelephone:hu(Nd),ContactFacsimileTelephone:hu(Nd),ContactElectronicMailAddress:hu(Nd)}),Kv=fu(Yv,{ContactPerson:hu(Nd),ContactOrganization:hu(Nd)}),Hv=fu(Yv,{AddressType:hu(Nd),Address:hu(Nd),City:hu(Nd),StateOrProvince:hu(Nd),PostCode:hu(Nd),Country:hu(Nd)}),Zv=fu(Yv,{Format:ou(Nd)}),qv=fu(Yv,{Name:hu(Nd),Title:hu(Nd),Abstract:hu(Nd),KeywordList:hu(lm),CRS:au(Nd),EX_GeographicBoundingBox:hu(function(t,e){var i=gu({},Qv,t,e);if(!i)return;var r=i.westBoundLongitude,n=i.southBoundLatitude,o=i.eastBoundLongitude,s=i.northBoundLatitude;if(void 0===r||void 0===n||void 0===o||void 0===s)return;return[r,n,o,s]}),BoundingBox:au(function(t,e){var i=[Md(t.getAttribute("minx")),Md(t.getAttribute("miny")),Md(t.getAttribute("maxx")),Md(t.getAttribute("maxy"))],r=[Md(t.getAttribute("resx")),Md(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS"),extent:i,res:r}}),Dimension:au(function(t,e){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:Od(t.getAttribute("multipleValues")),nearestValue:Od(t.getAttribute("nearestValue")),current:Od(t.getAttribute("current")),values:Nd(t)}}),Attribution:hu(function(t,e){return gu({},Jv,t,e)}),AuthorityURL:au(function(t,e){var i=sm(t,e);if(i)return i.name=t.getAttribute("name"),i;return}),Identifier:au(Nd),MetadataURL:au(function(t,e){var i=sm(t,e);if(i)return i.type=t.getAttribute("type"),i;return}),DataURL:au(sm),FeatureListURL:au(sm),Style:au(function(t,e){return gu({},rm,t,e)}),MinScaleDenominator:hu(bd),MaxScaleDenominator:hu(bd),Layer:au(function(t,e){var i=e[e.length-1],r=gu({},qv,t,e);if(!r)return;var n=Od(t.getAttribute("queryable"));void 0===n&&(n=i.queryable);r.queryable=void 0!==n&&n;var o=Ad(t.getAttribute("cascaded"));void 0===o&&(o=i.cascaded);r.cascaded=o;var s=Od(t.getAttribute("opaque"));void 0===s&&(s=i.opaque);r.opaque=void 0!==s&&s;var a=Od(t.getAttribute("noSubsets"));void 0===a&&(a=i.noSubsets);r.noSubsets=void 0!==a&&a;var h=Md(t.getAttribute("fixedWidth"));h||(h=i.fixedWidth);r.fixedWidth=h;var l=Md(t.getAttribute("fixedHeight"));l||(l=i.fixedHeight);r.fixedHeight=l,["Style","CRS","AuthorityURL"].forEach(function(t){if(t in i){var e=r[t]||[];r[t]=e.concat(i[t])}});return["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach(function(t){if(!(t in r)){var e=i[t];r[t]=e}}),r})}),Jv=fu(Yv,{Title:hu(Nd),OnlineResource:hu(kv),LogoURL:hu(hm)}),Qv=fu(Yv,{westBoundLongitude:hu(bd),eastBoundLongitude:hu(bd),southBoundLatitude:hu(bd),northBoundLatitude:hu(bd)}),$v=fu(Yv,{GetCapabilities:hu(am),GetMap:hu(am),GetFeatureInfo:hu(am)}),tm=fu(Yv,{Format:au(Nd),DCPType:au(function(t,e){return gu({},em,t,e)})}),em=fu(Yv,{HTTP:hu(function(t,e){return gu({},im,t,e)})}),im=fu(Yv,{Get:hu(sm),Post:hu(sm)}),rm=fu(Yv,{Name:hu(Nd),Title:hu(Nd),Abstract:hu(Nd),LegendURL:au(hm),StyleSheetURL:hu(sm),StyleURL:hu(sm)}),nm=fu(Yv,{Format:hu(Nd),OnlineResource:hu(kv)}),om=fu(Yv,{Keyword:ou(Nd)});function sm(t,e){return gu({},nm,t,e)}function am(t,e){return gu({},tm,t,e)}function hm(t,e){var i=sm(t,e);if(i){var r=[Ad(t.getAttribute("width")),Ad(t.getAttribute("height"))];return i.size=r,i}}function lm(t,e){return gu([],om,t,e)}var um=Xv,pm=function(t){function e(e){t.call(this);var i=e||{};this.featureNS_="http://mapserver.gis.umn.edu/mapserver",this.gmlFormat_=new Zd,this.layers_=i.layers?i.layers:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayers=function(){return this.layers_},e.prototype.setLayers=function(t){this.layers_=t},e.prototype.readFeatures_=function(t,e){t.setAttribute("namespaceURI",this.featureNS_);var i=t.localName,r=[];if(0===t.childNodes.length)return r;if("msGMLOutput"==i)for(var n=0,o=t.childNodes.length;n<o;n++){var s=t.childNodes[n];if(s.nodeType===Node.ELEMENT_NODE){var a=s,h=e[0],l=a.localName.replace("_layer","");if(!this.layers_||X(this.layers_,l)){var u=l+"_feature";h.featureType=u,h.featureNS=this.featureNS_;var p={};p[u]=ou(this.gmlFormat_.readFeatureElement,this.gmlFormat_);var c=fu([h.featureNS,null],p);a.setAttribute("namespaceURI",this.featureNS_);var d=gu([],c,a,e,this.gmlFormat_);d&&K(r,d)}}}if("FeatureCollection"==i){var f=gu([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,t,[{}],this.gmlFormat_);f&&(r=f)}return r},e.prototype.readFeaturesFromNode=function(t,e){var i={};return e&&u(i,this.getReadOptions(t,e)),this.readFeatures_(t,[i])},e}(Td),cm=[null,"http://www.opengis.net/ows/1.1"],dm=fu(cm,{ServiceIdentification:hu(function(t,e){return gu({},wm,t,e)}),ServiceProvider:hu(function(t,e){return gu({},Im,t,e)}),OperationsMetadata:hu(function(t,e){return gu({},Sm,t,e)})}),fm=function(t){function e(){t.call(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},e.prototype.readFromNode=function(t){var e=gu({},dm,t,[]);return e||null},e}(Uv),_m=fu(cm,{DeliveryPoint:hu(Nd),City:hu(Nd),AdministrativeArea:hu(Nd),PostalCode:hu(Nd),Country:hu(Nd),ElectronicMailAddress:hu(Nd)}),gm=fu(cm,{Value:au(function(t,e){return Nd(t)})}),ym=fu(cm,{AllowedValues:hu(function(t,e){return gu({},gm,t,e)})}),vm=fu(cm,{Phone:hu(function(t,e){return gu({},Tm,t,e)}),Address:hu(function(t,e){return gu({},_m,t,e)})}),mm=fu(cm,{HTTP:hu(function(t,e){return gu({},xm,t,e)})}),xm=fu(cm,{Get:au(function(t,e){var i=kv(t);if(!i)return;return gu({href:i},Cm,t,e)}),Post:void 0}),Em=fu(cm,{DCP:hu(function(t,e){return gu({},mm,t,e)})}),Sm=fu(cm,{Operation:function(t,e){var i=t.getAttribute("name"),r=gu({},Em,t,e);if(!r)return;e[e.length-1][i]=r}}),Tm=fu(cm,{Voice:hu(Nd),Facsimile:hu(Nd)}),Cm=fu(cm,{Constraint:au(function(t,e){var i=t.getAttribute("name");if(!i)return;return gu({name:i},ym,t,e)})}),Rm=fu(cm,{IndividualName:hu(Nd),PositionName:hu(Nd),ContactInfo:hu(function(t,e){return gu({},vm,t,e)})}),wm=fu(cm,{Abstract:hu(Nd),AccessConstraints:hu(Nd),Fees:hu(Nd),Title:hu(Nd),ServiceTypeVersion:hu(Nd),ServiceType:hu(Nd)}),Im=fu(cm,{ProviderName:hu(Nd),ProviderSite:hu(kv),ServiceContact:hu(function(t,e){return gu({},Rm,t,e)})});var Lm=fm,Om=[null,"http://www.opengis.net/wmts/1.0"],Pm=[null,"http://www.opengis.net/ows/1.1"],bm=fu(Om,{Contents:hu(function(t,e){return gu({},Fm,t,e)})}),Mm=function(t){function e(){t.call(this),this.owsParser_=new Lm}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},e.prototype.readFromNode=function(t){var e=t.getAttribute("version").trim(),i=this.owsParser_.readFromNode(t);return i?(i.version=e,(i=gu(i,bm,t,[]))||null):null},e}(Uv),Fm=fu(Om,{Layer:au(function(t,e){return gu({},Am,t,e)}),TileMatrixSet:au(function(t,e){return gu({},Ym,t,e)})}),Am=fu(Om,{Style:au(function(t,e){var i=gu({},Nm,t,e);if(!i)return;var r="true"===t.getAttribute("isDefault");return i.isDefault=r,i}),Format:au(Nd),TileMatrixSetLink:au(function(t,e){return gu({},Gm,t,e)}),Dimension:au(function(t,e){return gu({},jm,t,e)}),ResourceURL:au(function(t,e){var i=t.getAttribute("format"),r=t.getAttribute("template"),n=t.getAttribute("resourceType"),o={};i&&(o.format=i);r&&(o.template=r);n&&(o.resourceType=n);return o})},fu(Pm,{Title:hu(Nd),Abstract:hu(Nd),WGS84BoundingBox:hu(function(t,e){var i=gu([],Um,t,e);if(2!=i.length)return;return tt(i)}),Identifier:hu(Nd)})),Nm=fu(Om,{LegendURL:au(function(t,e){var i={};return i.format=t.getAttribute("format"),i.href=kv(t),i})},fu(Pm,{Title:hu(Nd),Identifier:hu(Nd)})),Gm=fu(Om,{TileMatrixSet:hu(Nd),TileMatrixSetLimits:hu(function(t,e){return gu([],Dm,t,e)})}),Dm=fu(Om,{TileMatrixLimits:ou(function(t,e){return gu({},km,t,e)})}),km=fu(Om,{TileMatrix:hu(Nd),MinTileRow:hu(Fd),MaxTileRow:hu(Fd),MinTileCol:hu(Fd),MaxTileCol:hu(Fd)}),jm=fu(Om,{Default:hu(Nd),Value:au(Nd)},fu(Pm,{Identifier:hu(Nd)})),Um=fu(Pm,{LowerCorner:ou(Vm),UpperCorner:ou(Vm)}),Ym=fu(Om,{WellKnownScaleSet:hu(Nd),TileMatrix:au(function(t,e){return gu({},Bm,t,e)})},fu(Pm,{SupportedCRS:hu(Nd),Identifier:hu(Nd)})),Bm=fu(Om,{TopLeftCorner:hu(Vm),ScaleDenominator:hu(bd),TileWidth:hu(Fd),TileHeight:hu(Fd),MatrixWidth:hu(Fd),MatrixHeight:hu(Fd)},fu(Pm,{Identifier:hu(Nd)}));function Vm(t,e){var i=Nd(t).split(/\s+/);if(i&&2==i.length){var r=+i[0],n=+i[1];if(!isNaN(r)&&!isNaN(n))return[r,n]}}var Xm=Mm,zm=function(){var t;return function(){if(!t){var e=document.body;e.webkitRequestFullscreen?t="webkitfullscreenchange":e.mozRequestFullScreen?t="mozfullscreenchange":e.msRequestFullscreen?t="MSFullscreenChange":e.requestFullscreen&&(t="fullscreenchange")}return t}}();function Wm(){var t=document.body;return!!(t.webkitRequestFullscreen||t.mozRequestFullScreen&&document.mozFullScreenEnabled||t.msRequestFullscreen&&document.msFullscreenEnabled||t.requestFullscreen&&document.fullscreenEnabled)}function Km(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}function Hm(t){t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}var Zm=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target}),this.cssClassName_=void 0!==i.className?i.className:"ol-full-screen";var r=void 0!==i.label?i.label:"⤢";this.labelNode_="string"==typeof r?document.createTextNode(r):r;var n=void 0!==i.labelActive?i.labelActive:"×";this.labelActiveNode_="string"==typeof n?document.createTextNode(n):n,this.button_=document.createElement("button");var o=i.tipLabel?i.tipLabel:"Toggle full-screen";this.setClassName_(this.button_,Km()),this.button_.setAttribute("type","button"),this.button_.title=o,this.button_.appendChild(this.labelNode_),v(this.button_,M.CLICK,this.handleClick_,this);var s=this.cssClassName_+" "+fo+" "+go+" "+(Wm()?"":_o),a=this.element;a.className=s,a.appendChild(this.button_),this.keys_=void 0!==i.keys&&i.keys,this.source_=i.source}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),this.handleFullScreen_()},e.prototype.handleFullScreen_=function(){if(Wm()){var t,e=this.getMap();if(e)if(Km())document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else t=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:e.getTargetElement(),this.keys_?function(t){t.mozRequestFullScreenWithKeys?t.mozRequestFullScreenWithKeys():t.webkitRequestFullscreen?t.webkitRequestFullscreen():Hm(t)}(t):Hm(t)}},e.prototype.handleFullScreenChange_=function(){var t=this.getMap();Km()?(this.setClassName_(this.button_,!0),Qn(this.labelActiveNode_,this.labelNode_)):(this.setClassName_(this.button_,!1),Qn(this.labelNode_,this.labelActiveNode_)),t&&t.updateSize()},e.prototype.setClassName_=function(t,e){var i=this.cssClassName_+"-true",r=this.cssClassName_+"-false",n=e?i:r;t.classList.remove(i),t.classList.remove(r),t.classList.add(n)},e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),e&&this.listenerKeys.push(v(document,zm(),this.handleFullScreenChange_,this))},e}(uo),qm="projection";function Jm(t){var e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null}var Qm=function(t){function e(e){var i=e||{},r=document.createElement("div");r.className=void 0!==i.className?i.className:"ol-mouse-position",t.call(this,{element:r,render:i.render||Jm,target:i.target}),v(this,G(qm),this.handleProjectionChanged_,this),i.coordinateFormat&&this.setCoordinateFormat(i.coordinateFormat),i.projection&&this.setProjection(i.projection),this.undefinedHTML_=void 0!==i.undefinedHTML?i.undefinedHTML:"&#160;",this.renderOnMouseOut_=!!this.undefinedHTML_,this.renderedHTML_=r.innerHTML,this.mapProjection_=null,this.transform_=null,this.lastMouseMovePixel_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleProjectionChanged_=function(){this.transform_=null},e.prototype.getCoordinateFormat=function(){return this.get("coordinateFormat")},e.prototype.getProjection=function(){return this.get(qm)},e.prototype.handleMouseMove=function(t){var e=this.getMap();this.lastMouseMovePixel_=e.getEventPixel(t),this.updateHTML_(this.lastMouseMovePixel_)},e.prototype.handleMouseOut=function(t){this.updateHTML_(null),this.lastMouseMovePixel_=null},e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var i=e.getViewport();this.listenerKeys.push(v(i,M.MOUSEMOVE,this.handleMouseMove,this),v(i,M.TOUCHSTART,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(v(i,M.MOUSEOUT,this.handleMouseOut,this),v(i,M.TOUCHEND,this.handleMouseOut,this))}},e.prototype.setCoordinateFormat=function(t){this.set("coordinateFormat",t)},e.prototype.setProjection=function(t){this.set(qm,Ee(t))},e.prototype.updateHTML_=function(t){var e=this.undefinedHTML_;if(t&&this.mapProjection_){if(!this.transform_){var i=this.getProjection();this.transform_=i?Le(this.mapProjection_,i):me}var r=this.getMap().getCoordinateFromPixel(t);if(r){this.transform_(r,r);var n=this.getCoordinateFormat();e=n?n(r):r.toString()}}this.renderedHTML_&&e===this.renderedHTML_||(this.element.innerHTML=e,this.renderedHTML_=e)},e}(uo);function $m(t){this.validateExtent_(),this.updateBox_()}var tx=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||$m,target:i.target}),this.collapsed_=void 0===i.collapsed||i.collapsed,this.collapsible_=void 0===i.collapsible||i.collapsible,this.collapsible_||(this.collapsed_=!1);var r=void 0!==i.className?i.className:"ol-overviewmap",n=void 0!==i.tipLabel?i.tipLabel:"Overview map",o=void 0!==i.collapseLabel?i.collapseLabel:"«";"string"==typeof o?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o):this.collapseLabel_=o;var s=void 0!==i.label?i.label:"»";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s):this.label_=s;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,h=document.createElement("button");h.setAttribute("type","button"),h.title=n,h.appendChild(a),v(h,M.CLICK,this.handleClick_,this),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.ovmap_=new Ha({controls:new U,interactions:new U,view:i.view});var l=this.ovmap_;i.layers&&i.layers.forEach(function(t){l.addLayer(t)}.bind(this));var u=document.createElement("div");u.className="ol-overviewmap-box",u.style.boxSizing="border-box",this.boxOverlay_=new Ja({position:[0,0],positioning:Za.BOTTOM_LEFT,element:u}),this.ovmap_.addOverlay(this.boxOverlay_);var p=r+" "+fo+" "+go+(this.collapsed_&&this.collapsible_?" "+yo:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=p,c.appendChild(this.ovmapDiv_),c.appendChild(h);var d=this,f=this.boxOverlay_,_=this.boxOverlay_.getElement(),g=function(t){var e=function(t){return{clientX:t.clientX-_.offsetWidth/2,clientY:t.clientY+_.offsetHeight/2}}(t),i=l.getEventCoordinate(e);f.setPosition(i)},y=function(t){var e=l.getEventCoordinate(t);d.getMap().getView().setCenter(e),window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",y)};_.addEventListener("mousedown",function(){window.addEventListener("mousemove",g),window.addEventListener("mouseup",y)})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){var i=this.getMap();if(e!==i){if(i){var r=i.getView();r&&this.unbindView_(r),this.ovmap_.setTarget(null)}if(t.prototype.setMap.call(this,e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(v(e,l,this.handleMapPropertyChange_,this)),0===this.ovmap_.getLayers().getLength()&&this.ovmap_.setLayerGroup(e.getLayerGroup());var n=e.getView();n&&(this.bindView_(n),n.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},e.prototype.handleMapPropertyChange_=function(t){if(t.key===Ln.VIEW){var e=t.oldValue;e&&this.unbindView_(e);var i=this.getMap().getView();this.bindView_(i)}},e.prototype.bindView_=function(t){v(t,G(Bn),this.handleRotationChanged_,this)},e.prototype.unbindView_=function(t){x(t,G(Bn),this.handleRotationChanged_,this)},e.prototype.handleRotationChanged_=function(){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},e.prototype.validateExtent_=function(){var t=this.getMap(),e=this.ovmap_;if(t.isRendered()&&e.isRendered()){var i=t.getSize(),r=t.getView().calculateExtent(i),n=e.getSize(),o=e.getView().calculateExtent(n),s=e.getPixelFromCoordinate(It(r)),a=e.getPixelFromCoordinate(St(r)),h=Math.abs(s[0]-a[0]),l=Math.abs(s[1]-a[1]),u=n[0],p=n[1];h<.1*u||l<.1*p||h>.75*u||l>.75*p?this.resetExtent_():ot(o,r)||this.recenter_()}},e.prototype.resetExtent_=function(){var t=this.getMap(),e=this.ovmap_,i=t.getSize(),r=t.getView().calculateExtent(i),n=e.getView(),o=Math.log(7.5)/Math.LN2;Mt(r,1/(.1*Math.pow(2,o/2))),n.fit(r)},e.prototype.recenter_=function(){var t=this.getMap(),e=this.ovmap_,i=t.getView();e.getView().setCenter(i.getCenter())},e.prototype.updateBox_=function(){var t=this.getMap(),e=this.ovmap_;if(t.isRendered()&&e.isRendered()){var i=t.getSize(),r=t.getView(),n=e.getView(),o=r.getRotation(),s=this.boxOverlay_,a=this.boxOverlay_.getElement(),h=r.calculateExtent(i),l=n.getResolution(),u=Et(h),p=Lt(h),c=this.calculateCoordinateRotate_(o,u);s.setPosition(c),a&&(a.style.width=Math.abs((u[0]-p[0])/l)+"px",a.style.height=Math.abs((p[1]-u[1])/l)+"px")}},e.prototype.calculateCoordinateRotate_=function(t,e){var i,r=this.getMap().getView().getCenter();return r&&($i(i=[e[0]-r[0],e[1]-r[1]],t),Hi(i,r)),i},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle(yo),this.collapsed_?Qn(this.collapseLabel_,this.label_):Qn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var t=this.ovmap_;this.collapsed_||t.isRendered()||(t.updateSize(),this.resetExtent_(),m(t,Rn,function(t){this.updateBox_()},this))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.getOverviewMap=function(){return this.ovmap_},e}(uo),ex="units",ix={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"},rx=[1,2,5];function nx(t){var e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()}var ox=function(t){function e(e){var i=e||{},r=void 0!==i.className?i.className:"ol-scale-line";t.call(this,{element:document.createElement("div"),render:i.render||nx,target:i.target}),this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+fo,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==i.minWidth?i.minWidth:64,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",v(this,G(ex),this.handleUnitsChanged_,this),this.setUnits(i.units||ix.METRIC)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getUnits=function(){return this.get(ex)},e.prototype.handleUnitsChanged_=function(){this.updateElement_()},e.prototype.setUnits=function(t){this.set(ex,t)},e.prototype.updateElement_=function(){var t=this.viewState_;if(t){var e=t.center,i=t.projection,r=this.getUnits(),n=r==ix.DEGREES?$t.DEGREES:$t.METERS,o=Se(i,t.resolution,e,n);i.getUnits()!=$t.DEGREES&&i.getMetersPerUnit()&&n==$t.METERS&&(o*=i.getMetersPerUnit());var s=this.minWidth_*o,a="";if(r==ix.DEGREES){var h=Qt[$t.DEGREES];i.getUnits()==$t.DEGREES?s*=h:o/=h,s<h/60?(a="″",o*=3600):s<h?(a="′",o*=60):a="°"}else r==ix.IMPERIAL?s<.9144?(a="in",o/=.0254):s<1609.344?(a="ft",o/=.3048):(a="mi",o/=1609.344):r==ix.NAUTICAL?(o/=1852,a="nm"):r==ix.METRIC?s<.001?(a="μm",o*=1e6):s<1?(a="mm",o*=1e3):s<1e3?a="m":(a="km",o/=1e3):r==ix.US?s<.9144?(a="in",o*=39.37):s<1609.344?(a="ft",o/=.30480061):(a="mi",o/=1609.3472):Y(!1,33);for(var l,u,p=3*Math.floor(Math.log(this.minWidth_*o)/Math.log(10));;){if(l=rx[(p%3+3)%3]*Math.pow(10,Math.floor(p/3)),u=Math.round(l/o),isNaN(u))return this.element.style.display="none",void(this.renderedVisible_=!1);if(u>=this.minWidth_)break;++p}var c=l+" "+a;this.renderedHTML_!=c&&(this.innerElement_.innerHTML=c,this.renderedHTML_=c),this.renderedWidth_!=u&&(this.innerElement_.style.width=u+"px",this.renderedWidth_=u),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e}(uo),sx={VERTICAL:0,HORIZONTAL:1};function ax(t){if(t.frameState){this.sliderInitialized_||this.initSlider_();var e=t.frameState.viewState.resolution;e!==this.currentResolution_&&(this.currentResolution_=e,this.setThumbPosition_(e))}}var hx=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||ax}),this.dragListenerKeys_=[],this.currentResolution_=void 0,this.direction_=sx.VERTICAL,this.dragging_,this.heightLimit_=0,this.widthLimit_=0,this.previousX_,this.previousY_,this.thumbSize_=null,this.sliderInitialized_=!1,this.duration_=void 0!==i.duration?i.duration:200;var r=void 0!==i.className?i.className:"ol-zoomslider",n=document.createElement("button");n.setAttribute("type","button"),n.className=r+"-thumb "+fo;var o=this.element;o.className=r+" "+fo+" "+go,o.appendChild(n),this.dragger_=new Tn(o),v(this.dragger_,Gr.POINTERDOWN,this.handleDraggerStart_,this),v(this.dragger_,Gr.POINTERMOVE,this.handleDraggerDrag_,this),v(this.dragger_,Gr.POINTERUP,this.handleDraggerEnd_,this),v(o,M.CLICK,this.handleContainerClick_,this),v(n,M.CLICK,O)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.dragger_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),e&&e.render()},e.prototype.initSlider_=function(){var t=this.element,e=t.offsetWidth,i=t.offsetHeight,r=t.firstElementChild,n=getComputedStyle(r),o=r.offsetWidth+parseFloat(n.marginRight)+parseFloat(n.marginLeft),s=r.offsetHeight+parseFloat(n.marginTop)+parseFloat(n.marginBottom);this.thumbSize_=[o,s],e>i?(this.direction_=sx.HORIZONTAL,this.widthLimit_=e-o):(this.direction_=sx.VERTICAL,this.heightLimit_=i-s),this.sliderInitialized_=!0},e.prototype.handleContainerClick_=function(t){var e=this.getMap().getView(),i=this.getRelativePosition_(t.offsetX-this.thumbSize_[0]/2,t.offsetY-this.thumbSize_[1]/2),r=this.getResolutionForPosition_(i);e.animate({resolution:e.constrainResolution(r),duration:this.duration_,easing:Xn})},e.prototype.handleDraggerStart_=function(t){if(!this.dragging_&&t.originalEvent.target===this.element.firstElementChild&&(this.getMap().getView().setHint(jn,1),this.previousX_=t.clientX,this.previousY_=t.clientY,this.dragging_=!0,0===this.dragListenerKeys_.length)){var e=this.handleDraggerDrag_,i=this.handleDraggerEnd_;this.dragListenerKeys_.push(v(document,M.MOUSEMOVE,e,this),v(document,Gr.POINTERMOVE,e,this),v(document,M.MOUSEUP,i,this),v(document,Gr.POINTERUP,i,this))}},e.prototype.handleDraggerDrag_=function(t){if(this.dragging_){var e=this.element.firstElementChild,i=t.clientX-this.previousX_+parseFloat(e.style.left),r=t.clientY-this.previousY_+parseFloat(e.style.top),n=this.getRelativePosition_(i,r);this.currentResolution_=this.getResolutionForPosition_(n),this.getMap().getView().setResolution(this.currentResolution_),this.setThumbPosition_(this.currentResolution_),this.previousX_=t.clientX,this.previousY_=t.clientY}},e.prototype.handleDraggerEnd_=function(t){if(this.dragging_){var e=this.getMap().getView();e.setHint(jn,-1),e.animate({resolution:e.constrainResolution(this.currentResolution_),duration:this.duration_,easing:Xn}),this.dragging_=!1,this.previousX_=void 0,this.previousY_=void 0,this.dragListenerKeys_.forEach(E),this.dragListenerKeys_.length=0}},e.prototype.setThumbPosition_=function(t){var e=this.getPositionForResolution_(t),i=this.element.firstElementChild;this.direction_==sx.HORIZONTAL?i.style.left=this.widthLimit_*e+"px":i.style.top=this.heightLimit_*e+"px"},e.prototype.getRelativePosition_=function(t,e){return kt(this.direction_===sx.HORIZONTAL?t/this.widthLimit_:e/this.heightLimit_,0,1)},e.prototype.getResolutionForPosition_=function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)},e.prototype.getPositionForResolution_=function(t){return 1-this.getMap().getView().getValueForResolutionFunction()(t)},e}(uo),lx=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target}),this.extent=i.extent?i.extent:null;var r=void 0!==i.className?i.className:"ol-zoom-extent",n=void 0!==i.label?i.label:"E",o=void 0!==i.tipLabel?i.tipLabel:"Fit to extent",s=document.createElement("button");s.setAttribute("type","button"),s.title=o,s.appendChild("string"==typeof n?document.createTextNode(n):n),v(s,M.CLICK,this.handleClick_,this);var a=r+" "+fo+" "+go,h=this.element;h.className=a,h.appendChild(s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),this.handleZoomToExtent()},e.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fit(e)},e}(uo),ux={array:{},color:{},colorlike:{},control:{},coordinate:{},easing:{},events:{}};ux.events.condition={},ux.extent={},ux.featureloader={},ux.format={},ux.format.filter={},ux.geom={},ux.has={},ux.interaction={},ux.layer={},ux.loadingstrategy={},ux.proj={},ux.proj.Units={},ux.proj.proj4={},ux.render={},ux.render.canvas={},ux.renderer={},ux.renderer.canvas={},ux.renderer.webgl={},ux.size={},ux.source={},ux.sphere={},ux.style={},ux.style.IconImageCache={},ux.tilegrid={},ux.xml={},ux.Collection=U,ux.Feature=B,ux.Geolocation=zi,ux.Graticule=Or,ux.Kinetic=br,ux.Map=Ha,ux.Object=D,ux.Observable=F,ux.Observable.unByKey=function(t){if(Array.isArray(t))for(var e=0,i=t.length;e<i;++e)E(t[e]);else E(t)},ux.Overlay=Ja,ux.PluggableMap=lo,ux.View=qn,ux.WebGLMap=Kl,ux.array.stableSort=q,ux.color.asArray=_r,ux.color.asString=dr,ux.colorlike.asColorLike=Ys,ux.control.Attribution=So,ux.control.Attribution.render=Eo,ux.control.Control=uo,ux.control.FullScreen=Zm,ux.control.MousePosition=Qm,ux.control.MousePosition.render=Jm,ux.control.OverviewMap=tx,ux.control.OverviewMap.render=$m,ux.control.Rotate=Co,ux.control.Rotate.render=To,ux.control.ScaleLine=ox,ux.control.ScaleLine.render=nx,ux.control.Zoom=Ro,ux.control.ZoomSlider=hx,ux.control.ZoomSlider.render=ax,ux.control.ZoomToExtent=lx,ux.control.defaults=wo,ux.coordinate.add=Hi,ux.coordinate.createStringXY=function(t){return function(e){return nr(e,t)}},ux.coordinate.format=Ji,ux.coordinate.rotate=$i,ux.coordinate.toStringHDMS=function(t,e){return t?qi("NS",t[1],e)+" "+qi("EW",t[0],e):""},ux.coordinate.toStringXY=nr,ux.easing.easeIn=Vn,ux.easing.easeOut=Xn,ux.easing.inAndOut=zn,ux.easing.linear=Wn,ux.easing.upAndDown=function(t){return t<.5?zn(2*t):1-zn(2*(t-.5))},ux.events.condition.altKeyOnly=Go,ux.events.condition.altShiftKeysOnly=Do,ux.events.condition.always=jo,ux.events.condition.click=function(t){return t.type==Ar.CLICK},ux.events.condition.doubleClick=function(t){return t.type==Ar.DBLCLICK},ux.events.condition.focus=ko,ux.events.condition.mouseOnly=Ko,ux.events.condition.never=Yo,ux.events.condition.noModifierKeys=Xo,ux.events.condition.platformModifierKeyOnly=function(t){var e=t.originalEvent;return!e.altKey&&(Gi?e.metaKey:e.ctrlKey)&&!e.shiftKey},ux.events.condition.pointerMove=Bo,ux.events.condition.primaryAction=Ho,ux.events.condition.shiftKeyOnly=zo,ux.events.condition.singleClick=Vo,ux.events.condition.targetNotEditable=Wo,ux.extent.applyTransform=Ft,ux.extent.boundingExtent=tt,ux.extent.buffer=et,ux.extent.containsCoordinate=nt,ux.extent.containsExtent=ot,ux.extent.containsXY=st,ux.extent.createEmpty=ht,ux.extent.equals=dt,ux.extent.extend=ft,ux.extent.getArea=xt,ux.extent.getBottomLeft=Et,ux.extent.getBottomRight=St,ux.extent.getCenter=Tt,ux.extent.getHeight=Rt,ux.extent.getIntersection=wt,ux.extent.getSize=function(t){return[t[2]-t[0],t[3]-t[1]]},ux.extent.getTopLeft=It,ux.extent.getTopRight=Lt,ux.extent.getWidth=Ot,ux.extent.intersects=Pt,ux.extent.isEmpty=bt,ux.featureloader.xhr=ql,ux.format.EsriJSON=Sd,ux.format.Feature=cd,ux.format.GML=zd,ux.format.GML2=Zd,ux.format.GML3=Vd,ux.format.GML32=Jd,ux.format.GPX=Ff,ux.format.GeoJSON=Gf,ux.format.IGC=Jf,ux.format.KML=Bg,ux.format.MVT=Qg,ux.format.OSMXML=oy,ux.format.Polyline=cy,ux.format.Polyline.decodeDeltas=hy,ux.format.Polyline.decodeFloats=uy,ux.format.Polyline.encodeDeltas=ay,ux.format.Polyline.encodeFloats=ly,ux.format.TopoJSON=my,ux.format.WFS=gv,ux.format.WFS.writeFilter=function(t){var e=tu(Qy,"Filter");return lv(e,t,[]),e},ux.format.WKT=Gv,ux.format.WMSCapabilities=um,ux.format.WMSGetFeatureInfo=pm,ux.format.WMTSCapabilities=Xm,ux.format.filter.Bbox=Cy,ux.format.filter.Contains=wy,ux.format.filter.During=Ly,ux.format.filter.EqualTo=Py,ux.format.filter.GreaterThan=by,ux.format.filter.GreaterThanOrEqualTo=My,ux.format.filter.Intersects=Fy,ux.format.filter.IsBetween=Ay,ux.format.filter.IsLike=Ny,ux.format.filter.IsNull=Gy,ux.format.filter.LessThan=Dy,ux.format.filter.LessThanOrEqualTo=ky,ux.format.filter.Not=jy,ux.format.filter.NotEqualTo=Uy,ux.format.filter.Or=Yy,ux.format.filter.Within=By,ux.format.filter.and=Vy,ux.format.filter.bbox=Xy,ux.format.filter.between=function(t,e,i){return new Ay(t,e,i)},ux.format.filter.contains=function(t,e,i){return new wy(t,e,i)},ux.format.filter.during=function(t,e,i){return new Ly(t,e,i)},ux.format.filter.equalTo=function(t,e,i){return new Py(t,e,i)},ux.format.filter.greaterThan=function(t,e){return new by(t,e)},ux.format.filter.greaterThanOrEqualTo=function(t,e){return new My(t,e)},ux.format.filter.intersects=function(t,e,i){return new Fy(t,e,i)},ux.format.filter.isNull=function(t){return new Gy(t)},ux.format.filter.lessThan=function(t,e){return new Dy(t,e)},ux.format.filter.lessThanOrEqualTo=function(t,e){return new ky(t,e)},ux.format.filter.like=function(t,e,i,r,n,o){return new Ny(t,e,i,r,n,o)},ux.format.filter.not=function(t){return new jy(t)},ux.format.filter.notEqualTo=function(t,e,i){return new Uy(t,e,i)},ux.format.filter.or=function(t){var e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Yy,e))},ux.format.filter.within=function(t,e,i){return new By(t,e,i)},ux.geom.Circle=Oc,ux.geom.Geometry=Xe,ux.geom.GeometryCollection=ud,ux.geom.LineString=hr,ux.geom.LinearRing=pi,ux.geom.MultiLineString=Pc,ux.geom.MultiPoint=bc,ux.geom.MultiPolygon=Fc,ux.geom.Point=ci,ux.geom.Polygon=Ii,ux.geom.Polygon.circular=Li,ux.geom.Polygon.fromCircle=Pi,ux.geom.Polygon.fromExtent=Oi,ux.geom.SimpleGeometry=We,ux.getUid=o,ux.has.DEVICE_PIXEL_RATIO=Di,ux.has.GEOLOCATION=ji,ux.has.TOUCH=Ui,ux.inherits=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},ux.interaction.DoubleClickZoom=No,ux.interaction.DragAndDrop=wc,ux.interaction.DragBox=ns,ux.interaction.DragPan=Jo,ux.interaction.DragRotate=Qo,ux.interaction.DragRotateAndZoom=Ic,ux.interaction.DragZoom=ss,ux.interaction.Draw=kc,ux.interaction.Draw.createBox=function(){return function(t,e){var i=tt(t),r=[[Et(i),St(i),Lt(i),It(i),Et(i)]],n=e;return n?n.setCoordinates(r):n=new Ii(r),n}},ux.interaction.Draw.createRegularPolygon=function(t,e){return function(i,r){var n=i[0],o=i[1],s=Math.sqrt(er(n,o)),a=r||Pi(new Oc(n),t),h=e;if(!e){var l=o[0]-n[0],u=o[1]-n[1];h=Math.atan(u/l)-(l<0?Math.PI:0)}return bi(a,n,s,h),a}},ux.interaction.Extent=Vc,ux.interaction.Interaction=Fo,ux.interaction.KeyboardPan=ls,ux.interaction.KeyboardZoom=ps,ux.interaction.Modify=Jc,ux.interaction.MouseWheelZoom=fs,ux.interaction.PinchRotate=_s,ux.interaction.PinchZoom=gs,ux.interaction.Pointer=qo,ux.interaction.Select=ed,ux.interaction.Snap=rd,ux.interaction.Translate=hd,ux.interaction.defaults=ys,ux.layer.Base=io,ux.layer.Group=oo,ux.layer.Heatmap=mc,ux.layer.Image=bp,ux.layer.Tile=Np,ux.layer.Vector=gc,ux.layer.VectorTile=Ec,ux.loadingstrategy.all=Jl,ux.loadingstrategy.bbox=function(t,e){return[t]},ux.loadingstrategy.tile=function(t){return function(e,i){var r=t.getZForResolution(i),n=t.getTileRangeForExtentAndZ(e,r),o=[],s=[r,0,0];for(s[1]=n.minX;s[1]<=n.maxX;++s[1])for(s[2]=n.minY;s[2]<=n.maxY;++s[2])o.push(t.getTileCoordExtent(s));return o}},ux.proj.Projection=ee,ux.proj.Units.METERS_PER_UNIT=Qt,ux.proj.addCoordinateTransforms=we,ux.proj.addEquivalentProjections=Te,ux.proj.addProjection=xe,ux.proj.equivalent=Ie,ux.proj.fromLonLat=function(t,e){return Pe(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")},ux.proj.get=Ee,ux.proj.getPointResolution=Se,ux.proj.getTransform=Oe,ux.proj.proj4.register=function(t){var e,i,r=Object.keys(t.defs),n=r.length;for(e=0;e<n;++e){var o=r[e];if(!Ee(o)){var s=t.defs(o);xe(new ee({code:o,axisOrientation:s.axis,metersPerUnit:s.to_meter,units:s.units}))}}for(e=0;e<n;++e){var a=r[e],h=Ee(a);for(i=0;i<n;++i){var l=r[i],u=Ee(l);if(!ye(a,l))if(t.defs[a]===t.defs[l])Te([h,u]);else{var p=t(a,l);we(h,u,p.forward,p.inverse)}}}},ux.proj.toLonLat=function(t,e){var i=Pe(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),r=i[0];return(r<-180||r>180)&&(i[0]=Xt(r+180,360)-180),i},ux.proj.transform=Pe,ux.proj.transformExtent=be,ux.render.VectorContext=Vs,ux.render.canvas.labelCache=Ps,ux.render.toContext=function(t,e){var i=t.canvas,r=e||{},n=r.pixelRatio||Di,o=r.size;o&&(i.width=o[0]*n,i.height=o[1]*n,i.style.width=o[0]+"px",i.style.height=o[1]+"px");var s=[0,0,i.width,i.height],a=je([1,0,0,1,0,0],n,n);return new Xs(t,n,s,a,0)},ux.renderer.canvas.ImageLayer=ra,ux.renderer.canvas.Map=Qs,ux.renderer.canvas.TileLayer=ha,ux.renderer.canvas.VectorLayer=Ba,ux.renderer.canvas.VectorTileLayer=Ka,ux.renderer.webgl.ImageLayer=gl,ux.renderer.webgl.Map=yl,ux.renderer.webgl.TileLayer=Xl,ux.renderer.webgl.VectorLayer=Wl,ux.size.toSize=ho,ux.source.BingMaps=tp,ux.source.CartoDB=ip,ux.source.Cluster=sp,ux.source.Image=dp,ux.source.ImageArcGISRest=gp,ux.source.ImageCanvas=yp,ux.source.ImageMapGuide=vp,ux.source.ImageStatic=mp,ux.source.ImageWMS=wp,ux.source.OSM=Lp,ux.source.OSM.ATTRIBUTION=Ip,ux.source.Raster=Vp,ux.source.Source=Il,ux.source.Stamen=Kp,ux.source.Tile=jl,ux.source.TileArcGISRest=Zp,ux.source.TileDebug=Jp,ux.source.TileImage=$u,ux.source.TileJSON=Qp,ux.source.TileWMS=tc,ux.source.UTFGrid=ic,ux.source.Vector=op,ux.source.VectorTile=ac,ux.source.WMTS=lc,ux.source.WMTS.optionsFromCapabilities=function(t,e){var i=H(t.Contents.Layer,function(t,i,r){return t.Identifier==e.layer});if(null===i)return null;var r,n=t.Contents.TileMatrixSet;(r=i.TileMatrixSetLink.length>1?J(i.TileMatrixSetLink,"projection"in e?function(t,i,r){var o=H(n,function(e){return e.Identifier==t.TileMatrixSet}).SupportedCRS,s=Ee(o.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||Ee(o),a=Ee(e.projection);return s&&a?Ie(s,a):o==e.projection}:function(t,i,r){return t.TileMatrixSet==e.matrixSet}):0)<0&&(r=0);var o=i.TileMatrixSetLink[r].TileMatrixSet,s=i.TileMatrixSetLink[r].TileMatrixSetLimits,a=i.Format[0];"format"in e&&(a=e.format),(r=J(i.Style,function(t,i,r){return"style"in e?t.Title==e.style:t.isDefault}))<0&&(r=0);var h=i.Style[r].Identifier,l={};"Dimension"in i&&i.Dimension.forEach(function(t,e,i){var r=t.Identifier,n=t.Default;void 0===n&&(n=t.Value[0]),l[r]=n});var u,p=H(t.Contents.TileMatrixSet,function(t,e,i){return t.Identifier==o}),c=p.SupportedCRS;if(c&&(u=Ee(c.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||Ee(c)),"projection"in e){var d=Ee(e.projection);d&&(u&&!Ie(d,u)||(u=d))}var f,_,g=i.WGS84BoundingBox;if(void 0!==g){var y=Ee("EPSG:4326").getExtent();_=g[0]==y[0]&&g[2]==y[2],f=be(g,"EPSG:4326",u);var v=u.getExtent();v&&(ot(v,f)||(f=void 0))}var m=Eu(p,f,s),x=[],E=e.requestEncoding;if(E=void 0!==E?E:"","OperationsMetadata"in t&&"GetTile"in t.OperationsMetadata)for(var S=t.OperationsMetadata.GetTile.DCP.HTTP.Get,T=0,C=S.length;T<C;++T)if(S[T].Constraint){var R=H(S[T].Constraint,function(t){return"GetEncoding"==t.name}).AllowedValues.Value;if(""===E&&(E=R[0]),E!==hc.KVP)break;X(R,hc.KVP)&&x.push(S[T].href)}else S[T].href&&(E=hc.KVP,x.push(S[T].href));return 0===x.length&&(E=hc.REST,i.ResourceURL.forEach(function(t){"tile"===t.resourceType&&(a=t.format,x.push(t.template))})),{urls:x,layer:e.layer,matrixSet:o,format:a,projection:u,requestEncoding:E,tileGrid:m,style:h,dimensions:l,wrapX:_,crossOrigin:e.crossOrigin}},ux.source.XYZ=ep,ux.source.Zoomify=dc,ux.sphere.getArea=function t(e,i){var r=i||{},n=r.radius||Wt,o=r.projection||"EPSG:3857",s=e.getType();s!==Nt.GEOMETRY_COLLECTION&&(e=e.clone().transform(o,"EPSG:4326"));var a,h,l,u,p,c,d=0;switch(s){case Nt.POINT:case Nt.MULTI_POINT:case Nt.LINE_STRING:case Nt.MULTI_LINE_STRING:case Nt.LINEAR_RING:break;case Nt.POLYGON:for(a=e.getCoordinates(),d=Math.abs(Zt(a[0],n)),l=1,u=a.length;l<u;++l)d-=Math.abs(Zt(a[l],n));break;case Nt.MULTI_POLYGON:for(l=0,u=(a=e.getCoordinates()).length;l<u;++l)for(h=a[l],d+=Math.abs(Zt(h[0],n)),p=1,c=h.length;p<c;++p)d-=Math.abs(Zt(h[p],n));break;case Nt.GEOMETRY_COLLECTION:var f=e.getGeometries();for(l=0,u=f.length;l<u;++l)d+=t(f[l],i);break;default:throw new Error("Unsupported geometry type: "+s)}return d},ux.sphere.getDistance=Kt,ux.sphere.getLength=function t(e,i){var r=i||{},n=r.radius||Wt,o=r.projection||"EPSG:3857",s=e.getType();s!==Nt.GEOMETRY_COLLECTION&&(e=e.clone().transform(o,"EPSG:4326"));var a,h,l,u,p,c,d=0;switch(s){case Nt.POINT:case Nt.MULTI_POINT:break;case Nt.LINE_STRING:case Nt.LINEAR_RING:d=Ht(a=e.getCoordinates(),n);break;case Nt.MULTI_LINE_STRING:case Nt.POLYGON:for(l=0,u=(a=e.getCoordinates()).length;l<u;++l)d+=Ht(a[l],n);break;case Nt.MULTI_POLYGON:for(l=0,u=(a=e.getCoordinates()).length;l<u;++l)for(p=0,c=(h=a[l]).length;p<c;++p)d+=Ht(h[p],n);break;case Nt.GEOMETRY_COLLECTION:var f=e.getGeometries();for(l=0,u=f.length;l<u;++l)d+=t(f[l],i);break;default:throw new Error("Unsupported geometry type: "+s)}return d},ux.style.AtlasManager=ol,ux.style.Circle=Ru,ux.style.Fill=mr,ux.style.Icon=Ou,ux.style.IconImageCache.shared=Ks,ux.style.Image=Tu,ux.style.RegularShape=Cu,ux.style.Stroke=Er,ux.style.Style=Nu,ux.style.Text=Rr,ux.tilegrid.TileGrid=Pl,ux.tilegrid.WMTS=xu,ux.tilegrid.WMTS.createFromCapabilitiesMatrixSet=Eu,ux.tilegrid.createXYZ=Fl,ux.xml.getAllTextContent=eu,ux.xml.parse=ru;e.default=ux}]).default});
   /* Ende openlayers */
   /* Start slick */
   (function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{if(typeof exports!=="undefined"){module.exports=factory(require("jquery"));}else{factory(jQuery);}}}(function($){var Slick=window.Slick||{};Slick=(function(){var instanceUid=0;function Slick(element,settings){var _=this,dataSettings;_.defaults={accessibility:true,adaptiveHeight:false,appendArrows:$(element),appendDots:$(element),arrows:true,asNavFor:null,prevArrow:'<button class="slick-prev" aria-label="Previous" type="button">Previous</button>',nextArrow:'<button class="slick-next" aria-label="Next" type="button">Next</button>',autoplay:false,autoplaySpeed:3000,centerMode:false,centerPadding:"50px",cssEase:"ease",customPaging:function(slider,i){return $('<button type="button" />').text(i+1);},dots:false,dotsClass:"slick-dots",draggable:true,easing:"linear",edgeFriction:0.35,fade:false,focusOnSelect:false,focusOnChange:false,infinite:true,initialSlide:0,lazyLoad:"ondemand",mobileFirst:false,pauseOnHover:true,pauseOnFocus:true,pauseOnDotsHover:false,respondTo:"window",responsive:null,rows:1,rtl:false,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:true,swipeToSlide:false,touchMove:true,touchThreshold:5,useCSS:true,useTransform:true,variableWidth:false,vertical:false,verticalSwiping:false,waitForAnimate:true,zIndex:1000};_.initials={animating:false,dragging:false,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:false,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:false,slideOffset:0,swipeLeft:null,swiping:false,$list:null,touchObject:{},transformsEnabled:false,unslicked:false};$.extend(_,_.initials);_.activeBreakpoint=null;_.animType=null;_.animProp=null;_.breakpoints=[];_.breakpointSettings=[];_.cssTransitions=false;_.focussed=false;_.interrupted=false;_.hidden="hidden";_.paused=true;_.positionProp=null;_.respondTo=null;_.rowCount=1;_.shouldClick=true;_.$slider=$(element);_.$slidesCache=null;_.transformType=null;_.transitionType=null;_.visibilityChange="visibilitychange";_.windowWidth=0;_.windowTimer=null;dataSettings=$(element).data("slick")||{};_.options=$.extend({},_.defaults,settings,dataSettings);_.currentSlide=_.options.initialSlide;_.originalSettings=_.options;if(typeof document.mozHidden!=="undefined"){_.hidden="mozHidden";_.visibilityChange="mozvisibilitychange";}else{if(typeof document.webkitHidden!=="undefined"){_.hidden="webkitHidden";_.visibilityChange="webkitvisibilitychange";}}_.autoPlay=$.proxy(_.autoPlay,_);_.autoPlayClear=$.proxy(_.autoPlayClear,_);_.autoPlayIterator=$.proxy(_.autoPlayIterator,_);_.changeSlide=$.proxy(_.changeSlide,_);_.clickHandler=$.proxy(_.clickHandler,_);_.selectHandler=$.proxy(_.selectHandler,_);_.setPosition=$.proxy(_.setPosition,_);_.swipeHandler=$.proxy(_.swipeHandler,_);_.dragHandler=$.proxy(_.dragHandler,_);_.keyHandler=$.proxy(_.keyHandler,_);_.instanceUid=instanceUid++;_.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/;_.registerBreakpoints();_.init(true);}return Slick;}());Slick.prototype.activateADA=function(){var _=this;_.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({"tabindex":"0"});};Slick.prototype.addSlide=Slick.prototype.slickAdd=function(markup,index,addBefore){var _=this;if(typeof(index)==="boolean"){addBefore=index;index=null;}else{if(index<0||(index>=_.slideCount)){return false;}}_.unload();if(typeof(index)==="number"){if(index===0&&_.$slides.length===0){$(markup).appendTo(_.$slideTrack);}else{if(addBefore){$(markup).insertBefore(_.$slides.eq(index));}else{$(markup).insertAfter(_.$slides.eq(index));}}}else{if(addBefore===true){$(markup).prependTo(_.$slideTrack);}else{$(markup).appendTo(_.$slideTrack);}}_.$slides=_.$slideTrack.children(this.options.slide);_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.append(_.$slides);_.$slides.each(function(index,element){$(element).attr("data-slick-index",index);});_.$slidesCache=_.$slides;_.reinit();};Slick.prototype.animateHeight=function(){var _=this;if(_.options.slidesToShow===1&&_.options.adaptiveHeight===true&&_.options.vertical===false){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(true);_.$list.animate({height:targetHeight},_.options.speed);}};Slick.prototype.animateSlide=function(targetLeft,callback){var animProps={},_=this;_.animateHeight();if(_.options.rtl===true&&_.options.vertical===false){targetLeft=-targetLeft;}if(_.transformsEnabled===false){if(_.options.vertical===false){_.$slideTrack.animate({left:targetLeft},_.options.speed,_.options.easing,callback);}else{_.$slideTrack.animate({top:targetLeft},_.options.speed,_.options.easing,callback);}}else{if(_.cssTransitions===false){if(_.options.rtl===true){_.currentLeft=-(_.currentLeft);}$({animStart:_.currentLeft}).animate({animStart:targetLeft},{duration:_.options.speed,easing:_.options.easing,step:function(now){now=Math.ceil(now);if(_.options.vertical===false){animProps[_.animType]="translate("+now+"px, 0px)";_.$slideTrack.css(animProps);}else{animProps[_.animType]="translate(0px,"+now+"px)";_.$slideTrack.css(animProps);}},complete:function(){if(callback){callback.call();}}});}else{_.applyTransition();targetLeft=Math.ceil(targetLeft);if(_.options.vertical===false){animProps[_.animType]="translate3d("+targetLeft+"px, 0px, 0px)";}else{animProps[_.animType]="translate3d(0px,"+targetLeft+"px, 0px)";}_.$slideTrack.css(animProps);if(callback){setTimeout(function(){_.disableTransition();callback.call();},_.options.speed);}}}};Slick.prototype.getNavTarget=function(){var _=this,asNavFor=_.options.asNavFor;if(asNavFor&&asNavFor!==null){asNavFor=$(asNavFor).not(_.$slider);}return asNavFor;};Slick.prototype.asNavFor=function(index){var _=this,asNavFor=_.getNavTarget();if(asNavFor!==null&&typeof asNavFor==="object"){asNavFor.each(function(){var target=$(this).slick("getSlick");if(!target.unslicked){target.slideHandler(index,true);}});}};Slick.prototype.applyTransition=function(slide){var _=this,transition={};if(_.options.fade===false){transition[_.transitionType]=_.transformType+" "+_.options.speed+"ms "+_.options.cssEase;}else{transition[_.transitionType]="opacity "+_.options.speed+"ms "+_.options.cssEase;}if(_.options.fade===false){_.$slideTrack.css(transition);}else{_.$slides.eq(slide).css(transition);}};Slick.prototype.autoPlay=function(){var _=this;_.autoPlayClear();if(_.slideCount>_.options.slidesToShow){_.autoPlayTimer=setInterval(_.autoPlayIterator,_.options.autoplaySpeed);}};Slick.prototype.autoPlayClear=function(){var _=this;if(_.autoPlayTimer){clearInterval(_.autoPlayTimer);}};Slick.prototype.autoPlayIterator=function(){var _=this,slideTo=_.currentSlide+_.options.slidesToScroll;if(!_.paused&&!_.interrupted&&!_.focussed){if(_.options.infinite===false){if(_.direction===1&&(_.currentSlide+1)===(_.slideCount-1)){_.direction=0;}else{if(_.direction===0){slideTo=_.currentSlide-_.options.slidesToScroll;if(_.currentSlide-1===0){_.direction=1;}}}}_.slideHandler(slideTo);}};Slick.prototype.buildArrows=function(){var _=this;if(_.options.arrows===true){_.$prevArrow=$(_.options.prevArrow).addClass("slick-arrow");_.$nextArrow=$(_.options.nextArrow).addClass("slick-arrow");if(_.slideCount>_.options.slidesToShow){_.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex");_.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex");if(_.htmlExpr.test(_.options.prevArrow)){_.$prevArrow.prependTo(_.options.appendArrows);}if(_.htmlExpr.test(_.options.nextArrow)){_.$nextArrow.appendTo(_.options.appendArrows);}if(_.options.infinite!==true){_.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true");}}else{_.$prevArrow.add(_.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true","tabindex":"-1"});}}};Slick.prototype.buildDots=function(){var _=this,i,dot;if(_.options.dots===true){_.$slider.addClass("slick-dotted");dot=$("<ul />").addClass(_.options.dotsClass);for(i=0;i<=_.getDotCount();i+=1){dot.append($("<li />").append(_.options.customPaging.call(this,_,i)));}_.$dots=dot.appendTo(_.options.appendDots);_.$dots.find("li").first().addClass("slick-active");}};Slick.prototype.buildOut=function(){var _=this;_.$slides=_.$slider.children(_.options.slide+":not(.slick-cloned)").addClass("slick-slide");_.slideCount=_.$slides.length;_.$slides.each(function(index,element){$(element).attr("data-slick-index",index).data("originalStyling",$(element).attr("style")||"");});_.$slider.addClass("slick-slider");_.$slideTrack=(_.slideCount===0)?$('<div class="slick-track"/>').appendTo(_.$slider):_.$slides.wrapAll('<div class="slick-track"/>').parent();_.$list=_.$slideTrack.wrap('<div class="slick-list"/>').parent();_.$slideTrack.css("opacity",0);if(_.options.centerMode===true||_.options.swipeToSlide===true){_.options.slidesToScroll=1;}$("img[data-lazy]",_.$slider).not("[src]").addClass("slick-loading");_.setupInfinite();_.buildArrows();_.buildDots();_.updateDots();_.setSlideClasses(typeof _.currentSlide==="number"?_.currentSlide:0);if(_.options.draggable===true){_.$list.addClass("draggable");}};Slick.prototype.buildRows=function(){var _=this,a,b,c,newSlides,numOfSlides,originalSlides,slidesPerSection;newSlides=document.createDocumentFragment();originalSlides=_.$slider.children();if(_.options.rows>1){slidesPerSection=_.options.slidesPerRow*_.options.rows;numOfSlides=Math.ceil(originalSlides.length/slidesPerSection);for(a=0;a<numOfSlides;a++){var slide=document.createElement("div");for(b=0;b<_.options.rows;b++){var row=document.createElement("div");for(c=0;c<_.options.slidesPerRow;c++){var target=(a*slidesPerSection+((b*_.options.slidesPerRow)+c));if(originalSlides.get(target)){row.appendChild(originalSlides.get(target));}}slide.appendChild(row);}newSlides.appendChild(slide);}_.$slider.empty().append(newSlides);_.$slider.children().children().children().css({"width":(100/_.options.slidesPerRow)+"%","display":"inline-block"});}};Slick.prototype.checkResponsive=function(initial,forceUpdate){var _=this,breakpoint,targetBreakpoint,respondToWidth,triggerBreakpoint=false;var sliderWidth=_.$slider.width();var windowWidth=window.innerWidth||$(window).width();if(_.respondTo==="window"){respondToWidth=windowWidth;}else{if(_.respondTo==="slider"){respondToWidth=sliderWidth;}else{if(_.respondTo==="min"){respondToWidth=Math.min(windowWidth,sliderWidth);}}}if(_.options.responsive&&_.options.responsive.length&&_.options.responsive!==null){targetBreakpoint=null;for(breakpoint in _.breakpoints){if(_.breakpoints.hasOwnProperty(breakpoint)){if(_.originalSettings.mobileFirst===false){if(respondToWidth<_.breakpoints[breakpoint]){targetBreakpoint=_.breakpoints[breakpoint];}}else{if(respondToWidth>_.breakpoints[breakpoint]){targetBreakpoint=_.breakpoints[breakpoint];}}}}if(targetBreakpoint!==null){if(_.activeBreakpoint!==null){if(targetBreakpoint!==_.activeBreakpoint||forceUpdate){_.activeBreakpoint=targetBreakpoint;if(_.breakpointSettings[targetBreakpoint]==="unslick"){_.unslick(targetBreakpoint);}else{_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]);if(initial===true){_.currentSlide=_.options.initialSlide;}_.refresh(initial);}triggerBreakpoint=targetBreakpoint;}}else{_.activeBreakpoint=targetBreakpoint;if(_.breakpointSettings[targetBreakpoint]==="unslick"){_.unslick(targetBreakpoint);}else{_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]);if(initial===true){_.currentSlide=_.options.initialSlide;}_.refresh(initial);}triggerBreakpoint=targetBreakpoint;}}else{if(_.activeBreakpoint!==null){_.activeBreakpoint=null;_.options=_.originalSettings;if(initial===true){_.currentSlide=_.options.initialSlide;}_.refresh(initial);triggerBreakpoint=targetBreakpoint;}}if(!initial&&triggerBreakpoint!==false){_.$slider.trigger("breakpoint",[_,triggerBreakpoint]);}}};Slick.prototype.changeSlide=function(event,dontAnimate){var _=this,$target=$(event.currentTarget),indexOffset,slideOffset,unevenOffset;if($target.is("a")){event.preventDefault();}if(!$target.is("li")){$target=$target.closest("li");}unevenOffset=(_.slideCount%_.options.slidesToScroll!==0);indexOffset=unevenOffset?0:(_.slideCount-_.currentSlide)%_.options.slidesToScroll;switch(event.data.message){case"previous":slideOffset=indexOffset===0?_.options.slidesToScroll:_.options.slidesToShow-indexOffset;if(_.slideCount>_.options.slidesToShow){_.slideHandler(_.currentSlide-slideOffset,false,dontAnimate);}break;case"next":slideOffset=indexOffset===0?_.options.slidesToScroll:indexOffset;if(_.slideCount>_.options.slidesToShow){_.slideHandler(_.currentSlide+slideOffset,false,dontAnimate);}break;case"index":var index=event.data.index===0?0:event.data.index||$target.index()*_.options.slidesToScroll;_.slideHandler(_.checkNavigable(index),false,dontAnimate);$target.children().trigger("focus");break;default:return;}};Slick.prototype.checkNavigable=function(index){var _=this,navigables,prevNavigable;navigables=_.getNavigableIndexes();prevNavigable=0;if(index>navigables[navigables.length-1]){index=navigables[navigables.length-1];}else{for(var n in navigables){if(index<navigables[n]){index=prevNavigable;break;}prevNavigable=navigables[n];}}return index;};Slick.prototype.cleanUpEvents=function(){var _=this;if(_.options.dots&&_.$dots!==null){$("li",_.$dots).off("click.slick",_.changeSlide).off("mouseenter.slick",$.proxy(_.interrupt,_,true)).off("mouseleave.slick",$.proxy(_.interrupt,_,false));if(_.options.accessibility===true){_.$dots.off("keydown.slick",_.keyHandler);}}_.$slider.off("focus.slick blur.slick");if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow&&_.$prevArrow.off("click.slick",_.changeSlide);_.$nextArrow&&_.$nextArrow.off("click.slick",_.changeSlide);if(_.options.accessibility===true){_.$prevArrow&&_.$prevArrow.off("keydown.slick",_.keyHandler);_.$nextArrow&&_.$nextArrow.off("keydown.slick",_.keyHandler);}}_.$list.off("touchstart.slick mousedown.slick",_.swipeHandler);_.$list.off("touchmove.slick mousemove.slick",_.swipeHandler);_.$list.off("touchend.slick mouseup.slick",_.swipeHandler);_.$list.off("touchcancel.slick mouseleave.slick",_.swipeHandler);_.$list.off("click.slick",_.clickHandler);$(document).off(_.visibilityChange,_.visibility);_.cleanUpSlideEvents();if(_.options.accessibility===true){_.$list.off("keydown.slick",_.keyHandler);}if(_.options.focusOnSelect===true){$(_.$slideTrack).children().off("click.slick",_.selectHandler);}$(window).off("orientationchange.slick.slick-"+_.instanceUid,_.orientationChange);$(window).off("resize.slick.slick-"+_.instanceUid,_.resize);$("[draggable!=true]",_.$slideTrack).off("dragstart",_.preventDefault);$(window).off("load.slick.slick-"+_.instanceUid,_.setPosition);};Slick.prototype.cleanUpSlideEvents=function(){var _=this;_.$list.off("mouseenter.slick",$.proxy(_.interrupt,_,true));_.$list.off("mouseleave.slick",$.proxy(_.interrupt,_,false));};Slick.prototype.cleanUpRows=function(){var _=this,originalSlides;if(_.options.rows>1){originalSlides=_.$slides.children().children();originalSlides.removeAttr("style");_.$slider.empty().append(originalSlides);}};Slick.prototype.clickHandler=function(event){var _=this;if(_.shouldClick===false){event.stopImmediatePropagation();event.stopPropagation();event.preventDefault();}};Slick.prototype.destroy=function(refresh){var _=this;_.autoPlayClear();_.touchObject={};_.cleanUpEvents();$(".slick-cloned",_.$slider).detach();if(_.$dots){_.$dots.remove();}if(_.$prevArrow&&_.$prevArrow.length){_.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display","");if(_.htmlExpr.test(_.options.prevArrow)){_.$prevArrow.remove();}}if(_.$nextArrow&&_.$nextArrow.length){_.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display","");if(_.htmlExpr.test(_.options.nextArrow)){_.$nextArrow.remove();}}if(_.$slides){_.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){$(this).attr("style",$(this).data("originalStyling"));});_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.detach();_.$list.detach();_.$slider.append(_.$slides);}_.cleanUpRows();_.$slider.removeClass("slick-slider");_.$slider.removeClass("slick-initialized");_.$slider.removeClass("slick-dotted");_.unslicked=true;if(!refresh){_.$slider.trigger("destroy",[_]);}};Slick.prototype.disableTransition=function(slide){var _=this,transition={};transition[_.transitionType]="";if(_.options.fade===false){_.$slideTrack.css(transition);}else{_.$slides.eq(slide).css(transition);}};Slick.prototype.fadeSlide=function(slideIndex,callback){var _=this;if(_.cssTransitions===false){_.$slides.eq(slideIndex).css({zIndex:_.options.zIndex});_.$slides.eq(slideIndex).animate({opacity:1},_.options.speed,_.options.easing,callback);}else{_.applyTransition(slideIndex);_.$slides.eq(slideIndex).css({opacity:1,zIndex:_.options.zIndex});if(callback){setTimeout(function(){_.disableTransition(slideIndex);callback.call();},_.options.speed);}}};Slick.prototype.fadeSlideOut=function(slideIndex){var _=this;if(_.cssTransitions===false){_.$slides.eq(slideIndex).animate({opacity:0,zIndex:_.options.zIndex-2},_.options.speed,_.options.easing);}else{_.applyTransition(slideIndex);_.$slides.eq(slideIndex).css({opacity:0,zIndex:_.options.zIndex-2});}};Slick.prototype.filterSlides=Slick.prototype.slickFilter=function(filter){var _=this;if(filter!==null){_.$slidesCache=_.$slides;_.unload();_.$slideTrack.children(this.options.slide).detach();_.$slidesCache.filter(filter).appendTo(_.$slideTrack);_.reinit();}};Slick.prototype.focusHandler=function(){var _=this;_.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(event){event.stopImmediatePropagation();var $sf=$(this);setTimeout(function(){if(_.options.pauseOnFocus){_.focussed=$sf.is(":focus");_.autoPlay();}},0);});};Slick.prototype.getCurrent=Slick.prototype.slickCurrentSlide=function(){var _=this;return _.currentSlide;};Slick.prototype.getDotCount=function(){var _=this;var breakPoint=0;var counter=0;var pagerQty=0;if(_.options.infinite===true){if(_.slideCount<=_.options.slidesToShow){++pagerQty;}else{while(breakPoint<_.slideCount){++pagerQty;breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;}}}else{if(_.options.centerMode===true){pagerQty=_.slideCount;}else{if(!_.options.asNavFor){pagerQty=1+Math.ceil((_.slideCount-_.options.slidesToShow)/_.options.slidesToScroll);}else{while(breakPoint<_.slideCount){++pagerQty;breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;}}}}return pagerQty-1;};Slick.prototype.getLeft=function(slideIndex){var _=this,targetLeft,verticalHeight,verticalOffset=0,targetSlide,coef;_.slideOffset=0;verticalHeight=_.$slides.first().outerHeight(true);if(_.options.infinite===true){if(_.slideCount>_.options.slidesToShow){_.slideOffset=(_.slideWidth*_.options.slidesToShow)*-1;coef=-1;if(_.options.vertical===true&&_.options.centerMode===true){if(_.options.slidesToShow===2){coef=-1.5;}else{if(_.options.slidesToShow===1){coef=-2;}}}verticalOffset=(verticalHeight*_.options.slidesToShow)*coef;}if(_.slideCount%_.options.slidesToScroll!==0){if(slideIndex+_.options.slidesToScroll>_.slideCount&&_.slideCount>_.options.slidesToShow){if(slideIndex>_.slideCount){_.slideOffset=((_.options.slidesToShow-(slideIndex-_.slideCount))*_.slideWidth)*-1;verticalOffset=((_.options.slidesToShow-(slideIndex-_.slideCount))*verticalHeight)*-1;}else{_.slideOffset=((_.slideCount%_.options.slidesToScroll)*_.slideWidth)*-1;verticalOffset=((_.slideCount%_.options.slidesToScroll)*verticalHeight)*-1;}}}}else{if(slideIndex+_.options.slidesToShow>_.slideCount){_.slideOffset=((slideIndex+_.options.slidesToShow)-_.slideCount)*_.slideWidth;verticalOffset=((slideIndex+_.options.slidesToShow)-_.slideCount)*verticalHeight;}}if(_.slideCount<=_.options.slidesToShow){_.slideOffset=0;verticalOffset=0;}if(_.options.centerMode===true&&_.slideCount<=_.options.slidesToShow){_.slideOffset=((_.slideWidth*Math.floor(_.options.slidesToShow))/2)-((_.slideWidth*_.slideCount)/2);}else{if(_.options.centerMode===true&&_.options.infinite===true){_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2)-_.slideWidth;}else{if(_.options.centerMode===true){_.slideOffset=0;_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2);}}}if(_.options.vertical===false){targetLeft=((slideIndex*_.slideWidth)*-1)+_.slideOffset;}else{targetLeft=((slideIndex*verticalHeight)*-1)+verticalOffset;}if(_.options.variableWidth===true){if(_.slideCount<=_.options.slidesToShow||_.options.infinite===false){targetSlide=_.$slideTrack.children(".slick-slide").eq(slideIndex);}else{targetSlide=_.$slideTrack.children(".slick-slide").eq(slideIndex+_.options.slidesToShow);}if(_.options.rtl===true){if(targetSlide[0]){targetLeft=(_.$slideTrack.width()-targetSlide[0].offsetLeft-targetSlide.width())*-1;}else{targetLeft=0;}}else{targetLeft=targetSlide[0]?targetSlide[0].offsetLeft*-1:0;}if(_.options.centerMode===true){if(_.slideCount<=_.options.slidesToShow||_.options.infinite===false){targetSlide=_.$slideTrack.children(".slick-slide").eq(slideIndex);}else{targetSlide=_.$slideTrack.children(".slick-slide").eq(slideIndex+_.options.slidesToShow+1);}if(_.options.rtl===true){if(targetSlide[0]){targetLeft=(_.$slideTrack.width()-targetSlide[0].offsetLeft-targetSlide.width())*-1;}else{targetLeft=0;}}else{targetLeft=targetSlide[0]?targetSlide[0].offsetLeft*-1:0;}targetLeft+=(_.$list.width()-targetSlide.outerWidth())/2;}}return targetLeft;};Slick.prototype.getOption=Slick.prototype.slickGetOption=function(option){var _=this;return _.options[option];};Slick.prototype.getNavigableIndexes=function(){var _=this,breakPoint=0,counter=0,indexes=[],max;if(_.options.infinite===false){max=_.slideCount;}else{breakPoint=_.options.slidesToScroll*-1;counter=_.options.slidesToScroll*-1;max=_.slideCount*2;}while(breakPoint<max){indexes.push(breakPoint);breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;}return indexes;};Slick.prototype.getSlick=function(){return this;};Slick.prototype.getSlideCount=function(){var _=this,slidesTraversed,swipedSlide,centerOffset;centerOffset=_.options.centerMode===true?_.slideWidth*Math.floor(_.options.slidesToShow/2):0;if(_.options.swipeToSlide===true){_.$slideTrack.find(".slick-slide").each(function(index,slide){if(slide.offsetLeft-centerOffset+($(slide).outerWidth()/2)>(_.swipeLeft*-1)){swipedSlide=slide;return false;}});slidesTraversed=Math.abs($(swipedSlide).attr("data-slick-index")-_.currentSlide)||1;return slidesTraversed;}else{return _.options.slidesToScroll;}};Slick.prototype.goTo=Slick.prototype.slickGoTo=function(slide,dontAnimate){var _=this;_.changeSlide({data:{message:"index",index:parseInt(slide)}},dontAnimate);};Slick.prototype.init=function(creation){var _=this;if(!$(_.$slider).hasClass("slick-initialized")){$(_.$slider).addClass("slick-initialized");_.buildRows();_.buildOut();_.setProps();_.startLoad();_.loadSlider();_.initializeEvents();_.updateArrows();_.updateDots();_.checkResponsive(true);_.focusHandler();}if(creation){_.$slider.trigger("init",[_]);}if(_.options.accessibility===true){_.initADA();}if(_.options.autoplay){_.paused=false;_.autoPlay();}};Slick.prototype.initADA=function(){var _=this,numDotGroups=Math.ceil(_.slideCount/_.options.slidesToShow),tabControlIndexes=_.getNavigableIndexes().filter(function(val){return(val>=0)&&(val<_.slideCount);});_.$slides.add(_.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true","tabindex":"-1"}).find("a, input, button, select").attr({"tabindex":"-1"});if(_.$dots!==null){_.$slides.not(_.$slideTrack.find(".slick-cloned")).each(function(i){var slideControlIndex=tabControlIndexes.indexOf(i);$(this).attr({"role":"tabpanel","id":"slick-slide"+_.instanceUid+i,"tabindex":-1});if(slideControlIndex!==-1){$(this).attr({"aria-describedby":"slick-slide-control"+_.instanceUid+slideControlIndex});}});_.$dots.attr("role","tablist").find("li").each(function(i){var mappedSlideIndex=tabControlIndexes[i];$(this).attr({"role":"presentation"});$(this).find("button").first().attr({"role":"tab","id":"slick-slide-control"+_.instanceUid+i,"aria-controls":"slick-slide"+_.instanceUid+mappedSlideIndex,"aria-label":(i+1)+" of "+numDotGroups,"aria-selected":null,"tabindex":"-1"});}).eq(_.currentSlide).find("button").attr({"aria-selected":"true","tabindex":"0"}).end();}for(var i=_.currentSlide,max=i+_.options.slidesToShow;i<max;i++){_.$slides.eq(i).attr("tabindex",0);}_.activateADA();};Slick.prototype.initArrowEvents=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},_.changeSlide);_.$nextArrow.off("click.slick").on("click.slick",{message:"next"},_.changeSlide);if(_.options.accessibility===true){_.$prevArrow.on("keydown.slick",_.keyHandler);_.$nextArrow.on("keydown.slick",_.keyHandler);}}};Slick.prototype.initDotEvents=function(){var _=this;if(_.options.dots===true){$("li",_.$dots).on("click.slick",{message:"index"},_.changeSlide);if(_.options.accessibility===true){_.$dots.on("keydown.slick",_.keyHandler);}}if(_.options.dots===true&&_.options.pauseOnDotsHover===true){$("li",_.$dots).on("mouseenter.slick",$.proxy(_.interrupt,_,true)).on("mouseleave.slick",$.proxy(_.interrupt,_,false));}};Slick.prototype.initSlideEvents=function(){var _=this;if(_.options.pauseOnHover){_.$list.on("mouseenter.slick",$.proxy(_.interrupt,_,true));_.$list.on("mouseleave.slick",$.proxy(_.interrupt,_,false));}};Slick.prototype.initializeEvents=function(){var _=this;_.initArrowEvents();_.initDotEvents();_.initSlideEvents();_.$list.on("touchstart.slick mousedown.slick",{action:"start"},_.swipeHandler);_.$list.on("touchmove.slick mousemove.slick",{action:"move"},_.swipeHandler);_.$list.on("touchend.slick mouseup.slick",{action:"end"},_.swipeHandler);_.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},_.swipeHandler);_.$list.on("click.slick",_.clickHandler);$(document).on(_.visibilityChange,$.proxy(_.visibility,_));if(_.options.accessibility===true){_.$list.on("keydown.slick",_.keyHandler);}if(_.options.focusOnSelect===true){$(_.$slideTrack).children().on("click.slick",_.selectHandler);}$(window).on("orientationchange.slick.slick-"+_.instanceUid,$.proxy(_.orientationChange,_));$(window).on("resize.slick.slick-"+_.instanceUid,$.proxy(_.resize,_));$("[draggable!=true]",_.$slideTrack).on("dragstart",_.preventDefault);$(window).on("load.slick.slick-"+_.instanceUid,_.setPosition);$(_.setPosition);};Slick.prototype.initUI=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.show();_.$nextArrow.show();}if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){_.$dots.show();}};Slick.prototype.keyHandler=function(event){var _=this;if(!event.target.tagName.match("TEXTAREA|INPUT|SELECT")){if(event.keyCode===37&&_.options.accessibility===true){_.changeSlide({data:{message:_.options.rtl===true?"next":"previous"}});}else{if(event.keyCode===39&&_.options.accessibility===true){_.changeSlide({data:{message:_.options.rtl===true?"previous":"next"}});}}}};Slick.prototype.lazyLoad=function(){var _=this,loadRange,cloneRange,rangeStart,rangeEnd;function loadImages(imagesScope){$("img[data-lazy]",imagesScope).each(function(){var image=$(this),imageSource=$(this).attr("data-lazy"),imageSrcSet=$(this).attr("data-srcset"),imageSizes=$(this).attr("data-sizes")||_.$slider.attr("data-sizes"),imageToLoad=document.createElement("img");imageToLoad.onload=function(){image.animate({opacity:0},100,function(){if(imageSrcSet){image.attr("srcset",imageSrcSet);if(imageSizes){image.attr("sizes",imageSizes);}}image.attr("src",imageSource).animate({opacity:1},200,function(){image.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading");});_.$slider.trigger("lazyLoaded",[_,image,imageSource]);});};imageToLoad.onerror=function(){image.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error");_.$slider.trigger("lazyLoadError",[_,image,imageSource]);};imageToLoad.src=imageSource;});}if(_.options.centerMode===true){if(_.options.infinite===true){rangeStart=_.currentSlide+(_.options.slidesToShow/2+1);rangeEnd=rangeStart+_.options.slidesToShow+2;}else{rangeStart=Math.max(0,_.currentSlide-(_.options.slidesToShow/2+1));rangeEnd=2+(_.options.slidesToShow/2+1)+_.currentSlide;}}else{rangeStart=_.options.infinite?_.options.slidesToShow+_.currentSlide:_.currentSlide;rangeEnd=Math.ceil(rangeStart+_.options.slidesToShow);if(_.options.fade===true){if(rangeStart>0){rangeStart--;}if(rangeEnd<=_.slideCount){rangeEnd++;}}}loadRange=_.$slider.find(".slick-slide").slice(rangeStart,rangeEnd);if(_.options.lazyLoad==="anticipated"){var prevSlide=rangeStart-1,nextSlide=rangeEnd,$slides=_.$slider.find(".slick-slide");for(var i=0;i<_.options.slidesToScroll;i++){if(prevSlide<0){prevSlide=_.slideCount-1;}loadRange=loadRange.add($slides.eq(prevSlide));loadRange=loadRange.add($slides.eq(nextSlide));prevSlide--;nextSlide++;}}loadImages(loadRange);if(_.slideCount<=_.options.slidesToShow){cloneRange=_.$slider.find(".slick-slide");loadImages(cloneRange);}else{if(_.currentSlide>=_.slideCount-_.options.slidesToShow){cloneRange=_.$slider.find(".slick-cloned").slice(0,_.options.slidesToShow);loadImages(cloneRange);}else{if(_.currentSlide===0){cloneRange=_.$slider.find(".slick-cloned").slice(_.options.slidesToShow*-1);loadImages(cloneRange);}}}};Slick.prototype.loadSlider=function(){var _=this;_.setPosition();_.$slideTrack.css({opacity:1});_.$slider.removeClass("slick-loading");_.initUI();if(_.options.lazyLoad==="progressive"){_.progressiveLazyLoad();}};Slick.prototype.next=Slick.prototype.slickNext=function(){var _=this;_.changeSlide({data:{message:"next"}});};Slick.prototype.orientationChange=function(){var _=this;_.checkResponsive();_.setPosition();};Slick.prototype.pause=Slick.prototype.slickPause=function(){var _=this;_.autoPlayClear();_.paused=true;};Slick.prototype.play=Slick.prototype.slickPlay=function(){var _=this;_.autoPlay();_.options.autoplay=true;_.paused=false;_.focussed=false;_.interrupted=false;};Slick.prototype.postSlide=function(index){var _=this;if(!_.unslicked){_.$slider.trigger("afterChange",[_,index]);_.animating=false;if(_.slideCount>_.options.slidesToShow){_.setPosition();}_.swipeLeft=null;if(_.options.autoplay){_.autoPlay();}if(_.options.accessibility===true){_.initADA();if(_.options.focusOnChange){var $currentSlide=$(_.$slides.get(_.currentSlide));$currentSlide.attr("tabindex",0).focus();}}}};Slick.prototype.prev=Slick.prototype.slickPrev=function(){var _=this;_.changeSlide({data:{message:"previous"}});};Slick.prototype.preventDefault=function(event){event.preventDefault();};Slick.prototype.progressiveLazyLoad=function(tryCount){tryCount=tryCount||1;var _=this,$imgsToLoad=$("img[data-lazy]",_.$slider),image,imageSource,imageSrcSet,imageSizes,imageToLoad;if($imgsToLoad.length){image=$imgsToLoad.first();imageSource=image.attr("data-lazy");imageSrcSet=image.attr("data-srcset");imageSizes=image.attr("data-sizes")||_.$slider.attr("data-sizes");imageToLoad=document.createElement("img");imageToLoad.onload=function(){if(imageSrcSet){image.attr("srcset",imageSrcSet);if(imageSizes){image.attr("sizes",imageSizes);}}image.attr("src",imageSource).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading");if(_.options.adaptiveHeight===true){_.setPosition();}_.$slider.trigger("lazyLoaded",[_,image,imageSource]);_.progressiveLazyLoad();};imageToLoad.onerror=function(){if(tryCount<3){setTimeout(function(){_.progressiveLazyLoad(tryCount+1);},500);}else{image.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error");_.$slider.trigger("lazyLoadError",[_,image,imageSource]);_.progressiveLazyLoad();}};imageToLoad.src=imageSource;}else{_.$slider.trigger("allImagesLoaded",[_]);}};Slick.prototype.refresh=function(initializing){var _=this,currentSlide,lastVisibleIndex;lastVisibleIndex=_.slideCount-_.options.slidesToShow;if(!_.options.infinite&&(_.currentSlide>lastVisibleIndex)){_.currentSlide=lastVisibleIndex;}if(_.slideCount<=_.options.slidesToShow){_.currentSlide=0;}currentSlide=_.currentSlide;_.destroy(true);$.extend(_,_.initials,{currentSlide:currentSlide});_.init();if(!initializing){_.changeSlide({data:{message:"index",index:currentSlide}},false);}};Slick.prototype.registerBreakpoints=function(){var _=this,breakpoint,currentBreakpoint,l,responsiveSettings=_.options.responsive||null;if($.type(responsiveSettings)==="array"&&responsiveSettings.length){_.respondTo=_.options.respondTo||"window";for(breakpoint in responsiveSettings){l=_.breakpoints.length-1;if(responsiveSettings.hasOwnProperty(breakpoint)){currentBreakpoint=responsiveSettings[breakpoint].breakpoint;while(l>=0){if(_.breakpoints[l]&&_.breakpoints[l]===currentBreakpoint){_.breakpoints.splice(l,1);}l--;}_.breakpoints.push(currentBreakpoint);_.breakpointSettings[currentBreakpoint]=responsiveSettings[breakpoint].settings;}}_.breakpoints.sort(function(a,b){return(_.options.mobileFirst)?a-b:b-a;});}};Slick.prototype.reinit=function(){var _=this;_.$slides=_.$slideTrack.children(_.options.slide).addClass("slick-slide");_.slideCount=_.$slides.length;if(_.currentSlide>=_.slideCount&&_.currentSlide!==0){_.currentSlide=_.currentSlide-_.options.slidesToScroll;}if(_.slideCount<=_.options.slidesToShow){_.currentSlide=0;}_.registerBreakpoints();_.setProps();_.setupInfinite();_.buildArrows();_.updateArrows();_.initArrowEvents();_.buildDots();_.updateDots();_.initDotEvents();_.cleanUpSlideEvents();_.initSlideEvents();_.checkResponsive(false,true);if(_.options.focusOnSelect===true){$(_.$slideTrack).children().on("click.slick",_.selectHandler);}_.setSlideClasses(typeof _.currentSlide==="number"?_.currentSlide:0);_.setPosition();_.focusHandler();_.paused=!_.options.autoplay;_.autoPlay();_.$slider.trigger("reInit",[_]);};Slick.prototype.resize=function(){var _=this;if($(window).width()!==_.windowWidth){clearTimeout(_.windowDelay);_.windowDelay=window.setTimeout(function(){_.windowWidth=$(window).width();_.checkResponsive();if(!_.unslicked){_.setPosition();}},50);}};Slick.prototype.removeSlide=Slick.prototype.slickRemove=function(index,removeBefore,removeAll){var _=this;if(typeof(index)==="boolean"){removeBefore=index;index=removeBefore===true?0:_.slideCount-1;}else{index=removeBefore===true?--index:index;}if(_.slideCount<1||index<0||index>_.slideCount-1){return false;}_.unload();if(removeAll===true){_.$slideTrack.children().remove();}else{_.$slideTrack.children(this.options.slide).eq(index).remove();}_.$slides=_.$slideTrack.children(this.options.slide);_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.append(_.$slides);_.$slidesCache=_.$slides;_.reinit();};Slick.prototype.setCSS=function(position){var _=this,positionProps={},x,y;if(_.options.rtl===true){position=-position;}x=_.positionProp=="left"?Math.ceil(position)+"px":"0px";y=_.positionProp=="top"?Math.ceil(position)+"px":"0px";positionProps[_.positionProp]=position;if(_.transformsEnabled===false){_.$slideTrack.css(positionProps);}else{positionProps={};if(_.cssTransitions===false){positionProps[_.animType]="translate("+x+", "+y+")";_.$slideTrack.css(positionProps);}else{positionProps[_.animType]="translate3d("+x+", "+y+", 0px)";_.$slideTrack.css(positionProps);}}};Slick.prototype.setDimensions=function(){var _=this;if(_.options.vertical===false){if(_.options.centerMode===true){_.$list.css({padding:("0px "+_.options.centerPadding)});}}else{_.$list.height(_.$slides.first().outerHeight(true)*_.options.slidesToShow);if(_.options.centerMode===true){_.$list.css({padding:(_.options.centerPadding+" 0px")});}}_.listWidth=_.$list.width();_.listHeight=_.$list.height();if(_.options.vertical===false&&_.options.variableWidth===false){_.slideWidth=Math.ceil(_.listWidth/_.options.slidesToShow);_.$slideTrack.width(Math.ceil((_.slideWidth*_.$slideTrack.children(".slick-slide").length)));}else{if(_.options.variableWidth===true){_.$slideTrack.width(5000*_.slideCount);}else{_.slideWidth=Math.ceil(_.listWidth);_.$slideTrack.height(Math.ceil((_.$slides.first().outerHeight(true)*_.$slideTrack.children(".slick-slide").length)));}}var offset=_.$slides.first().outerWidth(true)-_.$slides.first().width();if(_.options.variableWidth===false){_.$slideTrack.children(".slick-slide").width(_.slideWidth-offset);}};Slick.prototype.setFade=function(){var _=this,targetLeft;_.$slides.each(function(index,element){targetLeft=(_.slideWidth*index)*-1;if(_.options.rtl===true){$(element).css({position:"relative",right:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0});}else{$(element).css({position:"relative",left:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0});}});_.$slides.eq(_.currentSlide).css({zIndex:_.options.zIndex-1,opacity:1});};Slick.prototype.setHeight=function(){var _=this;if(_.options.slidesToShow===1&&_.options.adaptiveHeight===true&&_.options.vertical===false){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(true);_.$list.css("height",targetHeight);}};Slick.prototype.setOption=Slick.prototype.slickSetOption=function(){var _=this,l,item,option,value,refresh=false,type;if($.type(arguments[0])==="object"){option=arguments[0];refresh=arguments[1];type="multiple";}else{if($.type(arguments[0])==="string"){option=arguments[0];value=arguments[1];refresh=arguments[2];if(arguments[0]==="responsive"&&$.type(arguments[1])==="array"){type="responsive";}else{if(typeof arguments[1]!=="undefined"){type="single";}}}}if(type==="single"){_.options[option]=value;}else{if(type==="multiple"){$.each(option,function(opt,val){_.options[opt]=val;});}else{if(type==="responsive"){for(item in value){if($.type(_.options.responsive)!=="array"){_.options.responsive=[value[item]];}else{l=_.options.responsive.length-1;while(l>=0){if(_.options.responsive[l].breakpoint===value[item].breakpoint){_.options.responsive.splice(l,1);}l--;}_.options.responsive.push(value[item]);}}}}}if(refresh){_.unload();_.reinit();}};Slick.prototype.setPosition=function(){var _=this;_.setDimensions();_.setHeight();if(_.options.fade===false){_.setCSS(_.getLeft(_.currentSlide));}else{_.setFade();}_.$slider.trigger("setPosition",[_]);};Slick.prototype.setProps=function(){var _=this,bodyStyle=document.body.style;_.positionProp=_.options.vertical===true?"top":"left";if(_.positionProp==="top"){_.$slider.addClass("slick-vertical");}else{_.$slider.removeClass("slick-vertical");}if(bodyStyle.WebkitTransition!==undefined||bodyStyle.MozTransition!==undefined||bodyStyle.msTransition!==undefined){if(_.options.useCSS===true){_.cssTransitions=true;}}if(_.options.fade){if(typeof _.options.zIndex==="number"){if(_.options.zIndex<3){_.options.zIndex=3;}}else{_.options.zIndex=_.defaults.zIndex;}}if(bodyStyle.OTransform!==undefined){_.animType="OTransform";_.transformType="-o-transform";_.transitionType="OTransition";if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.webkitPerspective===undefined){_.animType=false;}}if(bodyStyle.MozTransform!==undefined){_.animType="MozTransform";_.transformType="-moz-transform";_.transitionType="MozTransition";if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.MozPerspective===undefined){_.animType=false;}}if(bodyStyle.webkitTransform!==undefined){_.animType="webkitTransform";_.transformType="-webkit-transform";_.transitionType="webkitTransition";if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.webkitPerspective===undefined){_.animType=false;}}if(bodyStyle.msTransform!==undefined){_.animType="msTransform";_.transformType="-ms-transform";_.transitionType="msTransition";if(bodyStyle.msTransform===undefined){_.animType=false;}}if(bodyStyle.transform!==undefined&&_.animType!==false){_.animType="transform";_.transformType="transform";_.transitionType="transition";}_.transformsEnabled=_.options.useTransform&&(_.animType!==null&&_.animType!==false);};Slick.prototype.setSlideClasses=function(index){var _=this,centerOffset,allSlides,indexOffset,remainder;allSlides=_.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true");_.$slides.eq(index).addClass("slick-current");if(_.options.centerMode===true){var evenCoef=_.options.slidesToShow%2===0?1:0;centerOffset=Math.floor(_.options.slidesToShow/2);if(_.options.infinite===true){if(index>=centerOffset&&index<=(_.slideCount-1)-centerOffset){_.$slides.slice(index-centerOffset+evenCoef,index+centerOffset+1).addClass("slick-active").attr("aria-hidden","false");}else{indexOffset=_.options.slidesToShow+index;allSlides.slice(indexOffset-centerOffset+1+evenCoef,indexOffset+centerOffset+2).addClass("slick-active").attr("aria-hidden","false");}if(index===0){allSlides.eq(allSlides.length-1-_.options.slidesToShow).addClass("slick-center");}else{if(index===_.slideCount-1){allSlides.eq(_.options.slidesToShow).addClass("slick-center");}}}_.$slides.eq(index).addClass("slick-center");}else{if(index>=0&&index<=(_.slideCount-_.options.slidesToShow)){_.$slides.slice(index,index+_.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false");}else{if(allSlides.length<=_.options.slidesToShow){allSlides.addClass("slick-active").attr("aria-hidden","false");}else{remainder=_.slideCount%_.options.slidesToShow;indexOffset=_.options.infinite===true?_.options.slidesToShow+index:index;if(_.options.slidesToShow==_.options.slidesToScroll&&(_.slideCount-index)<_.options.slidesToShow){allSlides.slice(indexOffset-(_.options.slidesToShow-remainder),indexOffset+remainder).addClass("slick-active").attr("aria-hidden","false");}else{allSlides.slice(indexOffset,indexOffset+_.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false");}}}}if(_.options.lazyLoad==="ondemand"||_.options.lazyLoad==="anticipated"){_.lazyLoad();}};Slick.prototype.setupInfinite=function(){var _=this,i,slideIndex,infiniteCount;if(_.options.fade===true){_.options.centerMode=false;}if(_.options.infinite===true&&_.options.fade===false){slideIndex=null;if(_.slideCount>_.options.slidesToShow){if(_.options.centerMode===true){infiniteCount=_.options.slidesToShow+1;}else{infiniteCount=_.options.slidesToShow;}for(i=_.slideCount;i>(_.slideCount-infiniteCount);i-=1){slideIndex=i-1;$(_.$slides[slideIndex]).clone(true).attr("id","").attr("data-slick-index",slideIndex-_.slideCount).prependTo(_.$slideTrack).addClass("slick-cloned");}for(i=0;i<infiniteCount+_.slideCount;i+=1){slideIndex=i;$(_.$slides[slideIndex]).clone(true).attr("id","").attr("data-slick-index",slideIndex+_.slideCount).appendTo(_.$slideTrack).addClass("slick-cloned");}_.$slideTrack.find(".slick-cloned").find("[id]").each(function(){$(this).attr("id","");});}}};Slick.prototype.interrupt=function(toggle){var _=this;if(!toggle){_.autoPlay();}_.interrupted=toggle;};Slick.prototype.selectHandler=function(event){var _=this;var targetElement=$(event.target).is(".slick-slide")?$(event.target):$(event.target).parents(".slick-slide");var index=parseInt(targetElement.attr("data-slick-index"));if(!index){index=0;}if(_.slideCount<=_.options.slidesToShow){_.slideHandler(index,false,true);return;}_.slideHandler(index);};Slick.prototype.slideHandler=function(index,sync,dontAnimate){var targetSlide,animSlide,oldSlide,slideLeft,targetLeft=null,_=this,navTarget;sync=sync||false;if(_.animating===true&&_.options.waitForAnimate===true){return;}if(_.options.fade===true&&_.currentSlide===index){return;}if(sync===false){_.asNavFor(index);}targetSlide=index;targetLeft=_.getLeft(targetSlide);slideLeft=_.getLeft(_.currentSlide);_.currentLeft=_.swipeLeft===null?slideLeft:_.swipeLeft;if(_.options.infinite===false&&_.options.centerMode===false&&(index<0||index>_.getDotCount()*_.options.slidesToScroll)){if(_.options.fade===false){targetSlide=_.currentSlide;if(dontAnimate!==true){_.animateSlide(slideLeft,function(){_.postSlide(targetSlide);});}else{_.postSlide(targetSlide);}}return;}else{if(_.options.infinite===false&&_.options.centerMode===true&&(index<0||index>(_.slideCount-_.options.slidesToScroll))){if(_.options.fade===false){targetSlide=_.currentSlide;if(dontAnimate!==true){_.animateSlide(slideLeft,function(){_.postSlide(targetSlide);});}else{_.postSlide(targetSlide);}}return;}}if(_.options.autoplay){clearInterval(_.autoPlayTimer);}if(targetSlide<0){if(_.slideCount%_.options.slidesToScroll!==0){animSlide=_.slideCount-(_.slideCount%_.options.slidesToScroll);}else{animSlide=_.slideCount+targetSlide;}}else{if(targetSlide>=_.slideCount){if(_.slideCount%_.options.slidesToScroll!==0){animSlide=0;}else{animSlide=targetSlide-_.slideCount;}}else{animSlide=targetSlide;}}_.animating=true;_.$slider.trigger("beforeChange",[_,_.currentSlide,animSlide]);oldSlide=_.currentSlide;_.currentSlide=animSlide;_.setSlideClasses(_.currentSlide);if(_.options.asNavFor){navTarget=_.getNavTarget();navTarget=navTarget.slick("getSlick");if(navTarget.slideCount<=navTarget.options.slidesToShow){navTarget.setSlideClasses(_.currentSlide);}}_.updateDots();_.updateArrows();if(_.options.fade===true){if(dontAnimate!==true){_.fadeSlideOut(oldSlide);_.fadeSlide(animSlide,function(){_.postSlide(animSlide);});}else{_.postSlide(animSlide);}_.animateHeight();return;}if(dontAnimate!==true){_.animateSlide(targetLeft,function(){_.postSlide(animSlide);});}else{_.postSlide(animSlide);}};Slick.prototype.startLoad=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.hide();_.$nextArrow.hide();}if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){_.$dots.hide();}_.$slider.addClass("slick-loading");};Slick.prototype.swipeDirection=function(){var xDist,yDist,r,swipeAngle,_=this;xDist=_.touchObject.startX-_.touchObject.curX;yDist=_.touchObject.startY-_.touchObject.curY;r=Math.atan2(yDist,xDist);swipeAngle=Math.round(r*180/Math.PI);if(swipeAngle<0){swipeAngle=360-Math.abs(swipeAngle);}if((swipeAngle<=45)&&(swipeAngle>=0)){return(_.options.rtl===false?"left":"right");}if((swipeAngle<=360)&&(swipeAngle>=315)){return(_.options.rtl===false?"left":"right");}if((swipeAngle>=135)&&(swipeAngle<=225)){return(_.options.rtl===false?"right":"left");}if(_.options.verticalSwiping===true){if((swipeAngle>=35)&&(swipeAngle<=135)){return"down";}else{return"up";}}return"vertical";};Slick.prototype.swipeEnd=function(event){var _=this,slideCount,direction;_.dragging=false;_.swiping=false;if(_.scrolling){_.scrolling=false;return false;}_.interrupted=false;_.shouldClick=(_.touchObject.swipeLength>10)?false:true;if(_.touchObject.curX===undefined){return false;}if(_.touchObject.edgeHit===true){_.$slider.trigger("edge",[_,_.swipeDirection()]);}if(_.touchObject.swipeLength>=_.touchObject.minSwipe){direction=_.swipeDirection();switch(direction){case"left":case"down":slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide+_.getSlideCount()):_.currentSlide+_.getSlideCount();_.currentDirection=0;break;case"right":case"up":slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide-_.getSlideCount()):_.currentSlide-_.getSlideCount();_.currentDirection=1;break;default:}if(direction!="vertical"){_.slideHandler(slideCount);_.touchObject={};_.$slider.trigger("swipe",[_,direction]);}}else{if(_.touchObject.startX!==_.touchObject.curX){_.slideHandler(_.currentSlide);_.touchObject={};}}};Slick.prototype.swipeHandler=function(event){var _=this;if((_.options.swipe===false)||("ontouchend" in document&&_.options.swipe===false)){return;}else{if(_.options.draggable===false&&event.type.indexOf("mouse")!==-1){return;}}_.touchObject.fingerCount=event.originalEvent&&event.originalEvent.touches!==undefined?event.originalEvent.touches.length:1;_.touchObject.minSwipe=_.listWidth/_.options.touchThreshold;if(_.options.verticalSwiping===true){_.touchObject.minSwipe=_.listHeight/_.options.touchThreshold;}switch(event.data.action){case"start":_.swipeStart(event);break;case"move":_.swipeMove(event);break;case"end":_.swipeEnd(event);break;}};Slick.prototype.swipeMove=function(event){var _=this,edgeWasHit=false,curLeft,swipeDirection,swipeLength,positionOffset,touches,verticalSwipeLength;touches=event.originalEvent!==undefined?event.originalEvent.touches:null;if(!_.dragging||_.scrolling||touches&&touches.length!==1){return false;}curLeft=_.getLeft(_.currentSlide);_.touchObject.curX=touches!==undefined?touches[0].pageX:event.clientX;_.touchObject.curY=touches!==undefined?touches[0].pageY:event.clientY;_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curX-_.touchObject.startX,2)));verticalSwipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curY-_.touchObject.startY,2)));if(!_.options.verticalSwiping&&!_.swiping&&verticalSwipeLength>4){_.scrolling=true;return false;}if(_.options.verticalSwiping===true){_.touchObject.swipeLength=verticalSwipeLength;}swipeDirection=_.swipeDirection();if(event.originalEvent!==undefined&&_.touchObject.swipeLength>4){_.swiping=true;event.preventDefault();}positionOffset=(_.options.rtl===false?1:-1)*(_.touchObject.curX>_.touchObject.startX?1:-1);if(_.options.verticalSwiping===true){positionOffset=_.touchObject.curY>_.touchObject.startY?1:-1;}swipeLength=_.touchObject.swipeLength;_.touchObject.edgeHit=false;if(_.options.infinite===false){if((_.currentSlide===0&&swipeDirection==="right")||(_.currentSlide>=_.getDotCount()&&swipeDirection==="left")){swipeLength=_.touchObject.swipeLength*_.options.edgeFriction;_.touchObject.edgeHit=true;}}if(_.options.vertical===false){_.swipeLeft=curLeft+swipeLength*positionOffset;}else{_.swipeLeft=curLeft+(swipeLength*(_.$list.height()/_.listWidth))*positionOffset;}if(_.options.verticalSwiping===true){_.swipeLeft=curLeft+swipeLength*positionOffset;}if(_.options.fade===true||_.options.touchMove===false){return false;}if(_.animating===true){_.swipeLeft=null;return false;}_.setCSS(_.swipeLeft);};Slick.prototype.swipeStart=function(event){var _=this,touches;_.interrupted=true;if(_.touchObject.fingerCount!==1||_.slideCount<=_.options.slidesToShow){_.touchObject={};return false;}if(event.originalEvent!==undefined&&event.originalEvent.touches!==undefined){touches=event.originalEvent.touches[0];}_.touchObject.startX=_.touchObject.curX=touches!==undefined?touches.pageX:event.clientX;_.touchObject.startY=_.touchObject.curY=touches!==undefined?touches.pageY:event.clientY;_.dragging=true;};Slick.prototype.unfilterSlides=Slick.prototype.slickUnfilter=function(){var _=this;if(_.$slidesCache!==null){_.unload();_.$slideTrack.children(this.options.slide).detach();_.$slidesCache.appendTo(_.$slideTrack);_.reinit();}};Slick.prototype.unload=function(){var _=this;$(".slick-cloned",_.$slider).remove();if(_.$dots){_.$dots.remove();}if(_.$prevArrow&&_.htmlExpr.test(_.options.prevArrow)){_.$prevArrow.remove();}if(_.$nextArrow&&_.htmlExpr.test(_.options.nextArrow)){_.$nextArrow.remove();}_.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","");};Slick.prototype.unslick=function(fromBreakpoint){var _=this;_.$slider.trigger("unslick",[_,fromBreakpoint]);_.destroy();};Slick.prototype.updateArrows=function(){var _=this,centerOffset;centerOffset=Math.floor(_.options.slidesToShow/2);if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow&&!_.options.infinite){_.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false");_.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false");if(_.currentSlide===0){_.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true");_.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false");}else{if(_.currentSlide>=_.slideCount-_.options.slidesToShow&&_.options.centerMode===false){_.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true");_.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false");}else{if(_.currentSlide>=_.slideCount-1&&_.options.centerMode===true){_.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true");_.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false");}}}}};Slick.prototype.updateDots=function(){var _=this;if(_.$dots!==null){_.$dots.find("li").removeClass("slick-active").end();_.$dots.find("li").eq(Math.floor(_.currentSlide/_.options.slidesToScroll)).addClass("slick-active");}};Slick.prototype.visibility=function(){var _=this;if(_.options.autoplay){if(document[_.hidden]){_.interrupted=true;}else{_.interrupted=false;}}};$.fn.slick=function(){var _=this,opt=arguments[0],args=Array.prototype.slice.call(arguments,1),l=_.length,i,ret;for(i=0;i<l;i++){if(typeof opt=="object"||typeof opt=="undefined"){_[i].slick=new Slick(_[i],opt);}else{ret=_[i].slick[opt].apply(_[i].slick,args);}if(typeof ret!="undefined"){return ret;}}return _;};}));
   /* Ende slick */
   /* Start shariff.min */
   /*!
 * shariff - v2.1.2 - Fri, 26 Jan 2018 10:49:36 GMT
 * https://github.com/heiseonline/shariff
 * Copyright (c) 2018 Ines Pauer, Philipp Busse, Sebastian Hilbig, Erich Kramer, Deniz Sesli
 * Licensed under the MIT license
 */
!function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t,r){"use strict";function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function n(e,t,r){if(e&&p.isObject(e)&&e instanceof a)return e;var n=new a;return n.parse(e,t,r),n}function o(e){return p.isString(e)&&(e=n(e)),e instanceof a?e.format():a.prototype.format.call(e)}function i(e,t){return n(e,!1,!0).resolve(t)}function s(e,t){return e?n(e,!1,!0).resolveObject(t):t}var l=r(9),p=r(11);t.parse=n,t.resolve=i,t.resolveObject=s,t.format=o,t.Url=a;var h=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,d=["<",">",'"',"`"," ","\r","\n","\t"],f=["{","}","|","\\","^","`"].concat(d),m=["'"].concat(f),g=["%","/","?",";","#"].concat(m),v=["/","?","#"],b=/^[+a-z0-9A-Z_-]{0,63}$/,k=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,T={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},j={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},z=r(12);a.prototype.parse=function(e,t,r){if(!p.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e.indexOf("?"),n=-1!==a&&a<e.indexOf("#")?"?":"#",o=e.split(n),i=/\\/g;o[0]=o[0].replace(i,"/"),e=o.join(n);var s=e;if(s=s.trim(),!r&&1===e.split("#").length){var u=c.exec(s);if(u)return this.path=s,this.href=s,this.pathname=u[1],u[2]?(this.search=u[2],this.query=t?z.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var d=h.exec(s);if(d){d=d[0];var f=d.toLowerCase();this.protocol=f,s=s.substr(d.length)}if(r||d||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var U="//"===s.substr(0,2);!U||d&&y[d]||(s=s.substr(2),this.slashes=!0)}if(!y[d]&&(U||d&&!j[d])){for(var w=-1,x=0;x<v.length;x++){var C=s.indexOf(v[x]);-1!==C&&(-1===w||C<w)&&(w=C)}var I,R;R=-1===w?s.lastIndexOf("@"):s.lastIndexOf("@",w),-1!==R&&(I=s.slice(0,R),s=s.slice(R+1),this.auth=decodeURIComponent(I)),w=-1;for(var x=0;x<g.length;x++){var C=s.indexOf(g[x]);-1!==C&&(-1===w||C<w)&&(w=C)}-1===w&&(w=s.length),this.host=s.slice(0,w),s=s.slice(w),this.parseHost(),this.hostname=this.hostname||"";var D="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!D)for(var P=this.hostname.split(/\./),x=0,L=P.length;x<L;x++){var O=P[x];if(O&&!O.match(b)){for(var A="",S=0,q=O.length;S<q;S++)O.charCodeAt(S)>127?A+="x":A+=O[S];if(!A.match(b)){var N=P.slice(0,x),F=P.slice(x+1),G=O.match(k);G&&(N.push(G[1]),F.unshift(G[2])),F.length&&(s="/"+F.join(".")+s),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),D||(this.hostname=l.toASCII(this.hostname));var M=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+M,this.href+=this.host,D&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!T[f])for(var x=0,L=m.length;x<L;x++){var W=m[x];if(-1!==s.indexOf(W)){var B=encodeURIComponent(W);B===W&&(B=escape(W)),s=s.split(W).join(B)}}var J=s.indexOf("#");-1!==J&&(this.hash=s.substr(J),s=s.slice(0,J));var K=s.indexOf("?");if(-1!==K?(this.search=s.substr(K),this.query=s.substr(K+1),t&&(this.query=z.parse(this.query)),s=s.slice(0,K)):t&&(this.search="",this.query={}),s&&(this.pathname=s),j[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",_=this.search||"";this.path=M+_}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",a=this.hash||"",n=!1,o="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&p.isObject(this.query)&&Object.keys(this.query).length&&(o=z.stringify(this.query));var i=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||j[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),a&&"#"!==a.charAt(0)&&(a="#"+a),i&&"?"!==i.charAt(0)&&(i="?"+i),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),i=i.replace("#","%23"),t+n+r+i+a},a.prototype.resolve=function(e){return this.resolveObject(n(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(p.isString(e)){var t=new a;t.parse(e,!1,!0),e=t}for(var r=new a,n=Object.keys(this),o=0;o<n.length;o++){var i=n[o];r[i]=this[i]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),l=0;l<s.length;l++){var h=s[l];"protocol"!==h&&(r[h]=e[h])}return j[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!j[e.protocol]){for(var u=Object.keys(e),c=0;c<u.length;c++){var d=u[c];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||y[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var m=r.pathname||"",g=r.search||"";r.path=m+g}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var v=r.pathname&&"/"===r.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),k=b||v||r.host&&e.pathname,T=k,z=r.pathname&&r.pathname.split("/")||[],f=e.pathname&&e.pathname.split("/")||[],U=r.protocol&&!j[r.protocol];if(U&&(r.hostname="",r.port=null,r.host&&(""===z[0]?z[0]=r.host:z.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),k=k&&(""===f[0]||""===z[0])),b)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,z=f;else if(f.length)z||(z=[]),z.pop(),z=z.concat(f),r.search=e.search,r.query=e.query;else if(!p.isNullOrUndefined(e.search)){if(U){r.hostname=r.host=z.shift();var w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");w&&(r.auth=w.shift(),r.host=r.hostname=w.shift())}return r.search=e.search,r.query=e.query,p.isNull(r.pathname)&&p.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!z.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var x=z.slice(-1)[0],C=(r.host||e.host||z.length>1)&&("."===x||".."===x)||""===x,I=0,R=z.length;R>=0;R--)x=z[R],"."===x?z.splice(R,1):".."===x?(z.splice(R,1),I++):I&&(z.splice(R,1),I--);if(!k&&!T)for(;I--;I)z.unshift("..");!k||""===z[0]||z[0]&&"/"===z[0].charAt(0)||z.unshift(""),C&&"/"!==z.join("/").substr(-1)&&z.push("");var D=""===z[0]||z[0]&&"/"===z[0].charAt(0);if(U){r.hostname=r.host=D?"":z.length?z.shift():"";var w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");w&&(r.auth=w.shift(),r.host=r.hostname=w.shift())}return k=k||r.host&&z.length,k&&!D&&z.unshift(""),z.length?r.pathname=z.join("/"):(r.pathname=null,r.path=null),p.isNull(r.pathname)&&p.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},a.prototype.parseHost=function(){var e=this.host,t=u.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r(3),e.exports=r(4)},function(e,t){},function(e,t,r){"use strict";(function(t){function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=r(5),s=r(6),l=r(0),p={theme:"color",backendUrl:null,infoUrl:"http://ct.de/-2467514",infoDisplay:"blank",lang:"de",langFallback:"en",mailUrl:function(){var e=l.parse(this.getURL(),!0);return e.query.view="mail",delete e.search,l.format(e)},mailBody:function(){return this.getURL()},mediaUrl:null,orientation:"horizontal",referrerTrack:null,services:["twitter","facebook","googleplus","info"],title:function(){return i("head title").text()},twitterVia:null,flattrUser:null,flattrCategory:null,url:function(){var e=t.document.location.href,r=i("link[rel=canonical]").attr("href")||this.getMeta("og:url")||"";return r.length>0&&(r.indexOf("http")<0&&(r=t.document.location.protocol+"//"+t.document.location.host+r),e=r),e}},h=function(){function e(t,r){var n=this;a(this,e),this.element=t,i(t).empty(),this.options=i.extend({},p,r,i(t).data()),this.services=Object.keys(s).filter(function(e){return n.isEnabledService(e)}).sort(function(e,t){var r=n.options.services;return r.indexOf(e)-r.indexOf(t)}).map(function(e){return s[e](n)}),this._addButtonList(),null!==this.options.backendUrl&&this.getShares(this._updateCounts.bind(this))}return o(e,[{key:"isEnabledService",value:function(e){return this.options.services.indexOf(e)>-1}},{key:"$socialshareElement",value:function(){return i(this.element)}},{key:"getLocalized",value:function(e,t){return"object"===n(e[t])?void 0===e[t][this.options.lang]?e[t][this.options.langFallback]:e[t][this.options.lang]:"string"==typeof e[t]?e[t]:void 0}},{key:"getMeta",value:function(e){return i('meta[name="'+e+'"],[property="'+e+'"]').attr("content")||""}},{key:"getInfoUrl",value:function(){return this.options.infoUrl}},{key:"getInfoDisplayPopup",value:function(){return"popup"===this.options.infoDisplay}},{key:"getInfoDisplayBlank",value:function(){return"popup"!==this.options.infoDisplay&&"self"!==this.options.infoDisplay}},{key:"getURL",value:function(){return this.getOption("url")}},{key:"getOption",value:function(e){var t=this.options[e];return"function"==typeof t?t.call(this):t}},{key:"getTitle",value:function(){var e=this.getOption("title")||this.getMeta("DC.title"),t=this.getMeta("DC.creator");return e&&t&&(e=e+" - "+t),e}},{key:"getReferrerTrack",value:function(){return this.options.referrerTrack||""}},{key:"getShares",value:function(e){var t=l.parse(this.options.backendUrl,!0);return t.query.url=this.getURL(),delete t.search,i.getJSON(l.format(t),e)}},{key:"_updateCounts",value:function(e,t,r){var a=this;e&&i.each(e,function(e,t){a.isEnabledService(e)&&(t>=1e3&&(t=Math.round(t/1e3)+"k"),i(a.element).find("."+e+" a").append(i("<span/>").addClass("share_count").text(t)))})}},{key:"_addButtonList",value:function(){var e=this,r=i("<ul/>").addClass(["theme-"+this.options.theme,"orientation-"+this.options.orientation,"col-"+this.options.services.length].join(" "));this.services.forEach(function(t){var a=i("<li/>").addClass("shariff-button "+t.name),n=i("<span/>").addClass("share_text").text(e.getLocalized(t,"shareText")),o=i("<a/>").attr("href",t.shareUrl).append(n);void 0!==t.faName&&o.prepend(i("<span/>").addClass("fa "+t.faName)),t.popup?(o.attr("data-rel","popup"),"info"!==t.name&&o.attr("rel","nofollow")):t.blank?(o.attr("target","_blank"),"info"===t.name?o.attr("rel","noopener noreferrer"):o.attr("rel","nofollow noopener noreferrer")):"info"!==t.name&&o.attr("rel","nofollow"),o.attr("title",e.getLocalized(t,"title")),o.attr("role","button"),o.attr("aria-label",e.getLocalized(t,"title")),a.append(o),r.append(a)}),r.on("click",'[data-rel="popup"]',function(e){e.preventDefault();var r=i(this).attr("href");if(r.match(/twitter\.com\/intent\/(\w+)/)){var a=t.window;if(a.__twttr&&a.__twttr.widgets&&a.__twttr.widgets.loaded)return}t.window.open(r,"_blank","width=600,height=460")}),this.$socialshareElement().append(r)}}]),e}();e.exports=h,t.Shariff=h,i(function(){i(".shariff").each(function(){this.hasOwnProperty("shariff")||(this.shariff=new h(this))})})}).call(t,r(1))},function(e,t){e.exports=jQuery},function(e,t,r){"use strict";e.exports={addthis:r(7),diaspora:r(8),facebook:r(15),flattr:r(16),googleplus:r(17),info:r(18),linkedin:r(19),mail:r(20),pinterest:r(21),print:r(22),qzone:r(23),reddit:r(24),stumbleupon:r(25),telegram:r(26),tencent:r(27),threema:r(28),tumblr:r(29),twitter:r(30),vk:r(31),weibo:r(32),whatsapp:r(33),xing:r(34)}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"addthis",faName:"fa-plus",title:{bg:"Сподели в AddThis",da:"Del på AddThis",de:"Bei AddThis teilen",en:"Share on AddThis",es:"Compartir en AddThis",fi:"Jaa AddThisissä",fr:"Partager sur AddThis",hr:"Podijelite na AddThis",hu:"Megosztás AddThisen",it:"Condividi su AddThis",ja:"AddThis上で共有",ko:"AddThis에서 공유하기",nl:"Delen op AddThis",no:"Del på AddThis",pl:"Udostępnij przez AddThis",pt:"Compartilhar no AddThis",ro:"Partajează pe AddThis",ru:"Поделиться на AddThis",sk:"Zdieľať na AddThis",sl:"Deli na AddThis",sr:"Podeli na AddThis",sv:"Dela på AddThis",tr:"AddThis'ta paylaş",zh:"在AddThis上分享"},shareUrl:"http://api.addthis.com/oexchange/0.8/offer?url="+encodeURIComponent(e.getURL())+e.getReferrerTrack()}}},function(e,t,r){"use strict";var a=r(0);e.exports=function(e){var t=a.parse("https://share.diasporafoundation.org/",!0);return t.query.url=e.getURL(),t.query.title=e.getTitle(),t.protocol="https",delete t.search,{popup:!0,shareText:{de:"teilen",en:"share",zh:"分享"},name:"diaspora",faName:"fa-asterisk",title:{de:"Bei Diaspora teilen",en:"Share on Diaspora",zh:"分享至Diaspora"},shareUrl:a.format(t)+e.getReferrerTrack()}}},function(e,t,r){(function(e,a){var n;!function(a){function o(e){throw new RangeError(D[e])}function i(e,t){for(var r=e.length,a=[];r--;)a[r]=t(e[r]);return a}function s(e,t){var r=e.split("@"),a="";return r.length>1&&(a=r[0]+"@",e=r[1]),e=e.replace(R,"."),a+i(e.split("."),t).join(".")}function l(e){for(var t,r,a=[],n=0,o=e.length;n<o;)t=e.charCodeAt(n++),t>=55296&&t<=56319&&n<o?(r=e.charCodeAt(n++),56320==(64512&r)?a.push(((1023&t)<<10)+(1023&r)+65536):(a.push(t),n--)):a.push(t);return a}function p(e){return i(e,function(e){var t="";return e>65535&&(e-=65536,t+=O(e>>>10&1023|55296),e=56320|1023&e),t+=O(e)}).join("")}function h(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:k}function u(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function c(e,t,r){var a=0;for(e=r?L(e/z):e>>1,e+=L(e/t);e>P*y>>1;a+=k)e=L(e/P);return L(a+(P+1)*e/(e+j))}function d(e){var t,r,a,n,i,s,l,u,d,f,m=[],g=e.length,v=0,j=w,z=U;for(r=e.lastIndexOf(x),r<0&&(r=0),a=0;a<r;++a)e.charCodeAt(a)>=128&&o("not-basic"),m.push(e.charCodeAt(a));for(n=r>0?r+1:0;n<g;){for(i=v,s=1,l=k;n>=g&&o("invalid-input"),u=h(e.charCodeAt(n++)),(u>=k||u>L((b-v)/s))&&o("overflow"),v+=u*s,d=l<=z?T:l>=z+y?y:l-z,!(u<d);l+=k)f=k-d,s>L(b/f)&&o("overflow"),s*=f;t=m.length+1,z=c(v-i,t,0==i),L(v/t)>b-j&&o("overflow"),j+=L(v/t),v%=t,m.splice(v++,0,j)}return p(m)}function f(e){var t,r,a,n,i,s,p,h,d,f,m,g,v,j,z,C=[];for(e=l(e),g=e.length,t=w,r=0,i=U,s=0;s<g;++s)(m=e[s])<128&&C.push(O(m));for(a=n=C.length,n&&C.push(x);a<g;){for(p=b,s=0;s<g;++s)(m=e[s])>=t&&m<p&&(p=m);for(v=a+1,p-t>L((b-r)/v)&&o("overflow"),r+=(p-t)*v,t=p,s=0;s<g;++s)if(m=e[s],m<t&&++r>b&&o("overflow"),m==t){for(h=r,d=k;f=d<=i?T:d>=i+y?y:d-i,!(h<f);d+=k)z=h-f,j=k-f,C.push(O(u(f+z%j,0))),h=L(z/j);C.push(O(u(h,0))),i=c(r,v,a==n),r=0,++a}++r,++t}return C.join("")}function m(e){return s(e,function(e){return C.test(e)?d(e.slice(4).toLowerCase()):e})}function g(e){return s(e,function(e){return I.test(e)?"xn--"+f(e):e})}var v,b=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,2147483647),k=36,T=1,y=26,j=38,z=700,U=72,w=128,x="-",C=/^xn--/,I=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,D={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},P=k-T,L=Math.floor,O=String.fromCharCode;v={version:"1.4.1",ucs2:{decode:l,encode:p},decode:d,encode:f,toASCII:g,toUnicode:m},void 0!==(n=function(){return v}.call(t,r,t,e))&&(e.exports=n)}()}).call(t,r(10)(e),r(1))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";t.decode=t.parse=r(13),t.encode=t.stringify=r(14)},function(e,t,r){"use strict";function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var s=/\+/g;e=e.split(t);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var p=e.length;l>0&&p>l&&(p=l);for(var h=0;h<p;++h){var u,c,d,f,m=e[h].replace(s,"%20"),g=m.indexOf(r);g>=0?(u=m.substr(0,g),c=m.substr(g+1)):(u=m,c=""),d=decodeURIComponent(u),f=decodeURIComponent(c),a(i,d)?n(i[d])?i[d].push(f):i[d]=[i[d],f]:i[d]=f}return i};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";function a(e,t){if(e.map)return e.map(t);for(var r=[],a=0;a<e.length;a++)r.push(t(e[a],a));return r}var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,s){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?a(i(e),function(i){var s=encodeURIComponent(n(i))+r;return o(e[i])?a(e[i],function(e){return s+encodeURIComponent(n(e))}).join(t):s+encodeURIComponent(n(e[i]))}).join(t):s?encodeURIComponent(n(s))+r+encodeURIComponent(n(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"facebook",faName:"fa-facebook",title:{bg:"Сподели във Facebook",da:"Del på Facebook",de:"Bei Facebook teilen",en:"Share on Facebook",es:"Compartir en Facebook",fi:"Jaa Facebookissa",fr:"Partager sur Facebook",hr:"Podijelite na Facebooku",hu:"Megosztás Facebookon",it:"Condividi su Facebook",ja:"フェイスブック上で共有",ko:"페이스북에서 공유하기",nl:"Delen op Facebook",no:"Del på Facebook",pl:"Udostępnij na Facebooku",pt:"Compartilhar no Facebook",ro:"Partajează pe Facebook",ru:"Поделиться на Facebook",sk:"Zdieľať na Facebooku",sl:"Deli na Facebooku",sr:"Podeli na Facebook-u",sv:"Dela på Facebook",tr:"Facebook'ta paylaş",zh:"在Facebook上分享"},shareUrl:"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e.getURL())+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){var t=encodeURIComponent(e.getURL()),r=e.getTitle(),a=e.getMeta("description");return{popup:!0,shareText:"Flattr",name:"flattr",faName:"fa-money",title:{de:"Artikel flattrn",en:"Flattr this"},shareUrl:"https://flattr.com/submit/auto?title="+encodeURIComponent(r)+"&description="+encodeURIComponent(a)+"&category="+encodeURIComponent(e.options.flattrCategory||"text")+"&user_id="+encodeURIComponent(e.options.flattrUser)+"&url="+t+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"googleplus",faName:"fa-google-plus",title:{bg:"Сподели в Google+",da:"Del på Google+",de:"Bei Google+ teilen",en:"Share on Google+",es:"Compartir en Google+",fi:"Jaa Google+:ssa",fr:"Partager sur Goolge+",hr:"Podijelite na Google+",hu:"Megosztás Google+on",it:"Condividi su Google+",ja:"Google+上で共有",ko:"Google+에서 공유하기",nl:"Delen op Google+",no:"Del på Google+",pl:"Udostępnij na Google+",pt:"Compartilhar no Google+",ro:"Partajează pe Google+",ru:"Поделиться на Google+",sk:"Zdieľať na Google+",sl:"Deli na Google+",sr:"Podeli na Google+",sv:"Dela på Google+",tr:"Google+'da paylaş",zh:"在Google+上分享"},shareUrl:"https://plus.google.com/share?url="+encodeURIComponent(e.getURL())+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){return{blank:e.getInfoDisplayBlank(),popup:e.getInfoDisplayPopup(),shareText:"Info",name:"info",faName:"fa-info",title:{bg:"Повече информация",da:"Flere oplysninger",de:"Externer Link: Weitere Informationen zu Shariff (Öffnet neues Fenster)",en:"More information",es:"Más informaciones",fi:"Lisätietoja",fr:"Plus d'informations",hr:"Više informacija",hu:"Több információ",it:"Maggiori informazioni",ja:"詳しい情報",ko:"추가 정보",nl:"Verdere informatie",no:"Mer informasjon",pl:"Więcej informacji",pt:"Mais informações",ro:"Mai multe informatii",ru:"Больше информации",sk:"Viac informácií",sl:"Več informacij",sr:"Više informacija",sv:"Mer information",tr:"Daha fazla bilgi",zh:"更多信息"},shareUrl:e.getInfoUrl()}}},function(e,t,r){"use strict";e.exports=function(e){var t=encodeURIComponent(e.getURL()),r=encodeURIComponent(e.getTitle());return{popup:!0,shareText:{de:"mitteilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"シェア",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"distribuiți",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"linkedin",faName:"fa-linkedin",title:{bg:"Сподели в LinkedIn",da:"Del på LinkedIn",de:"Bei LinkedIn teilen",en:"Share on LinkedIn",es:"Compartir en LinkedIn",fi:"Jaa LinkedInissä",fr:"Partager sur LinkedIn",hr:"Podijelite na LinkedIn",hu:"Megosztás LinkedInen",it:"Condividi su LinkedIn",ja:"LinkedIn上で共有",ko:"LinkedIn에서 공유하기",nl:"Delen op LinkedIn",no:"Del på LinkedIn",pl:"Udostępnij przez LinkedIn",pt:"Compartilhar no LinkedIn",ro:"Partajează pe LinkedIn",ru:"Поделиться на LinkedIn",sk:"Zdieľať na LinkedIn",sl:"Deli na LinkedIn",sr:"Podeli na LinkedIn-u",sv:"Dela på LinkedIn",tr:"LinkedIn'ta paylaş",zh:"在LinkedIn上分享"},shareUrl:"https://www.linkedin.com/shareArticle?mini=true&summary="+encodeURIComponent(e.getMeta("description"))+"&title="+r+"&url="+t}}},function(e,t,r){"use strict";e.exports=function(e){var t=e.getOption("mailUrl");return 0===t.indexOf("mailto:")&&(t+="?subject="+encodeURIComponent(e.getTitle()),t+="&body="+encodeURIComponent(e.getOption("mailBody").replace(/\{url\}/i,e.getURL()))),{blank:0===t.indexOf("http"),popup:!1,shareText:{en:"mail",zh:"分享"},name:"mail",faName:"fa-envelope",title:{bg:"Изпрати по имейл",da:"Sende via e-mail",de:"Per E-Mail versenden",en:"Send by email",es:"Enviar por email",fi:"Lähetä sähköpostitse",fr:"Envoyer par courriel",hr:"Pošaljite emailom",hu:"Elküldés e-mailben",it:"Inviare via email",ja:"電子メールで送信",ko:"이메일로 보내기",nl:"Sturen via e-mail",no:"Send via epost",pl:"Wyślij e-mailem",pt:"Enviar por e-mail",ro:"Trimite prin e-mail",ru:"Отправить по эл. почте",sk:"Poslať e-mailom",sl:"Pošlji po elektronski pošti",sr:"Pošalji putem email-a",sv:"Skicka via e-post",tr:"E-posta ile gönder",zh:"通过电子邮件传送"},shareUrl:t}}},function(e,t,r){"use strict";var a=r(0);e.exports=function(e){var t=e.getTitle(),r=e.getMeta("DC.creator");r.length>0&&(t+=" - "+r);var n=e.getOption("mediaUrl");(!n||n.length<=0)&&(n=e.getMeta("og:image"));var o=a.parse("https://www.pinterest.com/pin/create/link/",!0);return o.query.url=e.getURL(),o.query.media=n,o.query.description=t,delete o.search,{popup:!0,shareText:"pin it",name:"pinterest",faName:"fa-pinterest-p",title:{de:"Bei Pinterest pinnen",en:"Pin it on Pinterest",es:"Compartir en Pinterest",fr:"Partager sur Pinterest",it:"Condividi su Pinterest",da:"Del på Pinterest",nl:"Delen op Pinterest",zh:"分享至Pinterest"},shareUrl:a.format(o)+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){return{name:"print",faName:"fa-print",popup:!1,shareText:{bg:"",da:"",de:"drucken",en:"print",es:"",fi:"",fr:"",hr:"",hu:"",it:"",ja:"",ko:"",nl:"",no:"",pl:"",pt:"",ro:"",ru:"",sk:"",sl:"",sr:"",sv:"",tr:"",zh:""},title:{bg:"",da:"",de:"drucken",en:"print",es:"",fi:"",fr:"",hr:"",hu:"",it:"",ja:"",ko:"",nl:"",no:"",pl:"",pt:"",ro:"",ru:"",sk:"",sl:"",sr:"",sv:"",tr:"",zh:""},shareUrl:"javascript:window.print();"}}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"qzone",faName:"fa-qq",title:{de:"Bei Qzone teilen",en:"Share on Qzone",zh:"分享至QQ空间"},shareUrl:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+encodeURIComponent(e.getURL())+"&title="+e.getTitle()+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){var t=encodeURIComponent(e.getURL()),r=encodeURIComponent(e.getTitle());return""!==r&&(r="&title="+r),{popup:!0,shareText:{de:"teilen",en:"share",zh:"分享"},name:"reddit",faName:"fa-reddit",title:{de:"Bei Reddit teilen",en:"Share on Reddit",zh:"分享至Reddit"},shareUrl:"https://reddit.com/submit?url="+t+r+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){var t=encodeURIComponent(e.getURL()),r=encodeURIComponent(e.getTitle());return""!==r&&(r="&title="+r),{popup:!0,shareText:{de:"teilen",en:"share",zh:"分享"},name:"stumbleupon",faName:"fa-stumbleupon",title:{de:"Bei Stumbleupon teilen",en:"Share on Stumbleupon",zh:"分享至Stumbleupon"},shareUrl:"https://www.stumbleupon.com/submit?url="+t+r+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"telegram",faName:"fa-telegram",title:{bg:"Сподели в Telegram",da:"Del på Telegram",de:"Bei Telegram teilen",en:"Share on Telegram",es:"Compartir en Telegram",fi:"Jaa Telegramissä",fr:"Partager sur Telegram",hr:"Podijelite na Telegram",hu:"Megosztás Telegramen",it:"Condividi su Telegram",ja:"Telegram上で共有",ko:"Telegram에서 공유하기",nl:"Delen op Telegram",no:"Del på Telegram",pl:"Udostępnij przez Telegram",pt:"Compartilhar no Telegram",ro:"Partajează pe Telegram",ru:"Поделиться на Telegram",sk:"Zdieľať na Telegram",sl:"Deli na Telegram",sr:"Podeli na Telegram-u",sv:"Dela på Telegram",tr:"Telegram'ta paylaş",zh:"在Telegram上分享"},shareUrl:"https://t.me/share/url?url="+encodeURIComponent(e.getURL())+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"tencent-weibo",faName:"fa-tencent-weibo",title:{de:"Bei tencent weibo teilen",en:"Share on tencent weibo",zh:"分享至腾讯微博"},shareUrl:"http://v.t.qq.com/share/share.php?url="+encodeURIComponent(e.getURL())+"&title="+e.getTitle()+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){var t=encodeURIComponent(e.getURL()),r=e.getTitle();return{popup:!1,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"threema",faName:"fa-lock",title:{bg:"Сподели в Threema",da:"Del på Threema",de:"Bei Threema teilen",en:"Share on Threema",es:"Compartir en Threema",fi:"Jaa Threemaissä",fr:"Partager sur Threema",hr:"Podijelite na Threema",hu:"Megosztás Threemaen",it:"Condividi su Threema",ja:"Threema上で共有",ko:"Threema에서 공유하기",nl:"Delen op Threema",no:"Del på Threema",pl:"Udostępnij przez Threema",pt:"Compartilhar no Threema",ro:"Partajează pe Threema",ru:"Поделиться на Threema",sk:"Zdieľať na Threema",sl:"Deli na Threema",sr:"Podeli na Threema-u",sv:"Dela på Threema",tr:"Threema'ta paylaş",zh:"在Threema上分享"},shareUrl:"threema://compose?text="+encodeURIComponent(r)+"%20"+t+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"tumblr",faName:"fa-tumblr",title:{bg:"Сподели в tumblr",da:"Del på tumblr",de:"Bei tumblr teilen",en:"Share on tumblr",es:"Compartir en tumblr",fi:"Jaa tumblrissä",fr:"Partager sur tumblr",hr:"Podijelite na tumblr",hu:"Megosztás tumblren",it:"Condividi su tumblr",ja:"tumblr上で共有",ko:"tumblr에서 공유하기",nl:"Delen op tumblr",no:"Del på tumblr",pl:"Udostępnij przez tumblr",pt:"Compartilhar no tumblr",ro:"Partajează pe tumblr",ru:"Поделиться на tumblr",sk:"Zdieľať na tumblr",sl:"Deli na tumblr",sr:"Podeli na tumblr-u",sv:"Dela på tumblr",tr:"tumblr'ta paylaş",zh:"在tumblr上分享"},shareUrl:"http://tumblr.com/widgets/share/tool?canonicalUrl="+encodeURIComponent(e.getURL())+e.getReferrerTrack()}}},function(e,t,r){"use strict";var a=r(0),n=function(e,t){var r=document.createElement("div");r.innerHTML=e;var a=r.textContent;if(a.length<=t)return e;var n=a.substring(0,t-1).lastIndexOf(" ");return a=a.substring(0,n)+"…"};e.exports=function(e){var t=a.parse("https://twitter.com/intent/tweet",!0),r=e.getTitle();return t.query.text=n(r,120),t.query.url=e.getURL(),null!==e.options.twitterVia&&(t.query.via=e.options.twitterVia),delete t.search,{popup:!0,shareText:{en:"tweet",zh:"分享"},name:"twitter",faName:"fa-twitter",title:{bg:"Сподели в Twitter",da:"Del på Twitter",de:"Bei Twitter teilen",en:"Share on Twitter",es:"Compartir en Twitter",fi:"Jaa Twitterissä",fr:"Partager sur Twitter",hr:"Podijelite na Twitteru",hu:"Megosztás Twitteren",it:"Condividi su Twitter",ja:"ツイッター上で共有",ko:"트위터에서 공유하기",nl:"Delen op Twitter",no:"Del på Twitter",pl:"Udostępnij na Twitterze",pt:"Compartilhar no Twitter",ro:"Partajează pe Twitter",ru:"Поделиться на Twitter",sk:"Zdieľať na Twitteri",sl:"Deli na Twitterju",sr:"Podeli na Twitter-u",sv:"Dela på Twitter",tr:"Twitter'da paylaş",zh:"在Twitter上分享"},shareUrl:a.format(t)+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"vk",faName:"fa-vk",title:{bg:"Сподели във VK",da:"Del på VK",de:"Bei VK teilen",en:"Share on VK",es:"Compartir en VK",fi:"Jaa VKissa",fr:"Partager sur VK",hr:"Podijelite na VKu",hu:"Megosztás VKon",it:"Condividi su VK",ja:"フェイスブック上で共有",ko:"페이스북에서 공유하기",nl:"Delen op VK",no:"Del på VK",pl:"Udostępnij na VKu",pt:"Compartilhar no VK",ro:"Partajează pe VK",ru:"Поделиться на ВКонтакте",sk:"Zdieľať na VKu",sl:"Deli na VKu",sr:"Podeli na VK-u",sv:"Dela på VK",tr:"VK'ta paylaş",zh:"在VK上分享"},shareUrl:"https://vk.com/share.php?url="+encodeURIComponent(e.getURL())+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"weibo",faName:"fa-weibo",title:{de:"Bei weibo teilen",en:"Share on weibo",zh:"分享至新浪微博"},shareUrl:"http://service.weibo.com/share/share.php?url="+encodeURIComponent(e.getURL())+"&title="+e.getTitle()+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){var t=encodeURIComponent(e.getURL()),r=e.getTitle();return{popup:!1,shareText:{bg:"cподеляне",da:"del",de:"teilen",en:"share",es:"compartir",fi:"Jaa",fr:"partager",hr:"podijelite",hu:"megosztás",it:"condividi",ja:"共有",ko:"공유하기",nl:"delen",no:"del",pl:"udostępnij",pt:"compartilhar",ro:"partajează",ru:"поделиться",sk:"zdieľať",sl:"deli",sr:"podeli",sv:"dela",tr:"paylaş",zh:"分享"},name:"whatsapp",faName:"fa-whatsapp",title:{bg:"Сподели в Whatsapp",da:"Del på Whatsapp",de:"Bei Whatsapp teilen",en:"Share on Whatsapp",es:"Compartir en Whatsapp",fi:"Jaa WhatsAppissä",fr:"Partager sur Whatsapp",hr:"Podijelite na Whatsapp",hu:"Megosztás WhatsAppen",it:"Condividi su Whatsapp",ja:"Whatsapp上で共有",ko:"Whatsapp에서 공유하기",nl:"Delen op Whatsapp",no:"Del på Whatsapp",pl:"Udostępnij przez WhatsApp",pt:"Compartilhar no Whatsapp",ro:"Partajează pe Whatsapp",ru:"Поделиться на Whatsapp",sk:"Zdieľať na Whatsapp",sl:"Deli na Whatsapp",sr:"Podeli na WhatsApp-u",sv:"Dela på Whatsapp",tr:"Whatsapp'ta paylaş",zh:"在Whatsapp上分享"},shareUrl:"whatsapp://send?text="+encodeURIComponent(r)+"%20"+t+e.getReferrerTrack()}}},function(e,t,r){"use strict";e.exports=function(e){return{popup:!0,shareText:{de:"teilen",en:"share",es:"compartir",fr:"partager",it:"condividi",da:"del",nl:"delen",zh:"分享"},name:"xing",faName:"fa-xing",title:{de:"Bei XING teilen",en:"Share on XING",es:"Compartir en XING",fr:"Partager sur XING",it:"Condividi su XING",da:"Del på XING",nl:"Delen op XING",zh:"分享至XING"},shareUrl:"https://www.xing.com/social_plugins/share?url="+encodeURIComponent(e.getURL())+e.getReferrerTrack()}}}]);
   /* Ende shariff.min */
   /* Start jquery.magnific-popup */
   /*! Magnific Popup - v1.1.0 - 2016-02-20
* http://dimsemenov.com/plugins/magnific-popup/
* Copyright (c) 2016 Dmitry Semenov; */
;(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{if(typeof exports==="object"){factory(require("jquery"));}else{factory(window.jQuery||window.Zepto);}}}(function($){var CLOSE_EVENT="Close",BEFORE_CLOSE_EVENT="BeforeClose",AFTER_CLOSE_EVENT="AfterClose",BEFORE_APPEND_EVENT="BeforeAppend",MARKUP_PARSE_EVENT="MarkupParse",OPEN_EVENT="Open",CHANGE_EVENT="Change",NS="mfp",EVENT_NS="."+NS,READY_CLASS="mfp-ready",REMOVING_CLASS="mfp-removing",PREVENT_CLOSE_CLASS="mfp-prevent-close";var mfp,MagnificPopup=function(){},_isJQ=!!(window.jQuery),_prevStatus,_window=$(window),_document,_prevContentType,_wrapClasses,_currPopupType;var _mfpOn=function(name,f){mfp.ev.on(NS+name+EVENT_NS,f);},_getEl=function(className,appendTo,html,raw){var el=document.createElement("div");el.className="mfp-"+className;if(html){el.innerHTML=html;}if(!raw){el=$(el);if(appendTo){el.appendTo(appendTo);}}else{if(appendTo){appendTo.appendChild(el);}}return el;},_mfpTrigger=function(e,data){mfp.ev.triggerHandler(NS+e,data);if(mfp.st.callbacks){e=e.charAt(0).toLowerCase()+e.slice(1);if(mfp.st.callbacks[e]){mfp.st.callbacks[e].apply(mfp,$.isArray(data)?data:[data]);}}},_getCloseBtn=function(type){if(type!==_currPopupType||!mfp.currTemplate.closeBtn){mfp.currTemplate.closeBtn=$(mfp.st.closeMarkup.replace("%title%",mfp.st.tClose));_currPopupType=type;}return mfp.currTemplate.closeBtn;},_checkInstance=function(){if(!$.magnificPopup.instance){mfp=new MagnificPopup();mfp.init();$.magnificPopup.instance=mfp;}},supportsTransitions=function(){var s=document.createElement("p").style,v=["ms","O","Moz","Webkit"];if(s["transition"]!==undefined){return true;}while(v.length){if(v.pop()+"Transition" in s){return true;}}return false;};MagnificPopup.prototype={constructor:MagnificPopup,init:function(){var appVersion=navigator.appVersion;mfp.isLowIE=mfp.isIE8=document.all&&!document.addEventListener;mfp.isAndroid=(/android/gi).test(appVersion);mfp.isIOS=(/iphone|ipad|ipod/gi).test(appVersion);mfp.supportsTransition=supportsTransitions();mfp.probablyMobile=(mfp.isAndroid||mfp.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent));_document=$(document);mfp.popupsCache={};},open:function(data){var i;if(data.isObj===false){mfp.items=data.items.toArray();mfp.index=0;var items=data.items,item;for(i=0;i<items.length;i++){item=items[i];if(item.parsed){item=item.el[0];}if(item===data.el[0]){mfp.index=i;break;}}}else{mfp.items=$.isArray(data.items)?data.items:[data.items];mfp.index=data.index||0;}if(mfp.isOpen){mfp.updateItemHTML();return;}mfp.types=[];_wrapClasses="";if(data.mainEl&&data.mainEl.length){mfp.ev=data.mainEl.eq(0);}else{mfp.ev=_document;}if(data.key){if(!mfp.popupsCache[data.key]){mfp.popupsCache[data.key]={};}mfp.currTemplate=mfp.popupsCache[data.key];}else{mfp.currTemplate={};}mfp.st=$.extend(true,{},$.magnificPopup.defaults,data);mfp.fixedContentPos=mfp.st.fixedContentPos==="auto"?!mfp.probablyMobile:mfp.st.fixedContentPos;if(mfp.st.modal){mfp.st.closeOnContentClick=false;mfp.st.closeOnBgClick=false;mfp.st.showCloseBtn=false;mfp.st.enableEscapeKey=false;}if(!mfp.bgOverlay){mfp.bgOverlay=_getEl("bg").on("click"+EVENT_NS,function(){mfp.close();});mfp.wrap=_getEl("wrap").attr("tabindex",-1).on("click"+EVENT_NS,function(e){if(mfp._checkIfClose(e.target)){mfp.close();}});mfp.container=_getEl("container",mfp.wrap);}mfp.contentContainer=_getEl("content");if(mfp.st.preloader){mfp.preloader=_getEl("preloader",mfp.container,mfp.st.tLoading);}var modules=$.magnificPopup.modules;for(i=0;i<modules.length;i++){var n=modules[i];n=n.charAt(0).toUpperCase()+n.slice(1);mfp["init"+n].call(mfp);}_mfpTrigger("BeforeOpen");if(mfp.st.showCloseBtn){if(!mfp.st.closeBtnInside){mfp.wrap.append(_getCloseBtn());}else{_mfpOn(MARKUP_PARSE_EVENT,function(e,template,values,item){values.close_replaceWith=_getCloseBtn(item.type);});_wrapClasses+=" mfp-close-btn-in";}}if(mfp.st.alignTop){_wrapClasses+=" mfp-align-top";}if(mfp.fixedContentPos){mfp.wrap.css({overflow:mfp.st.overflowY,overflowX:"hidden",overflowY:mfp.st.overflowY});}else{mfp.wrap.css({top:_window.scrollTop(),position:"absolute"});}if(mfp.st.fixedBgPos===false||(mfp.st.fixedBgPos==="auto"&&!mfp.fixedContentPos)){mfp.bgOverlay.css({height:_document.height(),position:"absolute"});}if(mfp.st.enableEscapeKey){_document.on("keyup"+EVENT_NS,function(e){if(e.keyCode===27){mfp.close();}});}_window.on("resize"+EVENT_NS,function(){mfp.updateSize();});if(!mfp.st.closeOnContentClick){_wrapClasses+=" mfp-auto-cursor";}if(_wrapClasses){mfp.wrap.addClass(_wrapClasses);}var windowHeight=mfp.wH=_window.height();var windowStyles={};if(mfp.fixedContentPos){if(mfp._hasScrollBar(windowHeight)){var s=mfp._getScrollbarSize();if(s){windowStyles.marginRight=s;}}}if(mfp.fixedContentPos){if(!mfp.isIE7){windowStyles.overflow="hidden";}else{$("body, html").css("overflow","hidden");}}var classesToadd=mfp.st.mainClass;if(mfp.isIE7){classesToadd+=" mfp-ie7";}if(classesToadd){mfp._addClassToMFP(classesToadd);}mfp.updateItemHTML();_mfpTrigger("BuildControls");$("html").css(windowStyles);mfp.bgOverlay.add(mfp.wrap).prependTo(mfp.st.prependTo||$(document.body));mfp._lastFocusedEl=document.activeElement;setTimeout(function(){if(mfp.content){mfp._addClassToMFP(READY_CLASS);mfp._setFocus();}else{mfp.bgOverlay.addClass(READY_CLASS);}_document.on("focusin"+EVENT_NS,mfp._onFocusIn);},16);mfp.isOpen=true;mfp.updateSize(windowHeight);_mfpTrigger(OPEN_EVENT);return data;},close:function(){if(!mfp.isOpen){return;}_mfpTrigger(BEFORE_CLOSE_EVENT);mfp.isOpen=false;if(mfp.st.removalDelay&&!mfp.isLowIE&&mfp.supportsTransition){mfp._addClassToMFP(REMOVING_CLASS);setTimeout(function(){mfp._close();},mfp.st.removalDelay);}else{mfp._close();}},_close:function(){_mfpTrigger(CLOSE_EVENT);var classesToRemove=REMOVING_CLASS+" "+READY_CLASS+" ";mfp.bgOverlay.detach();mfp.wrap.detach();mfp.container.empty();if(mfp.st.mainClass){classesToRemove+=mfp.st.mainClass+" ";}mfp._removeClassFromMFP(classesToRemove);if(mfp.fixedContentPos){var windowStyles={marginRight:""};if(mfp.isIE7){$("body, html").css("overflow","");}else{windowStyles.overflow="";}$("html").css(windowStyles);}_document.off("keyup"+EVENT_NS+" focusin"+EVENT_NS);mfp.ev.off(EVENT_NS);mfp.wrap.attr("class","mfp-wrap").removeAttr("style");mfp.bgOverlay.attr("class","mfp-bg");mfp.container.attr("class","mfp-container");if(mfp.st.showCloseBtn&&(!mfp.st.closeBtnInside||mfp.currTemplate[mfp.currItem.type]===true)){if(mfp.currTemplate.closeBtn){mfp.currTemplate.closeBtn.detach();}}if(mfp.st.autoFocusLast&&mfp._lastFocusedEl){$(mfp._lastFocusedEl).focus();}mfp.currItem=null;mfp.content=null;mfp.currTemplate=null;mfp.prevHeight=0;_mfpTrigger(AFTER_CLOSE_EVENT);},updateSize:function(winHeight){if(mfp.isIOS){var zoomLevel=document.documentElement.clientWidth/window.innerWidth;var height=window.innerHeight*zoomLevel;mfp.wrap.css("height",height);mfp.wH=height;}else{mfp.wH=winHeight||_window.height();}if(!mfp.fixedContentPos){mfp.wrap.css("height",mfp.wH);}_mfpTrigger("Resize");},updateItemHTML:function(){var item=mfp.items[mfp.index];mfp.contentContainer.detach();if(mfp.content){mfp.content.detach();}if(!item.parsed){item=mfp.parseEl(mfp.index);}var type=item.type;_mfpTrigger("BeforeChange",[mfp.currItem?mfp.currItem.type:"",type]);mfp.currItem=item;if(!mfp.currTemplate[type]){var markup=mfp.st[type]?mfp.st[type].markup:false;_mfpTrigger("FirstMarkupParse",markup);if(markup){mfp.currTemplate[type]=$(markup);}else{mfp.currTemplate[type]=true;}}if(_prevContentType&&_prevContentType!==item.type){mfp.container.removeClass("mfp-"+_prevContentType+"-holder");}var newContent=mfp["get"+type.charAt(0).toUpperCase()+type.slice(1)](item,mfp.currTemplate[type]);mfp.appendContent(newContent,type);item.preloaded=true;_mfpTrigger(CHANGE_EVENT,item);_prevContentType=item.type;mfp.container.prepend(mfp.contentContainer);_mfpTrigger("AfterChange");},appendContent:function(newContent,type){mfp.content=newContent;if(newContent){if(mfp.st.showCloseBtn&&mfp.st.closeBtnInside&&mfp.currTemplate[type]===true){if(!mfp.content.find(".mfp-close").length){mfp.content.append(_getCloseBtn());}}else{mfp.content=newContent;}}else{mfp.content="";}_mfpTrigger(BEFORE_APPEND_EVENT);mfp.container.addClass("mfp-"+type+"-holder");mfp.contentContainer.append(mfp.content);},parseEl:function(index){var item=mfp.items[index],type;if(item.tagName){item={el:$(item)};}else{type=item.type;item={data:item,src:item.src};}if(item.el){var types=mfp.types;for(var i=0;i<types.length;i++){if(item.el.hasClass("mfp-"+types[i])){type=types[i];break;}}item.src=item.el.attr("data-mfp-src");if(!item.src){item.src=item.el.attr("href");}}item.type=type||mfp.st.type||"inline";item.index=index;item.parsed=true;mfp.items[index]=item;_mfpTrigger("ElementParse",item);return mfp.items[index];},addGroup:function(el,options){var eHandler=function(e){e.mfpEl=this;mfp._openClick(e,el,options);};if(!options){options={};}var eName="click.magnificPopup";options.mainEl=el;if(options.items){options.isObj=true;el.off(eName).on(eName,eHandler);}else{options.isObj=false;if(options.delegate){el.off(eName).on(eName,options.delegate,eHandler);}else{options.items=el;el.off(eName).on(eName,eHandler);}}},_openClick:function(e,el,options){var midClick=options.midClick!==undefined?options.midClick:$.magnificPopup.defaults.midClick;if(!midClick&&(e.which===2||e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)){return;}var disableOn=options.disableOn!==undefined?options.disableOn:$.magnificPopup.defaults.disableOn;if(disableOn){if($.isFunction(disableOn)){if(!disableOn.call(mfp)){return true;}}else{if(_window.width()<disableOn){return true;}}}if(e.type){e.preventDefault();if(mfp.isOpen){e.stopPropagation();}}options.el=$(e.mfpEl);if(options.delegate){options.items=el.find(options.delegate);}mfp.open(options);},updateStatus:function(status,text){if(mfp.preloader){if(_prevStatus!==status){mfp.container.removeClass("mfp-s-"+_prevStatus);}if(!text&&status==="loading"){text=mfp.st.tLoading;}var data={status:status,text:text};_mfpTrigger("UpdateStatus",data);status=data.status;text=data.text;mfp.preloader.html(text);mfp.preloader.find("a").on("click",function(e){e.stopImmediatePropagation();});mfp.container.addClass("mfp-s-"+status);_prevStatus=status;}},_checkIfClose:function(target){if($(target).hasClass(PREVENT_CLOSE_CLASS)){return;}var closeOnContent=mfp.st.closeOnContentClick;var closeOnBg=mfp.st.closeOnBgClick;if(closeOnContent&&closeOnBg){return true;}else{if(!mfp.content||$(target).hasClass("mfp-close")||(mfp.preloader&&target===mfp.preloader[0])){return true;}if((target!==mfp.content[0]&&!$.contains(mfp.content[0],target))){if(closeOnBg){if($.contains(document,target)){return true;}}}else{if(closeOnContent){return true;}}}return false;},_addClassToMFP:function(cName){mfp.bgOverlay.addClass(cName);mfp.wrap.addClass(cName);},_removeClassFromMFP:function(cName){this.bgOverlay.removeClass(cName);mfp.wrap.removeClass(cName);},_hasScrollBar:function(winHeight){return((mfp.isIE7?_document.height():document.body.scrollHeight)>(winHeight||_window.height()));},_setFocus:function(){(mfp.st.focus?mfp.content.find(mfp.st.focus).eq(0):mfp.wrap).focus();},_onFocusIn:function(e){if(e.target!==mfp.wrap[0]&&!$.contains(mfp.wrap[0],e.target)){mfp._setFocus();return false;}},_parseMarkup:function(template,values,item){var arr;if(item.data){values=$.extend(item.data,values);}_mfpTrigger(MARKUP_PARSE_EVENT,[template,values,item]);$.each(values,function(key,value){if(value===undefined||value===false){return true;}arr=key.split("_");if(arr.length>1){var el=template.find(EVENT_NS+"-"+arr[0]);if(el.length>0){var attr=arr[1];if(attr==="replaceWith"){if(el[0]!==value[0]){el.replaceWith(value);}}else{if(attr==="img"){if(el.is("img")){el.attr("src",value);}else{el.replaceWith($("<img>").attr("src",value).attr("class",el.attr("class")));}}else{el.attr(arr[1],value);}}}}else{template.find(EVENT_NS+"-"+key).html(value);}});},_getScrollbarSize:function(){if(mfp.scrollbarSize===undefined){var scrollDiv=document.createElement("div");scrollDiv.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;";document.body.appendChild(scrollDiv);mfp.scrollbarSize=scrollDiv.offsetWidth-scrollDiv.clientWidth;document.body.removeChild(scrollDiv);}return mfp.scrollbarSize;}};$.magnificPopup={instance:null,proto:MagnificPopup.prototype,modules:[],open:function(options,index){_checkInstance();if(!options){options={};}else{options=$.extend(true,{},options);}options.isObj=true;options.index=index||0;return this.instance.open(options);},close:function(){return $.magnificPopup.instance&&$.magnificPopup.instance.close();},registerModule:function(name,module){if(module.options){$.magnificPopup.defaults[name]=module.options;}$.extend(this.proto,module.proto);this.modules.push(name);},defaults:{disableOn:0,key:null,midClick:false,mainClass:"",preloader:true,focus:"",closeOnContentClick:false,closeOnBgClick:true,closeBtnInside:true,showCloseBtn:true,enableEscapeKey:true,modal:false,alignTop:false,removalDelay:0,prependTo:null,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close">&#215;</button>',tClose:"Close (Esc)",tLoading:"Loading...",autoFocusLast:true}};$.fn.magnificPopup=function(options){_checkInstance();var jqEl=$(this);if(typeof options==="string"){if(options==="open"){var items,itemOpts=_isJQ?jqEl.data("magnificPopup"):jqEl[0].magnificPopup,index=parseInt(arguments[1],10)||0;if(itemOpts.items){items=itemOpts.items[index];}else{items=jqEl;if(itemOpts.delegate){items=items.find(itemOpts.delegate);}items=items.eq(index);}mfp._openClick({mfpEl:items},jqEl,itemOpts);}else{if(mfp.isOpen){mfp[options].apply(mfp,Array.prototype.slice.call(arguments,1));}}}else{options=$.extend(true,{},options);if(_isJQ){jqEl.data("magnificPopup",options);}else{jqEl[0].magnificPopup=options;}mfp.addGroup(jqEl,options);}return jqEl;};var INLINE_NS="inline",_hiddenClass,_inlinePlaceholder,_lastInlineElement,_putInlineElementsBack=function(){if(_lastInlineElement){_inlinePlaceholder.after(_lastInlineElement.addClass(_hiddenClass)).detach();_lastInlineElement=null;}};$.magnificPopup.registerModule(INLINE_NS,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){mfp.types.push(INLINE_NS);_mfpOn(CLOSE_EVENT+"."+INLINE_NS,function(){_putInlineElementsBack();});},getInline:function(item,template){_putInlineElementsBack();if(item.src){var inlineSt=mfp.st.inline,el=$(item.src);if(el.length){var parent=el[0].parentNode;if(parent&&parent.tagName){if(!_inlinePlaceholder){_hiddenClass=inlineSt.hiddenClass;_inlinePlaceholder=_getEl(_hiddenClass);_hiddenClass="mfp-"+_hiddenClass;}_lastInlineElement=el.after(_inlinePlaceholder).detach().removeClass(_hiddenClass);}mfp.updateStatus("ready");}else{mfp.updateStatus("error",inlineSt.tNotFound);el=$("<div>");}item.inlineElement=el;return el;}mfp.updateStatus("ready");mfp._parseMarkup(template,{},item);return template;}}});var AJAX_NS="ajax",_ajaxCur,_removeAjaxCursor=function(){if(_ajaxCur){$(document.body).removeClass(_ajaxCur);}},_destroyAjaxRequest=function(){_removeAjaxCursor();if(mfp.req){mfp.req.abort();}};$.magnificPopup.registerModule(AJAX_NS,{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){mfp.types.push(AJAX_NS);_ajaxCur=mfp.st.ajax.cursor;_mfpOn(CLOSE_EVENT+"."+AJAX_NS,_destroyAjaxRequest);_mfpOn("BeforeChange."+AJAX_NS,_destroyAjaxRequest);},getAjax:function(item){if(_ajaxCur){$(document.body).addClass(_ajaxCur);}mfp.updateStatus("loading");var opts=$.extend({url:item.src,success:function(data,textStatus,jqXHR){var temp={data:data,xhr:jqXHR};_mfpTrigger("ParseAjax",temp);mfp.appendContent($(temp.data),AJAX_NS);item.finished=true;_removeAjaxCursor();mfp._setFocus();setTimeout(function(){mfp.wrap.addClass(READY_CLASS);},16);mfp.updateStatus("ready");_mfpTrigger("AjaxContentAdded");},error:function(){_removeAjaxCursor();item.finished=item.loadError=true;mfp.updateStatus("error",mfp.st.ajax.tError.replace("%url%",item.src));}},mfp.st.ajax.settings);mfp.req=$.ajax(opts);return"";}}});var _imgInterval,_getTitle=function(item){if(item.data&&item.data.title!==undefined){return item.data.title;}var src=mfp.st.image.titleSrc;if(src){if($.isFunction(src)){return src.call(mfp,item);}else{if(item.el){return item.el.attr(src)||"";}}}return"";};$.magnificPopup.registerModule("image",{options:{markup:'<div class="mfp-figure">'+'<div class="mfp-close"></div>'+"<figure>"+'<div class="mfp-img"></div>'+"<figcaption>"+'<div class="mfp-bottom-bar">'+'<div class="mfp-title"></div>'+'<div class="mfp-counter"></div>'+"</div>"+"</figcaption>"+"</figure>"+"</div>",cursor:"mfp-zoom-out-cur",titleSrc:"title",verticalFit:true,tError:'<a href="%url%">The image</a> could not be loaded.'},proto:{initImage:function(){var imgSt=mfp.st.image,ns=".image";mfp.types.push("image");_mfpOn(OPEN_EVENT+ns,function(){if(mfp.currItem.type==="image"&&imgSt.cursor){$(document.body).addClass(imgSt.cursor);}});_mfpOn(CLOSE_EVENT+ns,function(){if(imgSt.cursor){$(document.body).removeClass(imgSt.cursor);}_window.off("resize"+EVENT_NS);});_mfpOn("Resize"+ns,mfp.resizeImage);if(mfp.isLowIE){_mfpOn("AfterChange",mfp.resizeImage);}},resizeImage:function(){var item=mfp.currItem;if(!item||!item.img){return;}if(mfp.st.image.verticalFit){var decr=0;if(mfp.isLowIE){decr=parseInt(item.img.css("padding-top"),10)+parseInt(item.img.css("padding-bottom"),10);}item.img.css("max-height",mfp.wH-decr);}},_onImageHasSize:function(item){if(item.img){item.hasSize=true;if(_imgInterval){clearInterval(_imgInterval);}item.isCheckingImgSize=false;_mfpTrigger("ImageHasSize",item);if(item.imgHidden){if(mfp.content){mfp.content.removeClass("mfp-loading");}item.imgHidden=false;}}},findImageSize:function(item){var counter=0,img=item.img[0],mfpSetInterval=function(delay){if(_imgInterval){clearInterval(_imgInterval);}_imgInterval=setInterval(function(){if(img.naturalWidth>0){mfp._onImageHasSize(item);return;}if(counter>200){clearInterval(_imgInterval);}counter++;if(counter===3){mfpSetInterval(10);}else{if(counter===40){mfpSetInterval(50);}else{if(counter===100){mfpSetInterval(500);}}}},delay);};mfpSetInterval(1);},getImage:function(item,template){var guard=0,onLoadComplete=function(){if(item){if(item.img[0].complete){item.img.off(".mfploader");if(item===mfp.currItem){mfp._onImageHasSize(item);mfp.updateStatus("ready");}item.hasSize=true;item.loaded=true;_mfpTrigger("ImageLoadComplete");}else{guard++;if(guard<200){setTimeout(onLoadComplete,100);}else{onLoadError();}}}},onLoadError=function(){if(item){item.img.off(".mfploader");if(item===mfp.currItem){mfp._onImageHasSize(item);mfp.updateStatus("error",imgSt.tError.replace("%url%",item.src));}item.hasSize=true;item.loaded=true;item.loadError=true;}},imgSt=mfp.st.image;var el=template.find(".mfp-img");if(el.length){var img=document.createElement("img");img.className="mfp-img";if(item.el&&item.el.find("img").length){img.alt=item.el.find("img").attr("alt");}item.img=$(img).on("load.mfploader",onLoadComplete).on("error.mfploader",onLoadError);img.src=item.src;if(el.is("img")){item.img=item.img.clone();}img=item.img[0];if(img.naturalWidth>0){item.hasSize=true;}else{if(!img.width){item.hasSize=false;}}}mfp._parseMarkup(template,{title:_getTitle(item),img_replaceWith:item.img},item);mfp.resizeImage();if(item.hasSize){if(_imgInterval){clearInterval(_imgInterval);}if(item.loadError){template.addClass("mfp-loading");mfp.updateStatus("error",imgSt.tError.replace("%url%",item.src));}else{template.removeClass("mfp-loading");mfp.updateStatus("ready");}return template;}mfp.updateStatus("loading");item.loading=true;if(!item.hasSize){item.imgHidden=true;template.addClass("mfp-loading");mfp.findImageSize(item);}return template;}}});var hasMozTransform,getHasMozTransform=function(){if(hasMozTransform===undefined){hasMozTransform=document.createElement("p").style.MozTransform!==undefined;}return hasMozTransform;};$.magnificPopup.registerModule("zoom",{options:{enabled:false,easing:"ease-in-out",duration:300,opener:function(element){return element.is("img")?element:element.find("img");}},proto:{initZoom:function(){var zoomSt=mfp.st.zoom,ns=".zoom",image;if(!zoomSt.enabled||!mfp.supportsTransition){return;}var duration=zoomSt.duration,getElToAnimate=function(image){var newImg=image.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),transition="all "+(zoomSt.duration/1000)+"s "+zoomSt.easing,cssObj={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},t="transition";cssObj["-webkit-"+t]=cssObj["-moz-"+t]=cssObj["-o-"+t]=cssObj[t]=transition;newImg.css(cssObj);return newImg;},showMainContent=function(){mfp.content.css("visibility","visible");},openTimeout,animatedImg;_mfpOn("BuildControls"+ns,function(){if(mfp._allowZoom()){clearTimeout(openTimeout);mfp.content.css("visibility","hidden");image=mfp._getItemToZoom();if(!image){showMainContent();return;}animatedImg=getElToAnimate(image);animatedImg.css(mfp._getOffset());mfp.wrap.append(animatedImg);openTimeout=setTimeout(function(){animatedImg.css(mfp._getOffset(true));openTimeout=setTimeout(function(){showMainContent();setTimeout(function(){animatedImg.remove();image=animatedImg=null;_mfpTrigger("ZoomAnimationEnded");},16);},duration);},16);}});_mfpOn(BEFORE_CLOSE_EVENT+ns,function(){if(mfp._allowZoom()){clearTimeout(openTimeout);mfp.st.removalDelay=duration;if(!image){image=mfp._getItemToZoom();if(!image){return;}animatedImg=getElToAnimate(image);}animatedImg.css(mfp._getOffset(true));mfp.wrap.append(animatedImg);mfp.content.css("visibility","hidden");setTimeout(function(){animatedImg.css(mfp._getOffset());},16);}});_mfpOn(CLOSE_EVENT+ns,function(){if(mfp._allowZoom()){showMainContent();if(animatedImg){animatedImg.remove();}image=null;}});},_allowZoom:function(){return mfp.currItem.type==="image";},_getItemToZoom:function(){if(mfp.currItem.hasSize){return mfp.currItem.img;}else{return false;}},_getOffset:function(isLarge){var el;if(isLarge){el=mfp.currItem.img;}else{el=mfp.st.zoom.opener(mfp.currItem.el||mfp.currItem);}var offset=el.offset();var paddingTop=parseInt(el.css("padding-top"),10);var paddingBottom=parseInt(el.css("padding-bottom"),10);offset.top-=($(window).scrollTop()-paddingTop);var obj={width:el.width(),height:(_isJQ?el.innerHeight():el[0].offsetHeight)-paddingBottom-paddingTop};if(getHasMozTransform()){obj["-moz-transform"]=obj["transform"]="translate("+offset.left+"px,"+offset.top+"px)";}else{obj.left=offset.left;obj.top=offset.top;}return obj;}}});var IFRAME_NS="iframe",_emptyPage="//about:blank",_fixIframeBugs=function(isShowing){if(mfp.currTemplate[IFRAME_NS]){var el=mfp.currTemplate[IFRAME_NS].find("iframe");if(el.length){if(!isShowing){el[0].src=_emptyPage;}if(mfp.isIE8){el.css("display",isShowing?"block":"none");}}}};$.magnificPopup.registerModule(IFRAME_NS,{options:{markup:'<div class="mfp-iframe-scaler">'+'<div class="mfp-close"></div>'+'<iframe class="mfp-iframe" src="//about:blank" frameborder="0" allowfullscreen></iframe>'+"</div>",srcAction:"iframe_src",patterns:{youtube:{index:"youtube.com",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo.com/",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"},gmaps:{index:"//maps.google.",src:"%id%&output=embed"}}},proto:{initIframe:function(){mfp.types.push(IFRAME_NS);_mfpOn("BeforeChange",function(e,prevType,newType){if(prevType!==newType){if(prevType===IFRAME_NS){_fixIframeBugs();}else{if(newType===IFRAME_NS){_fixIframeBugs(true);}}}});_mfpOn(CLOSE_EVENT+"."+IFRAME_NS,function(){_fixIframeBugs();});},getIframe:function(item,template){var embedSrc=item.src;var iframeSt=mfp.st.iframe;$.each(iframeSt.patterns,function(){if(embedSrc.indexOf(this.index)>-1){if(this.id){if(typeof this.id==="string"){embedSrc=embedSrc.substr(embedSrc.lastIndexOf(this.id)+this.id.length,embedSrc.length);}else{embedSrc=this.id.call(this,embedSrc);}}embedSrc=this.src.replace("%id%",embedSrc);return false;}});var dataObj={};if(iframeSt.srcAction){dataObj[iframeSt.srcAction]=embedSrc;}mfp._parseMarkup(template,dataObj,item);mfp.updateStatus("ready");return template;}}});var _getLoopedId=function(index){var numSlides=mfp.items.length;if(index>numSlides-1){return index-numSlides;}else{if(index<0){return numSlides+index;}}return index;},_replaceCurrTotal=function(text,curr,total){return text.replace(/%curr%/gi,curr+1).replace(/%total%/gi,total);};$.magnificPopup.registerModule("gallery",{options:{enabled:false,arrowMarkup:'<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',preload:[0,2],navigateByImgClick:true,arrows:true,tPrev:"Previous (Left arrow key)",tNext:"Next (Right arrow key)",tCounter:"%curr% of %total%"},proto:{initGallery:function(){var gSt=mfp.st.gallery,ns=".mfp-gallery";mfp.direction=true;if(!gSt||!gSt.enabled){return false;}_wrapClasses+=" mfp-gallery";_mfpOn(OPEN_EVENT+ns,function(){if(gSt.navigateByImgClick){mfp.wrap.on("click"+ns,".mfp-img",function(){if(mfp.items.length>1){mfp.next();return false;}});}_document.on("keydown"+ns,function(e){if(e.keyCode===37){mfp.prev();}else{if(e.keyCode===39){mfp.next();}}});});_mfpOn("UpdateStatus"+ns,function(e,data){if(data.text){data.text=_replaceCurrTotal(data.text,mfp.currItem.index,mfp.items.length);}});_mfpOn(MARKUP_PARSE_EVENT+ns,function(e,element,values,item){var l=mfp.items.length;values.counter=l>1?_replaceCurrTotal(gSt.tCounter,item.index,l):"";});_mfpOn("BuildControls"+ns,function(){if(mfp.items.length>1&&gSt.arrows&&!mfp.arrowLeft){var markup=gSt.arrowMarkup,arrowLeft=mfp.arrowLeft=$(markup.replace(/%title%/gi,gSt.tPrev).replace(/%dir%/gi,"left")).addClass(PREVENT_CLOSE_CLASS),arrowRight=mfp.arrowRight=$(markup.replace(/%title%/gi,gSt.tNext).replace(/%dir%/gi,"right")).addClass(PREVENT_CLOSE_CLASS);arrowLeft.click(function(){mfp.prev();});arrowRight.click(function(){mfp.next();});mfp.container.append(arrowLeft.add(arrowRight));}});_mfpOn(CHANGE_EVENT+ns,function(){if(mfp._preloadTimeout){clearTimeout(mfp._preloadTimeout);}mfp._preloadTimeout=setTimeout(function(){mfp.preloadNearbyImages();mfp._preloadTimeout=null;},16);});_mfpOn(CLOSE_EVENT+ns,function(){_document.off(ns);mfp.wrap.off("click"+ns);mfp.arrowRight=mfp.arrowLeft=null;});},next:function(){mfp.direction=true;mfp.index=_getLoopedId(mfp.index+1);mfp.updateItemHTML();},prev:function(){mfp.direction=false;mfp.index=_getLoopedId(mfp.index-1);mfp.updateItemHTML();},goTo:function(newIndex){mfp.direction=(newIndex>=mfp.index);mfp.index=newIndex;mfp.updateItemHTML();},preloadNearbyImages:function(){var p=mfp.st.gallery.preload,preloadBefore=Math.min(p[0],mfp.items.length),preloadAfter=Math.min(p[1],mfp.items.length),i;for(i=1;i<=(mfp.direction?preloadAfter:preloadBefore);i++){mfp._preloadItem(mfp.index+i);}for(i=1;i<=(mfp.direction?preloadBefore:preloadAfter);i++){mfp._preloadItem(mfp.index-i);}},_preloadItem:function(index){index=_getLoopedId(index);if(mfp.items[index].preloaded){return;}var item=mfp.items[index];if(!item.parsed){item=mfp.parseEl(index);}_mfpTrigger("LazyLoad",item);if(item.type==="image"){item.img=$('<img class="mfp-img" />').on("load.mfploader",function(){item.hasSize=true;}).on("error.mfploader",function(){item.hasSize=true;item.loadError=true;_mfpTrigger("LazyLoadError",item);}).attr("src",item.src);}item.preloaded=true;}}});var RETINA_NS="retina";$.magnificPopup.registerModule(RETINA_NS,{options:{replaceSrc:function(item){return item.src.replace(/\.\w+$/,function(m){return"@2x"+m;});},ratio:1},proto:{initRetina:function(){if(window.devicePixelRatio>1){var st=mfp.st.retina,ratio=st.ratio;ratio=!isNaN(ratio)?ratio:ratio();if(ratio>1){_mfpOn("ImageHasSize"+"."+RETINA_NS,function(e,item){item.img.css({"max-width":item.img[0].naturalWidth/ratio,"width":"100%"});});_mfpOn("ElementParse"+"."+RETINA_NS,function(e,item){item.src=st.replaceSrc(item,ratio);});}}}}});_checkInstance();}));
   /* Ende jquery.magnific-popup */
   /* Start jquery.cookie */
   /*!
 * JavaScript Cookie v2.2.0
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */
;(function (factory) {
 var registeredInModuleLoader = false;
 if (typeof define === 'function' && define.amd) {
  define(factory);
  registeredInModuleLoader = true;
 }
 if (typeof exports === 'object') {
  module.exports = factory();
  registeredInModuleLoader = true;
 }
 if (!registeredInModuleLoader) {
  var OldCookies = window.Cookies;
  var api = window.Cookies = factory();
  api.noConflict = function () {
   window.Cookies = OldCookies;
   return api;
  };
 }
}(function () {
 function extend () {
  var i = 0;
  var result = {};
  for (; i < arguments.length; i++) {
   var attributes = arguments[ i ];
   for (var key in attributes) {
    result[key] = attributes[key];
   }
  }
  return result;
 }

 function init (converter) {
  function api (key, value, attributes) {
   var result;
   if (typeof document === 'undefined') {
    return;
   }

   // Write

   if (arguments.length > 1) {
    attributes = extend({
     path: '/'
    }, api.defaults, attributes);

    if (typeof attributes.expires === 'number') {
     var expires = new Date();
     expires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);
     attributes.expires = expires;
    }

    // We're using "expires" because "max-age" is not supported by IE
    attributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';

    try {
     result = JSON.stringify(value);
     if (/^[\{\[]/.test(result)) {
      value = result;
     }
    } catch (e) {}

    if (!converter.write) {
     value = encodeURIComponent(String(value))
         .replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);
    } else {
     value = converter.write(value, key);
    }

    key = encodeURIComponent(String(key));
    key = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);
    key = key.replace(/[\(\)]/g, escape);

    var stringifiedAttributes = '';

    for (var attributeName in attributes) {
     if (!attributes[attributeName]) {
      continue;
     }
     stringifiedAttributes += '; ' + attributeName;
     if (attributes[attributeName] === true) {
      continue;
     }
     stringifiedAttributes += '=' + attributes[attributeName];
    }
    return (document.cookie = key + '=' + value + stringifiedAttributes);
   }

   // Read

   if (!key) {
    result = {};
   }

   // To prevent the for loop in the first place assign an empty array
   // in case there are no cookies at all. Also prevents odd result when
   // calling "get()"
   var cookies = document.cookie ? document.cookie.split('; ') : [];
   var rdecode = /(%[0-9A-Z]{2})+/g;
   var i = 0;

   for (; i < cookies.length; i++) {
    var parts = cookies[i].split('=');
    var cookie = parts.slice(1).join('=');

    if (!this.json && cookie.charAt(0) === '"') {
     cookie = cookie.slice(1, -1);
    }

    try {
     var name = parts[0].replace(rdecode, decodeURIComponent);
     cookie = converter.read ?
         converter.read(cookie, name) : converter(cookie, name) ||
         cookie.replace(rdecode, decodeURIComponent);

     if (this.json) {
      try {
       cookie = JSON.parse(cookie);
      } catch (e) {}
     }

     if (key === name) {
      result = cookie;
      break;
     }

     if (!key) {
      result[name] = cookie;
     }
    } catch (e) {}
   }

   return result;
  }

  api.set = api;
  api.get = function (key) {
   return api.call(api, key);
  };
  api.getJSON = function () {
   return api.apply({
    json: true
   }, [].slice.call(arguments));
  };
  api.defaults = {};

  api.remove = function (key, attributes) {
   api(key, '', extend(attributes, {
    expires: -1
   }));
  };

  api.withConverter = init;

  return api;
 }

 return init(function () {});
}));
   /* Ende jquery.cookie */
   /* Start picturefill */
   /*! Picturefill - v2.2.0 - 2014-10-30
 * http://scottjehl.github.io/picturefill
 * Copyright (c) 2014 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT 
 * --GSBDocStart
 * @module picturefill
 * @version 2.2.0
 * @see {@link http://scottjehl.github.io/picturefill}
 * @author Scott Jehl, Paul Irish, Nicholas Zakas, David Knight, 2012
 * @license MIT license
 * 
 * @desc matchMedia() polyfill - Test a CSS media type/query in JS
 *--GSBDocEnd
*/
/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas, David Knight. Dual MIT/BSD license */
window.matchMedia||(window.matchMedia=function(){var styleMedia=(window.styleMedia||window.media);if(!styleMedia){var style=document.createElement("style"),script=document.getElementsByTagName("script")[0],info=null;style.type="text/css";style.id="matchmediajs-test";script.parentNode.insertBefore(style,script);info=("getComputedStyle" in window)&&window.getComputedStyle(style,null)||style.currentStyle;styleMedia={matchMedium:function(media){var text="@media "+media+"{ #matchmediajs-test { width: 1px; } }";if(style.styleSheet){style.styleSheet.cssText=text;}else{style.textContent=text;}return info.width==="1px";}};}return function(media){return{matches:styleMedia.matchMedium(media||"all"),media:media||"all"};};}());
/*! Picturefill - Responsive Images that work today.
 * Author: Scott Jehl, Filament Group, 2012 ( new proposal implemented by Shawn Jansepar )
 * License: MIT/GPLv2
 * Spec: http://picture.responsiveimages.org/
 */
(function(w,doc,image){if(w.HTMLPictureElement){w.picturefill=function(){};return;}doc.createElement("picture");var pf={};pf.ns="picturefill";(function(){pf.srcsetSupported="srcset" in image;pf.sizesSupported="sizes" in image;})();pf.trim=function(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"");};pf.endsWith=function(str,suffix){return str.endsWith?str.endsWith(suffix):str.indexOf(suffix,str.length-suffix.length)!==-1;};pf.restrictsMixedContent=function(){return w.location.protocol==="https:";};pf.matchesMedia=function(media){return w.matchMedia&&w.matchMedia(media).matches;};pf.getDpr=function(){return(w.devicePixelRatio||1);};pf.getWidthFromLength=function(length){length=length&&length.indexOf("%")>-1===false&&(parseFloat(length)>0||length.indexOf("calc(")>-1)?length:"100vw";length=length.replace("vw","%");if(!pf.lengthEl){pf.lengthEl=doc.createElement("div");pf.lengthEl.style.cssText="border:0;display:block;font-size:1em;left:0;margin:0;padding:0;position:absolute;visibility:hidden";}pf.lengthEl.style.width=length;doc.body.appendChild(pf.lengthEl);pf.lengthEl.className="helper-from-picturefill-js";if(pf.lengthEl.offsetWidth<=0){pf.lengthEl.style.width=doc.documentElement.offsetWidth+"px";}var offsetWidth=pf.lengthEl.offsetWidth;doc.body.removeChild(pf.lengthEl);return offsetWidth;};pf.types={};pf.types["image/jpeg"]=true;pf.types["image/gif"]=true;pf.types["image/png"]=true;pf.types["image/svg+xml"]=doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1");pf.types["image/webp"]=function(){var type="image/webp";image.onerror=function(){pf.types[type]=false;picturefill();};image.onload=function(){pf.types[type]=image.width===1;picturefill();};image.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=";};pf.verifyTypeSupport=function(source){var type=source.getAttribute("type");if(type===null||type===""){return true;}else{if(typeof(pf.types[type])==="function"){pf.types[type]();return"pending";}else{return pf.types[type];}}};pf.parseSize=function(sourceSizeStr){var match=/(\([^)]+\))?\s*(.+)/g.exec(sourceSizeStr);return{media:match&&match[1],length:match&&match[2]};};pf.findWidthFromSourceSize=function(sourceSizeListStr){var sourceSizeList=pf.trim(sourceSizeListStr).split(/\s*,\s*/),winningLength;for(var i=0,len=sourceSizeList.length;i<len;i++){var sourceSize=sourceSizeList[i],parsedSize=pf.parseSize(sourceSize),length=parsedSize.length,media=parsedSize.media;if(!length){continue;}if(!media||pf.matchesMedia(media)){winningLength=length;break;}}return pf.getWidthFromLength(winningLength);};pf.parseSrcset=function(srcset){var candidates=[];while(srcset!==""){srcset=srcset.replace(/^\s+/g,"");var pos=srcset.search(/\s/g),url,descriptor=null;if(pos!==-1){url=srcset.slice(0,pos);var last=url.slice(-1);if(last===","||url===""){url=url.replace(/,+$/,"");descriptor="";}srcset=srcset.slice(pos+1);if(descriptor===null){var descpos=srcset.indexOf(",");if(descpos!==-1){descriptor=srcset.slice(0,descpos);srcset=srcset.slice(descpos+1);}else{descriptor=srcset;srcset="";}}}else{url=srcset;srcset="";}if(url||descriptor){candidates.push({url:url,descriptor:descriptor});}}return candidates;};pf.parseDescriptor=function(descriptor,sizesattr){var sizes=sizesattr||"100vw",sizeDescriptor=descriptor&&descriptor.replace(/(^\s+|\s+$)/g,""),widthInCssPixels=pf.findWidthFromSourceSize(sizes),resCandidate;if(sizeDescriptor){var splitDescriptor=sizeDescriptor.split(" ");for(var i=splitDescriptor.length-1;i>=0;i--){var curr=splitDescriptor[i],lastchar=curr&&curr.slice(curr.length-1);if((lastchar==="h"||lastchar==="w")&&!pf.sizesSupported){resCandidate=parseFloat((parseInt(curr,10)/widthInCssPixels));}else{if(lastchar==="x"){var res=curr&&parseFloat(curr,10);resCandidate=res&&!isNaN(res)?res:1;}}}}return resCandidate||1;};pf.getCandidatesFromSourceSet=function(srcset,sizes){var candidates=pf.parseSrcset(srcset),formattedCandidates=[];for(var i=0,len=candidates.length;i<len;i++){var candidate=candidates[i];formattedCandidates.push({url:candidate.url,resolution:pf.parseDescriptor(candidate.descriptor,sizes)});}return formattedCandidates;};pf.dodgeSrcset=function(img){if(img.srcset){img[pf.ns].srcset=img.srcset;img.removeAttribute("srcset");}};pf.processSourceSet=function(el){var srcset=el.getAttribute("srcset"),sizes=el.getAttribute("sizes"),candidates=[];if(el.nodeName.toUpperCase()==="IMG"&&el[pf.ns]&&el[pf.ns].srcset){srcset=el[pf.ns].srcset;}if(srcset){candidates=pf.getCandidatesFromSourceSet(srcset,sizes);}return candidates;};pf.applyBestCandidate=function(candidates,picImg){var candidate,length,bestCandidate;candidates.sort(pf.ascendingSort);length=candidates.length;bestCandidate=candidates[length-1];for(var i=0;i<length;i++){candidate=candidates[i];if(candidate.resolution>=pf.getDpr()){bestCandidate=candidate;break;}}if(bestCandidate&&!pf.endsWith(picImg.src,bestCandidate.url)){if(pf.restrictsMixedContent()&&bestCandidate.url.substr(0,"http:".length).toLowerCase()==="http:"){if(typeof console!==undefined){console.warn("Blocked mixed content image "+bestCandidate.url);}}else{picImg.src=bestCandidate.url;picImg.currentSrc=picImg.src;var style=picImg.style||{},WebkitBackfaceVisibility="webkitBackfaceVisibility" in style,currentZoom=style.zoom;if(WebkitBackfaceVisibility){style.zoom=".999";WebkitBackfaceVisibility=picImg.offsetWidth;style.zoom=currentZoom;}}}};pf.ascendingSort=function(a,b){return a.resolution-b.resolution;};pf.removeVideoShim=function(picture){var videos=picture.getElementsByTagName("video");if(videos.length){var video=videos[0],vsources=video.getElementsByTagName("source");while(vsources.length){picture.insertBefore(vsources[0],video);}video.parentNode.removeChild(video);}};pf.getAllElements=function(){var elems=[],imgs=doc.getElementsByTagName("img");for(var h=0,len=imgs.length;h<len;h++){var currImg=imgs[h];if(currImg.parentNode.nodeName.toUpperCase()==="PICTURE"||(currImg.getAttribute("srcset")!==null)||currImg[pf.ns]&&currImg[pf.ns].srcset!==null){elems.push(currImg);}}return elems;};pf.getMatch=function(img,picture){var sources=picture.childNodes,match;for(var j=0,slen=sources.length;j<slen;j++){var source=sources[j];if(source.nodeType!==1){continue;}if(source===img){return match;}if(source.nodeName.toUpperCase()!=="SOURCE"){continue;}if(source.getAttribute("src")!==null&&typeof console!==undefined){console.warn("The `src` attribute is invalid on `picture` `source` element; instead, use `srcset`.");}var media=source.getAttribute("media");if(!source.getAttribute("srcset")){continue;}if((!media||pf.matchesMedia(media))){var typeSupported=pf.verifyTypeSupport(source);if(typeSupported===true){match=source;break;}else{if(typeSupported==="pending"){return false;}}}}return match;};function picturefill(opt){var elements,element,parent,firstMatch,candidates,options=opt||{};elements=options.elements||pf.getAllElements();for(var i=0,plen=elements.length;i<plen;i++){element=elements[i];parent=element.parentNode;firstMatch=undefined;candidates=undefined;if(element.nodeName.toUpperCase()!=="IMG"){continue;}if(!element[pf.ns]){element[pf.ns]={};}if(!options.reevaluate&&element[pf.ns].evaluated){continue;}if(parent.nodeName.toUpperCase()==="PICTURE"){pf.removeVideoShim(parent);firstMatch=pf.getMatch(element,parent);if(firstMatch===false){continue;}}else{firstMatch=undefined;}if(parent.nodeName.toUpperCase()==="PICTURE"||(element.srcset&&!pf.srcsetSupported)||(!pf.sizesSupported&&(element.srcset&&element.srcset.indexOf("w")>-1))){pf.dodgeSrcset(element);}if(firstMatch){candidates=pf.processSourceSet(firstMatch);pf.applyBestCandidate(candidates,element);}else{candidates=pf.processSourceSet(element);if(element.srcset===undefined||element[pf.ns].srcset){pf.applyBestCandidate(candidates,element);}}element[pf.ns].evaluated=true;}}function runPicturefill(){picturefill();var intervalId=setInterval(function(){picturefill();if(/^loaded|^i|^c/.test(doc.readyState)){clearInterval(intervalId);return;}},250);function checkResize(){var resizeThrottle;if(!w._picturefillWorking){w._picturefillWorking=true;w.clearTimeout(resizeThrottle);resizeThrottle=w.setTimeout(function(){picturefill({reevaluate:true});w._picturefillWorking=false;},60);}}if(w.addEventListener){w.addEventListener("resize",checkResize,false);}else{if(w.attachEvent){w.attachEvent("onresize",checkResize);}}}runPicturefill();picturefill._=pf;if(typeof module==="object"&&typeof module.exports==="object"){module.exports=picturefill;}else{if(typeof define==="function"&&define.amd){define(function(){return picturefill;});}else{if(typeof w==="object"){w.picturefill=picturefill;}}}})(this,this.document,new this.Image());
   /* Ende picturefill */
   /* Start jsonQ */
   /*jsonQ.js v 1.1.0
 *Author: Sudhanshu Yadav
 *s-yadav.github.com
 *Copyright (c) 2013 - 2016 Sudhanshu Yadav.
 *MIT licenses
 */
//initialize jsonQ
;(function(factory) {
  /** support UMD ***/
  var global = Function('return this')() || (42, eval)('this');
  if (typeof define === "function" && define.amd) {
    define(["jsonq"], function($) {
      return (global.jsonQ = factory());
    });
  } else if (typeof module === "object" && module.exports) {
    module.exports = factory();

  } else {
    global.jsonQ = factory();
  }
}(function(undefined) {

  var jsonQ = function(json) {
        //return a jsonQ object
        return new jsonQ.fn.init(json);
      },
  //plugin variable and methods
      error = function(msg) {
        throw msg;
      },
      stringify = JSON.stringify,
      parse = JSON.parse;

  //global settings
  jsonQ.settings = {
    sort: {
      "order": "ASC",
      "logic": function(val) {
        return val;
      },
      "caseIgnore": true,
      "allLevel": true //to sort all level if true and if false only lowest level
    }
  };

  /*****private functions for internal use only*******/

  //to check weather path b is subset of path a
  function matchPath(a, b) {
    var regex = new RegExp('^' + a.join('~~'), 'i');
    return regex.test(b.join('~~'));
  }

  //function to create new format
  function newFormat(option) {
    //parameter change
    var keyAdded = option.keyAdded || [],
        json = option.json,
        path = option.path,
        newJson = option.newJson;
    //add to new json

    jsonQ.each(json, function(k, val) {
      var lvlpath = path ? JSON.parse(JSON.stringify(path)) : [];
      lvlpath.push(k);

      //to add a new direct access for each key in json so we get the path of that key easily
      if (objType(json) == 'object') {
        if (keyAdded.indexOf(k) == -1) {
          keyAdded.push(k);
          newJson.jsonQ_path[k] = [];
        }

        newJson.jsonQ_path[k].push({
          path: lvlpath
        });
      }
      //if value is json or array go to further level
      var type = objType(val);
      if (type == 'object' || type == 'array') {
        newFormat({
          'json': val,
          'newJson': newJson,
          'path': lvlpath,
          'keyAdded': keyAdded
        });
      }


    });

    return newJson;
  }

  //traverse functions
  var tFunc = {
    //search on top level
    topLevel: function(option) {
      var current = this.jsonQ_current,
          newObj = this.cloneObj(jsonQ()),
          newCurrent = newObj.jsonQ_current = [],
          prevPathStr = '',
          key = option.key,
          method = option.method;

      for (var i = 0, ln = current.length; i < ln; i++) {
        var pathC = current[i].path,
            pathStr,
            outofBound = false,
            parPath = pathC.concat([]);

        //to run callback to apply top traverse logic
        if (method == 'parent') {
          if (parPath.length === 0) {
            outofBound = true;
          } else {
            parPath.pop();
          }
        } else {
          var keyIndex = parPath.lastIndexOf(key);
          if (keyIndex == -1) {
            outofBound = true;
          } else {
            parPath = parPath.slice(0, keyIndex + 1);
          }
        }

        pathStr = JSON.stringify(parPath);

        if (prevPathStr != pathStr && !outofBound) {
          newCurrent.push({
            path: parPath
          });
        }

        prevPathStr = pathStr;
      }

      //set other defination variables
      newObj.length = newCurrent.length;
      //to add selector
      newObj.selector.push({
        method: method,
        key: key
      });

      return newObj;
    },
    //travese which have qualifiers mainly on bottom and sibling method
    qualTrv: function(option) {
      var current = this.jsonQ_current,
          newObj = this.cloneObj(jsonQ()),
          newCurrent = newObj.jsonQ_current = [],
          pathObj = this.jsonQ_path,

      //key element (an array of paths with following key)
          key = option.key,
      //dont work with original object clone it and if undefined than make as empty array
          elm = jsonQ.clone(pathObj[key]) || [],
      //qualifier
          qualifier = option.qualifier,
          qType = objType(qualifier),
      //travese method
          method = option.method,
          find = method == "find" ? true : false;

      for (var i = 0, ln = current.length; i < ln; i++) {
        var pathC = current[i].path,
            pathCTemp = [],
            found = false;


        if (!find) {
          //if it is top level continue the loop. This case comes when we do sibling method called on initial object
          if (pathC.length === 0) {
            continue;
          }

          pathCTemp = pathC.concat([]);
          pathCTemp.pop();
        }

        //make a loop on element to match the current path and element path
        for (var j = 0; j < elm.length; j++) {
          var pathE = elm[j].path,
              condition;
          if (find) {
            condition = matchPath(pathC, pathE);
          } else {
            var pathETemp = pathE.concat([]);
            //to pop last element
            pathETemp.pop();
            condition = pathCTemp.join() == pathETemp.join();
          }

          if (condition) {
            //code to check qualifier need to be written this on is only when quantifier when it is function in other case it will be applied on last

            var qTest = tFunc.qTest.call(this, qType, qualifier, pathE, newCurrent);

            if (qTest) {
              //to remove element which is already added
              elm.splice(j, 1);
              j--;
            }

            //make found flag true
            found = true;
          }
          //break if path doesent match in next sequence and for one element is already there.
          else if (found) {
            break;
          }
        }
      }

      //to apply qualifier if it is string . its mainly for array kind of qualifier
      if (qType == "string") {
        newObj = this.filter.call(newObj, qualifier);
      }

      //set other defination variables
      newObj.length = newObj.jsonQ_current.length;

      //to add selector
      newObj.selector.push({
        method: method,
        key: key,
        qualifier: qualifier
      });


      return newObj;
    },
    qTest: function(qType, qualifier, path, array) {
      var qTest = qType == 'function' ? qualifier.call(this.pathValue(path)) : qType == 'object' ? jsonQ.checkKeyValue(this.pathValue(path), qualifier) : true;

      //if it is key value pair than also we can check here.
      if (qTest) {
        array.push({
          path: path
        });
      }
      return qTest;
    }

  };

  //functions involved on sorting
  var sortFunc = {
    baseConv: function(type, val, settings) {
      if (type == 'string') {
        if (settings.caseIgnore) {
          return val.toLowerCase();
        }
      } else if (type == 'array') {
        return val.join();
      } else if (type == 'object') {
        return stringify(jsonQ.order(val));
      }

      return val;
    },
    sortAry: function(array, logic, settings) {
      array.sort(function(a, b) {
        var compA = logic(a);
        var compB = logic(b);
        return (compA < compB) ? -1 : (compA > compB) ? 1 : 0;
      });

      //to display on decending order
      if (settings.order.toLowerCase() == "desc") {
        array.reverse();
      }
      return array;
    }
  };

  jsonQ.fn = jsonQ.prototype = {
    init: function(json) {
      var type;

      //to return if no parameter is passed

      if (!json) return this;

      type = objType(json);
      if (type == 'string') {
        try {
          json = JSON.parse(json);
        } catch (e) {
          error('Not a valid json string.');
        }
      } else if (type != 'object' && type != 'array') {
        error('Not a valid json object.');
        return json;
      }

      //to set initial values
      this.jsonQ_root = json;
      this.jsonQ_path = {};
      this.jsonQ_current = [{
        path: []
      }];

      //to get other keys
      newFormat({
        json: json,
        newJson: this,
        refresh: true
      });

      //set jsonQ defination variables
      this.length = this.jsonQ_current.length;
      this.selector = [];

      return this;

    },

    //to get value at specific path from root
    pathValue: function(path) {
      return jsonQ.pathValue(this.jsonQ_root, path);
    },
    setPathValue: function(path, value) {
      jsonQ.setPathValue(this.jsonQ_root, path, value);
      return this;
    },
    clone: function() {
      return parse(stringify(this.jsonQ_current));
    },
    cloneObj: function(newObj) {
      var obj = this;

      newObj = newObj || {};

      jsonQ.each(obj, function(k, v) {
        newObj[k] = v;
      });

      //to make a different copy of selector otherwise selector will be same on all object.
      newObj.selector = jsonQ.merge([], newObj.selector);

      return newObj;
    },
    value: function(value, clone) {
      var json = this.jsonQ_current;


      clone = clone === false ? false : true;

      //to return value if called as getter (ie value is undefined)
      if (!value) {
        var newArray = [];
        //create a new set of values
        this.each(function(idx, path, val) {
          newArray.push(val);
        });

        return newArray;
      }
      //value as setter. value can be the exact value which you want to set or can be a callback. In callback pathvalue will be first argument.
      else {
        var type = objType(value);
        for (var i = 0, ln = json.length; i < ln; i++) {
          var path = json[i].path,
              val;
          if (type == 'function') {
            var prevVal = this.pathValue(path);
            val = clone ? jsonQ.clone(value(prevVal)) : value(prevVal);
          } else {
            val = clone ? jsonQ.clone(value) : value;
          }
          //to set value on json
          this.setPathValue(path, val);
        }

        return this;
      }

    },
    //clone parameter is for if you want to append any object so append exact object or create clone of object and append
    //to append in last of values of current
    append: function(valObj, clone) {
      return this.appendAt("last", valObj, clone);
    },
    //to append in first of values of current
    prepend: function(valObj, clone) {
      return this.appendAt("first", valObj, clone);
    },
    //to append at specific index of values of current
    appendAt: function(index, valObj, clone) {
      var current = this.jsonQ_current;
      //return if incorrect index is given
      if (isNaN(index) && index != "first" && index != "last") {
        error(index + 'is not a valid index.');
        return this;
      }

      for (var i = 0, ln = current.length; i < ln; i++) {
        var pathC = current[i].path.concat([]),
            lastKey = pathC.pop(),
            parRef = this.pathValue(pathC),
            type = objType(parRef[lastKey]),
            objLn = parRef[lastKey].length;


        //to limit index
        var idx = index < 0 || index == "first" ? 0 : index > objLn || index == "last" ? objLn : index;


        //if array push
        if (type == 'array') {
          valObj = clone ? jsonQ.clone(valObj) : valObj;

          parRef[lastKey].splice(idx, 0, valObj);
        }

        //if string concatinate , if number add
        else if (type == 'string') {
          var str = parRef[lastKey];
          parRef[lastKey] = str.substring(0, idx) + valObj + str.substring(idx, objLn);
        }


      }
      return this;

    },
    filter: function(qualifier) {
      var current = this.jsonQ_current,
          newObj = this.cloneObj(jsonQ()),
          newCurrent = newObj.jsonQ_current = [],
          qType = objType(qualifier);

      if (!qualifier) return this;

      for (var i = 0, ln = current.length; i < ln; i++) {
        var pathC = current[i].path;

        //code to check qualifier need to be written this on is only when quantifier when it is function or json in other case it will be applied on last
        tFunc.qTest.call(this, qType, qualifier, pathC, newCurrent);
      }

      //to apply qualifier if it is string . its mainly for array kind of qualifier
      if (qType == 'string') {
        //to check string for nth and eq
        var regex = /(nth|eq)\((.+)\)/,
            matched = regex.exec(qualifier);
        if (matched) {
          newCurrent = jsonQ.nthElm(current, matched[2], true);
        } else {
          newCurrent = jsonQ.nthElm(current, qualifier, true);
        }
        //to store it back on newObj
        newObj.jsonQ_current = newCurrent;
      }

      //set other defination variables
      newObj.length = newCurrent.length;

      //to add selector
      newObj.selector.push({
        method: 'filter',
        qualifier: qualifier
      });

      return newObj;

    },
    //first argument is key in which you want to search, second key is qualifier of it.
    find: function(key, qualifier) {
      return tFunc.qualTrv.call(this, {
        method: "find",
        key: key,
        qualifier: qualifier
      });
    },
    sibling: function(key, qualifier) {
      return tFunc.qualTrv.call(this, {
        method: "sibling",
        key: key,
        qualifier: qualifier
      });
    },
    parent: function() {
      return tFunc.topLevel.call(this, {
        method: "parent"
      });
    },
    closest: function(key) {
      return tFunc.topLevel.call(this, {
        method: "closest",
        key: key
      });
    },
    //return path of first element found through selector
    path: function() {
      return this.jsonQ_current[0].path;
    },
    //some time we can only return the value of the first element in current
    firstElm: function() {
      return this.pathValue(this.jsonQ_current[0].path);
    },
    lastElm: function() {
      return this.pathValue(this.jsonQ_current[this.length - 1].path);
    },
    nthElm: function(pattern, arrayReturn) {
      return jsonQ.nthElm(this.value(), pattern, arrayReturn);
    },
    index: function(elm, isQualifier) {
      return jsonQ.index(this.value(), elm, isQualifier);
    },
    createXML: function() {
      return jsonQ.createXML(this.value());
    },


    //function to sort array objects
    sort: function(key, settings) {
      //merge global setting with local setting
      settings = jsonQ.merge({}, jsonQ.settings.sort, settings);
      var jobj = this.find(key),
          current = jobj.clone(),
          sortStack = [],
          i, ln,
          sortedPath = [],
          type = objType(jobj.pathValue(current[0].path)),
      //function to get value which is an array from pathKey traversing from right.
          getClosestArray = function(key) {
            while (key.length !== 0) {
              var lastKey = key.pop();
              if (!isNaN(lastKey)) {
                var val = jobj.pathValue(key);
                if (objType(val) == 'array') {
                  return val;
                }
              }
            }
            return null;
          };

      //initialize sort stack
      for (i = 0, ln = current.length; i < ln; i++) {
        sortStack.push({
          pathHolder: current[i].path.concat([]),
          current: current[i].path.concat([])
        });
      }

      //to run the loop untill all ar sorted
      var alpha = 0,

      // function to remove element if sorting is done for that path
          spliceElm = function(i) {
            sortStack.splice(i, 1);
            return --i;
          };
      while (sortStack.length !== 0) {
        alpha++;
        for (i = 0; i < sortStack.length; i++) {
          var cur = sortStack[i].current,
              pH = sortStack[i].pathHolder,
          //to get the closest array in the current path. This will also change value of current path variable.
              ary = getClosestArray(cur),
              pathStr = cur.join();



          //to remove from sort stack if no array is left on key or if that is already sorted
          if (cur.length === 0 || sortedPath.indexOf(pathStr) != -1) {
            i = spliceElm(i);
          }

          //to sort if array found
          else {
            //logic path is path which we add in on condition to find the element value according to which we are sorting
            var logicPath = pH.slice(cur.length + 1, pH.length),

                logic = function(a) {
                  var val = jsonQ.pathValue(a, logicPath);

                  //to convert val to be compared
                  val = sortFunc.baseConv(type, val, settings);
                  return settings.logic(val);
                };

            //to sort the root json
            sortFunc.sortAry(ary, logic, settings);

            //if multilevel sort is true
            if (settings.allLevel) {
              //to maintain the path which is already sorted and change pathHolder to point first element of sorted array
              pH[cur.length] = 0;
              sortedPath.push(pathStr);
            } else {
              //remove sorted path
              i = spliceElm(i);
            }
          }



        }
      }


      return jsonQ(jobj.jsonQ_root).find(key);
    },
    //to make loop on current
    each: function(callback) {
      var current = this.jsonQ_current;
      for (var i = 0, ln = current.length; i < ln; i++) {
        callback(i, current[i].path, this.pathValue(current[i].path));
      }
      return this;
    },
    //to return unique value of current
    unique: function() {
      return jsonQ.unique(this.value());
    },
    refresh: function() {
      var selector = this.selector;

      var jObj = jsonQ(this.jsonQ_root);
      for (var i = 0, ln = selector.length; i < ln; i++) {
        var curSel = selector[i],
            args = [];

        if (curSel.key) args.push(curSel.key);
        if (curSel.qualifier) args.push(curSel.qualifier);

        jObj = jObj[curSel.method].apply(jObj, args);
      }

      //to store value back on this
      this.cloneObj.call(jObj, this);

      return this;
    },
    prettify: function(htmlReturn) {
      return jsonQ.prettify(this.value(), htmlReturn);
    }
  };

  //super exposed functions
  //jsonQ each
  jsonQ.each = function(json, callback) {
    for (var key in json) {
      if (json.hasOwnProperty(key)) {
        callback(key, json[key]);
      }
    }
  };

  //to find object type of any object
  var objType = jsonQ.objType = (function() {
    var map = {
      '[object Array]': 'array',
      '[object Object]': 'object',
      '[object String]': 'string',
      '[object Number]': 'number',
      '[object Boolean]': 'boolean',
      '[object Null]': 'null',
      '[object Function]': 'function'
    };

    return function(obj) {
      var type = Object.prototype.toString.call(obj);
      return map[type];
    };
  }());

  //to merge all the objects in argument to the first argument.
  //idea taken by jquery extend.

  //deep parameter is required if a person want to merge a json in all level recursively
  jsonQ.merge = function() {
    var arg = arguments,
        deepType = objType(arg[0]),
        i = 1,
        ln = arg.length,
        deep = false,
        target = arg[0];
    if (ln === 0 || (deepType == "boolean" && ln == 1)) {
      return;
    }
    //to get the target object where all merge will be done
    if (deepType == "boolean") {
      target = arg[1];
      i = 2;
      deep = arg[0];
    }

    //callback function to recursiveliy merge
    var eachCallback = function(k, v) {
      var type = objType(v),
          tarType = objType(target[k]);

      if (deep && (type == "array" || type == "object")) {
        target[k] = type == tarType && (tarType == "array" || tarType == "object") ? target[k] : type == "array" ? [] : {};

        //to merge recursively
        jsonQ.merge(deep, target[k], v);
      } else {
        target[k] = v;
      }
    };

    for (; i < ln; i++) {

      jsonQ.each(arg[i], eachCallback);
    }
    return target;
  };

  jsonQ.merge(jsonQ, {
    sort: function(ary, settings) {
      settings = jsonQ.merge({}, jsonQ.settings.sort, settings);

      if (objType(ary) != 'array') {
        error('Only array is allowed to sort');
        return;
      }

      var convLogic = function(val) {

        var type = objType(val);
        val = sortFunc.baseConv(type, val, settings);

        return settings.logic(val);
      };

      //to return sorted array
      return sortFunc.sortAry(ary, convLogic, settings);
    },
    order: function(json) {

      //to return if json type is not an object type
      if (typeof json != 'object') {
        return json;
      }

      var logic = function(val) {
            //if a json is an array alike and keys are numbers as string type ("1","2" instad of 1,2) convert them to integer.
            if (!isNaN(val)) val = parseInt(val);
            return val;
          },

          func = function(jsonVal) {
            var jsonType = objType(jsonVal),
                keys = Object.keys(jsonVal);

            if (jsonType == 'object') {
              keys.sort(function(a, b) {
                var compA = logic(a);
                var compB = logic(b);
                return (compA < compB) ? -1 : (compA > compB) ? 1 : 0;
              });
            }
            //to order
            for (var i = 0, ln = keys.length; i < ln; i++) {
              var key = keys[i],
                  val = jsonVal[key],
                  type = objType(val);

              //to go to next level if value is json type
              if (type == 'object' || type == "array") {
                func(val);
              }

              //to order
              if (jsonType == 'object') {
                delete jsonVal[key];
                jsonVal[key] = val;
              }
            }
          };

      //initialize
      func(json);

      return json;
    },
    clone: function(json) {
      var type = objType(json);
      return type == 'object' || type == 'array' ? parse(stringify(json)) : json;
    },
    //to find index of an element in set of element
    index: function(list, elm, isQualifier) {
      var type = objType(elm),
          ln = list.length,
      //check that elm is a object or not that is taken by refrence
          refObj = type == "object" || type == "array" || type == "function" ? true : false;


      //if elm is a function consider it as a qualifier
      if (type == "function") {
        isQualifier = true;
      }

      if (refObj && !isQualifier) {
        //convert object to string so that they can be compared.
        var jsonStr = stringify(jsonQ.order(elm));
      }

      for (var i = 0; i < ln; i++) {
        var cur = list[i];
        if (refObj) {
          var lType = objType(cur);
          if (lType != type && !isQualifier) continue;

          //to compare
          if (!isQualifier) {
            if (stringify(jsonQ.order(cur)) == jsonStr) {
              return i;
            }

            //if element is a qualifier
          } else {
            var test;
            if (type == 'function') {
              test = elm.call(cur);
            } else if (type == "object" && lType == "object") {
              test = jsonQ.checkKeyValue(cur, elm);
            } else if (lType == "array") {
              if (type == "array") {
                for (var j = 0, elmLn = elm.length; j < elmLn; j++) {
                  test = jsonQ.index(cur, elm[j]) != -1;
                  if (!test) break;
                }
              } else {
                test = jsonQ.index(cur, elm) != -1;
              }
            }

            //return index if it passes the test
            if (test) return i;

          }

        } else if (elm == cur) {
          return i;
        }
      }
      return -1;
    },
    //to check an array contains a specfic element or not . an element can be aaray or json.
    contains: function(array, elm, isQualifier) {
      return jsonQ.index(array, elm, isQualifier) != -1;
    },
    //function to check an json object contains a set of key value pair or not
    checkKeyValue: function(json, keyVal) {
      for (var k in keyVal) {
        if (keyVal.hasOwnProperty(k))
          if (!jsonQ.identical(keyVal[k], json[k])) return false;
      }
      return true;
    },

    nthElm: function(array, arg, aryRetrn) {
      var result;
      if (array[arg]) {
        result = array[arg];
      } else if (arg == 'last') {
        result = array[array.length - 1];
      } else if (arg == 'first') {
        result = array[0];
      } else if (arg == 'random') {
        var rand = Math.floor(Math.random() * array.length);
        result = array[rand];
      } else if (arg == 'even') {
        result = jsonQ.nthElm(array, '2n');
      } else if (arg == 'odd') {
        result = jsonQ.nthElm(array, '2n+1');
      }
      //to return sequence
      else {
        try {
          var newArray = [],
              ln = array.length;

          if (!arg.match(/^[0-9n*+-\/]+$/)) throw ('');

          arg = arg.replace(/([0-9])n/g, function($0, $1) {
            return $1 ? $1 + '*n' : $0;
          });



          for (var n = 0; n < ln; n++) {
            var index = eval(arg);
            if (index > ln - 1) {
              break;
            }
            newArray.push(array[index]);
          }
          result = newArray;
        } catch (error) {
          //if no correct option return whole array
          result = array;
        }
      }
      result = result || array;
      return objType(result) != 'array' && aryRetrn ? [result] : result;
    },
    prettify: function(obj, htmlReturn) {

      if (typeof obj != 'object') {
        throw ('Only valid json object is allowed.');
      }

      //to return prtified. If htmlReturn false add 3 spaces else add &nbsp;
      if (htmlReturn) {
        return JSON.stringify(obj, null, '\t').replace(/\n/g, '</br>').replace(/\t/g, '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;');
      }
      return JSON.stringify(obj, null, 3);

    },

    //need to modify it little bit
    //By Chris O'Brien, prettycode.org
    identical: function(a, b) {

      function sort(object) {
        if (typeof object !== "object" || object === null) {
          return object;
        }

        return Object.keys(object).sort().map(function(key) {
          return {
            key: key,
            value: sort(object[key])
          };
        });
      }

      return JSON.stringify(sort(a)) === JSON.stringify(sort(b));
    },
    //Return the union of arrays in new array
    union: function() {
      var arg = arguments,
          target = [],
          ln = arg.length;

      for (var i = 0; i < ln; i++) {
        var aryLn = arg[i].length;
        for (var j = 0; j < aryLn; j++) {
          var itm = arg[i][j];
          if (jsonQ.index(target, itm) == -1) {
            target.push(itm);
          }
        }

      }
      return target;
    },
    //return intersection of array in new array
    intersection: function() {
      var arg = arguments,
          target = [],
          flag,
          ln = arg.length;

      if (ln == 1) {
        target = arg[0];
      } else {
        for (var j = 0, aryLn = arg[0].length; j < aryLn; j++) {
          var elm = arg[0][j];
          flag = 1;
          for (var i = 1; i < ln; i++) {
            if (jsonQ.index(arg[i], elm) == -1) {
              flag = 0;
              break;
            }
          }
          if (flag == 1) {
            target.push(elm);
          }

        }
      }
      return target;
    },
    //suffle the order of elements in a array. returns the same array.
    suffle: function(array) {
      for (var i = 1, ln = array.length; i < ln; i++) {
        var j = Math.floor(Math.random() * (i + 1)),
            tmp = array[i];
        array[i] = array[j];
        array[j] = tmp;
      }

      return array;

    },
    //return a new array list of unuiqe(distinct) elements of an array
    unique: function(array) {
      var ln = array.length,
          newAry = [];
      for (var i = 0; i < ln; i++) {
        if (jsonQ.index(newAry, array[i]) == -1) {
          newAry.push(array[i]);
        }
      }
      return newAry;
    },
    //to get value at specific path in a json
    pathValue: function(json, path) {
      var i = 0,

          ln = path.length;

      if (json === null) {
        return null;
      }
      while (i < ln) {
        if (json[path[i]] === null) {
          json = null;
          return;
        } else {
          json = json[path[i]];
        }
        i = i + 1;
      }
      return json;
    },
    setPathValue: function(json, path, value) {
      var i = 0,
          tempJson = json,
          ln = path.length;
      if (json === null) {
        return null;
      }
      while (i < ln) {
        if (typeof tempJson[path[i]] != 'object') {
          tempJson[path[i]] = objType(path[i + 1]) == 'number' ? [] : {};
        }
        if (i == path.length - 1) {
          tempJson[path[i]] = value;
        }
        tempJson = tempJson[path[i]];
        i = i + 1;
      }
      return json;
    },
    createXML: function(json) {
      var jsonToXML = function(json, xmlAry) {
        xmlAry = xmlAry || [];
        var start = xmlAry.length === 0 ? true : false,
            type = objType(json);
        if (start) {
          xmlAry.push('<?xml version="1.0" encoding="ISO-8859-1"?><jsonXML>');
        }

        //to make loop on array or object;
        jsonQ.each(json, function(k, val) {
          var tag = type == 'array' ? 'arrayItem' : k,
              elmType = objType(val);
          xmlAry.push('<' + tag + ' type="' + elmType + '">');
          if (elmType == 'object' || elmType == 'array') {
            jsonToXML(val, xmlAry);
          } else {
            xmlAry.push('<![CDATA[' + val + ']]>');

          }
          xmlAry.push('</' + tag + '>');
        });


        if (start) {
          xmlAry.push('</jsonXML>');
          return xmlAry.join('');
        } else {
          return xmlAry;
        }

      };
      return jsonToXML(json);
    },
    //append functions

    //to append in last of values of array or string
    append: function(target, val, clone) {
      return jsonQ.appendAt(target, "last", val, clone);
    },
    //to append in first of values of array or string
    prepend: function(target, val, clone) {
      return jsonQ.appendAt(target, "first", val, clone);
    },
    //to append at specific index of values of array or string
    appendAt: function(target, index, val, clone) {

      if (isNaN(index) && index != "first" && index != "last") {
        error(index + 'is not a valid index.');
        return;
      }

      var type = objType(target),
          length = target.length;

      //to limit index
      var idx = index < 0 || index == "first" ? 0 : index > length || index == "last" ? length : index;


      //if array push
      if (type == 'array') {
        val = clone ? jsonQ.clone(val) : val;
        target.splice(idx, 0, val);
      }

      //if string concatinate , if number add
      else if (type == 'string') {
        target = target.substring(0, idx) + val + target.substring(idx, length);
      }


      return target;

    }

  });

  //to assign jsonQ prototypes to init function
  jsonQ.fn.init.prototype = jsonQ.fn;

  return jsonQ;
}));
   /* Ende jsonQ */
   /* Start whatinput */
   /**
 * what-input - A global utility for tracking the current input method (mouse, keyboard or touch).
 * @version v5.0.2
 * @link https://github.com/ten1seven/what-input
 * @license MIT
 */
(function webpackUniversalModuleDefinition(root, factory) {
  if( typeof exports === 'object' && typeof module === 'object' )
    module.exports = factory();
  else if( typeof define === 'function' && define.amd )
    define("whatInput", [], factory);
  else if( typeof exports === 'object' )
    exports["whatInput"] = factory();
  else
    root["whatInput"] = factory();
})(this, function () {
  return /******/ (function (modules) { // webpackBootstrap
    /******/   // The module cache
    /******/
    var installedModules = {};
    /******/   // The require function
    /******/
    function __webpack_require__(moduleId) {

      /******/     // Check if module is in cache
      /******/
      if( installedModules[moduleId] )
      /******/      return installedModules[moduleId].exports;
      /******/     // Create a new module (and put it into the cache)
      /******/
      var module = installedModules[moduleId] = {
        /******/      exports: {},
        /******/      id: moduleId,
        /******/      loaded: false
        /******/
      };
      /******/     // Execute the module function
      /******/
      modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
      /******/     // Flag the module as loaded
      /******/
      module.loaded = true;
      /******/     // Return the exports of the module
      /******/
      return module.exports;
      /******/
    }

    /******/   // expose the modules object (__webpack_modules__)
    /******/
    __webpack_require__.m = modules;
    /******/   // expose the module cache
    /******/
    __webpack_require__.c = installedModules;
    /******/   // __webpack_public_path__
    /******/
    __webpack_require__.p = "";
    /******/   // Load entry module and return exports
    /******/
    return __webpack_require__(0);
    /******/
  })
    /************************************************************************/
    /******/([
    /* 0 */
    /***/ (function (module, exports) {
      'use strict';
      module.exports = function () {
        /*
         * variables
         */
        // cache document.documentElement
        var docElem = document.documentElement;
        // currently focused dom element
        var currentElement = null;
        // last used input type
        var currentInput = 'initial';
        // last used input intent
        var currentIntent = currentInput;
        // event buffer timer
        var eventTimer = null;
        // form input types
        var formInputs = ['input', 'select', 'textarea'];
        // empty array for holding callback functions
        var functionList = [];
        // list of modifier keys commonly used with the mouse and
        // can be safely ignored to prevent false keyboard detection
        var ignoreMap = [16, // shift
                         17, // control
                         18, // alt
                         91, // Windows key / left Apple cmd
                         93 // Windows menu / right Apple cmd
        ];
        // mapping of events to input types
        var inputMap = {
          keydown: 'keyboard',
          keyup: 'keyboard',
          mousedown: 'mouse',
          mousemove: 'mouse',
          MSPointerDown: 'pointer',
          MSPointerMove: 'pointer',
          pointerdown: 'pointer',
          pointermove: 'pointer',
          touchstart: 'touch'

          // boolean: true if touch buffer is active
        };
        var isBuffering = false;
        // boolean: true if the page is being scrolled
        var isScrolling = false;
        // store current mouse position
        var mousePos = {
          x: null,
          y: null

          // map of IE 10 pointer events
        };
        var pointerMap = {
          2: 'touch',
          3: 'touch', // treat pen like touch
          4: 'mouse'

          // check support for passive event listeners
        };
        var supportsPassive = false;
        try
        {
          var opts = Object.defineProperty({}, 'passive', {
            get: function get() {
              supportsPassive = true;
            }
          });
          window.addEventListener('test', null, opts);
        }
        catch( e )
        {}
        /*
         * set up
         */
        var setUp = function setUp() {
          // add correct mouse wheel event mapping to `inputMap`
          inputMap[detectWheel()] = 'mouse';
          addListeners();
          doUpdate('input');
          doUpdate('intent');
        };
        /*
         * events
         */
        var addListeners = function addListeners() {
          // `pointermove`, `MSPointerMove`, `mousemove` and mouse wheel event binding
          // can only demonstrate potential, but not actual, interaction
          // and are treated separately
          var options = supportsPassive ? {passive: true} : false;
          // pointer events (mouse, pen, touch)
          if( window.PointerEvent )
          {
            window.addEventListener('pointerdown', setInput);
            window.addEventListener('pointermove', setIntent);
          }
          else if( window.MSPointerEvent )
          {
            window.addEventListener('MSPointerDown', setInput);
            window.addEventListener('MSPointerMove', setIntent);
          }
          else
          {
            // mouse events
            window.addEventListener('mousedown', setInput);
            window.addEventListener('mousemove', setIntent);
            // touch events
            if( 'ontouchstart' in window )
            {
              window.addEventListener('touchstart', eventBuffer, options);
              window.addEventListener('touchend', setInput);
            }
          }
          // mouse wheel
          window.addEventListener(detectWheel(), setIntent, options);
          // keyboard events
          window.addEventListener('keydown', eventBuffer);
          window.addEventListener('keyup', eventBuffer);
          // focus events
          window.addEventListener('focusin', setElement);
          window.addEventListener('focusout', clearElement);
        };
        // checks conditions before updating new input
        var setInput = function setInput(event) {
          // only execute if the event buffer timer isn't running
          if( !isBuffering )
          {
            var eventKey = event.which;
            var value = inputMap[event.type];
            if( value === 'pointer' )
            {
              value = pointerType(event);
            }
            var shouldUpdate = value === 'keyboard' && eventKey && ignoreMap.indexOf(eventKey) === -1 || value === 'mouse' || value === 'touch';
            if( currentInput !== value && shouldUpdate )
            {
              currentInput = value;
              doUpdate('input');
            }
            if( currentIntent !== value && shouldUpdate )
            {
              // preserve intent for keyboard typing in form fields
              var activeElem = document.activeElement;
              var notFormInput = activeElem && activeElem.nodeName && formInputs.indexOf(activeElem.nodeName.toLowerCase()) === -1;
              if( notFormInput )
              {
                currentIntent = value;
                doUpdate('intent');
              }
            }
          }
        };
        // updates the doc and `inputTypes` array with new input
        var doUpdate = function doUpdate(which) {
          docElem.setAttribute('data-what'+which, which === 'input' ? currentInput : currentIntent);
          fireFunctions(which);
        };
        // updates input intent for `mousemove` and `pointermove`
        var setIntent = function setIntent(event) {
          // test to see if `mousemove` happened relative to the screen to detect scrolling versus mousemove
          detectScrolling(event);
          // only execute if the event buffer timer isn't running
          // or scrolling isn't happening
          if( !isBuffering && !isScrolling )
          {
            var value = inputMap[event.type];
            if( value === 'pointer' )
            {
              value = pointerType(event);
            }
            if( currentIntent !== value )
            {
              currentIntent = value;
              doUpdate('intent');
            }
          }
        };
        var setElement = function setElement(event) {
          currentElement = event.target.nodeName.toLowerCase();
          docElem.setAttribute('data-whatelement', currentElement);
          if( event.target.classList && event.target.classList.length )
          {
            docElem.setAttribute('data-whatclasses', event.target.classList.toString().replace(' ', ','));
          }
        };
        var clearElement = function clearElement() {
          currentElement = null;
          docElem.removeAttribute('data-whatelement');
          docElem.removeAttribute('data-whatclasses');
        };
        // buffers events that frequently also fire mouse events
        var eventBuffer = function eventBuffer(event) {
          // set the current input
          setInput(event);
          // clear the timer if it happens to be running
          window.clearTimeout(eventTimer);
          // set the isBuffering to `true`
          isBuffering = true;
          // run the timer
          eventTimer = window.setTimeout(function () {
            // if the timer runs out, set isBuffering back to `false`
            isBuffering = false;
          }, 100);
        };
        /*
         * utilities
         */
        var pointerType = function pointerType(event) {
          if( typeof event.pointerType === 'number' )
          {
            return pointerMap[event.pointerType];
          }
          else
          {
            // treat pen like touch
            return event.pointerType === 'pen' ? 'touch' : event.pointerType;
          }
        };
        // detect version of mouse wheel event to use
        // via https://developer.mozilla.org/en-US/docs/Web/Events/wheel
        var detectWheel = function detectWheel() {
          var wheelType = void 0;
          // Modern browsers support "wheel"
          if( 'onwheel' in document.createElement('div') )
          {
            wheelType = 'wheel';
          }
          else
          {
            // Webkit and IE support at least "mousewheel"
            // or assume that remaining browsers are older Firefox
            wheelType = document.onmousewheel !== undefined ? 'mousewheel' : 'DOMMouseScroll';
          }
          return wheelType;
        };
        // runs callback functions
        var fireFunctions = function fireFunctions(type) {
          for( var i = 0, len = functionList.length; i < len; i++ )
          {
            if( functionList[i].type === type )
            {
              functionList[i].fn.call(undefined, type === 'input' ? currentInput : currentIntent);
            }
          }
        };
        // finds matching element in an object
        var objPos = function objPos(match) {
          for( var i = 0, len = functionList.length; i < len; i++ )
          {
            if( functionList[i].fn === match )
            {
              return i;
            }
          }
        };
        var detectScrolling = function detectScrolling(event) {
          if( mousePos['x'] !== event.screenX || mousePos['y'] !== event.screenY )
          {
            isScrolling = false;
            mousePos['x'] = event.screenX;
            mousePos['y'] = event.screenY;
          }
          else
          {
            isScrolling = true;
          }
        };
        /*
         * init
         */
        // don't start script unless browser cuts the mustard
        // (also passes if polyfills are used)
        if( 'addEventListener' in window && Array.prototype.indexOf )
        {
          setUp();
        }
        /*
         * api
         */
        return {
          // returns string: the current input type
          // opt: 'intent'|'input'
          // 'input' (default): returns the same value as the `data-whatinput` attribute
          // 'intent': includes `data-whatintent` value if it's different than `data-whatinput`
          ask: function ask(opt) {
            return opt === 'intent' ? currentIntent : currentInput;
          },
          // returns string: the currently focused element or null
          element: function element() {
            return currentElement;
          },
          // overwrites ignored keys with provided array
          ignoreKeys: function ignoreKeys(arr) {
            ignoreMap = arr;
          },
          // attach functions to input and intent "events"
          // funct: function to fire on change
          // eventType: 'input'|'intent'
          registerOnChange: function registerOnChange(fn, eventType) {
            functionList.push({
              fn: fn,
              type: eventType || 'input'
            });
          },
          unRegisterOnChange: function unRegisterOnChange(fn) {
            var position = objPos(fn);
            if( position )
            {
              functionList.splice(position, 1);
            }
          }
        };
      }();
      /***/
    })
    /******/])
});
;
   /* Ende whatinput */
   /* Start select2 */
   /*!
 * Select2 4.0.5
 * https://select2.github.io
 *
 * Released under the MIT license
 * https://github.com/select2/select2/blob/master/LICENSE.md
 */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{if(typeof module==="object"&&module.exports){module.exports=function(root,jQuery){if(jQuery===undefined){if(typeof window!=="undefined"){jQuery=require("jquery");}else{jQuery=require("jquery")(root);}}factory(jQuery);return jQuery;};}else{factory(jQuery);}}}(function(jQuery){var S2=(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd){var S2=jQuery.fn.select2.amd;}var S2;(function(){if(!S2||!S2.requirejs){if(!S2){S2={};}else{require=S2;}var requirejs,require,define;(function(undef){var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;function hasProp(obj,prop){return hasOwn.call(obj,prop);}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,normalizedBaseParts,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=(map&&map["*"])||{};if(name){name=name.split("/");lastIndex=name.length-1;if(config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])){name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"");}if(name[0].charAt(0)==="."&&baseParts){normalizedBaseParts=baseParts.slice(0,baseParts.length-1);name=normalizedBaseParts.concat(name);}for(i=0;i<name.length;i++){part=name[i];if(part==="."){name.splice(i,1);i-=1;}else{if(part===".."){if(i===0||(i===1&&name[2]==="..")||name[i-1]===".."){continue;}else{if(i>0){name.splice(i-1,2);i-=2;}}}}}name=name.join("/");}if((baseParts||starMap)&&map){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=map[baseParts.slice(0,j).join("/")];if(mapValue){mapValue=mapValue[nameSegment];if(mapValue){foundMap=mapValue;foundI=i;break;}}}}if(foundMap){break;}if(!foundStarMap&&starMap&&starMap[nameSegment]){foundStarMap=starMap[nameSegment];starI=i;}}if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI;}if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join("/");}}return name;}function makeRequire(relName,forceSync){return function(){var args=aps.call(arguments,0);if(typeof args[0]!=="string"&&args.length===1){args.push(null);}return req.apply(undef,args.concat([relName,forceSync]));};}function makeNormalize(relName){return function(name){return normalize(name,relName);};}function makeLoad(depName){return function(value){defined[depName]=value;};}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name];defining[name]=true;main.apply(undef,args);}if(!hasProp(defined,name)&&!hasProp(defining,name)){throw new Error("No "+name);}return defined[name];}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length);}return[prefix,name];}function makeRelParts(relName){return relName?splitPrefix(relName):[];}makeMap=function(name,relParts){var plugin,parts=splitPrefix(name),prefix=parts[0],relResourceName=relParts[1];name=parts[1];if(prefix){prefix=normalize(prefix,relResourceName);plugin=callDep(prefix);}if(prefix){if(plugin&&plugin.normalize){name=plugin.normalize(name,makeNormalize(relResourceName));}else{name=normalize(name,relResourceName);}}else{name=normalize(name,relResourceName);parts=splitPrefix(name);prefix=parts[0];name=parts[1];if(prefix){plugin=callDep(prefix);}}return{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin};};function makeConfig(name){return function(){return(config&&config.config&&config.config[name])||{};};}handlers={require:function(name){return makeRequire(name);},exports:function(name){var e=defined[name];if(typeof e!=="undefined"){return e;}else{return(defined[name]={});}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)};}};main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,relParts,args=[],callbackType=typeof callback,usingExports;relName=relName||name;relParts=makeRelParts(relName);if(callbackType==="undefined"||callbackType==="function"){deps=!deps.length&&callback.length?["require","exports","module"]:deps;for(i=0;i<deps.length;i+=1){map=makeMap(deps[i],relParts);depName=map.f;if(depName==="require"){args[i]=handlers.require(name);}else{if(depName==="exports"){args[i]=handlers.exports(name);usingExports=true;}else{if(depName==="module"){cjsModule=args[i]=handlers.module(name);}else{if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName)){args[i]=callDep(depName);}else{if(map.p){map.p.load(map.n,makeRequire(relName,true),makeLoad(depName),{});args[i]=defined[depName];}else{throw new Error(name+" missing "+depName);}}}}}}ret=callback?callback.apply(defined[name],args):undefined;if(name){if(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]){defined[name]=cjsModule.exports;}else{if(ret!==undef||!usingExports){defined[name]=ret;}}}}else{if(name){defined[name]=callback;}}};requirejs=require=req=function(deps,callback,relName,forceSync,alt){if(typeof deps==="string"){if(handlers[deps]){return handlers[deps](callback);}return callDep(makeMap(deps,makeRelParts(callback)).f);}else{if(!deps.splice){config=deps;if(config.deps){req(config.deps,config.callback);}if(!callback){return;}if(callback.splice){deps=callback;callback=relName;relName=null;}else{deps=undef;}}}callback=callback||function(){};if(typeof relName==="function"){relName=forceSync;forceSync=alt;}if(forceSync){main(undef,deps,callback,relName);}else{setTimeout(function(){main(undef,deps,callback,relName);},4);}return req;};req.config=function(cfg){return req(cfg);};requirejs._defined=defined;define=function(name,deps,callback){if(typeof name!=="string"){throw new Error("See almond README: incorrect module build, no module name");}if(!deps.splice){callback=deps;deps=[];}if(!hasProp(defined,name)&&!hasProp(waiting,name)){waiting[name]=[name,deps,callback];}};define.amd={jQuery:true};}());S2.requirejs=requirejs;S2.require=require;S2.define=define;}}());S2.define("almond",function(){});S2.define("jquery",[],function(){var _$=jQuery||$;if(_$==null&&console&&console.error){console.error("Select2: An instance of jQuery or a jQuery-compatible library was not "+"found. Make sure that you are including jQuery before Select2 on your "+"web page.");}return _$;});S2.define("select2/utils",["jquery"],function($){var Utils={};Utils.Extend=function(ChildClass,SuperClass){var __hasProp={}.hasOwnProperty;function BaseConstructor(){this.constructor=ChildClass;}for(var key in SuperClass){if(__hasProp.call(SuperClass,key)){ChildClass[key]=SuperClass[key];}}BaseConstructor.prototype=SuperClass.prototype;ChildClass.prototype=new BaseConstructor();ChildClass.__super__=SuperClass.prototype;return ChildClass;};function getMethods(theClass){var proto=theClass.prototype;var methods=[];for(var methodName in proto){var m=proto[methodName];if(typeof m!=="function"){continue;}if(methodName==="constructor"){continue;}methods.push(methodName);}return methods;}Utils.Decorate=function(SuperClass,DecoratorClass){var decoratedMethods=getMethods(DecoratorClass);var superMethods=getMethods(SuperClass);function DecoratedClass(){var unshift=Array.prototype.unshift;var argCount=DecoratorClass.prototype.constructor.length;var calledConstructor=SuperClass.prototype.constructor;if(argCount>0){unshift.call(arguments,SuperClass.prototype.constructor);calledConstructor=DecoratorClass.prototype.constructor;}calledConstructor.apply(this,arguments);}DecoratorClass.displayName=SuperClass.displayName;function ctr(){this.constructor=DecoratedClass;}DecoratedClass.prototype=new ctr();for(var m=0;m<superMethods.length;m++){var superMethod=superMethods[m];DecoratedClass.prototype[superMethod]=SuperClass.prototype[superMethod];}var calledMethod=function(methodName){var originalMethod=function(){};if(methodName in DecoratedClass.prototype){originalMethod=DecoratedClass.prototype[methodName];}var decoratedMethod=DecoratorClass.prototype[methodName];return function(){var unshift=Array.prototype.unshift;unshift.call(arguments,originalMethod);return decoratedMethod.apply(this,arguments);};};for(var d=0;d<decoratedMethods.length;d++){var decoratedMethod=decoratedMethods[d];DecoratedClass.prototype[decoratedMethod]=calledMethod(decoratedMethod);}return DecoratedClass;};var Observable=function(){this.listeners={};};Observable.prototype.on=function(event,callback){this.listeners=this.listeners||{};if(event in this.listeners){this.listeners[event].push(callback);}else{this.listeners[event]=[callback];}};Observable.prototype.trigger=function(event){var slice=Array.prototype.slice;var params=slice.call(arguments,1);this.listeners=this.listeners||{};if(params==null){params=[];}if(params.length===0){params.push({});}params[0]._type=event;if(event in this.listeners){this.invoke(this.listeners[event],slice.call(arguments,1));}if("*" in this.listeners){this.invoke(this.listeners["*"],arguments);}};Observable.prototype.invoke=function(listeners,params){for(var i=0,len=listeners.length;i<len;i++){listeners[i].apply(this,params);}};Utils.Observable=Observable;Utils.generateChars=function(length){var chars="";for(var i=0;i<length;i++){var randomChar=Math.floor(Math.random()*36);chars+=randomChar.toString(36);}return chars;};Utils.bind=function(func,context){return function(){func.apply(context,arguments);};};Utils._convertData=function(data){for(var originalKey in data){var keys=originalKey.split("-");var dataLevel=data;if(keys.length===1){continue;}for(var k=0;k<keys.length;k++){var key=keys[k];key=key.substring(0,1).toLowerCase()+key.substring(1);if(!(key in dataLevel)){dataLevel[key]={};}if(k==keys.length-1){dataLevel[key]=data[originalKey];}dataLevel=dataLevel[key];}delete data[originalKey];}return data;};Utils.hasScroll=function(index,el){var $el=$(el);var overflowX=el.style.overflowX;var overflowY=el.style.overflowY;if(overflowX===overflowY&&(overflowY==="hidden"||overflowY==="visible")){return false;}if(overflowX==="scroll"||overflowY==="scroll"){return true;}return($el.innerHeight()<el.scrollHeight||$el.innerWidth()<el.scrollWidth);};Utils.escapeMarkup=function(markup){var replaceMap={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};if(typeof markup!=="string"){return markup;}return String(markup).replace(/[&<>"'\/\\]/g,function(match){return replaceMap[match];});};Utils.appendMany=function($element,$nodes){if($.fn.jquery.substr(0,3)==="1.7"){var $jqNodes=$();$.map($nodes,function(node){$jqNodes=$jqNodes.add(node);});$nodes=$jqNodes;}$element.append($nodes);};return Utils;});S2.define("select2/results",["jquery","./utils"],function($,Utils){function Results($element,options,dataAdapter){this.$element=$element;this.data=dataAdapter;this.options=options;Results.__super__.constructor.call(this);}Utils.Extend(Results,Utils.Observable);Results.prototype.render=function(){var $results=$('<ul class="select2-results__options" role="tree"></ul>');if(this.options.get("multiple")){$results.attr("aria-multiselectable","true");}this.$results=$results;return $results;};Results.prototype.clear=function(){this.$results.empty();};Results.prototype.displayMessage=function(params){var escapeMarkup=this.options.get("escapeMarkup");this.clear();this.hideLoading();var $message=$('<li role="treeitem" aria-live="assertive"'+' class="select2-results__option"></li>');var message=this.options.get("translations").get(params.message);$message.append(escapeMarkup(message(params.args)));$message[0].className+=" select2-results__message";this.$results.append($message);};Results.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove();};Results.prototype.append=function(data){this.hideLoading();var $options=[];if(data.results==null||data.results.length===0){if(this.$results.children().length===0){this.trigger("results:message",{message:"noResults"});}return;}data.results=this.sort(data.results);for(var d=0;d<data.results.length;d++){var item=data.results[d];var $option=this.option(item);$options.push($option);}this.$results.append($options);};Results.prototype.position=function($results,$dropdown){var $resultsContainer=$dropdown.find(".select2-results");$resultsContainer.append($results);};Results.prototype.sort=function(data){var sorter=this.options.get("sorter");return sorter(data);};Results.prototype.highlightFirstItem=function(){var $options=this.$results.find(".select2-results__option[aria-selected]");var $selected=$options.filter("[aria-selected=true]");if($selected.length>0){$selected.first().trigger("mouseenter");}else{$options.first().trigger("mouseenter");}this.ensureHighlightVisible();};Results.prototype.setClasses=function(){var self=this;this.data.current(function(selected){var selectedIds=$.map(selected,function(s){return s.id.toString();});var $options=self.$results.find(".select2-results__option[aria-selected]");$options.each(function(){var $option=$(this);var item=$.data(this,"data");var id=""+item.id;if((item.element!=null&&item.element.selected)||(item.element==null&&$.inArray(id,selectedIds)>-1)){$option.attr("aria-selected","true");}else{$option.attr("aria-selected","false");}});});};Results.prototype.showLoading=function(params){this.hideLoading();var loadingMore=this.options.get("translations").get("searching");var loading={disabled:true,loading:true,text:loadingMore(params)};var $loading=this.option(loading);$loading.className+=" loading-results";this.$results.prepend($loading);};Results.prototype.hideLoading=function(){this.$results.find(".loading-results").remove();};Results.prototype.option=function(data){var option=document.createElement("li");option.className="select2-results__option";var attrs={"role":"treeitem","aria-selected":"false"};if(data.disabled){delete attrs["aria-selected"];attrs["aria-disabled"]="true";}if(data.id==null){delete attrs["aria-selected"];}if(data._resultId!=null){option.id=data._resultId;}if(data.title){option.title=data.title;}if(data.children){attrs.role="group";attrs["aria-label"]=data.text;delete attrs["aria-selected"];}for(var attr in attrs){var val=attrs[attr];option.setAttribute(attr,val);}if(data.children){var $option=$(option);var label=document.createElement("strong");label.className="select2-results__group";var $label=$(label);this.template(data,label);var $children=[];for(var c=0;c<data.children.length;c++){var child=data.children[c];var $child=this.option(child);$children.push($child);}var $childrenContainer=$("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});$childrenContainer.append($children);$option.append(label);$option.append($childrenContainer);}else{this.template(data,option);}$.data(option,"data",data);return option;};Results.prototype.bind=function(container,$container){var self=this;var id=container.id+"-results";this.$results.attr("id",id);container.on("results:all",function(params){self.clear();self.append(params.data);if(container.isOpen()){self.setClasses();self.highlightFirstItem();}});container.on("results:append",function(params){self.append(params.data);if(container.isOpen()){self.setClasses();}});container.on("query",function(params){self.hideMessages();self.showLoading(params);});container.on("select",function(){if(!container.isOpen()){return;}self.setClasses();self.highlightFirstItem();});container.on("unselect",function(){if(!container.isOpen()){return;}self.setClasses();self.highlightFirstItem();});container.on("open",function(){self.$results.attr("aria-expanded","true");self.$results.attr("aria-hidden","false");self.setClasses();self.ensureHighlightVisible();});container.on("close",function(){self.$results.attr("aria-expanded","false");self.$results.attr("aria-hidden","true");self.$results.removeAttr("aria-activedescendant");});container.on("results:toggle",function(){var $highlighted=self.getHighlightedResults();if($highlighted.length===0){return;}$highlighted.trigger("mouseup");});container.on("results:select",function(){var $highlighted=self.getHighlightedResults();if($highlighted.length===0){return;}var data=$highlighted.data("data");if($highlighted.attr("aria-selected")=="true"){self.trigger("close",{});}else{self.trigger("select",{data:data});}});container.on("results:previous",function(){var $highlighted=self.getHighlightedResults();var $options=self.$results.find("[aria-selected]");var currentIndex=$options.index($highlighted);if(currentIndex===0){return;}var nextIndex=currentIndex-1;if($highlighted.length===0){nextIndex=0;}var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top;var nextTop=$next.offset().top;var nextOffset=self.$results.scrollTop()+(nextTop-currentOffset);if(nextIndex===0){self.$results.scrollTop(0);}else{if(nextTop-currentOffset<0){self.$results.scrollTop(nextOffset);}}});container.on("results:next",function(){var $highlighted=self.getHighlightedResults();var $options=self.$results.find("[aria-selected]");var currentIndex=$options.index($highlighted);var nextIndex=currentIndex+1;if(nextIndex>=$options.length){return;}var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top+self.$results.outerHeight(false);var nextBottom=$next.offset().top+$next.outerHeight(false);var nextOffset=self.$results.scrollTop()+nextBottom-currentOffset;if(nextIndex===0){self.$results.scrollTop(0);}else{if(nextBottom>currentOffset){self.$results.scrollTop(nextOffset);}}});container.on("results:focus",function(params){params.element.addClass("select2-results__option--highlighted");});container.on("results:message",function(params){self.displayMessage(params);});if($.fn.mousewheel){this.$results.on("mousewheel",function(e){var top=self.$results.scrollTop();var bottom=self.$results.get(0).scrollHeight-top+e.deltaY;var isAtTop=e.deltaY>0&&top-e.deltaY<=0;var isAtBottom=e.deltaY<0&&bottom<=self.$results.height();if(isAtTop){self.$results.scrollTop(0);e.preventDefault();e.stopPropagation();}else{if(isAtBottom){self.$results.scrollTop(self.$results.get(0).scrollHeight-self.$results.height());e.preventDefault();e.stopPropagation();}}});}this.$results.on("mouseup",".select2-results__option[aria-selected]",function(evt){var $this=$(this);var data=$this.data("data");if($this.attr("aria-selected")==="true"){if(self.options.get("multiple")){self.trigger("unselect",{originalEvent:evt,data:data});}else{self.trigger("close",{});}return;}self.trigger("select",{originalEvent:evt,data:data});});this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(evt){var data=$(this).data("data");self.getHighlightedResults().removeClass("select2-results__option--highlighted");self.trigger("results:focus",{data:data,element:$(this)});});};Results.prototype.getHighlightedResults=function(){var $highlighted=this.$results.find(".select2-results__option--highlighted");return $highlighted;};Results.prototype.destroy=function(){this.$results.remove();};Results.prototype.ensureHighlightVisible=function(){var $highlighted=this.getHighlightedResults();if($highlighted.length===0){return;}var $options=this.$results.find("[aria-selected]");var currentIndex=$options.index($highlighted);var currentOffset=this.$results.offset().top;var nextTop=$highlighted.offset().top;var nextOffset=this.$results.scrollTop()+(nextTop-currentOffset);var offsetDelta=nextTop-currentOffset;nextOffset-=$highlighted.outerHeight(false)*2;if(currentIndex<=2){this.$results.scrollTop(0);}else{if(offsetDelta>this.$results.outerHeight()||offsetDelta<0){this.$results.scrollTop(nextOffset);}}};Results.prototype.template=function(result,container){var template=this.options.get("templateResult");var escapeMarkup=this.options.get("escapeMarkup");var content=template(result,container);if(content==null){container.style.display="none";}else{if(typeof content==="string"){container.innerHTML=escapeMarkup(content);}else{$(container).append(content);}}};return Results;});S2.define("select2/keys",[],function(){var KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return KEYS;});S2.define("select2/selection/base",["jquery","../utils","../keys"],function($,Utils,KEYS){function BaseSelection($element,options){this.$element=$element;this.options=options;BaseSelection.__super__.constructor.call(this);}Utils.Extend(BaseSelection,Utils.Observable);BaseSelection.prototype.render=function(){var $selection=$('<span class="select2-selection" role="combobox" '+' aria-haspopup="true" aria-expanded="false">'+"</span>");this._tabindex=0;if(this.$element.data("old-tabindex")!=null){this._tabindex=this.$element.data("old-tabindex");}else{if(this.$element.attr("tabindex")!=null){this._tabindex=this.$element.attr("tabindex");}}$selection.attr("title",this.$element.attr("title"));$selection.attr("tabindex",this._tabindex);this.$selection=$selection;return $selection;};BaseSelection.prototype.bind=function(container,$container){var self=this;var id=container.id+"-container";var resultsId=container.id+"-results";this.container=container;this.$selection.on("focus",function(evt){self.trigger("focus",evt);});this.$selection.on("blur",function(evt){self._handleBlur(evt);});this.$selection.on("keydown",function(evt){self.trigger("keypress",evt);if(evt.which===KEYS.SPACE){evt.preventDefault();}});container.on("results:focus",function(params){self.$selection.attr("aria-activedescendant",params.data._resultId);});container.on("selection:update",function(params){self.update(params.data);});container.on("open",function(){self.$selection.attr("aria-expanded","true");self.$selection.attr("aria-owns",resultsId);self._attachCloseHandler(container);});container.on("close",function(){self.$selection.attr("aria-expanded","false");self.$selection.removeAttr("aria-activedescendant");self.$selection.removeAttr("aria-owns");self.$selection.focus();self._detachCloseHandler(container);});container.on("enable",function(){self.$selection.attr("tabindex",self._tabindex);});container.on("disable",function(){self.$selection.attr("tabindex","-1");});};BaseSelection.prototype._handleBlur=function(evt){var self=this;window.setTimeout(function(){if((document.activeElement==self.$selection[0])||($.contains(self.$selection[0],document.activeElement))){return;}self.trigger("blur",evt);},1);};BaseSelection.prototype._attachCloseHandler=function(container){var self=this;$(document.body).on("mousedown.select2."+container.id,function(e){var $target=$(e.target);var $select=$target.closest(".select2");var $all=$(".select2.select2-container--open");$all.each(function(){var $this=$(this);if(this==$select[0]){return;}var $element=$this.data("element");$element.select2("close");});});};BaseSelection.prototype._detachCloseHandler=function(container){$(document.body).off("mousedown.select2."+container.id);};BaseSelection.prototype.position=function($selection,$container){var $selectionContainer=$container.find(".selection");$selectionContainer.append($selection);};BaseSelection.prototype.destroy=function(){this._detachCloseHandler(this.container);};BaseSelection.prototype.update=function(data){throw new Error("The `update` method must be defined in child classes.");};return BaseSelection;});S2.define("select2/selection/single",["jquery","./base","../utils","../keys"],function($,BaseSelection,Utils,KEYS){function SingleSelection(){SingleSelection.__super__.constructor.apply(this,arguments);}Utils.Extend(SingleSelection,BaseSelection);SingleSelection.prototype.render=function(){var $selection=SingleSelection.__super__.render.call(this);$selection.addClass("select2-selection--single");$selection.html('<span class="select2-selection__rendered"></span>'+'<span class="select2-selection__arrow" role="presentation">'+'<b role="presentation"></b>'+"</span>");return $selection;};SingleSelection.prototype.bind=function(container,$container){var self=this;SingleSelection.__super__.bind.apply(this,arguments);var id=container.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",id);this.$selection.attr("aria-labelledby",id);this.$selection.on("mousedown",function(evt){if(evt.which!==1){return;}self.trigger("toggle",{originalEvent:evt});});this.$selection.on("focus",function(evt){});this.$selection.on("blur",function(evt){});container.on("focus",function(evt){if(!container.isOpen()){self.$selection.focus();}});container.on("selection:update",function(params){self.update(params.data);});};SingleSelection.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty();};SingleSelection.prototype.display=function(data,container){var template=this.options.get("templateSelection");var escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data,container));};SingleSelection.prototype.selectionContainer=function(){return $("<span></span>");};SingleSelection.prototype.update=function(data){if(data.length===0){this.clear();return;}var selection=data[0];var $rendered=this.$selection.find(".select2-selection__rendered");var formatted=this.display(selection,$rendered);$rendered.empty().append(formatted);$rendered.prop("title",selection.title||selection.text);};return SingleSelection;});S2.define("select2/selection/multiple",["jquery","./base","../utils"],function($,BaseSelection,Utils){function MultipleSelection($element,options){MultipleSelection.__super__.constructor.apply(this,arguments);}Utils.Extend(MultipleSelection,BaseSelection);MultipleSelection.prototype.render=function(){var $selection=MultipleSelection.__super__.render.call(this);$selection.addClass("select2-selection--multiple");$selection.html('<ul class="select2-selection__rendered"></ul>');return $selection;};MultipleSelection.prototype.bind=function(container,$container){var self=this;MultipleSelection.__super__.bind.apply(this,arguments);this.$selection.on("click",function(evt){self.trigger("toggle",{originalEvent:evt});});this.$selection.on("click",".select2-selection__choice__remove",function(evt){if(self.options.get("disabled")){return;}var $remove=$(this);var $selection=$remove.parent();var data=$selection.data("data");self.trigger("unselect",{originalEvent:evt,data:data});});};MultipleSelection.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty();};MultipleSelection.prototype.display=function(data,container){var template=this.options.get("templateSelection");var escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data,container));};MultipleSelection.prototype.selectionContainer=function(){var $container=$('<li class="select2-selection__choice">'+'<span class="select2-selection__choice__remove" role="presentation">'+"&times;"+"</span>"+"</li>");return $container;};MultipleSelection.prototype.update=function(data){this.clear();if(data.length===0){return;}var $selections=[];for(var d=0;d<data.length;d++){var selection=data[d];var $selection=this.selectionContainer();var formatted=this.display(selection,$selection);$selection.append(formatted);$selection.prop("title",selection.title||selection.text);$selection.data("data",selection);$selections.push($selection);}var $rendered=this.$selection.find(".select2-selection__rendered");Utils.appendMany($rendered,$selections);};return MultipleSelection;});S2.define("select2/selection/placeholder",["../utils"],function(Utils){function Placeholder(decorated,$element,options){this.placeholder=this.normalizePlaceholder(options.get("placeholder"));decorated.call(this,$element,options);}Placeholder.prototype.normalizePlaceholder=function(_,placeholder){if(typeof placeholder==="string"){placeholder={id:"",text:placeholder};}return placeholder;};Placeholder.prototype.createPlaceholder=function(decorated,placeholder){var $placeholder=this.selectionContainer();$placeholder.html(this.display(placeholder));$placeholder.addClass("select2-selection__placeholder").removeClass("select2-selection__choice");return $placeholder;};Placeholder.prototype.update=function(decorated,data){var singlePlaceholder=(data.length==1&&data[0].id!=this.placeholder.id);var multipleSelections=data.length>1;if(multipleSelections||singlePlaceholder){return decorated.call(this,data);}this.clear();var $placeholder=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append($placeholder);};return Placeholder;});S2.define("select2/selection/allowClear",["jquery","../keys"],function($,KEYS){function AllowClear(){}AllowClear.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);if(this.placeholder==null){if(this.options.get("debug")&&window.console&&console.error){console.error("Select2: The `allowClear` option should be used in combination "+"with the `placeholder` option.");}}this.$selection.on("mousedown",".select2-selection__clear",function(evt){self._handleClear(evt);});container.on("keypress",function(evt){self._handleKeyboardClear(evt,container);});};AllowClear.prototype._handleClear=function(_,evt){if(this.options.get("disabled")){return;}var $clear=this.$selection.find(".select2-selection__clear");if($clear.length===0){return;}evt.stopPropagation();var data=$clear.data("data");for(var d=0;d<data.length;d++){var unselectData={data:data[d]};this.trigger("unselect",unselectData);if(unselectData.prevented){return;}}this.$element.val(this.placeholder.id).trigger("change");this.trigger("toggle",{});};AllowClear.prototype._handleKeyboardClear=function(_,evt,container){if(container.isOpen()){return;}if(evt.which==KEYS.DELETE||evt.which==KEYS.BACKSPACE){this._handleClear(evt);}};AllowClear.prototype.update=function(decorated,data){decorated.call(this,data);if(this.$selection.find(".select2-selection__placeholder").length>0||data.length===0){return;}var $remove=$('<span class="select2-selection__clear">'+"&times;"+"</span>");$remove.data("data",data);this.$selection.find(".select2-selection__rendered").prepend($remove);};return AllowClear;});S2.define("select2/selection/search",["jquery","../utils","../keys"],function($,Utils,KEYS){function Search(decorated,$element,options){decorated.call(this,$element,options);}Search.prototype.render=function(decorated){var $search=$('<li class="select2-search select2-search--inline">'+'<input class="select2-search__field" type="search" tabindex="-1"'+' autocomplete="off" autocorrect="off" autocapitalize="none"'+' spellcheck="false" role="textbox" aria-autocomplete="list" />'+"</li>");this.$searchContainer=$search;this.$search=$search.find("input");var $rendered=decorated.call(this);this._transferTabIndex();return $rendered;};Search.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("open",function(){self.$search.trigger("focus");});container.on("close",function(){self.$search.val("");self.$search.removeAttr("aria-activedescendant");self.$search.trigger("focus");});container.on("enable",function(){self.$search.prop("disabled",false);self._transferTabIndex();});container.on("disable",function(){self.$search.prop("disabled",true);});container.on("focus",function(evt){self.$search.trigger("focus");});container.on("results:focus",function(params){self.$search.attr("aria-activedescendant",params.id);});this.$selection.on("focusin",".select2-search--inline",function(evt){self.trigger("focus",evt);});this.$selection.on("focusout",".select2-search--inline",function(evt){self._handleBlur(evt);});this.$selection.on("keydown",".select2-search--inline",function(evt){evt.stopPropagation();self.trigger("keypress",evt);self._keyUpPrevented=evt.isDefaultPrevented();var key=evt.which;if(key===KEYS.BACKSPACE&&self.$search.val()===""){var $previousChoice=self.$searchContainer.prev(".select2-selection__choice");if($previousChoice.length>0){var item=$previousChoice.data("data");self.searchRemoveChoice(item);evt.preventDefault();}}});var msie=document.documentMode;var disableInputEvents=msie&&msie<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(evt){if(disableInputEvents){self.$selection.off("input.search input.searchcheck");return;}self.$selection.off("keyup.search");});this.$selection.on("keyup.search input.search",".select2-search--inline",function(evt){if(disableInputEvents&&evt.type==="input"){self.$selection.off("input.search input.searchcheck");return;}var key=evt.which;if(key==KEYS.SHIFT||key==KEYS.CTRL||key==KEYS.ALT){return;}if(key==KEYS.TAB){return;}self.handleSearch(evt);});};Search.prototype._transferTabIndex=function(decorated){this.$search.attr("tabindex",this.$selection.attr("tabindex"));this.$selection.attr("tabindex","-1");};Search.prototype.createPlaceholder=function(decorated,placeholder){this.$search.attr("placeholder",placeholder.text);};Search.prototype.update=function(decorated,data){var searchHadFocus=this.$search[0]==document.activeElement;this.$search.attr("placeholder","");decorated.call(this,data);this.$selection.find(".select2-selection__rendered").append(this.$searchContainer);this.resizeSearch();if(searchHadFocus){this.$search.focus();}};Search.prototype.handleSearch=function(){this.resizeSearch();if(!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input});}this._keyUpPrevented=false;};Search.prototype.searchRemoveChoice=function(decorated,item){this.trigger("unselect",{data:item});this.$search.val(item.text);this.handleSearch();};Search.prototype.resizeSearch=function(){this.$search.css("width","25px");var width="";if(this.$search.attr("placeholder")!==""){width=this.$selection.find(".select2-selection__rendered").innerWidth();}else{var minimumWidth=this.$search.val().length+1;width=(minimumWidth*0.75)+"em";}this.$search.css("width",width);};return Search;});S2.define("select2/selection/eventRelay",["jquery"],function($){function EventRelay(){}EventRelay.prototype.bind=function(decorated,container,$container){var self=this;var relayEvents=["open","opening","close","closing","select","selecting","unselect","unselecting"];var preventableEvents=["opening","closing","selecting","unselecting"];decorated.call(this,container,$container);container.on("*",function(name,params){if($.inArray(name,relayEvents)===-1){return;}params=params||{};var evt=$.Event("select2:"+name,{params:params});self.$element.trigger(evt);if($.inArray(name,preventableEvents)===-1){return;}params.prevented=evt.isDefaultPrevented();});};return EventRelay;});S2.define("select2/translation",["jquery","require"],function($,require){function Translation(dict){this.dict=dict||{};}Translation.prototype.all=function(){return this.dict;};Translation.prototype.get=function(key){return this.dict[key];};Translation.prototype.extend=function(translation){this.dict=$.extend({},translation.all(),this.dict);};Translation._cache={};Translation.loadPath=function(path){if(!(path in Translation._cache)){var translations=require(path);Translation._cache[path]=translations;}return new Translation(Translation._cache[path]);};return Translation;});S2.define("select2/diacritics",[],function(){var diacritics={"\u24B6":"A","\uFF21":"A","\u00C0":"A","\u00C1":"A","\u00C2":"A","\u1EA6":"A","\u1EA4":"A","\u1EAA":"A","\u1EA8":"A","\u00C3":"A","\u0100":"A","\u0102":"A","\u1EB0":"A","\u1EAE":"A","\u1EB4":"A","\u1EB2":"A","\u0226":"A","\u01E0":"A","\u00C4":"A","\u01DE":"A","\u1EA2":"A","\u00C5":"A","\u01FA":"A","\u01CD":"A","\u0200":"A","\u0202":"A","\u1EA0":"A","\u1EAC":"A","\u1EB6":"A","\u1E00":"A","\u0104":"A","\u023A":"A","\u2C6F":"A","\uA732":"AA","\u00C6":"AE","\u01FC":"AE","\u01E2":"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B","\uFF22":"B","\u1E02":"B","\u1E04":"B","\u1E06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24B8":"C","\uFF23":"C","\u0106":"C","\u0108":"C","\u010A":"C","\u010C":"C","\u00C7":"C","\u1E08":"C","\u0187":"C","\u023B":"C","\uA73E":"C","\u24B9":"D","\uFF24":"D","\u1E0A":"D","\u010E":"D","\u1E0C":"D","\u1E10":"D","\u1E12":"D","\u1E0E":"D","\u0110":"D","\u018B":"D","\u018A":"D","\u0189":"D","\uA779":"D","\u01F1":"DZ","\u01C4":"DZ","\u01F2":"Dz","\u01C5":"Dz","\u24BA":"E","\uFF25":"E","\u00C8":"E","\u00C9":"E","\u00CA":"E","\u1EC0":"E","\u1EBE":"E","\u1EC4":"E","\u1EC2":"E","\u1EBC":"E","\u0112":"E","\u1E14":"E","\u1E16":"E","\u0114":"E","\u0116":"E","\u00CB":"E","\u1EBA":"E","\u011A":"E","\u0204":"E","\u0206":"E","\u1EB8":"E","\u1EC6":"E","\u0228":"E","\u1E1C":"E","\u0118":"E","\u1E18":"E","\u1E1A":"E","\u0190":"E","\u018E":"E","\u24BB":"F","\uFF26":"F","\u1E1E":"F","\u0191":"F","\uA77B":"F","\u24BC":"G","\uFF27":"G","\u01F4":"G","\u011C":"G","\u1E20":"G","\u011E":"G","\u0120":"G","\u01E6":"G","\u0122":"G","\u01E4":"G","\u0193":"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H","\uFF28":"H","\u0124":"H","\u1E22":"H","\u1E26":"H","\u021E":"H","\u1E24":"H","\u1E28":"H","\u1E2A":"H","\u0126":"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I","\uFF29":"I","\u00CC":"I","\u00CD":"I","\u00CE":"I","\u0128":"I","\u012A":"I","\u012C":"I","\u0130":"I","\u00CF":"I","\u1E2E":"I","\u1EC8":"I","\u01CF":"I","\u0208":"I","\u020A":"I","\u1ECA":"I","\u012E":"I","\u1E2C":"I","\u0197":"I","\u24BF":"J","\uFF2A":"J","\u0134":"J","\u0248":"J","\u24C0":"K","\uFF2B":"K","\u1E30":"K","\u01E8":"K","\u1E32":"K","\u0136":"K","\u1E34":"K","\u0198":"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L","\uFF2C":"L","\u013F":"L","\u0139":"L","\u013D":"L","\u1E36":"L","\u1E38":"L","\u013B":"L","\u1E3C":"L","\u1E3A":"L","\u0141":"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L","\u01C7":"LJ","\u01C8":"Lj","\u24C2":"M","\uFF2D":"M","\u1E3E":"M","\u1E40":"M","\u1E42":"M","\u2C6E":"M","\u019C":"M","\u24C3":"N","\uFF2E":"N","\u01F8":"N","\u0143":"N","\u00D1":"N","\u1E44":"N","\u0147":"N","\u1E46":"N","\u0145":"N","\u1E4A":"N","\u1E48":"N","\u0220":"N","\u019D":"N","\uA790":"N","\uA7A4":"N","\u01CA":"NJ","\u01CB":"Nj","\u24C4":"O","\uFF2F":"O","\u00D2":"O","\u00D3":"O","\u00D4":"O","\u1ED2":"O","\u1ED0":"O","\u1ED6":"O","\u1ED4":"O","\u00D5":"O","\u1E4C":"O","\u022C":"O","\u1E4E":"O","\u014C":"O","\u1E50":"O","\u1E52":"O","\u014E":"O","\u022E":"O","\u0230":"O","\u00D6":"O","\u022A":"O","\u1ECE":"O","\u0150":"O","\u01D1":"O","\u020C":"O","\u020E":"O","\u01A0":"O","\u1EDC":"O","\u1EDA":"O","\u1EE0":"O","\u1EDE":"O","\u1EE2":"O","\u1ECC":"O","\u1ED8":"O","\u01EA":"O","\u01EC":"O","\u00D8":"O","\u01FE":"O","\u0186":"O","\u019F":"O","\uA74A":"O","\uA74C":"O","\u01A2":"OI","\uA74E":"OO","\u0222":"OU","\u24C5":"P","\uFF30":"P","\u1E54":"P","\u1E56":"P","\u01A4":"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q","\uFF31":"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R","\uFF32":"R","\u0154":"R","\u1E58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1E5A":"R","\u1E5C":"R","\u0156":"R","\u1E5E":"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S","\uFF33":"S","\u1E9E":"S","\u015A":"S","\u1E64":"S","\u015C":"S","\u1E60":"S","\u0160":"S","\u1E66":"S","\u1E62":"S","\u1E68":"S","\u0218":"S","\u015E":"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T","\uFF34":"T","\u1E6A":"T","\u0164":"T","\u1E6C":"T","\u021A":"T","\u0162":"T","\u1E70":"T","\u1E6E":"T","\u0166":"T","\u01AC":"T","\u01AE":"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U","\uFF35":"U","\u00D9":"U","\u00DA":"U","\u00DB":"U","\u0168":"U","\u1E78":"U","\u016A":"U","\u1E7A":"U","\u016C":"U","\u00DC":"U","\u01DB":"U","\u01D7":"U","\u01D5":"U","\u01D9":"U","\u1EE6":"U","\u016E":"U","\u0170":"U","\u01D3":"U","\u0214":"U","\u0216":"U","\u01AF":"U","\u1EEA":"U","\u1EE8":"U","\u1EEE":"U","\u1EEC":"U","\u1EF0":"U","\u1EE4":"U","\u1E72":"U","\u0172":"U","\u1E76":"U","\u1E74":"U","\u0244":"U","\u24CB":"V","\uFF36":"V","\u1E7C":"V","\u1E7E":"V","\u01B2":"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W","\uFF37":"W","\u1E80":"W","\u1E82":"W","\u0174":"W","\u1E86":"W","\u1E84":"W","\u1E88":"W","\u2C72":"W","\u24CD":"X","\uFF38":"X","\u1E8A":"X","\u1E8C":"X","\u24CE":"Y","\uFF39":"Y","\u1EF2":"Y","\u00DD":"Y","\u0176":"Y","\u1EF8":"Y","\u0232":"Y","\u1E8E":"Y","\u0178":"Y","\u1EF6":"Y","\u1EF4":"Y","\u01B3":"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z","\uFF3A":"Z","\u0179":"Z","\u1E90":"Z","\u017B":"Z","\u017D":"Z","\u1E92":"Z","\u1E94":"Z","\u01B5":"Z","\u0224":"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a","\uFF41":"a","\u1E9A":"a","\u00E0":"a","\u00E1":"a","\u00E2":"a","\u1EA7":"a","\u1EA5":"a","\u1EAB":"a","\u1EA9":"a","\u00E3":"a","\u0101":"a","\u0103":"a","\u1EB1":"a","\u1EAF":"a","\u1EB5":"a","\u1EB3":"a","\u0227":"a","\u01E1":"a","\u00E4":"a","\u01DF":"a","\u1EA3":"a","\u00E5":"a","\u01FB":"a","\u01CE":"a","\u0201":"a","\u0203":"a","\u1EA1":"a","\u1EAD":"a","\u1EB7":"a","\u1E01":"a","\u0105":"a","\u2C65":"a","\u0250":"a","\uA733":"aa","\u00E6":"ae","\u01FD":"ae","\u01E3":"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b","\uFF42":"b","\u1E03":"b","\u1E05":"b","\u1E07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24D2":"c","\uFF43":"c","\u0107":"c","\u0109":"c","\u010B":"c","\u010D":"c","\u00E7":"c","\u1E09":"c","\u0188":"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d","\uFF44":"d","\u1E0B":"d","\u010F":"d","\u1E0D":"d","\u1E11":"d","\u1E13":"d","\u1E0F":"d","\u0111":"d","\u018C":"d","\u0256":"d","\u0257":"d","\uA77A":"d","\u01F3":"dz","\u01C6":"dz","\u24D4":"e","\uFF45":"e","\u00E8":"e","\u00E9":"e","\u00EA":"e","\u1EC1":"e","\u1EBF":"e","\u1EC5":"e","\u1EC3":"e","\u1EBD":"e","\u0113":"e","\u1E15":"e","\u1E17":"e","\u0115":"e","\u0117":"e","\u00EB":"e","\u1EBB":"e","\u011B":"e","\u0205":"e","\u0207":"e","\u1EB9":"e","\u1EC7":"e","\u0229":"e","\u1E1D":"e","\u0119":"e","\u1E19":"e","\u1E1B":"e","\u0247":"e","\u025B":"e","\u01DD":"e","\u24D5":"f","\uFF46":"f","\u1E1F":"f","\u0192":"f","\uA77C":"f","\u24D6":"g","\uFF47":"g","\u01F5":"g","\u011D":"g","\u1E21":"g","\u011F":"g","\u0121":"g","\u01E7":"g","\u0123":"g","\u01E5":"g","\u0260":"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h","\uFF48":"h","\u0125":"h","\u1E23":"h","\u1E27":"h","\u021F":"h","\u1E25":"h","\u1E29":"h","\u1E2B":"h","\u1E96":"h","\u0127":"h","\u2C68":"h","\u2C76":"h","\u0265":"h","\u0195":"hv","\u24D8":"i","\uFF49":"i","\u00EC":"i","\u00ED":"i","\u00EE":"i","\u0129":"i","\u012B":"i","\u012D":"i","\u00EF":"i","\u1E2F":"i","\u1EC9":"i","\u01D0":"i","\u0209":"i","\u020B":"i","\u1ECB":"i","\u012F":"i","\u1E2D":"i","\u0268":"i","\u0131":"i","\u24D9":"j","\uFF4A":"j","\u0135":"j","\u01F0":"j","\u0249":"j","\u24DA":"k","\uFF4B":"k","\u1E31":"k","\u01E9":"k","\u1E33":"k","\u0137":"k","\u1E35":"k","\u0199":"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l","\uFF4C":"l","\u0140":"l","\u013A":"l","\u013E":"l","\u1E37":"l","\u1E39":"l","\u013C":"l","\u1E3D":"l","\u1E3B":"l","\u017F":"l","\u0142":"l","\u019A":"l","\u026B":"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l","\u01C9":"lj","\u24DC":"m","\uFF4D":"m","\u1E3F":"m","\u1E41":"m","\u1E43":"m","\u0271":"m","\u026F":"m","\u24DD":"n","\uFF4E":"n","\u01F9":"n","\u0144":"n","\u00F1":"n","\u1E45":"n","\u0148":"n","\u1E47":"n","\u0146":"n","\u1E4B":"n","\u1E49":"n","\u019E":"n","\u0272":"n","\u0149":"n","\uA791":"n","\uA7A5":"n","\u01CC":"nj","\u24DE":"o","\uFF4F":"o","\u00F2":"o","\u00F3":"o","\u00F4":"o","\u1ED3":"o","\u1ED1":"o","\u1ED7":"o","\u1ED5":"o","\u00F5":"o","\u1E4D":"o","\u022D":"o","\u1E4F":"o","\u014D":"o","\u1E51":"o","\u1E53":"o","\u014F":"o","\u022F":"o","\u0231":"o","\u00F6":"o","\u022B":"o","\u1ECF":"o","\u0151":"o","\u01D2":"o","\u020D":"o","\u020F":"o","\u01A1":"o","\u1EDD":"o","\u1EDB":"o","\u1EE1":"o","\u1EDF":"o","\u1EE3":"o","\u1ECD":"o","\u1ED9":"o","\u01EB":"o","\u01ED":"o","\u00F8":"o","\u01FF":"o","\u0254":"o","\uA74B":"o","\uA74D":"o","\u0275":"o","\u01A3":"oi","\u0223":"ou","\uA74F":"oo","\u24DF":"p","\uFF50":"p","\u1E55":"p","\u1E57":"p","\u01A5":"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q","\uFF51":"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r","\uFF52":"r","\u0155":"r","\u1E59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1E5B":"r","\u1E5D":"r","\u0157":"r","\u1E5F":"r","\u024D":"r","\u027D":"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s","\uFF53":"s","\u00DF":"s","\u015B":"s","\u1E65":"s","\u015D":"s","\u1E61":"s","\u0161":"s","\u1E67":"s","\u1E63":"s","\u1E69":"s","\u0219":"s","\u015F":"s","\u023F":"s","\uA7A9":"s","\uA785":"s","\u1E9B":"s","\u24E3":"t","\uFF54":"t","\u1E6B":"t","\u1E97":"t","\u0165":"t","\u1E6D":"t","\u021B":"t","\u0163":"t","\u1E71":"t","\u1E6F":"t","\u0167":"t","\u01AD":"t","\u0288":"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u","\uFF55":"u","\u00F9":"u","\u00FA":"u","\u00FB":"u","\u0169":"u","\u1E79":"u","\u016B":"u","\u1E7B":"u","\u016D":"u","\u00FC":"u","\u01DC":"u","\u01D8":"u","\u01D6":"u","\u01DA":"u","\u1EE7":"u","\u016F":"u","\u0171":"u","\u01D4":"u","\u0215":"u","\u0217":"u","\u01B0":"u","\u1EEB":"u","\u1EE9":"u","\u1EEF":"u","\u1EED":"u","\u1EF1":"u","\u1EE5":"u","\u1E73":"u","\u0173":"u","\u1E77":"u","\u1E75":"u","\u0289":"u","\u24E5":"v","\uFF56":"v","\u1E7D":"v","\u1E7F":"v","\u028B":"v","\uA75F":"v","\u028C":"v","\uA761":"vy","\u24E6":"w","\uFF57":"w","\u1E81":"w","\u1E83":"w","\u0175":"w","\u1E87":"w","\u1E85":"w","\u1E98":"w","\u1E89":"w","\u2C73":"w","\u24E7":"x","\uFF58":"x","\u1E8B":"x","\u1E8D":"x","\u24E8":"y","\uFF59":"y","\u1EF3":"y","\u00FD":"y","\u0177":"y","\u1EF9":"y","\u0233":"y","\u1E8F":"y","\u00FF":"y","\u1EF7":"y","\u1E99":"y","\u1EF5":"y","\u01B4":"y","\u024F":"y","\u1EFF":"y","\u24E9":"z","\uFF5A":"z","\u017A":"z","\u1E91":"z","\u017C":"z","\u017E":"z","\u1E93":"z","\u1E95":"z","\u01B6":"z","\u0225":"z","\u0240":"z","\u2C6C":"z","\uA763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038A":"\u0399","\u03AA":"\u0399","\u038C":"\u039F","\u038E":"\u03A5","\u03AB":"\u03A5","\u038F":"\u03A9","\u03AC":"\u03B1","\u03AD":"\u03B5","\u03AE":"\u03B7","\u03AF":"\u03B9","\u03CA":"\u03B9","\u0390":"\u03B9","\u03CC":"\u03BF","\u03CD":"\u03C5","\u03CB":"\u03C5","\u03B0":"\u03C5","\u03C9":"\u03C9","\u03C2":"\u03C3"};return diacritics;});S2.define("select2/data/base",["../utils"],function(Utils){function BaseAdapter($element,options){BaseAdapter.__super__.constructor.call(this);}Utils.Extend(BaseAdapter,Utils.Observable);BaseAdapter.prototype.current=function(callback){throw new Error("The `current` method must be defined in child classes.");};BaseAdapter.prototype.query=function(params,callback){throw new Error("The `query` method must be defined in child classes.");};BaseAdapter.prototype.bind=function(container,$container){};BaseAdapter.prototype.destroy=function(){};BaseAdapter.prototype.generateResultId=function(container,data){var id=container.id+"-result-";id+=Utils.generateChars(4);if(data.id!=null){id+="-"+data.id.toString();}else{id+="-"+Utils.generateChars(4);}return id;};return BaseAdapter;});S2.define("select2/data/select",["./base","../utils","jquery"],function(BaseAdapter,Utils,$){function SelectAdapter($element,options){this.$element=$element;this.options=options;SelectAdapter.__super__.constructor.call(this);}Utils.Extend(SelectAdapter,BaseAdapter);SelectAdapter.prototype.current=function(callback){var data=[];var self=this;this.$element.find(":selected").each(function(){var $option=$(this);var option=self.item($option);data.push(option);});callback(data);};SelectAdapter.prototype.select=function(data){var self=this;data.selected=true;if($(data.element).is("option")){data.element.selected=true;this.$element.trigger("change");return;}if(this.$element.prop("multiple")){this.current(function(currentData){var val=[];data=[data];data.push.apply(data,currentData);for(var d=0;d<data.length;d++){var id=data[d].id;if($.inArray(id,val)===-1){val.push(id);}}self.$element.val(val);self.$element.trigger("change");});}else{var val=data.id;this.$element.val(val);this.$element.trigger("change");}};SelectAdapter.prototype.unselect=function(data){var self=this;if(!this.$element.prop("multiple")){return;}data.selected=false;if($(data.element).is("option")){data.element.selected=false;this.$element.trigger("change");return;}this.current(function(currentData){var val=[];for(var d=0;d<currentData.length;d++){var id=currentData[d].id;if(id!==data.id&&$.inArray(id,val)===-1){val.push(id);}}self.$element.val(val);self.$element.trigger("change");});};SelectAdapter.prototype.bind=function(container,$container){var self=this;this.container=container;container.on("select",function(params){self.select(params.data);});container.on("unselect",function(params){self.unselect(params.data);});};SelectAdapter.prototype.destroy=function(){this.$element.find("*").each(function(){$.removeData(this,"data");});};SelectAdapter.prototype.query=function(params,callback){var data=[];var self=this;var $options=this.$element.children();$options.each(function(){var $option=$(this);if(!$option.is("option")&&!$option.is("optgroup")){return;}var option=self.item($option);var matches=self.matches(params,option);if(matches!==null){data.push(matches);}});callback({results:data});};SelectAdapter.prototype.addOptions=function($options){Utils.appendMany(this.$element,$options);};SelectAdapter.prototype.option=function(data){var option;if(data.children){option=document.createElement("optgroup");option.label=data.text;}else{option=document.createElement("option");if(option.textContent!==undefined){option.textContent=data.text;}else{option.innerText=data.text;}}if(data.id!==undefined){option.value=data.id;}if(data.disabled){option.disabled=true;}if(data.selected){option.selected=true;}if(data.title){option.title=data.title;}var $option=$(option);var normalizedData=this._normalizeItem(data);normalizedData.element=option;$.data(option,"data",normalizedData);return $option;};SelectAdapter.prototype.item=function($option){var data={};data=$.data($option[0],"data");if(data!=null){return data;}if($option.is("option")){data={id:$option.val(),text:$option.text(),disabled:$option.prop("disabled"),selected:$option.prop("selected"),title:$option.prop("title")};}else{if($option.is("optgroup")){data={text:$option.prop("label"),children:[],title:$option.prop("title")};var $children=$option.children("option");var children=[];for(var c=0;c<$children.length;c++){var $child=$($children[c]);var child=this.item($child);children.push(child);}data.children=children;}}data=this._normalizeItem(data);data.element=$option[0];$.data($option[0],"data",data);return data;};SelectAdapter.prototype._normalizeItem=function(item){if(!$.isPlainObject(item)){item={id:item,text:item};}item=$.extend({},{text:""},item);var defaults={selected:false,disabled:false};if(item.id!=null){item.id=item.id.toString();}if(item.text!=null){item.text=item.text.toString();}if(item._resultId==null&&item.id&&this.container!=null){item._resultId=this.generateResultId(this.container,item);}return $.extend({},defaults,item);};SelectAdapter.prototype.matches=function(params,data){var matcher=this.options.get("matcher");return matcher(params,data);};return SelectAdapter;});S2.define("select2/data/array",["./select","../utils","jquery"],function(SelectAdapter,Utils,$){function ArrayAdapter($element,options){var data=options.get("data")||[];ArrayAdapter.__super__.constructor.call(this,$element,options);this.addOptions(this.convertToOptions(data));}Utils.Extend(ArrayAdapter,SelectAdapter);ArrayAdapter.prototype.select=function(data){var $option=this.$element.find("option").filter(function(i,elm){return elm.value==data.id.toString();});if($option.length===0){$option=this.option(data);this.addOptions($option);}ArrayAdapter.__super__.select.call(this,data);};ArrayAdapter.prototype.convertToOptions=function(data){var self=this;var $existing=this.$element.find("option");var existingIds=$existing.map(function(){return self.item($(this)).id;}).get();var $options=[];function onlyItem(item){return function(){return $(this).val()==item.id;};}for(var d=0;d<data.length;d++){var item=this._normalizeItem(data[d]);if($.inArray(item.id,existingIds)>=0){var $existingOption=$existing.filter(onlyItem(item));var existingData=this.item($existingOption);var newData=$.extend(true,{},item,existingData);var $newOption=this.option(newData);$existingOption.replaceWith($newOption);continue;}var $option=this.option(item);if(item.children){var $children=this.convertToOptions(item.children);Utils.appendMany($option,$children);}$options.push($option);}return $options;};return ArrayAdapter;});S2.define("select2/data/ajax",["./array","../utils","jquery"],function(ArrayAdapter,Utils,$){function AjaxAdapter($element,options){this.ajaxOptions=this._applyDefaults(options.get("ajax"));if(this.ajaxOptions.processResults!=null){this.processResults=this.ajaxOptions.processResults;}AjaxAdapter.__super__.constructor.call(this,$element,options);}Utils.Extend(AjaxAdapter,ArrayAdapter);AjaxAdapter.prototype._applyDefaults=function(options){var defaults={data:function(params){return $.extend({},params,{q:params.term});},transport:function(params,success,failure){var $request=$.ajax(params);$request.then(success);$request.fail(failure);return $request;}};return $.extend({},defaults,options,true);};AjaxAdapter.prototype.processResults=function(results){return results;};AjaxAdapter.prototype.query=function(params,callback){var matches=[];var self=this;if(this._request!=null){if($.isFunction(this._request.abort)){this._request.abort();}this._request=null;}var options=$.extend({type:"GET"},this.ajaxOptions);if(typeof options.url==="function"){options.url=options.url.call(this.$element,params);}if(typeof options.data==="function"){options.data=options.data.call(this.$element,params);}function request(){var $request=options.transport(options,function(data){var results=self.processResults(data,params);if(self.options.get("debug")&&window.console&&console.error){if(!results||!results.results||!$.isArray(results.results)){console.error("Select2: The AJAX results did not return an array in the "+"`results` key of the response.");}}callback(results);},function(){if($request.status&&$request.status==="0"){return;}self.trigger("results:message",{message:"errorLoading"});});self._request=$request;}if(this.ajaxOptions.delay&&params.term!=null){if(this._queryTimeout){window.clearTimeout(this._queryTimeout);}this._queryTimeout=window.setTimeout(request,this.ajaxOptions.delay);}else{request();}};return AjaxAdapter;});S2.define("select2/data/tags",["jquery"],function($){function Tags(decorated,$element,options){var tags=options.get("tags");var createTag=options.get("createTag");if(createTag!==undefined){this.createTag=createTag;}var insertTag=options.get("insertTag");if(insertTag!==undefined){this.insertTag=insertTag;}decorated.call(this,$element,options);if($.isArray(tags)){for(var t=0;t<tags.length;t++){var tag=tags[t];var item=this._normalizeItem(tag);var $option=this.option(item);this.$element.append($option);}}}Tags.prototype.query=function(decorated,params,callback){var self=this;this._removeOldTags();if(params.term==null||params.page!=null){decorated.call(this,params,callback);return;}function wrapper(obj,child){var data=obj.results;for(var i=0;i<data.length;i++){var option=data[i];var checkChildren=(option.children!=null&&!wrapper({results:option.children},true));var optionText=(option.text||"").toUpperCase();var paramsTerm=(params.term||"").toUpperCase();var checkText=optionText===paramsTerm;if(checkText||checkChildren){if(child){return false;}obj.data=data;callback(obj);return;}}if(child){return true;}var tag=self.createTag(params);if(tag!=null){var $option=self.option(tag);$option.attr("data-select2-tag",true);self.addOptions([$option]);self.insertTag(data,tag);}obj.results=data;callback(obj);}decorated.call(this,params,wrapper);};Tags.prototype.createTag=function(decorated,params){var term=$.trim(params.term);if(term===""){return null;}return{id:term,text:term};};Tags.prototype.insertTag=function(_,data,tag){data.unshift(tag);};Tags.prototype._removeOldTags=function(_){var tag=this._lastTag;var $options=this.$element.find("option[data-select2-tag]");$options.each(function(){if(this.selected){return;}$(this).remove();});};return Tags;});S2.define("select2/data/tokenizer",["jquery"],function($){function Tokenizer(decorated,$element,options){var tokenizer=options.get("tokenizer");if(tokenizer!==undefined){this.tokenizer=tokenizer;}decorated.call(this,$element,options);}Tokenizer.prototype.bind=function(decorated,container,$container){decorated.call(this,container,$container);this.$search=container.dropdown.$search||container.selection.$search||$container.find(".select2-search__field");};Tokenizer.prototype.query=function(decorated,params,callback){var self=this;function createAndSelect(data){var item=self._normalizeItem(data);var $existingOptions=self.$element.find("option").filter(function(){return $(this).val()===item.id;});if(!$existingOptions.length){var $option=self.option(item);$option.attr("data-select2-tag",true);self._removeOldTags();self.addOptions([$option]);}select(item);}function select(data){self.trigger("select",{data:data});}params.term=params.term||"";var tokenData=this.tokenizer(params,this.options,createAndSelect);if(tokenData.term!==params.term){if(this.$search.length){this.$search.val(tokenData.term);this.$search.focus();}params.term=tokenData.term;}decorated.call(this,params,callback);};Tokenizer.prototype.tokenizer=function(_,params,options,callback){var separators=options.get("tokenSeparators")||[];var term=params.term;var i=0;var createTag=this.createTag||function(params){return{id:params.term,text:params.term};};while(i<term.length){var termChar=term[i];if($.inArray(termChar,separators)===-1){i++;continue;}var part=term.substr(0,i);var partParams=$.extend({},params,{term:part});var data=createTag(partParams);if(data==null){i++;continue;}callback(data);term=term.substr(i+1)||"";i=0;}return{term:term};};return Tokenizer;});S2.define("select2/data/minimumInputLength",[],function(){function MinimumInputLength(decorated,$e,options){this.minimumInputLength=options.get("minimumInputLength");decorated.call(this,$e,options);}MinimumInputLength.prototype.query=function(decorated,params,callback){params.term=params.term||"";if(params.term.length<this.minimumInputLength){this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:params.term,params:params}});return;}decorated.call(this,params,callback);};return MinimumInputLength;});S2.define("select2/data/maximumInputLength",[],function(){function MaximumInputLength(decorated,$e,options){this.maximumInputLength=options.get("maximumInputLength");decorated.call(this,$e,options);}MaximumInputLength.prototype.query=function(decorated,params,callback){params.term=params.term||"";if(this.maximumInputLength>0&&params.term.length>this.maximumInputLength){this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:params.term,params:params}});return;}decorated.call(this,params,callback);};return MaximumInputLength;});S2.define("select2/data/maximumSelectionLength",[],function(){function MaximumSelectionLength(decorated,$e,options){this.maximumSelectionLength=options.get("maximumSelectionLength");decorated.call(this,$e,options);}MaximumSelectionLength.prototype.query=function(decorated,params,callback){var self=this;this.current(function(currentData){var count=currentData!=null?currentData.length:0;if(self.maximumSelectionLength>0&&count>=self.maximumSelectionLength){self.trigger("results:message",{message:"maximumSelected",args:{maximum:self.maximumSelectionLength}});return;}decorated.call(self,params,callback);});};return MaximumSelectionLength;});S2.define("select2/dropdown",["jquery","./utils"],function($,Utils){function Dropdown($element,options){this.$element=$element;this.options=options;Dropdown.__super__.constructor.call(this);}Utils.Extend(Dropdown,Utils.Observable);Dropdown.prototype.render=function(){var $dropdown=$('<span class="select2-dropdown">'+'<span class="select2-results"></span>'+"</span>");$dropdown.attr("dir",this.options.get("dir"));this.$dropdown=$dropdown;return $dropdown;};Dropdown.prototype.bind=function(){};Dropdown.prototype.position=function($dropdown,$container){};Dropdown.prototype.destroy=function(){this.$dropdown.remove();};return Dropdown;});S2.define("select2/dropdown/search",["jquery","../utils"],function($,Utils){function Search(){}Search.prototype.render=function(decorated){var $rendered=decorated.call(this);var $search=$('<span class="select2-search select2-search--dropdown">'+'<input class="select2-search__field" type="search" tabindex="-1"'+' autocomplete="off" autocorrect="off" autocapitalize="none"'+' spellcheck="false" role="textbox" />'+"</span>");this.$searchContainer=$search;this.$search=$search.find("input");$rendered.prepend($search);return $rendered;};Search.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);this.$search.on("keydown",function(evt){self.trigger("keypress",evt);self._keyUpPrevented=evt.isDefaultPrevented();});this.$search.on("input",function(evt){$(this).off("keyup");});this.$search.on("keyup input",function(evt){self.handleSearch(evt);});container.on("open",function(){self.$search.attr("tabindex",0);self.$search.focus();window.setTimeout(function(){self.$search.focus();},0);});container.on("close",function(){self.$search.attr("tabindex",-1);self.$search.val("");});container.on("focus",function(){if(!container.isOpen()){self.$search.focus();}});container.on("results:all",function(params){if(params.query.term==null||params.query.term===""){var showSearch=self.showSearch(params);if(showSearch){self.$searchContainer.removeClass("select2-search--hide");}else{self.$searchContainer.addClass("select2-search--hide");}}});};Search.prototype.handleSearch=function(evt){if(!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input});}this._keyUpPrevented=false;};Search.prototype.showSearch=function(_,params){return true;};return Search;});S2.define("select2/dropdown/hidePlaceholder",[],function(){function HidePlaceholder(decorated,$element,options,dataAdapter){this.placeholder=this.normalizePlaceholder(options.get("placeholder"));decorated.call(this,$element,options,dataAdapter);}HidePlaceholder.prototype.append=function(decorated,data){data.results=this.removePlaceholder(data.results);decorated.call(this,data);};HidePlaceholder.prototype.normalizePlaceholder=function(_,placeholder){if(typeof placeholder==="string"){placeholder={id:"",text:placeholder};}return placeholder;};HidePlaceholder.prototype.removePlaceholder=function(_,data){var modifiedData=data.slice(0);for(var d=data.length-1;d>=0;d--){var item=data[d];if(this.placeholder.id===item.id){modifiedData.splice(d,1);}}return modifiedData;};return HidePlaceholder;});S2.define("select2/dropdown/infiniteScroll",["jquery"],function($){function InfiniteScroll(decorated,$element,options,dataAdapter){this.lastParams={};decorated.call(this,$element,options,dataAdapter);this.$loadingMore=this.createLoadingMore();this.loading=false;}InfiniteScroll.prototype.append=function(decorated,data){this.$loadingMore.remove();this.loading=false;decorated.call(this,data);if(this.showLoadingMore(data)){this.$results.append(this.$loadingMore);}};InfiniteScroll.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("query",function(params){self.lastParams=params;self.loading=true;});container.on("query:append",function(params){self.lastParams=params;self.loading=true;});this.$results.on("scroll",function(){var isLoadMoreVisible=$.contains(document.documentElement,self.$loadingMore[0]);if(self.loading||!isLoadMoreVisible){return;}var currentOffset=self.$results.offset().top+self.$results.outerHeight(false);var loadingMoreOffset=self.$loadingMore.offset().top+self.$loadingMore.outerHeight(false);if(currentOffset+50>=loadingMoreOffset){self.loadMore();}});};InfiniteScroll.prototype.loadMore=function(){this.loading=true;var params=$.extend({},{page:1},this.lastParams);params.page++;this.trigger("query:append",params);};InfiniteScroll.prototype.showLoadingMore=function(_,data){return data.pagination&&data.pagination.more;};InfiniteScroll.prototype.createLoadingMore=function(){var $option=$("<li "+'class="select2-results__option select2-results__option--load-more"'+'role="treeitem" aria-disabled="true"></li>');var message=this.options.get("translations").get("loadingMore");$option.html(message(this.lastParams));return $option;};return InfiniteScroll;});S2.define("select2/dropdown/attachBody",["jquery","../utils"],function($,Utils){function AttachBody(decorated,$element,options){this.$dropdownParent=options.get("dropdownParent")||$(document.body);decorated.call(this,$element,options);}AttachBody.prototype.bind=function(decorated,container,$container){var self=this;var setupResultsEvents=false;decorated.call(this,container,$container);container.on("open",function(){self._showDropdown();self._attachPositioningHandler(container);if(!setupResultsEvents){setupResultsEvents=true;container.on("results:all",function(){self._positionDropdown();self._resizeDropdown();});container.on("results:append",function(){self._positionDropdown();self._resizeDropdown();});}});container.on("close",function(){self._hideDropdown();self._detachPositioningHandler(container);});this.$dropdownContainer.on("mousedown",function(evt){evt.stopPropagation();});};AttachBody.prototype.destroy=function(decorated){decorated.call(this);this.$dropdownContainer.remove();};AttachBody.prototype.position=function(decorated,$dropdown,$container){$dropdown.attr("class",$container.attr("class"));$dropdown.removeClass("select2");$dropdown.addClass("select2-container--open");$dropdown.css({position:"absolute",top:-999999});this.$container=$container;};AttachBody.prototype.render=function(decorated){var $container=$("<span></span>");var $dropdown=decorated.call(this);$container.append($dropdown);this.$dropdownContainer=$container;return $container;};AttachBody.prototype._hideDropdown=function(decorated){this.$dropdownContainer.detach();};AttachBody.prototype._attachPositioningHandler=function(decorated,container){var self=this;var scrollEvent="scroll.select2."+container.id;var resizeEvent="resize.select2."+container.id;var orientationEvent="orientationchange.select2."+container.id;var $watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.each(function(){$(this).data("select2-scroll-position",{x:$(this).scrollLeft(),y:$(this).scrollTop()});});$watchers.on(scrollEvent,function(ev){var position=$(this).data("select2-scroll-position");$(this).scrollTop(position.y);});$(window).on(scrollEvent+" "+resizeEvent+" "+orientationEvent,function(e){self._positionDropdown();self._resizeDropdown();});};AttachBody.prototype._detachPositioningHandler=function(decorated,container){var scrollEvent="scroll.select2."+container.id;var resizeEvent="resize.select2."+container.id;var orientationEvent="orientationchange.select2."+container.id;var $watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.off(scrollEvent);$(window).off(scrollEvent+" "+resizeEvent+" "+orientationEvent);};AttachBody.prototype._positionDropdown=function(){var $window=$(window);var isCurrentlyAbove=this.$dropdown.hasClass("select2-dropdown--above");var isCurrentlyBelow=this.$dropdown.hasClass("select2-dropdown--below");var newDirection=null;var offset=this.$container.offset();offset.bottom=offset.top+this.$container.outerHeight(false);var container={height:this.$container.outerHeight(false)};container.top=offset.top;container.bottom=offset.top+container.height;var dropdown={height:this.$dropdown.outerHeight(false)};var viewport={top:$window.scrollTop(),bottom:$window.scrollTop()+$window.height()};var enoughRoomAbove=viewport.top<(offset.top-dropdown.height);var enoughRoomBelow=viewport.bottom>(offset.bottom+dropdown.height);var css={left:offset.left,top:container.bottom};var $offsetParent=this.$dropdownParent;if($offsetParent.css("position")==="static"){$offsetParent=$offsetParent.offsetParent();}var parentOffset=$offsetParent.offset();css.top-=parentOffset.top;css.left-=parentOffset.left;if(!isCurrentlyAbove&&!isCurrentlyBelow){newDirection="below";}if(!enoughRoomBelow&&enoughRoomAbove&&!isCurrentlyAbove){newDirection="above";}else{if(!enoughRoomAbove&&enoughRoomBelow&&isCurrentlyAbove){newDirection="below";}}if(newDirection=="above"||(isCurrentlyAbove&&newDirection!=="below")){css.top=container.top-parentOffset.top-dropdown.height;}if(newDirection!=null){this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+newDirection);this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+newDirection);}this.$dropdownContainer.css(css);};AttachBody.prototype._resizeDropdown=function(){var css={width:this.$container.outerWidth(false)+"px"};if(this.options.get("dropdownAutoWidth")){css.minWidth=css.width;css.position="relative";css.width="auto";}this.$dropdown.css(css);};AttachBody.prototype._showDropdown=function(decorated){this.$dropdownContainer.appendTo(this.$dropdownParent);this._positionDropdown();this._resizeDropdown();};return AttachBody;});S2.define("select2/dropdown/minimumResultsForSearch",[],function(){function countResults(data){var count=0;for(var d=0;d<data.length;d++){var item=data[d];if(item.children){count+=countResults(item.children);}else{count++;}}return count;}function MinimumResultsForSearch(decorated,$element,options,dataAdapter){this.minimumResultsForSearch=options.get("minimumResultsForSearch");if(this.minimumResultsForSearch<0){this.minimumResultsForSearch=Infinity;}decorated.call(this,$element,options,dataAdapter);}MinimumResultsForSearch.prototype.showSearch=function(decorated,params){if(countResults(params.data.results)<this.minimumResultsForSearch){return false;}return decorated.call(this,params);};return MinimumResultsForSearch;});S2.define("select2/dropdown/selectOnClose",[],function(){function SelectOnClose(){}SelectOnClose.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("close",function(params){self._handleSelectOnClose(params);});};SelectOnClose.prototype._handleSelectOnClose=function(_,params){if(params&&params.originalSelect2Event!=null){var event=params.originalSelect2Event;if(event._type==="select"||event._type==="unselect"){return;}}var $highlightedResults=this.getHighlightedResults();if($highlightedResults.length<1){return;}var data=$highlightedResults.data("data");if((data.element!=null&&data.element.selected)||(data.element==null&&data.selected)){return;}this.trigger("select",{data:data});};return SelectOnClose;});S2.define("select2/dropdown/closeOnSelect",[],function(){function CloseOnSelect(){}CloseOnSelect.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container);container.on("select",function(evt){self._selectTriggered(evt);});container.on("unselect",function(evt){self._selectTriggered(evt);});};CloseOnSelect.prototype._selectTriggered=function(_,evt){var originalEvent=evt.originalEvent;if(originalEvent&&originalEvent.ctrlKey){return;}this.trigger("close",{originalEvent:originalEvent,originalSelect2Event:evt});};return CloseOnSelect;});S2.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded.";},inputTooLong:function(args){var overChars=args.input.length-args.maximum;var message="Please delete "+overChars+" character";if(overChars!=1){message+="s";}return message;},inputTooShort:function(args){var remainingChars=args.minimum-args.input.length;var message="Please enter "+remainingChars+" or more characters";return message;},loadingMore:function(){return"Loading more results…";},maximumSelected:function(args){var message="You can only select "+args.maximum+" item";if(args.maximum!=1){message+="s";}return message;},noResults:function(){return"No results found";},searching:function(){return"Searching…";}};});S2.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function($,require,ResultsList,SingleSelection,MultipleSelection,Placeholder,AllowClear,SelectionSearch,EventRelay,Utils,Translation,DIACRITICS,SelectData,ArrayData,AjaxData,Tags,Tokenizer,MinimumInputLength,MaximumInputLength,MaximumSelectionLength,Dropdown,DropdownSearch,HidePlaceholder,InfiniteScroll,AttachBody,MinimumResultsForSearch,SelectOnClose,CloseOnSelect,EnglishTranslation){function Defaults(){this.reset();}Defaults.prototype.apply=function(options){options=$.extend(true,{},this.defaults,options);if(options.dataAdapter==null){if(options.ajax!=null){options.dataAdapter=AjaxData;}else{if(options.data!=null){options.dataAdapter=ArrayData;}else{options.dataAdapter=SelectData;}}if(options.minimumInputLength>0){options.dataAdapter=Utils.Decorate(options.dataAdapter,MinimumInputLength);}if(options.maximumInputLength>0){options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumInputLength);}if(options.maximumSelectionLength>0){options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumSelectionLength);}if(options.tags){options.dataAdapter=Utils.Decorate(options.dataAdapter,Tags);}if(options.tokenSeparators!=null||options.tokenizer!=null){options.dataAdapter=Utils.Decorate(options.dataAdapter,Tokenizer);}if(options.query!=null){var Query=require(options.amdBase+"compat/query");options.dataAdapter=Utils.Decorate(options.dataAdapter,Query);}if(options.initSelection!=null){var InitSelection=require(options.amdBase+"compat/initSelection");options.dataAdapter=Utils.Decorate(options.dataAdapter,InitSelection);}}if(options.resultsAdapter==null){options.resultsAdapter=ResultsList;if(options.ajax!=null){options.resultsAdapter=Utils.Decorate(options.resultsAdapter,InfiniteScroll);}if(options.placeholder!=null){options.resultsAdapter=Utils.Decorate(options.resultsAdapter,HidePlaceholder);}if(options.selectOnClose){options.resultsAdapter=Utils.Decorate(options.resultsAdapter,SelectOnClose);}}if(options.dropdownAdapter==null){if(options.multiple){options.dropdownAdapter=Dropdown;}else{var SearchableDropdown=Utils.Decorate(Dropdown,DropdownSearch);options.dropdownAdapter=SearchableDropdown;}if(options.minimumResultsForSearch!==0){options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,MinimumResultsForSearch);}if(options.closeOnSelect){options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,CloseOnSelect);}if(options.dropdownCssClass!=null||options.dropdownCss!=null||options.adaptDropdownCssClass!=null){var DropdownCSS=require(options.amdBase+"compat/dropdownCss");options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,DropdownCSS);}options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,AttachBody);}if(options.selectionAdapter==null){if(options.multiple){options.selectionAdapter=MultipleSelection;}else{options.selectionAdapter=SingleSelection;}if(options.placeholder!=null){options.selectionAdapter=Utils.Decorate(options.selectionAdapter,Placeholder);}if(options.allowClear){options.selectionAdapter=Utils.Decorate(options.selectionAdapter,AllowClear);}if(options.multiple){options.selectionAdapter=Utils.Decorate(options.selectionAdapter,SelectionSearch);}if(options.containerCssClass!=null||options.containerCss!=null||options.adaptContainerCssClass!=null){var ContainerCSS=require(options.amdBase+"compat/containerCss");options.selectionAdapter=Utils.Decorate(options.selectionAdapter,ContainerCSS);}options.selectionAdapter=Utils.Decorate(options.selectionAdapter,EventRelay);}if(typeof options.language==="string"){if(options.language.indexOf("-")>0){var languageParts=options.language.split("-");var baseLanguage=languageParts[0];options.language=[options.language,baseLanguage];}else{options.language=[options.language];}}if($.isArray(options.language)){var languages=new Translation();options.language.push("en");var languageNames=options.language;for(var l=0;l<languageNames.length;l++){var name=languageNames[l];var language={};try{language=Translation.loadPath(name);}catch(e){try{name=this.defaults.amdLanguageBase+name;language=Translation.loadPath(name);}catch(ex){if(options.debug&&window.console&&console.warn){console.warn('Select2: The language file for "'+name+'" could not be '+"automatically loaded. A fallback will be used instead.");}continue;}}languages.extend(language);}options.translations=languages;}else{var baseTranslation=Translation.loadPath(this.defaults.amdLanguageBase+"en");var customTranslation=new Translation(options.language);customTranslation.extend(baseTranslation);options.translations=customTranslation;}return options;};Defaults.prototype.reset=function(){function stripDiacritics(text){function match(a){return DIACRITICS[a]||a;}return text.replace(/[^\u0000-\u007E]/g,match);}function matcher(params,data){if($.trim(params.term)===""){return data;}if(data.children&&data.children.length>0){var match=$.extend(true,{},data);for(var c=data.children.length-1;c>=0;c--){var child=data.children[c];var matches=matcher(params,child);if(matches==null){match.children.splice(c,1);}}if(match.children.length>0){return match;}return matcher(params,match);}var original=stripDiacritics(data.text).toUpperCase();var term=stripDiacritics(params.term).toUpperCase();if(original.indexOf(term)>-1){return data;}return null;}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:true,debug:false,dropdownAutoWidth:false,escapeMarkup:Utils.escapeMarkup,language:EnglishTranslation,matcher:matcher,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:false,sorter:function(data){return data;},templateResult:function(result){return result.text;},templateSelection:function(selection){return selection.text;},theme:"default",width:"resolve"};};Defaults.prototype.set=function(key,value){var camelKey=$.camelCase(key);var data={};data[camelKey]=value;var convertedData=Utils._convertData(data);$.extend(this.defaults,convertedData);};var defaults=new Defaults();return defaults;});S2.define("select2/options",["require","jquery","./defaults","./utils"],function(require,$,Defaults,Utils){function Options(options,$element){this.options=options;if($element!=null){this.fromElement($element);}this.options=Defaults.apply(this.options);if($element&&$element.is("input")){var InputCompat=require(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=Utils.Decorate(this.options.dataAdapter,InputCompat);}}Options.prototype.fromElement=function($e){var excludedData=["select2"];if(this.options.multiple==null){this.options.multiple=$e.prop("multiple");}if(this.options.disabled==null){this.options.disabled=$e.prop("disabled");}if(this.options.language==null){if($e.prop("lang")){this.options.language=$e.prop("lang").toLowerCase();}else{if($e.closest("[lang]").prop("lang")){this.options.language=$e.closest("[lang]").prop("lang");}}}if(this.options.dir==null){if($e.prop("dir")){this.options.dir=$e.prop("dir");}else{if($e.closest("[dir]").prop("dir")){this.options.dir=$e.closest("[dir]").prop("dir");}else{this.options.dir="ltr";}}}$e.prop("disabled",this.options.disabled);$e.prop("multiple",this.options.multiple);if($e.data("select2Tags")){if(this.options.debug&&window.console&&console.warn){console.warn("Select2: The `data-select2-tags` attribute has been changed to "+'use the `data-data` and `data-tags="true"` attributes and will be '+"removed in future versions of Select2.");}$e.data("data",$e.data("select2Tags"));$e.data("tags",true);}if($e.data("ajaxUrl")){if(this.options.debug&&window.console&&console.warn){console.warn("Select2: The `data-ajax-url` attribute has been changed to "+"`data-ajax--url` and support for the old attribute will be removed"+" in future versions of Select2.");}$e.attr("ajax--url",$e.data("ajaxUrl"));$e.data("ajax--url",$e.data("ajaxUrl"));}var dataset={};if($.fn.jquery&&$.fn.jquery.substr(0,2)=="1."&&$e[0].dataset){dataset=$.extend(true,{},$e[0].dataset,$e.data());}else{dataset=$e.data();}var data=$.extend(true,{},dataset);data=Utils._convertData(data);for(var key in data){if($.inArray(key,excludedData)>-1){continue;}if($.isPlainObject(this.options[key])){$.extend(this.options[key],data[key]);}else{this.options[key]=data[key];}}return this;};Options.prototype.get=function(key){return this.options[key];};Options.prototype.set=function(key,val){this.options[key]=val;};return Options;});S2.define("select2/core",["jquery","./options","./utils","./keys"],function($,Options,Utils,KEYS){var Select2=function($element,options){if($element.data("select2")!=null){$element.data("select2").destroy();}this.$element=$element;this.id=this._generateId($element);options=options||{};this.options=new Options(options,$element);Select2.__super__.constructor.call(this);var tabindex=$element.attr("tabindex")||0;$element.data("old-tabindex",tabindex);$element.attr("tabindex","-1");var DataAdapter=this.options.get("dataAdapter");this.dataAdapter=new DataAdapter($element,this.options);var $container=this.render();this._placeContainer($container);var SelectionAdapter=this.options.get("selectionAdapter");this.selection=new SelectionAdapter($element,this.options);this.$selection=this.selection.render();this.selection.position(this.$selection,$container);var DropdownAdapter=this.options.get("dropdownAdapter");this.dropdown=new DropdownAdapter($element,this.options);this.$dropdown=this.dropdown.render();this.dropdown.position(this.$dropdown,$container);var ResultsAdapter=this.options.get("resultsAdapter");this.results=new ResultsAdapter($element,this.options,this.dataAdapter);this.$results=this.results.render();this.results.position(this.$results,this.$dropdown);var self=this;this._bindAdapters();this._registerDomEvents();this._registerDataEvents();this._registerSelectionEvents();this._registerDropdownEvents();this._registerResultsEvents();this._registerEvents();this.dataAdapter.current(function(initialData){self.trigger("selection:update",{data:initialData});});$element.addClass("select2-hidden-accessible");$element.attr("aria-hidden","true");this._syncAttributes();$element.data("select2",this);};Utils.Extend(Select2,Utils.Observable);Select2.prototype._generateId=function($element){var id="";if($element.attr("id")!=null){id=$element.attr("id");}else{if($element.attr("name")!=null){id=$element.attr("name")+"-"+Utils.generateChars(2);}else{id=Utils.generateChars(4);}}id=id.replace(/(:|\.|\[|\]|,)/g,"");id="select2-"+id;return id;};Select2.prototype._placeContainer=function($container){$container.insertAfter(this.$element);var width=this._resolveWidth(this.$element,this.options.get("width"));if(width!=null){$container.css("width",width);}};Select2.prototype._resolveWidth=function($element,method){var WIDTH=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if(method=="resolve"){var styleWidth=this._resolveWidth($element,"style");if(styleWidth!=null){return styleWidth;}return this._resolveWidth($element,"element");}if(method=="element"){var elementWidth=$element.outerWidth(false);if(elementWidth<=0){return"auto";}return elementWidth+"px";}if(method=="style"){var style=$element.attr("style");if(typeof(style)!=="string"){return null;}var attrs=style.split(";");for(var i=0,l=attrs.length;i<l;i=i+1){var attr=attrs[i].replace(/\s/g,"");var matches=attr.match(WIDTH);if(matches!==null&&matches.length>=1){return matches[1];}}return null;}return method;};Select2.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container);this.selection.bind(this,this.$container);this.dropdown.bind(this,this.$container);this.results.bind(this,this.$container);};Select2.prototype._registerDomEvents=function(){var self=this;this.$element.on("change.select2",function(){self.dataAdapter.current(function(data){self.trigger("selection:update",{data:data});});});this.$element.on("focus.select2",function(evt){self.trigger("focus",evt);});this._syncA=Utils.bind(this._syncAttributes,this);this._syncS=Utils.bind(this._syncSubtree,this);if(this.$element[0].attachEvent){this.$element[0].attachEvent("onpropertychange",this._syncA);}var observer=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(observer!=null){this._observer=new observer(function(mutations){$.each(mutations,self._syncA);$.each(mutations,self._syncS);});this._observer.observe(this.$element[0],{attributes:true,childList:true,subtree:false});}else{if(this.$element[0].addEventListener){this.$element[0].addEventListener("DOMAttrModified",self._syncA,false);this.$element[0].addEventListener("DOMNodeInserted",self._syncS,false);this.$element[0].addEventListener("DOMNodeRemoved",self._syncS,false);}}};Select2.prototype._registerDataEvents=function(){var self=this;this.dataAdapter.on("*",function(name,params){self.trigger(name,params);});};Select2.prototype._registerSelectionEvents=function(){var self=this;var nonRelayEvents=["toggle","focus"];this.selection.on("toggle",function(){self.toggleDropdown();});this.selection.on("focus",function(params){self.focus(params);});this.selection.on("*",function(name,params){if($.inArray(name,nonRelayEvents)!==-1){return;}self.trigger(name,params);});};Select2.prototype._registerDropdownEvents=function(){var self=this;this.dropdown.on("*",function(name,params){self.trigger(name,params);});};Select2.prototype._registerResultsEvents=function(){var self=this;this.results.on("*",function(name,params){self.trigger(name,params);});};Select2.prototype._registerEvents=function(){var self=this;this.on("open",function(){self.$container.addClass("select2-container--open");});this.on("close",function(){self.$container.removeClass("select2-container--open");});this.on("enable",function(){self.$container.removeClass("select2-container--disabled");});this.on("disable",function(){self.$container.addClass("select2-container--disabled");});this.on("blur",function(){self.$container.removeClass("select2-container--focus");});this.on("query",function(params){if(!self.isOpen()){self.trigger("open",{});}this.dataAdapter.query(params,function(data){self.trigger("results:all",{data:data,query:params});});});this.on("query:append",function(params){this.dataAdapter.query(params,function(data){self.trigger("results:append",{data:data,query:params});});});this.on("keypress",function(evt){var key=evt.which;if(self.isOpen()){if(key===KEYS.ESC||key===KEYS.TAB||(key===KEYS.UP&&evt.altKey)){self.close();evt.preventDefault();}else{if(key===KEYS.ENTER){self.trigger("results:select",{});evt.preventDefault();}else{if((key===KEYS.SPACE&&evt.ctrlKey)){self.trigger("results:toggle",{});evt.preventDefault();}else{if(key===KEYS.UP){self.trigger("results:previous",{});evt.preventDefault();}else{if(key===KEYS.DOWN){self.trigger("results:next",{});evt.preventDefault();}}}}}}else{if(key===KEYS.ENTER||key===KEYS.SPACE||(key===KEYS.DOWN&&evt.altKey)){self.open();evt.preventDefault();}}});};Select2.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled"));if(this.options.get("disabled")){if(this.isOpen()){this.close();}this.trigger("disable",{});}else{this.trigger("enable",{});}};Select2.prototype._syncSubtree=function(evt,mutations){var changed=false;var self=this;if(evt&&evt.target&&(evt.target.nodeName!=="OPTION"&&evt.target.nodeName!=="OPTGROUP")){return;}if(!mutations){changed=true;}else{if(mutations.addedNodes&&mutations.addedNodes.length>0){for(var n=0;n<mutations.addedNodes.length;n++){var node=mutations.addedNodes[n];if(node.selected){changed=true;}}}else{if(mutations.removedNodes&&mutations.removedNodes.length>0){changed=true;}}}if(changed){this.dataAdapter.current(function(currentData){self.trigger("selection:update",{data:currentData});});}};Select2.prototype.trigger=function(name,args){var actualTrigger=Select2.__super__.trigger;var preTriggerMap={"open":"opening","close":"closing","select":"selecting","unselect":"unselecting"};if(args===undefined){args={};}if(name in preTriggerMap){var preTriggerName=preTriggerMap[name];var preTriggerArgs={prevented:false,name:name,args:args};actualTrigger.call(this,preTriggerName,preTriggerArgs);if(preTriggerArgs.prevented){args.prevented=true;return;}}actualTrigger.call(this,name,args);};Select2.prototype.toggleDropdown=function(){if(this.options.get("disabled")){return;}if(this.isOpen()){this.close();}else{this.open();}};Select2.prototype.open=function(){if(this.isOpen()){return;}this.trigger("query",{});};Select2.prototype.close=function(){if(!this.isOpen()){return;}this.trigger("close",{});};Select2.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open");};Select2.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus");};Select2.prototype.focus=function(data){if(this.hasFocus()){return;}this.$container.addClass("select2-container--focus");this.trigger("focus",{});};Select2.prototype.enable=function(args){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("enable")` method has been deprecated and will'+' be removed in later Select2 versions. Use $element.prop("disabled")'+" instead.");}if(args==null||args.length===0){args=[true];}var disabled=!args[0];this.$element.prop("disabled",disabled);};Select2.prototype.data=function(){if(this.options.get("debug")&&arguments.length>0&&window.console&&console.warn){console.warn('Select2: Data can no longer be set using `select2("data")`. You '+"should consider setting the value instead using `$element.val()`.");}var data=[];this.dataAdapter.current(function(currentData){data=currentData;});return data;};Select2.prototype.val=function(args){if(this.options.get("debug")&&window.console&&console.warn){console.warn('Select2: The `select2("val")` method has been deprecated and will be'+" removed in later Select2 versions. Use $element.val() instead.");}if(args==null||args.length===0){return this.$element.val();}var newVal=args[0];if($.isArray(newVal)){newVal=$.map(newVal,function(obj){return obj.toString();});}this.$element.val(newVal).trigger("change");};Select2.prototype.destroy=function(){this.$container.remove();if(this.$element[0].detachEvent){this.$element[0].detachEvent("onpropertychange",this._syncA);}if(this._observer!=null){this._observer.disconnect();this._observer=null;}else{if(this.$element[0].removeEventListener){this.$element[0].removeEventListener("DOMAttrModified",this._syncA,false);this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,false);this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,false);}}this._syncA=null;this._syncS=null;this.$element.off(".select2");this.$element.attr("tabindex",this.$element.data("old-tabindex"));this.$element.removeClass("select2-hidden-accessible");this.$element.attr("aria-hidden","false");this.$element.removeData("select2");this.dataAdapter.destroy();this.selection.destroy();this.dropdown.destroy();this.results.destroy();this.dataAdapter=null;this.selection=null;this.dropdown=null;this.results=null;};Select2.prototype.render=function(){var $container=$('<span class="select2 select2-container">'+'<span class="selection"></span>'+'<span class="dropdown-wrapper" aria-hidden="true"></span>'+"</span>");$container.attr("dir",this.options.get("dir"));this.$container=$container;this.$container.addClass("select2-container--"+this.options.get("theme"));$container.data("element",this.$element);return $container;};return Select2;});S2.define("jquery-mousewheel",["jquery"],function($){return $;});S2.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function($,_,Select2,Defaults){if($.fn.select2==null){var thisMethods=["open","close","destroy"];$.fn.select2=function(options){options=options||{};if(typeof options==="object"){this.each(function(){var instanceOptions=$.extend(true,{},options);var instance=new Select2($(this),instanceOptions);});return this;}else{if(typeof options==="string"){var ret;var args=Array.prototype.slice.call(arguments,1);this.each(function(){var instance=$(this).data("select2");if(instance==null&&window.console&&console.error){console.error("The select2('"+options+"') method was called on an "+"element that is not using Select2.");}ret=instance[options].apply(instance,args);});if($.inArray(options,thisMethods)>-1){return this;}return ret;}else{throw new Error("Invalid arguments for Select2: "+options);}}};}if($.fn.select2.defaults==null){$.fn.select2.defaults=Defaults;}return Select2;});return{define:S2.define,require:S2.require};}());var select2=S2.require("jquery.select2");jQuery.fn.select2.amd=S2;return select2;}));
   /* Ende select2 */
   /* Start select2.i18n.de */
   /*! Select2 4.0.5 | https://github.com/select2/select2/blob/master/LICENSE.md */
(function () {
  if( jQuery && jQuery.fn && jQuery.fn.select2 && jQuery.fn.select2.amd ) var e = jQuery.fn.select2.amd;
  return e.define("select2/i18n/de", [], function () {
    return {
      errorLoading: function () {
        return "Die Ergebnisse konnten nicht geladen werden."
      },
      inputTooLong: function (e) {
        var t = e.input.length-e.maximum;
        return "Bitte "+t+" Zeichen weniger eingeben"
      },
      inputTooShort: function (e) {
        var t = e.minimum-e.input.length;
        return "Bitte "+t+" Zeichen mehr eingeben"
      },
      loadingMore: function () {
        return "Lade mehr Ergebnisse…"
      },
      maximumSelected: function (e) {
        var t = "Sie können nur "+e.maximum+" Eintr";
        return e.maximum === 1 ? t += "ag" : t += "äge", t += " auswählen", t
      },
      noResults: function () {
        return "Keine Übereinstimmungen gefunden"
      },
      searching: function () {
        return "Suche…"
      }
    }
  }), {define: e.define, require: e.require}
})();
   /* Ende select2.i18n.de */
   /* Start datepicker */
   /*!
 * Datepicker v1.0.9
 * https://fengyuanchen.github.io/datepicker
 *
 * Copyright 2014-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2019-09-21T06:57:34.100Z
 */

(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(require('jquery')) :
  typeof define === 'function' && define.amd ? define(['jquery'], factory) :
  (global = global || self, factory(global.jQuery));
}(this, function ($) { 'use strict';

  $ = $ && $.hasOwnProperty('default') ? $['default'] : $;

  function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  function _defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties(Constructor, staticProps);
    return Constructor;
  }

  var DEFAULTS = {
    // Show the datepicker automatically when initialized
    autoShow: false,
    // Hide the datepicker automatically when picked
    autoHide: false,
    // Pick the initial date automatically when initialized
    autoPick: false,
    // Enable inline mode
    inline: false,
    // A element (or selector) for putting the datepicker
    container: null,
    // A element (or selector) for triggering the datepicker
    trigger: null,
    // The ISO language code (built-in: en-US)
    language: '',
    // The date string format
    format: 'mm/dd/yyyy',
    // The initial date
    date: null,
    // The start view date
    startDate: null,
    // The end view date
    endDate: null,
    // The start view when initialized
    startView: 0,
    // 0 for days, 1 for months, 2 for years
    // The start day of the week
    // 0 for Sunday, 1 for Monday, 2 for Tuesday, 3 for Wednesday,
    // 4 for Thursday, 5 for Friday, 6 for Saturday
    weekStart: 0,
    // Show year before month on the datepicker header
    yearFirst: false,
    // A string suffix to the year number.
    yearSuffix: '',
    // Days' name of the week.
    days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
    // Shorter days' name
    daysShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
    // Shortest days' name
    daysMin: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
    // Months' name
    months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
    // Shorter months' name
    monthsShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    // A element tag for each item of years, months and days
    itemTag: 'li',
    // A class (CSS) for muted date item
    mutedClass: 'muted',
    // A class (CSS) for picked date item
    pickedClass: 'picked',
    // A class (CSS) for disabled date item
    disabledClass: 'disabled',
    // A class (CSS) for highlight date item
    highlightedClass: 'highlighted',
    // The template of the datepicker
    template: '<div class="datepicker-container">' + '<div class="datepicker-panel" data-view="years picker">' + '<ul>' + '<li data-view="years prev">&lsaquo;</li>' + '<li data-view="years current"></li>' + '<li data-view="years next">&rsaquo;</li>' + '</ul>' + '<ul data-view="years"></ul>' + '</div>' + '<div class="datepicker-panel" data-view="months picker">' + '<ul>' + '<li data-view="year prev">&lsaquo;</li>' + '<li data-view="year current"></li>' + '<li data-view="year next">&rsaquo;</li>' + '</ul>' + '<ul data-view="months"></ul>' + '</div>' + '<div class="datepicker-panel" data-view="days picker">' + '<ul>' + '<li data-view="month prev">&lsaquo;</li>' + '<li data-view="month current"></li>' + '<li data-view="month next">&rsaquo;</li>' + '</ul>' + '<ul data-view="week"></ul>' + '<ul data-view="days"></ul>' + '</div>' + '</div>',
    // The offset top or bottom of the datepicker from the element
    offset: 10,
    // The `z-index` of the datepicker
    zIndex: 1000,
    // Filter each date item (return `false` to disable a date item)
    filter: null,
    // Event shortcuts
    show: null,
    hide: null,
    pick: null
  };

  var IS_BROWSER = typeof window !== 'undefined';
  var WINDOW = IS_BROWSER ? window : {};
  var IS_TOUCH_DEVICE = IS_BROWSER ? 'ontouchstart' in WINDOW.document.documentElement : false;
  var NAMESPACE = 'datepicker';
  var EVENT_CLICK = "click.".concat(NAMESPACE);
  var EVENT_FOCUS = "focus.".concat(NAMESPACE);
  var EVENT_HIDE = "hide.".concat(NAMESPACE);
  var EVENT_KEYUP = "keyup.".concat(NAMESPACE);
  var EVENT_PICK = "pick.".concat(NAMESPACE);
  var EVENT_RESIZE = "resize.".concat(NAMESPACE);
  var EVENT_SCROLL = "scroll.".concat(NAMESPACE);
  var EVENT_SHOW = "show.".concat(NAMESPACE);
  var EVENT_TOUCH_START = "touchstart.".concat(NAMESPACE);
  var CLASS_HIDE = "".concat(NAMESPACE, "-hide");
  var LANGUAGES = {};
  var VIEWS = {
    DAYS: 0,
    MONTHS: 1,
    YEARS: 2
  };

  var toString = Object.prototype.toString;
  function typeOf(obj) {
    return toString.call(obj).slice(8, -1).toLowerCase();
  }
  function isString(value) {
    return typeof value === 'string';
  }
  var isNaN = Number.isNaN || WINDOW.isNaN;
  function isNumber(value) {
    return typeof value === 'number' && !isNaN(value);
  }
  function isUndefined(value) {
    return typeof value === 'undefined';
  }
  function isDate(value) {
    return typeOf(value) === 'date' && !isNaN(value.getTime());
  }
  function proxy(fn, context) {
    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {
      args[_key - 2] = arguments[_key];
    }

    return function () {
      for (var _len2 = arguments.length, args2 = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args2[_key2] = arguments[_key2];
      }

      return fn.apply(context, args.concat(args2));
    };
  }
  function selectorOf(view) {
    return "[data-view=\"".concat(view, "\"]");
  }
  function isLeapYear(year) {
    return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
  }
  function getDaysInMonth(year, month) {
    return [31, isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];
  }
  function getMinDay(year, month, day) {
    return Math.min(day, getDaysInMonth(year, month));
  }
  var formatParts = /(y|m|d)+/g;
  function parseFormat(format) {
    var source = String(format).toLowerCase();
    var parts = source.match(formatParts);

    if (!parts || parts.length === 0) {
      throw new Error('Invalid date format.');
    }

    format = {
      source: source,
      parts: parts
    };
    $.each(parts, function (i, part) {
      switch (part) {
        case 'dd':
        case 'd':
          format.hasDay = true;
          break;

        case 'mm':
        case 'm':
          format.hasMonth = true;
          break;

        case 'yyyy':
        case 'yy':
          format.hasYear = true;
          break;

        default:
      }
    });
    return format;
  }
  function getScrollParent(element) {
    var includeHidden = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var $element = $(element);
    var position = $element.css('position');
    var excludeStaticParent = position === 'absolute';
    var overflowRegex = includeHidden ? /auto|scroll|hidden/ : /auto|scroll/;
    var scrollParent = $element.parents().filter(function (index, parent) {
      var $parent = $(parent);

      if (excludeStaticParent && $parent.css('position') === 'static') {
        return false;
      }

      return overflowRegex.test($parent.css('overflow') + $parent.css('overflow-y') + $parent.css('overflow-x'));
    }).eq(0);
    return position === 'fixed' || !scrollParent.length ? $(element.ownerDocument || document) : scrollParent;
  }
  /**
   * Add leading zeroes to the given value
   * @param {number} value - The value to add.
   * @param {number} [length=1] - The expected value length.
   * @returns {string} Returns converted value.
   */

  function addLeadingZero(value) {
    var length = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
    var str = String(Math.abs(value));
    var i = str.length;
    var result = '';

    if (value < 0) {
      result += '-';
    }

    while (i < length) {
      i += 1;
      result += '0';
    }

    return result + str;
  }

  var REGEXP_DIGITS = /\d+/g;
  var methods = {
    // Show the datepicker
    show: function show() {
      if (!this.built) {
        this.build();
      }

      if (this.shown) {
        return;
      }

      if (this.trigger(EVENT_SHOW).isDefaultPrevented()) {
        return;
      }

      this.shown = true;
      this.$picker.removeClass(CLASS_HIDE).on(EVENT_CLICK, $.proxy(this.click, this));
      this.showView(this.options.startView);

      if (!this.inline) {
        this.$scrollParent.on(EVENT_SCROLL, $.proxy(this.place, this));
        $(window).on(EVENT_RESIZE, this.onResize = proxy(this.place, this));
        $(document).on(EVENT_CLICK, this.onGlobalClick = proxy(this.globalClick, this));
        $(document).on(EVENT_KEYUP, this.onGlobalKeyup = proxy(this.globalKeyup, this));

        if (IS_TOUCH_DEVICE) {
          $(document).on(EVENT_TOUCH_START, this.onTouchStart = proxy(this.touchstart, this));
        }

        this.place();
      }
    },
    // Hide the datepicker
    hide: function hide() {
      if (!this.shown) {
        return;
      }

      if (this.trigger(EVENT_HIDE).isDefaultPrevented()) {
        return;
      }

      this.shown = false;
      this.$picker.addClass(CLASS_HIDE).off(EVENT_CLICK, this.click);

      if (!this.inline) {
        this.$scrollParent.off(EVENT_SCROLL, this.place);
        $(window).off(EVENT_RESIZE, this.onResize);
        $(document).off(EVENT_CLICK, this.onGlobalClick);
        $(document).off(EVENT_KEYUP, this.onGlobalKeyup);

        if (IS_TOUCH_DEVICE) {
          $(document).off(EVENT_TOUCH_START, this.onTouchStart);
        }
      }
    },
    toggle: function toggle() {
      if (this.shown) {
        this.hide();
      } else {
        this.show();
      }
    },
    // Update the datepicker with the current input value
    update: function update() {
      var value = this.getValue();

      if (value === this.oldValue) {
        return;
      }

      this.setDate(value, true);
      this.oldValue = value;
    },

    /**
     * Pick the current date to the element
     *
     * @param {String} _view (private)
     */
    pick: function pick(_view) {
      var $this = this.$element;
      var date = this.date;

      if (this.trigger(EVENT_PICK, {
        view: _view || '',
        date: date
      }).isDefaultPrevented()) {
        return;
      }

      date = this.formatDate(this.date);
      this.setValue(date);

      if (this.isInput) {
        $this.trigger('input');
        $this.trigger('change');
      }
    },
    // Reset the datepicker
    reset: function reset() {
      this.setDate(this.initialDate, true);
      this.setValue(this.initialValue);

      if (this.shown) {
        this.showView(this.options.startView);
      }
    },

    /**
     * Get the month name with given argument or the current date
     *
     * @param {Number} month (optional)
     * @param {Boolean} shortForm (optional)
     * @return {String} (month name)
     */
    getMonthName: function getMonthName(month, shortForm) {
      var options = this.options;
      var monthsShort = options.monthsShort;
      var months = options.months;

      if ($.isNumeric(month)) {
        month = Number(month);
      } else if (isUndefined(shortForm)) {
        shortForm = month;
      }

      if (shortForm === true) {
        months = monthsShort;
      }

      return months[isNumber(month) ? month : this.date.getMonth()];
    },

    /**
     * Get the day name with given argument or the current date
     *
     * @param {Number} day (optional)
     * @param {Boolean} shortForm (optional)
     * @param {Boolean} min (optional)
     * @return {String} (day name)
     */
    getDayName: function getDayName(day, shortForm, min) {
      var options = this.options;
      var days = options.days;

      if ($.isNumeric(day)) {
        day = Number(day);
      } else {
        if (isUndefined(min)) {
          min = shortForm;
        }

        if (isUndefined(shortForm)) {
          shortForm = day;
        }
      }

      if (min) {
        days = options.daysMin;
      } else if (shortForm) {
        days = options.daysShort;
      }

      return days[isNumber(day) ? day : this.date.getDay()];
    },

    /**
     * Get the current date
     *
     * @param {Boolean} formatted (optional)
     * @return {Date|String} (date)
     */
    getDate: function getDate(formatted) {
      var date = this.date;
      return formatted ? this.formatDate(date) : new Date(date);
    },

    /**
     * Set the current date with a new date
     *
     * @param {Date} date
     * @param {Boolean} _updated (private)
     */
    setDate: function setDate(date, _updated) {
      var filter = this.options.filter;

      if (isDate(date) || isString(date)) {
        date = this.parseDate(date);

        if ($.isFunction(filter) && filter.call(this.$element, date, 'day') === false) {
          return;
        }

        this.date = date;
        this.viewDate = new Date(date);

        if (!_updated) {
          this.pick();
        }

        if (this.built) {
          this.render();
        }
      }
    },

    /**
     * Set the start view date with a new date
     *
     * @param {Date|string|null} date
     */
    setStartDate: function setStartDate(date) {
      if (isDate(date) || isString(date)) {
        this.startDate = this.parseDate(date);
      } else {
        this.startDate = null;
      }

      if (this.built) {
        this.render();
      }
    },

    /**
     * Set the end view date with a new date
     *
     * @param {Date|string|null} date
     */
    setEndDate: function setEndDate(date) {
      if (isDate(date) || isString(date)) {
        this.endDate = this.parseDate(date);
      } else {
        this.endDate = null;
      }

      if (this.built) {
        this.render();
      }
    },

    /**
     * Parse a date string with the set date format
     *
     * @param {String} date
     * @return {Date} (parsed date)
     */
    parseDate: function parseDate(date) {
      var format = this.format;
      var parts = [];

      if (!isDate(date)) {
        if (isString(date)) {
          parts = date.match(REGEXP_DIGITS) || [];
        }

        date = date ? new Date(date) : new Date();

        if (!isDate(date)) {
          date = new Date();
        }

        if (parts.length === format.parts.length) {
          // Set year and month first
          $.each(parts, function (i, part) {
            var value = parseInt(part, 10);

            switch (format.parts[i]) {
              case 'yy':
                date.setFullYear(2000 + value);
                break;

              case 'yyyy':
                // Converts 2-digit year to 2000+
                date.setFullYear(part.length === 2 ? 2000 + value : value);
                break;

              case 'mm':
              case 'm':
                date.setMonth(value - 1);
                break;

              default:
            }
          }); // Set day in the last to avoid converting `31/10/2019` to `01/10/2019`

          $.each(parts, function (i, part) {
            var value = parseInt(part, 10);

            switch (format.parts[i]) {
              case 'dd':
              case 'd':
                date.setDate(value);
                break;

              default:
            }
          });
        }
      } // Ignore hours, minutes, seconds and milliseconds to avoid side effect (#192)


      return new Date(date.getFullYear(), date.getMonth(), date.getDate());
    },

    /**
     * Format a date object to a string with the set date format
     *
     * @param {Date} date
     * @return {String} (formatted date)
     */
    formatDate: function formatDate(date) {
      var format = this.format;
      var formatted = '';

      if (isDate(date)) {
        var year = date.getFullYear();
        var month = date.getMonth();
        var day = date.getDate();
        var values = {
          d: day,
          dd: addLeadingZero(day, 2),
          m: month + 1,
          mm: addLeadingZero(month + 1, 2),
          yy: String(year).substring(2),
          yyyy: addLeadingZero(year, 4)
        };
        formatted = format.source;
        $.each(format.parts, function (i, part) {
          formatted = formatted.replace(part, values[part]);
        });
      }

      return formatted;
    },
    // Destroy the datepicker and remove the instance from the target element
    destroy: function destroy() {
      this.unbind();
      this.unbuild();
      this.$element.removeData(NAMESPACE);
    }
  };

  var handlers = {
    click: function click(e) {
      var $target = $(e.target);
      var options = this.options,
          date = this.date,
          viewDate = this.viewDate,
          format = this.format;
      e.stopPropagation();
      e.preventDefault();

      if ($target.hasClass('disabled')) {
        return;
      }

      var view = $target.data('view');
      var viewYear = viewDate.getFullYear();
      var viewMonth = viewDate.getMonth();
      var viewDay = viewDate.getDate();

      switch (view) {
        case 'years prev':
        case 'years next':
          {
            viewYear = view === 'years prev' ? viewYear - 10 : viewYear + 10;
            viewDate.setFullYear(viewYear);
            viewDate.setDate(getMinDay(viewYear, viewMonth, viewDay));
            this.renderYears();
            break;
          }

        case 'year prev':
        case 'year next':
          viewYear = view === 'year prev' ? viewYear - 1 : viewYear + 1;
          viewDate.setFullYear(viewYear);
          viewDate.setDate(getMinDay(viewYear, viewMonth, viewDay));
          this.renderMonths();
          break;

        case 'year current':
          if (format.hasYear) {
            this.showView(VIEWS.YEARS);
          }

          break;

        case 'year picked':
          if (format.hasMonth) {
            this.showView(VIEWS.MONTHS);
          } else {
            $target.siblings(".".concat(options.pickedClass)).removeClass(options.pickedClass).data('view', 'year');
            this.hideView();
          }

          this.pick('year');
          break;

        case 'year':
          viewYear = parseInt($target.text(), 10); // Set date first to avoid month changing (#195)

          date.setDate(getMinDay(viewYear, viewMonth, viewDay));
          date.setFullYear(viewYear);
          viewDate.setDate(getMinDay(viewYear, viewMonth, viewDay));
          viewDate.setFullYear(viewYear);

          if (format.hasMonth) {
            this.showView(VIEWS.MONTHS);
          } else {
            $target.addClass(options.pickedClass).data('view', 'year picked').siblings(".".concat(options.pickedClass)).removeClass(options.pickedClass).data('view', 'year');
            this.hideView();
          }

          this.pick('year');
          break;

        case 'month prev':
        case 'month next':
          viewMonth = view === 'month prev' ? viewMonth - 1 : viewMonth + 1;

          if (viewMonth < 0) {
            viewYear -= 1;
            viewMonth += 12;
          } else if (viewMonth > 11) {
            viewYear += 1;
            viewMonth -= 12;
          }

          viewDate.setFullYear(viewYear);
          viewDate.setDate(getMinDay(viewYear, viewMonth, viewDay));
          viewDate.setMonth(viewMonth);
          this.renderDays();
          break;

        case 'month current':
          if (format.hasMonth) {
            this.showView(VIEWS.MONTHS);
          }

          break;

        case 'month picked':
          if (format.hasDay) {
            this.showView(VIEWS.DAYS);
          } else {
            $target.siblings(".".concat(options.pickedClass)).removeClass(options.pickedClass).data('view', 'month');
            this.hideView();
          }

          this.pick('month');
          break;

        case 'month':
          viewMonth = $.inArray($target.text(), options.monthsShort);
          date.setFullYear(viewYear); // Set date before month to avoid month changing (#195)

          date.setDate(getMinDay(viewYear, viewMonth, viewDay));
          date.setMonth(viewMonth);
          viewDate.setFullYear(viewYear);
          viewDate.setDate(getMinDay(viewYear, viewMonth, viewDay));
          viewDate.setMonth(viewMonth);

          if (format.hasDay) {
            this.showView(VIEWS.DAYS);
          } else {
            $target.addClass(options.pickedClass).data('view', 'month picked').siblings(".".concat(options.pickedClass)).removeClass(options.pickedClass).data('view', 'month');
            this.hideView();
          }

          this.pick('month');
          break;

        case 'day prev':
        case 'day next':
        case 'day':
          if (view === 'day prev') {
            viewMonth -= 1;
          } else if (view === 'day next') {
            viewMonth += 1;
          }

          viewDay = parseInt($target.text(), 10); // Set date to 1 to avoid month changing (#195)

          date.setDate(1);
          date.setFullYear(viewYear);
          date.setMonth(viewMonth);
          date.setDate(viewDay);
          viewDate.setDate(1);
          viewDate.setFullYear(viewYear);
          viewDate.setMonth(viewMonth);
          viewDate.setDate(viewDay);
          this.renderDays();

          if (view === 'day') {
            this.hideView();
          }

          this.pick('day');
          break;

        case 'day picked':
          this.hideView();
          this.pick('day');
          break;

        default:
      }
    },
    globalClick: function globalClick(_ref) {
      var target = _ref.target;
      var element = this.element,
          $trigger = this.$trigger;
      var trigger = $trigger[0];
      var hidden = true;

      while (target !== document) {
        if (target === trigger || target === element) {
          hidden = false;
          break;
        }

        target = target.parentNode;
      }

      if (hidden) {
        this.hide();
      }
    },
    keyup: function keyup() {
      this.update();
    },
    globalKeyup: function globalKeyup(_ref2) {
      var target = _ref2.target,
          key = _ref2.key,
          keyCode = _ref2.keyCode;

      if (this.isInput && target !== this.element && this.shown && (key === 'Tab' || keyCode === 9)) {
        this.hide();
      }
    },
    touchstart: function touchstart(_ref3) {
      var target = _ref3.target;

      // Emulate click in touch devices to support hiding the picker automatically (#197).
      if (this.isInput && target !== this.element && !$.contains(this.$picker[0], target)) {
        this.hide();
        this.element.blur();
      }
    }
  };

  var render = {
    render: function render() {
      this.renderYears();
      this.renderMonths();
      this.renderDays();
    },
    renderWeek: function renderWeek() {
      var _this = this;

      var items = [];
      var _this$options = this.options,
          weekStart = _this$options.weekStart,
          daysMin = _this$options.daysMin;
      weekStart = parseInt(weekStart, 10) % 7;
      daysMin = daysMin.slice(weekStart).concat(daysMin.slice(0, weekStart));
      $.each(daysMin, function (i, day) {
        items.push(_this.createItem({
          text: day
        }));
      });
      this.$week.html(items.join(''));
    },
    renderYears: function renderYears() {
      var options = this.options,
          startDate = this.startDate,
          endDate = this.endDate;
      var disabledClass = options.disabledClass,
          filter = options.filter,
          yearSuffix = options.yearSuffix;
      var viewYear = this.viewDate.getFullYear();
      var now = new Date();
      var thisYear = now.getFullYear();
      var year = this.date.getFullYear();
      var start = -5;
      var end = 6;
      var items = [];
      var prevDisabled = false;
      var nextDisabled = false;
      var i;

      for (i = start; i <= end; i += 1) {
        var date = new Date(viewYear + i, 1, 1);
        var disabled = false;

        if (startDate) {
          disabled = date.getFullYear() < startDate.getFullYear();

          if (i === start) {
            prevDisabled = disabled;
          }
        }

        if (!disabled && endDate) {
          disabled = date.getFullYear() > endDate.getFullYear();

          if (i === end) {
            nextDisabled = disabled;
          }
        }

        if (!disabled && filter) {
          disabled = filter.call(this.$element, date, 'year') === false;
        }

        var picked = viewYear + i === year;
        var view = picked ? 'year picked' : 'year';
        items.push(this.createItem({
          picked: picked,
          disabled: disabled,
          text: viewYear + i,
          view: disabled ? 'year disabled' : view,
          highlighted: date.getFullYear() === thisYear
        }));
      }

      this.$yearsPrev.toggleClass(disabledClass, prevDisabled);
      this.$yearsNext.toggleClass(disabledClass, nextDisabled);
      this.$yearsCurrent.toggleClass(disabledClass, true).html("".concat(viewYear + start + yearSuffix, " - ").concat(viewYear + end).concat(yearSuffix));
      this.$years.html(items.join(''));
    },
    renderMonths: function renderMonths() {
      var options = this.options,
          startDate = this.startDate,
          endDate = this.endDate,
          viewDate = this.viewDate;
      var disabledClass = options.disabledClass || '';
      var months = options.monthsShort;
      var filter = $.isFunction(options.filter) && options.filter;
      var viewYear = viewDate.getFullYear();
      var now = new Date();
      var thisYear = now.getFullYear();
      var thisMonth = now.getMonth();
      var year = this.date.getFullYear();
      var month = this.date.getMonth();
      var items = [];
      var prevDisabled = false;
      var nextDisabled = false;
      var i;

      for (i = 0; i <= 11; i += 1) {
        var date = new Date(viewYear, i, 1);
        var disabled = false;

        if (startDate) {
          prevDisabled = date.getFullYear() === startDate.getFullYear();
          disabled = prevDisabled && date.getMonth() < startDate.getMonth();
        }

        if (!disabled && endDate) {
          nextDisabled = date.getFullYear() === endDate.getFullYear();
          disabled = nextDisabled && date.getMonth() > endDate.getMonth();
        }

        if (!disabled && filter) {
          disabled = filter.call(this.$element, date, 'month') === false;
        }

        var picked = viewYear === year && i === month;
        var view = picked ? 'month picked' : 'month';
        items.push(this.createItem({
          disabled: disabled,
          picked: picked,
          highlighted: viewYear === thisYear && date.getMonth() === thisMonth,
          index: i,
          text: months[i],
          view: disabled ? 'month disabled' : view
        }));
      }

      this.$yearPrev.toggleClass(disabledClass, prevDisabled);
      this.$yearNext.toggleClass(disabledClass, nextDisabled);
      this.$yearCurrent.toggleClass(disabledClass, prevDisabled && nextDisabled).html(viewYear + options.yearSuffix || '');
      this.$months.html(items.join(''));
    },
    renderDays: function renderDays() {
      var $element = this.$element,
          options = this.options,
          startDate = this.startDate,
          endDate = this.endDate,
          viewDate = this.viewDate,
          currentDate = this.date;
      var disabledClass = options.disabledClass,
          filter = options.filter,
          months = options.months,
          weekStart = options.weekStart,
          yearSuffix = options.yearSuffix;
      var viewYear = viewDate.getFullYear();
      var viewMonth = viewDate.getMonth();
      var now = new Date();
      var thisYear = now.getFullYear();
      var thisMonth = now.getMonth();
      var thisDay = now.getDate();
      var year = currentDate.getFullYear();
      var month = currentDate.getMonth();
      var day = currentDate.getDate();
      var length;
      var i;
      var n; // Days of prev month
      // -----------------------------------------------------------------------

      var prevItems = [];
      var prevViewYear = viewYear;
      var prevViewMonth = viewMonth;
      var prevDisabled = false;

      if (viewMonth === 0) {
        prevViewYear -= 1;
        prevViewMonth = 11;
      } else {
        prevViewMonth -= 1;
      } // The length of the days of prev month


      length = getDaysInMonth(prevViewYear, prevViewMonth); // The first day of current month

      var firstDay = new Date(viewYear, viewMonth, 1); // The visible length of the days of prev month
      // [0,1,2,3,4,5,6] - [0,1,2,3,4,5,6] => [-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6]

      n = firstDay.getDay() - parseInt(weekStart, 10) % 7; // [-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6] => [1,2,3,4,5,6,7]

      if (n <= 0) {
        n += 7;
      }

      if (startDate) {
        prevDisabled = firstDay.getTime() <= startDate.getTime();
      }

      for (i = length - (n - 1); i <= length; i += 1) {
        var prevViewDate = new Date(prevViewYear, prevViewMonth, i);
        var disabled = false;

        if (startDate) {
          disabled = prevViewDate.getTime() < startDate.getTime();
        }

        if (!disabled && filter) {
          disabled = filter.call($element, prevViewDate, 'day') === false;
        }

        prevItems.push(this.createItem({
          disabled: disabled,
          highlighted: prevViewYear === thisYear && prevViewMonth === thisMonth && prevViewDate.getDate() === thisDay,
          muted: true,
          picked: prevViewYear === year && prevViewMonth === month && i === day,
          text: i,
          view: 'day prev'
        }));
      } // Days of next month
      // -----------------------------------------------------------------------


      var nextItems = [];
      var nextViewYear = viewYear;
      var nextViewMonth = viewMonth;
      var nextDisabled = false;

      if (viewMonth === 11) {
        nextViewYear += 1;
        nextViewMonth = 0;
      } else {
        nextViewMonth += 1;
      } // The length of the days of current month


      length = getDaysInMonth(viewYear, viewMonth); // The visible length of next month (42 means 6 rows and 7 columns)

      n = 42 - (prevItems.length + length); // The last day of current month

      var lastDate = new Date(viewYear, viewMonth, length);

      if (endDate) {
        nextDisabled = lastDate.getTime() >= endDate.getTime();
      }

      for (i = 1; i <= n; i += 1) {
        var date = new Date(nextViewYear, nextViewMonth, i);
        var picked = nextViewYear === year && nextViewMonth === month && i === day;
        var _disabled = false;

        if (endDate) {
          _disabled = date.getTime() > endDate.getTime();
        }

        if (!_disabled && filter) {
          _disabled = filter.call($element, date, 'day') === false;
        }

        nextItems.push(this.createItem({
          disabled: _disabled,
          picked: picked,
          highlighted: nextViewYear === thisYear && nextViewMonth === thisMonth && date.getDate() === thisDay,
          muted: true,
          text: i,
          view: 'day next'
        }));
      } // Days of current month
      // -----------------------------------------------------------------------


      var items = [];

      for (i = 1; i <= length; i += 1) {
        var _date = new Date(viewYear, viewMonth, i);

        var _disabled2 = false;

        if (startDate) {
          _disabled2 = _date.getTime() < startDate.getTime();
        }

        if (!_disabled2 && endDate) {
          _disabled2 = _date.getTime() > endDate.getTime();
        }

        if (!_disabled2 && filter) {
          _disabled2 = filter.call($element, _date, 'day') === false;
        }

        var _picked = viewYear === year && viewMonth === month && i === day;

        var view = _picked ? 'day picked' : 'day';
        items.push(this.createItem({
          disabled: _disabled2,
          picked: _picked,
          highlighted: viewYear === thisYear && viewMonth === thisMonth && _date.getDate() === thisDay,
          text: i,
          view: _disabled2 ? 'day disabled' : view
        }));
      } // Render days picker
      // -----------------------------------------------------------------------


      this.$monthPrev.toggleClass(disabledClass, prevDisabled);
      this.$monthNext.toggleClass(disabledClass, nextDisabled);
      this.$monthCurrent.toggleClass(disabledClass, prevDisabled && nextDisabled).html(options.yearFirst ? "".concat(viewYear + yearSuffix, " ").concat(months[viewMonth]) : "".concat(months[viewMonth], " ").concat(viewYear).concat(yearSuffix));
      this.$days.html(prevItems.join('') + items.join('') + nextItems.join(''));
    }
  };

  var CLASS_TOP_LEFT = "".concat(NAMESPACE, "-top-left");
  var CLASS_TOP_RIGHT = "".concat(NAMESPACE, "-top-right");
  var CLASS_BOTTOM_LEFT = "".concat(NAMESPACE, "-bottom-left");
  var CLASS_BOTTOM_RIGHT = "".concat(NAMESPACE, "-bottom-right");
  var CLASS_PLACEMENTS = [CLASS_TOP_LEFT, CLASS_TOP_RIGHT, CLASS_BOTTOM_LEFT, CLASS_BOTTOM_RIGHT].join(' ');

  var Datepicker =
  /*#__PURE__*/
  function () {
    function Datepicker(element) {
      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      _classCallCheck(this, Datepicker);

      this.$element = $(element);
      this.element = element;
      this.options = $.extend({}, DEFAULTS, LANGUAGES[options.language], $.isPlainObject(options) && options);
      this.$scrollParent = getScrollParent(element, true);
      this.built = false;
      this.shown = false;
      this.isInput = false;
      this.inline = false;
      this.initialValue = '';
      this.initialDate = null;
      this.startDate = null;
      this.endDate = null;
      this.init();
    }

    _createClass(Datepicker, [{
      key: "init",
      value: function init() {
        var $this = this.$element,
            options = this.options;
        var startDate = options.startDate,
            endDate = options.endDate,
            date = options.date;
        this.$trigger = $(options.trigger);
        this.isInput = $this.is('input') || $this.is('textarea');
        this.inline = options.inline && (options.container || !this.isInput);
        this.format = parseFormat(options.format);
        var initialValue = this.getValue();
        this.initialValue = initialValue;
        this.oldValue = initialValue;
        date = this.parseDate(date || initialValue);

        if (startDate) {
          startDate = this.parseDate(startDate);

          if (date.getTime() < startDate.getTime()) {
            date = new Date(startDate);
          }

          this.startDate = startDate;
        }

        if (endDate) {
          endDate = this.parseDate(endDate);

          if (startDate && endDate.getTime() < startDate.getTime()) {
            endDate = new Date(startDate);
          }

          if (date.getTime() > endDate.getTime()) {
            date = new Date(endDate);
          }

          this.endDate = endDate;
        }

        this.date = date;
        this.viewDate = new Date(date);
        this.initialDate = new Date(this.date);
        this.bind();

        if (options.autoShow || this.inline) {
          this.show();
        }

        if (options.autoPick) {
          this.pick();
        }
      }
    }, {
      key: "build",
      value: function build() {
        if (this.built) {
          return;
        }

        this.built = true;
        var $this = this.$element,
            options = this.options;
        var $picker = $(options.template);
        this.$picker = $picker;
        this.$week = $picker.find(selectorOf('week')); // Years view

        this.$yearsPicker = $picker.find(selectorOf('years picker'));
        this.$yearsPrev = $picker.find(selectorOf('years prev'));
        this.$yearsNext = $picker.find(selectorOf('years next'));
        this.$yearsCurrent = $picker.find(selectorOf('years current'));
        this.$years = $picker.find(selectorOf('years')); // Months view

        this.$monthsPicker = $picker.find(selectorOf('months picker'));
        this.$yearPrev = $picker.find(selectorOf('year prev'));
        this.$yearNext = $picker.find(selectorOf('year next'));
        this.$yearCurrent = $picker.find(selectorOf('year current'));
        this.$months = $picker.find(selectorOf('months')); // Days view

        this.$daysPicker = $picker.find(selectorOf('days picker'));
        this.$monthPrev = $picker.find(selectorOf('month prev'));
        this.$monthNext = $picker.find(selectorOf('month next'));
        this.$monthCurrent = $picker.find(selectorOf('month current'));
        this.$days = $picker.find(selectorOf('days'));

        if (this.inline) {
          $(options.container || $this).append($picker.addClass("".concat(NAMESPACE, "-inline")));
        } else {
          $(document.body).append($picker.addClass("".concat(NAMESPACE, "-dropdown")));
          $picker.addClass(CLASS_HIDE).css({
            zIndex: parseInt(options.zIndex, 10)
          });
        }

        this.renderWeek();
      }
    }, {
      key: "unbuild",
      value: function unbuild() {
        if (!this.built) {
          return;
        }

        this.built = false;
        this.$picker.remove();
      }
    }, {
      key: "bind",
      value: function bind() {
        var options = this.options,
            $this = this.$element;

        if ($.isFunction(options.show)) {
          $this.on(EVENT_SHOW, options.show);
        }

        if ($.isFunction(options.hide)) {
          $this.on(EVENT_HIDE, options.hide);
        }

        if ($.isFunction(options.pick)) {
          $this.on(EVENT_PICK, options.pick);
        }

        if (this.isInput) {
          $this.on(EVENT_KEYUP, $.proxy(this.keyup, this));
        }

        if (!this.inline) {
          if (options.trigger) {
            this.$trigger.on(EVENT_CLICK, $.proxy(this.toggle, this));
          } else if (this.isInput) {
            $this.on(EVENT_FOCUS, $.proxy(this.show, this));
          } else {
            $this.on(EVENT_CLICK, $.proxy(this.show, this));
          }
        }
      }
    }, {
      key: "unbind",
      value: function unbind() {
        var $this = this.$element,
            options = this.options;

        if ($.isFunction(options.show)) {
          $this.off(EVENT_SHOW, options.show);
        }

        if ($.isFunction(options.hide)) {
          $this.off(EVENT_HIDE, options.hide);
        }

        if ($.isFunction(options.pick)) {
          $this.off(EVENT_PICK, options.pick);
        }

        if (this.isInput) {
          $this.off(EVENT_KEYUP, this.keyup);
        }

        if (!this.inline) {
          if (options.trigger) {
            this.$trigger.off(EVENT_CLICK, this.toggle);
          } else if (this.isInput) {
            $this.off(EVENT_FOCUS, this.show);
          } else {
            $this.off(EVENT_CLICK, this.show);
          }
        }
      }
    }, {
      key: "showView",
      value: function showView(view) {
        var $yearsPicker = this.$yearsPicker,
            $monthsPicker = this.$monthsPicker,
            $daysPicker = this.$daysPicker,
            format = this.format;

        if (format.hasYear || format.hasMonth || format.hasDay) {
          switch (Number(view)) {
            case VIEWS.YEARS:
              $monthsPicker.addClass(CLASS_HIDE);
              $daysPicker.addClass(CLASS_HIDE);

              if (format.hasYear) {
                this.renderYears();
                $yearsPicker.removeClass(CLASS_HIDE);
                this.place();
              } else {
                this.showView(VIEWS.DAYS);
              }

              break;

            case VIEWS.MONTHS:
              $yearsPicker.addClass(CLASS_HIDE);
              $daysPicker.addClass(CLASS_HIDE);

              if (format.hasMonth) {
                this.renderMonths();
                $monthsPicker.removeClass(CLASS_HIDE);
                this.place();
              } else {
                this.showView(VIEWS.YEARS);
              }

              break;
            // case VIEWS.DAYS:

            default:
              $yearsPicker.addClass(CLASS_HIDE);
              $monthsPicker.addClass(CLASS_HIDE);

              if (format.hasDay) {
                this.renderDays();
                $daysPicker.removeClass(CLASS_HIDE);
                this.place();
              } else {
                this.showView(VIEWS.MONTHS);
              }

          }
        }
      }
    }, {
      key: "hideView",
      value: function hideView() {
        if (!this.inline && this.options.autoHide) {
          this.hide();
        }
      }
    }, {
      key: "place",
      value: function place() {
        if (this.inline) {
          return;
        }

        var $this = this.$element,
            options = this.options,
            $picker = this.$picker;
        var containerWidth = $(document).outerWidth();
        var containerHeight = $(document).outerHeight();
        var elementWidth = $this.outerWidth();
        var elementHeight = $this.outerHeight();
        var width = $picker.width();
        var height = $picker.height();

        var _$this$offset = $this.offset(),
            left = _$this$offset.left,
            top = _$this$offset.top;

        var offset = parseFloat(options.offset);
        var placement = CLASS_TOP_LEFT;

        if (isNaN(offset)) {
          offset = 10;
        }

        if (top > height && top + elementHeight + height > containerHeight) {
          top -= height + offset;
          placement = CLASS_BOTTOM_LEFT;
        } else {
          top += elementHeight + offset;
        }

        if (left + width > containerWidth) {
          left += elementWidth - width;
          placement = placement.replace('left', 'right');
        }

        $picker.removeClass(CLASS_PLACEMENTS).addClass(placement).css({
          top: top,
          left: left
        });
      } // A shortcut for triggering custom events

    }, {
      key: "trigger",
      value: function trigger(type, data) {
        var e = $.Event(type, data);
        this.$element.trigger(e);
        return e;
      }
    }, {
      key: "createItem",
      value: function createItem(data) {
        var options = this.options;
        var itemTag = options.itemTag;
        var item = {
          text: '',
          view: '',
          muted: false,
          picked: false,
          disabled: false,
          highlighted: false
        };
        var classes = [];
        $.extend(item, data);

        if (item.muted) {
          classes.push(options.mutedClass);
        }

        if (item.highlighted) {
          classes.push(options.highlightedClass);
        }

        if (item.picked) {
          classes.push(options.pickedClass);
        }

        if (item.disabled) {
          classes.push(options.disabledClass);
        }

        return "<".concat(itemTag, " class=\"").concat(classes.join(' '), "\" data-view=\"").concat(item.view, "\">").concat(item.text, "</").concat(itemTag, ">");
      }
    }, {
      key: "getValue",
      value: function getValue() {
        var $this = this.$element;
        return this.isInput ? $this.val() : $this.text();
      }
    }, {
      key: "setValue",
      value: function setValue() {
        var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
        var $this = this.$element;

        if (this.isInput) {
          $this.val(value);
        } else if (!this.inline || this.options.container) {
          $this.text(value);
        }
      }
    }], [{
      key: "setDefaults",
      value: function setDefaults() {
        var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
        $.extend(DEFAULTS, LANGUAGES[options.language], $.isPlainObject(options) && options);
      }
    }]);

    return Datepicker;
  }();

  if ($.extend) {
    $.extend(Datepicker.prototype, render, handlers, methods);
  }

  if ($.fn) {
    var AnotherDatepicker = $.fn.datepicker;

    $.fn.datepicker = function jQueryDatepicker(option) {
      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }

      var result;
      this.each(function (i, element) {
        var $element = $(element);
        var isDestroy = option === 'destroy';
        var datepicker = $element.data(NAMESPACE);

        if (!datepicker) {
          if (isDestroy) {
            return;
          }

          var options = $.extend({}, $element.data(), $.isPlainObject(option) && option);
          datepicker = new Datepicker(element, options);
          $element.data(NAMESPACE, datepicker);
        }

        if (isString(option)) {
          var fn = datepicker[option];

          if ($.isFunction(fn)) {
            result = fn.apply(datepicker, args);

            if (isDestroy) {
              $element.removeData(NAMESPACE);
            }
          }
        }
      });
      return !isUndefined(result) ? result : this;
    };

    $.fn.datepicker.Constructor = Datepicker;
    $.fn.datepicker.languages = LANGUAGES;
    $.fn.datepicker.setDefaults = Datepicker.setDefaults;

    $.fn.datepicker.noConflict = function noConflict() {
      $.fn.datepicker = AnotherDatepicker;
      return this;
    };
  }

}));
   /* Ende datepicker */
   /* Start datepicker.de-DE */
   (function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(require('jquery')) :
  typeof define === 'function' && define.amd ? define(['jquery'], factory) :
  (factory(global.jQuery));
}(this, (function ($) {
  'use strict';

  $.fn.datepicker.languages['de-DE'] = {
    format: 'dd.mm.yyyy',
    days: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],
    daysShort: ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],
    daysMin: ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],
    weekStart: 1,
    months: ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],
    monthsShort: ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez']
  };
})));
   /* Ende datepicker.de-DE */
   /* Start datepicker.en-US */
   (function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(require('jquery')) :
  typeof define === 'function' && define.amd ? define(['jquery'], factory) :
  (factory(global.jQuery));
}(this, (function ($) {
  'use strict';

  $.fn.datepicker.languages['en-US'] = {
    format: 'dd.mm.yyyy'
  };
})));
   /* Ende datepicker.en-US */
   /* Start gsb_aria */
   /*!!
 * @name gsb_aria
 * @version 1.1.0
 * @see {@link http://semver.org|Semantic Versioning}
 * @author rkrusenb
 *
 * @desc Modulbeschreibung (TODO)
 *
 * @requires  {@link external:jQuery}
 *
 * @example
 * Beispielaufruf (TODO)
 */
var gsb;
gsb = gsb || {};
(function ($, gsb) {
  gsb.aria = function aria(el, options, params) {
    var base = Object.create(aria.prototype);
    base.$el = $(el);
    base.el = el;
    base.moduleName = "gsb.aria";
    base.$el.data(base.moduleName, base);
    base.options = $.extend({}, gsb.aria.defaultOptions, options);
    base.init(el, options, params);
    return base;
  };

  gsb.aria.prototype = {
    /**
     * @method generateID
     * @desc generiert eine ID aus einer Zufallszahl und dessen toString result mit der Basis 36
     */
    generateID: function generateID() {
      // Math.random should be unique because of its seeding algorithm.
      // Convert it to base 36 (numbers + letters), and grab the first 9 characters
      // after the decimal.
      return '_' + Math.random().toString(36).substr(2, 9);
    },
    setInitialValues: function setInitialValues() {
      var base = this;

      Object.keys(base.types).forEach(function (typeName) {
        var type = this[typeName];
        base.applyToggle(type, typeName, 1);
        type.prop('gsb_aria_index', function (index) {
          return index;
        });
      }, base.types);

      base.initial.forEach(function (statement) {
        var typeName = statement._type,
            type = base.types[typeName];
        Object.keys(statement).forEach(function (attrName) {
          var attrValue = statement[attrName];
          if (attrName === "_type") {
            //ignore
          } else if (attrName === "class") {
            //ignore
          } else if (typeof attrValue === "function") {
            type.each(function (i, el) {
              $(el).attr(attrName, attrValue.call(base, base, i, attrName));
            });
          } else {
            type.attr(attrName, attrValue);
          }
        });
      });
    },
    init: function init(_, __, params) {
      this.types = params.types;
      this.initial = params.initial;
      this.toggles = params.toggles;
      this.setInitialValues();
    },
    getToggleValues: function getToggleValues(object, index) {
      var values = {};
      Object.keys(object || {}).forEach(function (key) {
        if (key !== "class" && key !== "style") {
          values[key] = object[key][index];
        }
      });
      return values;
    },
    applyToggle: function applyToggle($elements, typeName, index) {
      var base = this,
          toggles = base.toggles[typeName] || {},
          classes = toggles["class"] || [];
      $elements.attr(base.getToggleValues(toggles, index));
      $elements.removeClass(classes[index === 0 ? 1 : 0]);
      $elements.addClass(classes[index]);
    },
    updateAria: function updateAria(elem, open, singleOpen) {
      var base = this,
          index = elem['gsb_aria_index'];
      if (!open || singleOpen) {
        Object.keys(base.types).forEach(function (typeName) {
          var type = base.types[typeName];
          base.applyToggle($(type[index]), typeName, open ? 0 : 1);
        });
      } else {
        Object.keys(base.types).forEach(function (typeName) {
          var type = base.types[typeName];
          $(type).each(function (idx) {
            if (index === idx) {
              base.applyToggle($(type[idx]), typeName, 0);
            } else {
              base.applyToggle($(type[idx]), typeName, 1);
            }
          });
        });
      }
    }
  };

  gsb.aria.defaultOptions = {
    //options
  };
})(jQuery, gsb);
   /* Ende gsb_aria */
   /* Start gsb_makeGSBModule */
   /*!
   @author rkrusenb
   @license MIT
*/
var gsb;
gsb = gsb || {};
(function ($, gsb) {

  /* @example
   * function module(){}
   * var $;
   * set($, ['gsb', 'foo', 'bar'], module);
   * $.gsb && $.gsb.foo && $.gsb.foo.bar === module //true
   */
  function set(object, namespace, value) {
    var i,
        l = namespace.length - 1,
        property,
        last = namespace[l];
    for (i = 0; i < l; i++) {
      property = namespace[i];
      object[property] = object[property] || {};
      object = object[property];
    }
    object[last] = value;
  }
  /* @example
   * var $ = {
   *   gsb: {
   *     foo: {
   *       bar: function(x){
   *         return x;
   *       }
   *     }
   *   }
   * };
   * apply($, ['gsb', 'foo', 'bar'], ['baz']) === 'baz' //true
   */
  function apply(object, namespace, args) {
    var i,
        l = namespace.length - 1,
        property,
        last = namespace[l];
    for (i = 0; i < l; i++) {
      property = namespace[i];
      object = object && object[property];
    }
    if (typeof object[last] === "function") {
      object[last].apply(object, args);
    }
  }
  function enhance(fullName, namespace, template) {
    //returns an "enhanced" copy of a template
    return $.extend({
      eventName: namespace.slice().reverse().join('.'),
      moduleName: fullName
    }, template);
  }
  gsb.makeGSBModule = function makeGSBModule(fullName, template) {
    var namespace = fullName.split('.');

    function module(el, userOptions) {
      var base = $.extend({}, template);
      base.el = el;
      base.$el = $(el);
      base.options = $.extend(true, {}, template.defaultOptions, userOptions);
      base.$el.data(namespace.join('.'), base);

      for (var _len = arguments.length, additionalParameters = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {
        additionalParameters[_key - 2] = arguments[_key];
      }

      base.init.apply(base, [el, userOptions].concat(additionalParameters));
    }

    template = enhance(fullName, namespace, template);

    module.defaultOptions = template.defaultOptions || {};

    set($, namespace, module);

    $.fn[namespace.join('_')] = function (userOptions) {
      for (var _len2 = arguments.length, additionalParameters = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
        additionalParameters[_key2 - 1] = arguments[_key2];
      }

      $(this).each(function (i, el) {
        if (!$(el).data(namespace.join('.')) || userOptions && userOptions.force) {
          apply($, namespace, [el, userOptions].concat(additionalParameters));
        }
      });
      return this;
    };
  };
})(jQuery, gsb);
   /* Ende gsb_makeGSBModule */
   /* Start gsb_autosuggest */
   /*!
 * GSB-Plugin zur Darstellung von Suchvorschlaegen
 *
 * Optionen:
 * minInputLength: Ab wieviel eingegebenen Zeichen werden Vorschlaege ausgegeben (optional (default: 2))
 *
 * Author: gsb
 */
;(function($){if(!$.gsb){$.gsb={};}$.gsb.AutoSuggestBoxCounter=1;$.gsb.AutoSuggest=function(el,actionUrl,options){var base=this;base.$el=$(el);base.el=el;base.boxNumber=$.gsb.AutoSuggestBoxCounter++;base.$input=base.$el.find("input[type=text]:first");base.$submit=base.$el.find("input[type=submit]:first");if(base.$submit.length===0){base.$submit=base.$el.find("input[type=image]:first");}base.$el.data("gsb.AutoSuggest",base);base.reqQuery=false;base.queries=[];base.enterPos=-1;base.debug=false;base.init=function(options){base.actionUrl=actionUrl;base.options=$.extend({},$.gsb.AutoSuggest.defaultOptions,options);var positions=base.$input.position();base.$box=$('<div id="searchAutoSuggestBox'+base.boxNumber+'" class="searchAutoSuggestBox"></div>');base.$box.css({"width":base.$input.outerWidth()-2+"px","top":positions.top+base.$input.outerHeight()+"px","left":positions.left+"px"});base.$box.hide();$(window).resize(function(){positions=base.$input.position();base.$box.css({"top":positions.top+base.$input.outerHeight()+"px","left":positions.left+"px"});});base.$input.attr("autocomplete","off");base.$input.get(0).onkeydown=function(e){e=e||window.event;if(e){var code=e.keyCode!==undefined&&null!==e.keyCode?e.keyCode:e.which;if(code===13){return base.keydownEnter();}else{if(code===38){return base.keydownUp();}else{if(code===40){return base.keydownDown();}}}}};base.$input.get(0).onkeyup=function(e){var go=false;e=e||window.event;if(e){var code=e.keyCode!==undefined&&null!==e.keyCode?e.keyCode:e.which;if(code!==13&&code!==38&&code!==40){go=true;}}else{go=true;}if(go){if(base.$input.val().length>=base.options.minInputLength){base.query(base.$input.val());}else{base.showSuggestionBox(false);}}};base.$input.after(base.$box);base.$box=base.$el.find("#searchAutoSuggestBox"+base.boxNumber);base.$input.bind("blur",function(){base.showSuggestionBox(false);});};base.query=function(value){base.reqQuery=value;if(typeof base.queries[base.reqQuery]=="undefined"){if(base.debug&&typeof console!="undefined"&&console&&console.log){console.log('AutoSuggest-AJAX-Anfrage für "'+base.reqQuery+'"');}$.ajax({url:base.actionUrl,dataType:"json",data:{"userQuery":value},error:function error(jqXHR,textStatus,errorThrown){if(base.debug&&typeof console!="undefined"&&console&&console.log){console.log("AJAX Fehler beim Abruf der JSON-Resource "+base.actionUrl+": "+textStatus+" :: "+errorThrown);}},success:function success(data){base.queries[value]=data;if(base.reqQuery==value){if(base.debug&&typeof console!="undefined"&&console&&console.log){console.log('AJAX-Antwort für "'+base.reqQuery+'" wird nun verarbeitet...');}if(base.debug&&typeof console!="undefined"&&console&&console.log){console.log(data);}base.showSuggestions(data);}else{if(base.debug&&typeof console!="undefined"&&console&&console.log){console.log('AJAX-Antwort für "'+base.reqQuery+'" ist nicht mehr relevant...');}}}});}else{base.showSuggestions(base.queries[base.reqQuery]);}};base.showSuggestions=function(suggestionsContainer){base.$box.empty();var userDefinedSuggestions=suggestionsContainer.userDefinedSuggestions,fulltextSuggestions=suggestionsContainer.fulltextSuggestions,showSuggestionBox=userDefinedSuggestions.length||fulltextSuggestions.length;function showSuggestionsGroup(suggestionsGroup,headline){if(suggestionsGroup&&suggestionsGroup.length){$("<h3></h3>").text(headline).appendTo(base.$box);var $suggestionGroupList=$('<ul class="c-suggestions__ul"></ul>'),handleSuggestionClick=function handleSuggestionClick(e){var $suggestionLink=$(this);if($suggestionLink.attr("href")==="#"){e.preventDefault();base.$input.val($suggestionLink.text());base.$submit.click();}},insertSuggestionIntoGroup=function insertSuggestionIntoGroup(suggestion){var $listItem=$('<li class="c-suggestions__li"></li>'),suggestionLink=suggestion.link||"#",$listItemLink=$('<a href="'+suggestionLink+'"></a>');$listItemLink.html(suggestion.name);$listItemLink.click(handleSuggestionClick);$listItemLink.appendTo($listItem);$listItem.appendTo($suggestionGroupList);};suggestionsGroup.forEach(insertSuggestionIntoGroup);$suggestionGroupList.appendTo(base.$box);}}showSuggestionsGroup(userDefinedSuggestions,AUTOSUGGEST_USER_DEFINED_SUGGESTIONS_HEADLINE);showSuggestionsGroup(fulltextSuggestions,AUTOSUGGEST_FULLTEXT_SUGGESTIONS_HEADLINE);base.showSuggestionBox(showSuggestionBox);};base.showSuggestionBox=function(show){base.enterPos=-1;if(show){base.$box.fadeIn("fast");}else{base.$box.fadeOut("fast");}};base.keydownDown=function(){if(base.debug&&typeof console!="undefined"&&console&&console.log){console.log("KEYDOWN down");}if(base.enterPos<0&&base.$box.find("a").length>0){base.$box.find("a").removeClass("active");base.enterPos=0;$(base.$box.find("a")[base.enterPos]).addClass("active");}else{if(base.enterPos<base.$box.find("a").length-1){base.$box.find("a").removeClass("active");base.enterPos++;$(base.$box.find("a")[base.enterPos]).addClass("active");}}};base.keydownUp=function(){if(base.debug&&typeof console!="undefined"&&console&&console.log){console.log("KEYDOWN up");}if(base.enterPos<0&&base.$box.find("a").length>0){base.$box.find("a").removeClass("active");base.enterPos=base.$box.find("a").length-1;$(base.$box.find("a")[base.enterPos]).addClass("active");}else{if(base.enterPos>0){base.$box.find("a").removeClass("active");base.enterPos--;$(base.$box.find("a")[base.enterPos]).addClass("active");}}};base.keydownEnter=function(){if(base.debug&&typeof console!="undefined"&&console&&console.log){console.log("KEYDOWN enter");}if(base.enterPos>=0&&base.$box.find("a").length>base.enterPos){base.$box.find("a")[base.enterPos].click();return false;}};base.init(options);};$.gsb.AutoSuggest.defaultOptions={minInputLength:2};$.fn.gsb_AutoSuggest=function(actionUrl,options){return this.each(function(){new $.gsb.AutoSuggest(this,actionUrl,options);});};})(jQuery);
   /* Ende gsb_autosuggest */
   /* Start gsb_banner */
   gsb.makeGSBModule('gsb.banner', {
  init: function init() {
    var base = this;
    gsb.log('gsb_banner.init()');

    base.options.trackingModules = $.extend(true, {
      matomo: {
        consent: base.callConsentCallbacks,
        reject: base.callRejectCallbacks
      }
    }, base.options.trackingModules);

    if (base.options.trackingEnabled && !base.shouldCreateBanner()) {
      base.callRejectCallbacks();
      base.$el.remove();
      return;
    }

    if (base.options.trackingEnabled) {
      base.addTrackingFormListeners();
      if (Cookies.get(base.options.trackingCookieName)) {
        base.callConsentCallbacks();
      }
    }

    base.createBanner(false);

    base.$el.gsb_responsiveListener(base);

    if (base.options.restrictAccess && base.options.trackingEnabled) {
      base.setupLightbox();
    }
  },
  shouldCreateBanner: function shouldCreateBanner() {
    var base = this,
        cookiesEnabled = base.areCookiesEnabled(),
        doNotTrack = base.options.respectDoNotTrack && navigator.doNotTrack === "1";
    return cookiesEnabled && !doNotTrack;
  },
  areCookiesEnabled: function areCookiesEnabled() {
    // TODO: Deliberate whether Modernizr should be used
    /*! adapted from https://github.com/Modernizr/Modernizr/blob/master/feature-detects/cookies.js,
     * Modernizr 3.11.0 | Copyright © 2021 The Modernizr Team | License MIT
     */
    var enabled = false;
    try {
      // create cookie
      document.cookie = 'cookietest=1';
      enabled = document.cookie.indexOf('cookietest=') !== -1;
      // remove cookie
      document.cookie = 'cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT';
      return enabled;
    } catch (e) {
      return false;
    }
  },
  callRejectCallbacks: function callRejectCallbacks() {
    var base = this;
    if (typeof matomoRejectFunction !== "undefined") {
      matomoRejectFunction(base);
    }
    gsb.log('matomoReject called');
  },
  callConsentCallbacks: function callConsentCallbacks() {
    var base = this;
    if (typeof matomoConsentFunction !== "undefined") {
      matomoConsentFunction(base);
    }
    gsb.log('matomoConsent called');
  },
  onResize: function onResize(ev) {
    var base = ev.data;
  },
  addTrackingFormListeners: function addTrackingFormListeners() {
    var base = this,
        container = $('#matomoTracking'),
        enable = container.find('[name=matomoTracking][value=true]'),
        disable = container.find('[name=matomoTracking][value=false]');
    if (Cookies.get(base.options.trackingCookieName)) {
      enable.prop('checked', true);
    } else {
      disable.prop('checked', true);
    }
    enable.on('click', base, base.optionalCookiesConsent);
    disable.on('click', base, base.optionalCookiesReject);
  },
  setupLightbox: function setupLightbox() {
    var base = this,
        configUrl = base.$el.attr('data-gsb-tracking-config') || base.options.trackingConfigUrl;
    if (typeof configUrl !== "string") {
      base.makeRestricting();
    } else {
      $.ajax({
        url: configUrl,
        complete: base.mergeConfigAndInitializeLightbox,
        context: base
      });
    }
  },
  mergeConfigAndInitializeLightbox: function mergeConfigAndInitializeLightbox(jqXHR) {
    var base = this,
        data = jqXHR.responseJSON;
    if (data) {
      $.extend(true, base.options.trackingMarkup, data.trackingMarkup);
      $.extend(true, base.options.trackingSelectors, data.trackingSelectors);
      $.extend(true, base.options.trackingModules, data.trackingModules);
      base.options.trackingList = data.trackingList || base.options.trackingList;
    }
    base.makeRestricting();
  },
  makeRestricting: function makeRestricting() {
    var base = this,
        structure = $(base.options.trackingMarkup.structure),
        container = structure.find(base.options.trackingSelectors.container),
        trackingList = base.options.trackingList || [],
        trackingModules = base.options.trackingModules || {};

    base.$el.css("height", "auto").addClass(base.options.trackingClasses.restrictive);

    base.$el.contents().remove();

    container.append(base.buildModules(trackingList));
    container.append(base.buildButtons(trackingModules.buttons));

    base.$el.append(structure);

    base.$el.gsb_lightbox({
      selectors: {
        toggleHidden: base.options.pageElementsToHide
      },
      opener: $(),
      magnificOptions: {
        items: {
          src: base.$el,
          type: "inline"
        },
        closeOnBgClick: false,
        enableEscapeKey: false,
        showCloseBtn: false,
        callbacks: {
          open: function open() {
            $('body').addClass(base.options.bodyVisibleClass).removeClass(base.options.bodyHiddenClass);
          },
          close: function close() {
            $('body').addClass(base.options.bodyHiddenClass).removeClass(base.options.bodyVisibleClass);
          }
        } }
    }).off('click.magnificPopup'); // like lightbox in gallery mode, remove handler that cancels all click events

    if (!base.options.lightboxHidden && (!base.options.cookieName || !Cookies.get(base.options.cookieName))) {
      base.$el.magnificPopup('open');
    }

    $(document).on('cookieUpdate.gsb', base, base.onCookieUpdate);
    $(window).on("resize", base, base.onResize);
  },
  onCookieUpdate: function onCookieUpdate(ev) {
    var base = ev.data,
        detail = ev.detail,
        cookieName = detail && detail.cookieName,
        isNotRemoval = Boolean(detail && detail.removed),
        isNotSelfReport = Boolean(detail) && detail.moduleName !== base.moduleName,
        trackingModules = base.options.trackingModules || {},
        moduleList = Object.keys(trackingModules);
    if (isNotSelfReport && typeof cookieName === "string") {
      moduleList.forEach(function (id) {
        var module = trackingModules[id],
            binaryCookie = module.binaryCookie;
        var input = void 0;
        if (cookieName === binaryCookie) {
          input = base.$el.find(base.options.trackingSelectors.controlElement).filter('input[name=' + id + ']');
          if (isNotRemoval === input.prop('checked')) {
            input.trigger('click');
          }
        }
      });
    }
  },
  buildModules: function buildModules(moduleList) {
    var base = this,
        sections = [],
        trackingModules = base.options.trackingModules || {};

    moduleList.forEach(function (item) {
      var id = item.id,
          module = trackingModules[id],
          section = base.createSection(id);
      if (module && id !== "buttons") {
        module.id = id;
        module.subModules = item.subModules;
        sections.push(section[0]);
        if (module.build) {
          module.build.call(base, module, section);
        } else if (module.type === 'html' && module.markup) {
          base.insertMarkup(module, section);
        } else if (module.type === 'structured') {
          base.buildStructured(module, section);
        } else {
          sections.pop();
        }
      }
    });

    return $(sections);
  },
  createSection: function createSection(id) {
    var base = this;
    return $('<div/>').addClass(base.options.trackingClasses.section).attr('data-gsb-tracking-section', id);
  },
  insertMarkup: function insertMarkup(module, section) {
    var base = this;
    return $(module.markup).appendTo(section);
  },
  buildButtons: function buildButtons(module, section) {
    var base = this,
        buttonContent = $(base.options.trackingMarkup.buttons),
        confirmSelection = buttonContent.find(base.options.trackingSelectors.confirmSelection),
        consentToAll = buttonContent.find(base.options.trackingSelectors.consentToAll);
    confirmSelection.on('click', base, base.applyChoice).on('click', base, base.confirmModules);
    consentToAll.on('click', base, base.applyChoice).on('click', base, function (ev) {
      base.$el.find(base.options.trackingSelectors.controlElement).attr("checked", true);
      base.confirmModules(ev, true);
    });
    return base.createSection('buttons').append(buttonContent);
  },
  confirmModules: function confirmModules(ev, all) {
    var base = ev.data,
        trackingList = base.options.trackingList || [],
        trackingModules = base.options.trackingModules || {};
    var moduleList = trackingList.reduce(function (list, item) {
      if (!item || !item.subModules || !item.subModules.length) {
        return list.concat(item);
      } else {
        return list.concat(item.subModules);
      }
    }, []);
    moduleList.forEach(function (item) {
      var id = item.id,
          module = trackingModules[id],

      //input = base.$el.find(`input[name=${id}]`),
      input = base.$el.find(base.options.trackingSelectors.controlElement).filter('input[name=' + id + ']'),
          moduleConsent = input.length && (all || input.prop('checked')),
          moduleReject = input.length && !all && !input.prop('checked'),
          binaryCookie = module && module.binaryCookie;
      if (module) {
        if (module.required || moduleConsent) {
          gsb.debug(base.moduleName + ': user action (module ' + id + ') - consent');
          if (typeof binaryCookie === "string") {
            if (typeof module.consent !== "function" || module.consent.call(base, module) !== false) {
              base.setBinaryCookie(binaryCookie, module);
            }
          }
        } else if (moduleReject) {
          gsb.debug(base.moduleName + ': user action (module ' + id + ') - reject');
          if (typeof binaryCookie === "string") {
            if (typeof module.reject !== "function" || module.reject.call(base, module) !== false) {
              base.unsetBinaryCookie(binaryCookie, module);
            }
          }
        }
      }
    });
  },
  setBinaryCookie: function setBinaryCookie(binaryCookieName, module) {
    var base = this,
        cookieValue = String(true),
        cookieLifeTimeInDays = module && module.cookieLifeTimeInDays || base.options.trackingCookieLifeTimeInDays;
    Cookies.set(binaryCookieName, cookieValue, {
      expires: cookieLifeTimeInDays,
      path: '/'
    });
    $(document).trigger($.Event('cookieUpdate.gsb', {
      detail: {
        cookieName: binaryCookieName,
        moduleName: base.moduleName,
        value: cookieValue,
        removed: false
      }
    }));
  },
  unsetBinaryCookie: function unsetBinaryCookie(binaryCookieName, module) {
    var base = this;
    Cookies.remove(binaryCookieName);
    $(document).trigger($.Event('cookieUpdate.gsb', {
      detail: {
        cookieName: binaryCookieName,
        moduleName: base.moduleName,
        value: null,
        removed: true
      }
    }));
  },
  buildStructured: function buildStructured(module, section) {
    var base = this,
        hasSubModules = module.subModules && module.subModules.length,
        structure = module.structure,
        title = $(structure.title),
        headingId = title.attr('id') || base.generateID(),
        details = $(structure.details),
        detailsContainer = $('<div/>'),
        detailsId = base.generateID(),
        accordionContainer = $('<div/>');
    var container = $(structure.container).appendTo(section);

    if (!container.length) {
      container = section;
    }

    title.addClass(base.options.trackingClasses.sectionTitle).attr({
      id: headingId
    });
    if (title.length === 1 && (details.length > 0 || hasSubModules)) {
      detailsContainer.attr('id', detailsId);
      accordionContainer.append(title);
      detailsContainer.append(details);
      if (hasSubModules) {
        detailsContainer.append(base.buildModules(module.subModules));
      }
      accordionContainer.append(detailsContainer);
      container.append(accordionContainer);

      if (module.alwaysShowDetails === false) {
        accordionContainer.gsb_toggle({
          tab: false,
          accordion: true,
          heading: '#' + headingId, //workaround(gsb_toggle) - jQuery's on() method accepts only strings as delegate targets
          elements: detailsContainer,
          onRefresh: function onRefresh() {
            this.initialize();
            this.refreshAccordion();
          },
          responsive: []
        });
      }
    } else {
      container.append(title);
      container.append(details);
    }

    if (!hasSubModules) {
      container.append(base.createSectionToggle(module, headingId, details.length ? detailsId : null));
    }
  },
  createSectionToggle: function createSectionToggle(module, labelId, detailsId) {
    var base = this,
        moduleId = module.id,
        controlId = base.generateID(),
        control = $('<input/>'),
        label = $('<label/>').addClass(base.options.trackingClasses.controlLabel),
        controlContainer = $("<div/>"),
        required = Boolean(module.required),
        alreadyActive = module.binaryCookie ? Cookies.get(module.binaryCookie) : false,
        shouldCheck = required || alreadyActive,
        textModuleOff = module.labels && module.labels.moduleOff ? module.labels.moduleOff : base.options.labels.moduleOff,
        textModuleOn = module.labels && module.labels.moduleOn ? module.labels.moduleOn : base.options.labels.moduleOn;
    control.addClass(base.options.trackingClasses.controlElement).attr({
      id: controlId,
      name: moduleId,
      type: 'checkbox',
      checked: shouldCheck ? 'checked' : null,
      disabled: required ? 'disabled' : null,
      'aria-describedby': detailsId,
      'aria-labelledby': labelId
    }).prop('checked', shouldCheck).on('change', function (ev) {
      label.text(control.prop('checked') ? textModuleOn : textModuleOff);
    }).trigger('change');
    label.attr('for', controlId);
    return controlContainer.append(control).append(label);
  },
  show: function show() {
    var base = this,
        animationSpeed = base.options.animationSpeed;

    gsb.log('show banner position=' + base.options.position);
    if (base.options.positionRelative) {
      base.showPositionRelative();
    } else if (base.options.animation) {
      if (base.options.position === 'top') {
        base.$el.animate({ top: 0 }, animationSpeed);
      } else {
        base.$el.animate({ bottom: 0 }, animationSpeed);
      }
    } else {
      base.$el.css(base.options.position, 0);
    }
    base.$el.promise().done(function () {
      $('body').addClass(base.options.bodyVisibleClass).removeClass(base.options.bodyHiddenClass);
    });

    if (base.options.restrictAccess) {
      base.$el.finish();
    }
  },
  showPositionRelative: function showPositionRelative() {
    var base = this;
    if (base.options.position === 'top') {
      base.$el.addClass(base.options.positionRelativeClass);
      var $navSkipList = $(base.options.navSkipListSelector);
      if ($navSkipList.length > 0) {
        $navSkipList.after(base.$el);
      } else {
        gsb.warn('Das Cookiebanner wird vor dem <header>-Element eingebunden, weil \'' + base.options.navSkipListSelector + '\' nicht gefunden werden konnte.');
        $('header').before(base.$el);
      }
    } else {
      $(base.options.newBannerParentSelector).after(base.$el);
      $('.' + base.options.positionRelativePlaceholderClass).remove();
      $(base.options.newBannerParentSelector).after($('<div>').addClass(base.options.positionRelativePlaceholderClass).css('height', base.bannerHeight));
    }
    if (base.options.animation) {
      base.$el.finish().css({
        paddingTop: 0,
        paddingBottom: 0,
        height: 0
      }).animate({
        height: base.bannerHeight - base.options.topOffset,
        paddingTop: base.bannerPadding.top,
        paddingBottom: base.bannerPadding.bottom
      }, {
        duration: base.options.animationSpeed,
        complete: function complete() {
          base.$el.css('height', '');
        }
      });
    }
  },
  hide: function hide(ignoreAnimation) {
    var base = this;

    if (base.bannerHeight && base.options.animation && !ignoreAnimation) {
      if (base.options.position === 'top') {
        if (base.options.positionRelative) {
          base.$el.animate({ height: 0, paddingTop: 0, paddingBottom: 0 }, base.options.animationSpeed, function () {
            base.$el.css('display', 'none');
          });
        } else {
          base.$el.animate({ top: -base.bannerHeight }, base.options.animationSpeed, function () {
            base.$el.css('display', 'none');
          });
        }
      } else {
        base.$el.animate({ bottom: -base.bannerHeight }, base.options.animationSpeed, function () {
          base.$el.css('display', 'none');
          $('.' + base.options.positionRelativePlaceholderClass).remove();
        });
      }
    } else {
      base.$el.css('display', 'none');
    }
    base.$el.promise().done(function () {
      $('body').addClass(base.options.bodyHiddenClass).removeClass(base.options.bodyVisibleClass);
    });

    if (base.options.restrictAccess) {
      base.$el.finish();
    }
  },
  createBanner: function createBanner(triggeredByResponsiveListener) {
    var base = this;
    var button = base.$el.find(base.options.closeButton).first();

    if (!triggeredByResponsiveListener) {
      if (base.options.trackingEnabled) {
        if (!base.options.restrictAccess) {
          base.modifyButton(button);
          base.insertRejectButton(button);
        }
      } else {
        button.on('click', base, base.applyChoice);
      }
    }

    if (!base.options.restrictAccess) {
      base.handleAnimation(triggeredByResponsiveListener);
    }
  },
  modifyButton: function modifyButton(button) {
    var base = this,
        buttonText = base.options.restrictAccess ? base.options.labels.confirmSelection : base.options.labels.consent;
    button.parent().addClass(base.options.matomoButtonAddClassParent).removeClass(base.options.matomoButtonRemoveClassParent);

    button.text(buttonText).on('click', base, base.applyChoice).on('click', base, base.optionalCookiesConsent);
  },
  insertRejectButton: function insertRejectButton(button) {
    var base = this,
        rejectButton = button.clone().insertAfter(button);
    rejectButton.text(base.options.labels.reject).on('click', base, base.applyChoice).on('click', base, base.optionalCookiesReject);
  },
  applyChoice: function applyChoice(ev) {
    var base = ev.data;
    gsb.log('gsb_banner.click() > confirm');
    ev.preventDefault();
    ev.stopPropagation();

    if (base.options.restrictAccess) {
      $.magnificPopup.close();
    } else {
      // hide banner with or without animation
      base.hide();
    }
    base.setCookieClosed();
  },
  handleAnimation: function handleAnimation(triggeredByResponsiveListener) {
    var base = this;
    base.prepareState(triggeredByResponsiveListener);
    // hide banner
    base.$el.css(base.options.position, base.options.positionRelative ? 0 : -base.bannerHeight);
    // if no cookie
    if (!base.options.cookieName) {
      base.show();
    } else if (!Cookies.get(base.options.cookieName)) {
      gsb.log('gsb_banner.createBanner() > no cookie');
      // display banner with or without animation
      base.show();
    } else {
      gsb.log('gsb_banner.createBanner() > valid cookie > hide banner');
      // hide banner without animation
      base.hide(true);
    }
  },
  setCookieClosed: function setCookieClosed() {
    var base = this,
        cookieName = base.options.cookieName;
    if (typeof cookieName === "string") {
      gsb.debug(base.moduleName + ': setting cookie \'' + cookieName + '\' to \'closed\'');
      // set cookie with expiredate
      Cookies.set(cookieName, 'closed', {
        expires: base.options.bannerCookieLifeTimeInDays,
        path: '/'
      });
    } else {
      gsb.error(base.moduleName + ': cookieName is not a string. Banner will be shown on reload. This is only acceptable for debugging purposes.');
    }
  },
  prepareState: function prepareState(reset) {
    var base = this;
    if (reset) {
      base.$el.css({
        paddingTop: '',
        paddingBottom: '',
        height: ''
      });
    }
    base.bannerHeight = !reset && base.bannerHeight && base.options.position === 'top' ? base.bannerHeight : base.$el.outerHeight() + base.options.topOffset;
    base.bannerPadding = !reset && base.bannerPadding ? base.bannerPadding : {
      top: base.$el.css('padding-top'),
      bottom: base.$el.css('padding-bottom')
    };
  },
  optionalCookiesConsent: function optionalCookiesConsent(ev) {
    var base = ev ? ev.data : this;
    var consent = base.$el.find('[name=' + base.options.trackingCookieName + ']').prop("checked");
    var optOut = $('[name=matomoTracking][value=true]').prop("checked");
    base.setCookieClosed();
    if (base.options.restrictAccess && consent || !base.options.restrictAccess || optOut) {
      base.callConsentCallbacks();
      Cookies.set(base.options.trackingCookieName, true, {
        expires: base.options.trackingCookieLifeTimeInDays,
        path: '/'
      });
    }
  },
  optionalCookiesReject: function optionalCookiesReject(ev) {
    var base = ev ? ev.data : this;
    base.setCookieClosed();
    base.callRejectCallbacks();
    Cookies.remove(base.options.trackingCookieName);
  },
  generateID: function generateID() {
    return gsb.aria.prototype.generateID();
  },
  defaultOptions: {
    animation: false,
    animationSpeed: 1800,
    position: 'bottom',
    topOffset: 20,
    closeButton: '.close',
    bodyVisibleClass: 'banner-visible',
    bodyHiddenClass: 'banner-hidden',
    newBannerParentSelector: "footer",
    positionRelativeClass: 'cookiebanner__relative',
    positionRelativePlaceholderClass: 'cookiebanner__placeholder',
    cookieName: 'gsbbanner',
    trackingCookieName: 'matomoTracking',
    bannerCookieLifeTimeInDays: 30,
    respondToEvents: true,
    positionRelative: true, // make room for the cookiebanner in the dom to not overlay content
    navSkipListSelector: 'ul.navSkip', // used if positionRelative is true
    trackingEnabled: false, // if false, restrictAccess will not be applied
    matomoButtonAddClassParent: 'button-row',
    matomoButtonRemoveClassParent: 'all',
    restrictAccess: false, // start banner in a lightbox, disable all other elements
    lightboxHidden: false,
    pageElementsToHide: '.wrapperInner, .previewhint, .c-preview-hint',
    trackingCookieLifeTimeInDays: 30,
    respectDoNotTrack: false,
    labels: {
      consent: typeof TRACKING_CONSENT !== "undefined" ? TRACKING_CONSENT : 'Consent',
      reject: typeof TRACKING_DISSENT !== "undefined" ? TRACKING_DISSENT : 'Reject',
      confirmSelection: typeof TRACKING_CONFIRM !== "undefined" ? TRACKING_CONFIRM : 'Auswahl bestätigen',
      consentToAll: typeof TRACKING_CONSENT_TO_ALL !== "undefined" ? TRACKING_CONSENT_TO_ALL : 'Alle auswählen',
      moduleOn: typeof TRACKING_MODULE_ON !== "undefined" ? TRACKING_MODULE_ON : 'ausschalten',
      moduleOff: typeof TRACKING_MODULE_OFF !== "undefined" ? TRACKING_MODULE_OFF : 'einschalten'
    },
    onRefresh: function onRefresh() {
      this.createBanner(true);
    },
    trackingConfigUrl: null,
    trackingMarkup: {
      structure: '' + '<div class="cookiebannerbox">\n          <div class="row">\n            <div class="column small-12 js-banner__container"></div>\n          </div>\n        </div>',
      buttons: '' + '<div class="shrink text-right">\n          <p class="button-row">\n            <button type="button" class="c-button close confirmSelection js-banner-button-confirm-selection">Auswahl best\xE4tigen1</button><button type="button" class="c-button close consentToAll js-banner-button-consent-to-all">Alle ausw\xE4hlen2</button>\n          </p>\n        </div>'
    },
    trackingSelectors: {
      confirmSelection: '.js-banner-button-confirm-selection',
      consentToAll: '.js-banner-button-consent-to-all',
      container: '.js-banner__container',
      controlElement: '.js-banner-control__element'
    },
    trackingClasses: {
      controlElement: 'cookiebanner-control__element js-banner-control__element',
      controlLabel: 'cookiebanner-control__label',
      restrictive: 'cookiebanner__restrictive',
      section: 'cookiebanner-section',
      sectionTitle: 'cookiebanner-section__title'
    },
    trackingList: [{
      id: 'preamble'
    }, {
      id: 'necessary'
    }, {
      id: 'matomo'
    }],
    trackingModules: {
      preamble: {
        type: 'html',
        markup: '' + '<h1>Hinweis zur Verwendung von Cookies</h1>\n           <p>Cookies erleichtern die Bereitstellung unserer Dienste. Mit der Nutzung unserer Dienste erkl\xE4ren Sie sich damit einverstanden,\n              dass wir Cookies verwenden. Weitere Informationen zum Datenschutz erhalten Sie \xFCber den folgenden Link:\n              <a class="RichTextIntLink NavNode" href="/datenschutz" title="Datenschutz">Datenschutz</a>\n           </p>'
      },
      necessary: {
        type: 'structured',
        required: true,
        alwaysShowDetails: true,
        structure: {
          title: '<h2>Notwendige Cookies</h2>',
          details: '<p>Lorem Ipsum dolor sit amet</p>'
        },
        labels: {
          moduleOff: 'kann nicht deaktiviert werden',
          moduleOn: 'immer aktiv'
        }
      },
      matomo: {
        type: 'structured',
        binaryCookie: 'matomoTracking',
        alwaysShowDetails: true,
        structure: {
          title: '<h2>' + (typeof TRACKING_OPTIONAL !== "undefined" ? TRACKING_OPTIONAL : 'Statistik') + '</h2>',
          details: '<p>' + (typeof TRACKING_HINT !== "undefined" ? TRACKING_HINT : 'Lorem ipsum Lorem ipsum <a href="#">dolor</a> Lorem ipsum Lorem ipsum Lorem ipsum') + '</p>'
        },
        labels: {
          moduleOff: 'Statistik-Tracker einschalten',
          moduleOn: 'Statistik-Tracker ausschalten'
        }
      }
    }
  }
});
   /* Ende gsb_banner */
   /* Start gsb_bkgMap */
   ;(function ($) {
  "use strict";
  if (!$.gsb) {
    $.gsb = {};
  }
  $.gsb.bkgMap = function bkgMap(el, options) {
    var base = Object.create(bkgMap.prototype);
    base.$el = $(el);
    base.el = el;
    base.moduleName = "gsb.bkgMap";
    base.$el.data(base.moduleName, base);
    base.options = $.extend(true, {}, $.gsb.bkgMap.defaultOptions, options);
    base.init();
  };
  $.gsb.bkgMap.prototype = {
    init: function init() {
      var base = this;
      base.data = [];
      base.data.push({
        geo: [parseFloat(base.$el.attr('data-geoLon')), parseFloat(base.$el.attr('data-geoLat'))],
        markerIcon: image_url_gmaps_marker,
        isActive: true
      });
      base.$el.gsb_map();
      base.gsbMapInstance = base.$el.data("gsb.map");
      base.gsbMapInstance.data = base.data;
      base.gsbMapInstance.options.markerScale = 1;
      base.createMap();
    },
    createMap: function createMap() {
      var base = this;
      base.map = new ol.Map({
        target: base.$el.get(0),
        layers: base.gsbMapInstance.createLayers(),
        view: new ol.View({ center: base.gsbMapInstance.markerLayer.getSource().getExtent(), zoom: 15 }),
        overlays: base.gsbMapInstance.createOverlays(),
        controls: base.gsbMapInstance.createControls(),
        pixelRatio: 1
      });
    }
  };
  $.gsb.bkgMap.defaultOptions = {
    //responsiveListener options
    respondToEvents: true,
    onRefresh: function onRefresh() {},
    responsive: [{
      breakpoint: 480,
      onRefresh: function onRefresh() {
        //do nothing
      }
    }]
  };
  $.fn.gsb_bkgMap = function (options) {
    return this.each(function () {
      $.gsb.bkgMap(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_bkgMap */
   /* Start gsb_calendar */
   /*!
* --GSBDocStart
 * @module gsb_calendar
 * @version 1.0.0 
 * @see {@link http://semver.org|Semantic Versioning}
 * @author pespeloe
 *
 * @desc Kalendar-Modul für die Marginalspalte
 * GSB-Plugin zur Animation und zum Nachladen von Kalender
 * 
 * @init
 * $('#supplement .live-calendar').gsb_calendar({
 *   beforeInit: function(){
 *     $('#supplement .live-calendar').find('.has-tip').each(function(_, el){
 *       $('#' + $(el).attr('aria-describedby')).remove();
 *     });
 *   },
 *   afterInit: function afterInit(){
 *     $('#supplement .live-calendar').find('abbr, acronym').gsb_tooltip().foundation();
 *   }
 * });
 *--GSBDocEnd
 */
(function($){if(!$.gsb){$.gsb={};}$.gsb.calendar=function(el,options){var base=this;base.$el=$(el);base.el=el;base.$el.data("gsb.calendar",base);base.init=function(){base.options=$.extend({},$.gsb.calendar.defaultOptions,options);options=base.options;base.$el.on("click touchstart","td > a",function(e){e.preventDefault();e.stopPropagation();if($(this).parent().hasClass(options.detailsOpenedClass)){$(this).parent().removeClass(options.detailsOpenedClass).addClass(options.detailsClosedClass);}else{base.$el.find("."+options.detailsOpenedClass).removeClass(options.detailsOpenedClass);$(this).parent().removeClass(options.detailsClosedClass).addClass(options.detailsOpenedClass);}});base.$el.on("click touchstart",options.prevButton,function(e){e.preventDefault();e.stopPropagation();base.loadCalendar($(this).data("href"));});base.$el.on("click touchstart",options.nextButton,function(e){e.preventDefault();e.stopPropagation();base.loadCalendar($(this).data("href"));});};base.loadCalendar=function(href){if(typeof options.beforeInit==="function"){base.options.beforeInit.call($(this),base.$el);}base.$el.fadeTo(options.duration,0,function(){base.$el.load(href,function(){base.$el.fadeTo(options.duration,1,function(){base.addA11y();if(typeof options.afterInit==="function"){base.options.afterInit.call($(this),base.$el);}});});});};base.addA11y=function(elem){elem=elem||base.$el;var focusElements=elem.find("input,textarea,select,a,button").not(":hidden");focusElements[0].focus();};base.init();};$.gsb.calendar.defaultOptions={nextButton:".next > a",prevButton:".prev > a",fadeDuration:400,detailsOpenedClass:"opened",detailsClosedClass:"closed",beforeInit:undefined,afterInit:undefined};$.fn.gsb_calendar=function(options){return this.each(function(){(new $.gsb.calendar(this,options));});};})(jQuery);
   /* Ende gsb_calendar */
   /* Start gsb_clearfields */
   /*!
* --GSBDocStart
 * @module gsb_clearfields
 * @version 1.0.0 
 * @see {@link http://semver.org|Semantic Versioning}
 * @author sbaecker
 *
 * @desc GSB-Plugin zum autom. Leeren von Text-Input-Feldern
 * Script löscht die Text-Vorbelegung der unter Feld "Parameter" eingehängten Textfelder
 * 
 * @init
 *  $.gsb_clearfields();
 *--GSBDocEnd
 */
(function($){jQuery.fn.attachToField=function(id,defaultValue){var field=$("#"+id);var input_text=field.attr("value");return jQuery(field).bind("focus",function(){if(input_text==defaultValue){field.attr("value","");}}).bind("blur",function(){if(field.attr("value")==""){field.attr("value",input_text);}input_text=field.attr("value");});};})(jQuery);
   /* Ende gsb_clearfields */
   /* Start gsb_lightbox */
   /*!!
 * @module gsb_lightbox
 * @version 2.1.0
 * - 2.1.0: jelseber: Ergänzung für Bildnachweis
 * - 2.0.0: jelseber: Verwendung von inline svgs als Pfeile für die galleryBox lightbox. Mandantenspezifische Lösung
 * @see {@link http://semver.org|Semantic Versioning}
 * @desc GSB-Wrapper-Plugin fuer magnific popup
 *
 *
 * @requires {@link external:jQuery}
 * @requires {@link external:magnific-popup}
 * @requires {@link external:hammerjs}
 * @requires {@link external:jquery-hammerjs}
 *
 * @author rkrusenb
 */
(function($){if(!$.gsb){$.gsb={};}$.gsb.lightbox=function lightbx(el,userOptions){var lightbox=Object.create(lightbx.prototype);var $el=lightbox.$el=$(el);var options,disabled;lightbox.openerClickHandler=function(ev){if(!disabled){if(ev&&typeof ev.preventDefault==="function"){ev.preventDefault();}$el.data("magnificPopup").index=$(this).data("gsb.lightboxopener").index;}$el.magnificPopup("open");};function checkArrowState(mfp){if(!options.cycle&&mfp.arrowLeft&&mfp.arrowRight){if(mfp.index===0){mfp.arrowLeft.addClass("inactive");mfp.arrowLeft.html(options.imagePrevInactive);}else{mfp.arrowLeft.removeClass("inactive");mfp.arrowLeft.html(options.imagePrev);}if(mfp.index===mfp.items.length-1){mfp.arrowRight.addClass("inactive");mfp.arrowRight.html(options.imageNextInactive);}else{mfp.arrowRight.removeClass("inactive");mfp.arrowRight.html(options.imageNext);}}}lightbox.makeGallery=function(){$(options.selectors.header+", "+options.selectors.main+", "+options.selectors.footer).attr("aria-hidden",true);options.reallyMagnificOptions.callbacks.open=function(){var mfp=this;mfp.wrap.find(".mfp-close").appendTo(mfp.contentContainer);if(options.imagePrev){$(".mfp-arrow-left").append(options.imagePrev);}if(options.imageNext){$(".mfp-arrow-right").append(options.imageNext);}mfp.prev=function(){if(options.cycle||mfp.index!==0){$.magnificPopup.proto.prev.call(this);}};mfp.next=function(){if(options.cycle||mfp.index!==mfp.items.length-1){$.magnificPopup.proto.next.call(this);}};checkArrowState(this);if(typeof mfp.contentContainer.hammer==="function"&&!mfp.wrap.data("gsb.swipe")){mfp.contentContainer.hammer({drag_block_horizontal:true,stop_browser_behavior:{touchAction:"auto"},swipe_velocity:0.3}).on("swiperight",function(){mfp.prev();}).on("swipeleft",function(){mfp.next();}).data("gsb.swipe",{});}if(options.preloadImages){mfp.items.forEach(function(el){var src=el.src&&el.src.jquery?el.src:null;if(!src){return;}src.find("img").each(function(){var $img=$(this),src=$img.attr("src"),altSrc=$img.attr("data-src");if(src===undefined&&altSrc!==undefined){$img.attr("src",altSrc);}});});}};options.reallyMagnificOptions.callbacks.change=function(){checkArrowState(this);};$.extend(true,options.reallyMagnificOptions,{items:$.map($(this).find(options.element),function(item){return{src:$(item).clone().find(".loupe").remove().end().removeClass("slick-slide").attr("style",null),type:"inline"};})},(userOptions||{}).magnificOptions);$el.magnificPopup(options.reallyMagnificOptions).unbind("click");};lightbox.el=el;lightbox.$el.data("gsb.lightbox",lightbox);lightbox.init=function(){gsb.log("gsb_lightbox.init()");var url,closeText,defer;options=lightbox.options=$.extend(true,{},$.gsb.lightbox.defaultOptions,userOptions);options.reallyMagnificOptions=$.extend(true,{},$.gsb.lightbox.defaultOptions.magnificOptions);closeText=options.magnificOptions.tClose;$.extend(true,options.reallyMagnificOptions,{disableOn:function disableOn(){return !disabled;},closeMarkup:'<button class="mfp-close">%title%</button>'});if(options.lightboxType==="single"){url=$el.data("lightbox-href");if(url){options.reallyMagnificOptions.type="ajax";options.reallyMagnificOptions.ajax.settings.url=url;}else{if($el.parents(options.element).length){if(options.getMethod==="inline"){options.reallyMagnificOptions.type="inline";}else{options.reallyMagnificOptions.type="image";}}}if(options.getMethod==="inline"){$.extend(options.reallyMagnificOptions,{items:{src:$(options.element),type:"inline"}},(userOptions||{}).magnificOptions);}else{$.extend(options.reallyMagnificOptions,(userOptions||{}).magnificOptions);}$el.magnificPopup(options.reallyMagnificOptions);}else{if(options.lightboxType==="multiple"){url=$el.data("lightbox-href");if(url){$("<div />").load(url,lightbox.makeGallery);}else{$el.on("init.slideshow.gsb",lightbox.makeGallery);}$el.on("init.slideshow.gsb",function(){$el.find(options.opener).each(function(idx){var opener=$(this),openerData=opener.data("gsb.lightboxopener")||{};openerData.index=idx;opener.data("gsb.lightboxopener",openerData);opener.click(lightbox.openerClickHandler).keydown(function(e){if(e.which===23){$(this).click();}});});});$.extend(true,options.reallyMagnificOptions,{gallery:{enabled:true}});$.extend(true,options.reallyMagnificOptions,(userOptions||{}).magnificOptions);}}gsb.log("gsb_lightbox.options lightboxType="+options.lightboxType+" url="+url);};lightbox.closeLightbox=function(){$el.magnificPopup("close");};lightbox.disable=function(){disabled=true;};lightbox.enable=function(){disabled=false;};lightbox.addA11y=function(){};lightbox.init();};$.gsb.lightbox.defaultOptions={selectors:{header:"header",main:"main",footer:"footer"},lightboxType:"single",cycle:false,element:".picture",opener:".loupe",imagePrev:"",imageNext:"",preloadImages:true,magnificOptions:{tClose:typeof CLOSE==="undefined"?"Schließen (Esc)":CLOSE,gallery:{tPrev:typeof PREV==="undefined"?"Vorheriges (linke Pfeiltaste)":PREV,tNext:typeof NEXT==="undefined"?"Nächstes (rechte Pfeiltaste)":NEXT,tCounter:typeof LIGHTBOX_X_OF_Y==="undefined"?"%curr% von %total%":LIGHTBOX_X_OF_Y},type:"ajax",closeOnContentClick:false,closeBtnInside:false,image:{verticalFit:true,titleSrc:function titleSrc(){return $(this.currItem&&this.currItem.el).find("img").attr("alt");}},ajax:{settings:{}},callbacks:{afterChange:function afterChange(){$(this.content).find("video, audio").each(function(_,el){var data=$(el).data("gsb.Multimedia");if(!data){data=$(el).gsb_Multimedia().data("gsb.Multimedia");}if(!data.workaround&&typeof data.triggerRefresh==="function"){data.workaround=true;data.triggerRefresh();}});$(this.content).find("img").each(function(){var $img=$(this),src=$img.attr("src"),altSrc=$img.attr("data-src");if(src===undefined&&altSrc!==undefined){$img.attr("src",altSrc);}});},buildControls:function buildControls(){if(this.contentContainer&&this.arrowLeft&&this.arrowRight){this.contentContainer.append(this.arrowLeft.add(this.arrowRight));}},open:function open(){$("header, main, footer").attr("aria-hidden",true);if(this.wrap&&this.wrap.find){this.wrap.find(".mfp-close").appendTo(this.contentContainer);}},close:function close(){$("header, main, footer").attr("aria-hidden",false);}}}};$.fn.gsb_lightbox=function(options){return this.each(function(){$.gsb.lightbox(this,options);});};})(jQuery);
   /* Ende gsb_lightbox */
   /* Start gsb_imageSourceLightbox */
   /**
 * @name gsb_imageSourceLightbox
 * @version 0.0.1
 * @see {@link http://semver.org|Semantic Versioning}
 * @author rkrusenb
 *
 * @desc Modulbeschreibung (TODO)
 *
 * @requires  {@link external:jQuery}
 * @requires  {@link external:Foundation.util.imageLoader}
 *
 * @example
 * // lightbox: Bildnachweis
 * $('.js-bildnachweis-lightbox').gsb_imageSourceLightbox({
 *   images: $('#content, #supplement, .c-stage').find('img:visible')
 * });
 */
;(function ($) {
  "use strict";

  if (!$.gsb) {
    $.gsb = {};
  }

  $.gsb.imageSourceLightbox = function imageSourceLightbox(el, options) {
    var base = Object.create(imageSourceLightbox.prototype);
    base.$el = $(el);
    base.el = el;
    base.moduleName = "gsb.imageSourceLightbox";
    base.$el.data(base.moduleName, base);
    base.options = $.extend(true, {}, $.gsb.imageSourceLightbox.defaultOptions, options);

    base.init();
  };

  $.gsb.imageSourceLightbox.prototype = {
    init: function init() {
      var base = this,
          ignoredImages = $(base.options.selectors.ignoredImages, base.el),
          nachweisImages = $(base.options.images, base.el).not(ignoredImages);

      //consider deleting this after initial testing
      gsb.log("gsb_imageSourceLightbox::init");

      base.opener = base.$el.find('.js-bildnachweis-lightbox-opener');
      base.content = base.$el.find('.js-bildnachweis-lightbox-content');
      base.nachweisContainer = base.content.find(base.options.selectors.nachweisContainer);
      base.nachweisTemplate = base.nachweisContainer.html();

      base.opener.gsb_lightbox({
        element: base.content,
        getMethod: 'inline'
      }).on('click', base, base.updateContent);

      Foundation.onImagesLoaded(nachweisImages, function () {
        base.updateContent();
      });
    },
    updateContent: function updateContent(ev) {
      var base = ev ? ev.data : this,
          ignoredImages = $(base.options.selectors.ignoredImages, base.el),
          nachweisImages = $(base.options.images, base.el).not(ignoredImages),
          nachweisContainer = base.nachweisContainer,
          nachweisTemplate = base.nachweisTemplate;
      if (nachweisImages.length > 0) {
        base.opener.show();
        nachweisContainer.empty();
        nachweisImages.each(function () {
          var image = $(this).clone(true),
              imageSource = image.attr(base.options.attributes.imageSource),
              imageTitle = image.attr(base.options.attributes.imageTitle),
              nachweisElem = void 0;
          image.addClass(base.options.classes.thumbnail);
          if (imageSource !== undefined) {
            nachweisElem = $(nachweisTemplate);
            nachweisElem.find(base.options.selectors.sourceContainer).html(imageSource);
            if (imageTitle !== undefined) {
              nachweisElem.find(base.options.selectors.titleContainer).html(imageTitle);
            }
            nachweisElem.find(base.options.selectors.imageContainer).append(image);
            nachweisContainer.append(nachweisElem);
          }
        });
      }
    }
  };

  $.gsb.imageSourceLightbox.defaultOptions = {
    images: 'img',
    attributes: {
      imageSource: 'data-source',
      imageTitle: 'data-title'
    },
    classes: {
      thumbnail: 'c-topiclist__img'
    },
    selectors: {
      ignoredImages: '.js-bildnachweis-lightbox-ignore',
      imageContainer: '.js-bildnachweis-image-container',
      nachweisContainer: '.js-bildnachweis-list',
      sourceContainer: '.js-bildnachweis-source-container',
      titleContainer: '.js-bildnachweis-title-container'
    }
  };

  $.fn.gsb_imageSourceLightbox = function (options) {
    return this.each(function () {
      $.gsb.imageSourceLightbox(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_imageSourceLightbox */
   /* Start gsb_navigation */
   /*!
 * Licensed under the MIT license
* --GSBDocStart
 * @module gsb_navigation
 * @version 1.1.0
 * @see {@link http://semver.org|Semantic Versioning}
 * @author pespeloe
 *
 * @desc Das Addon dient der Darstellung des Flyout-Menüs auf der Seite
 *
 * @requires jQuery >= 1.11.1, gsb_responsiveListener
 *
 * @init
 *  $('#navPrimary').gsb_navigation();
 *--GSBDocEnd
 * */
(function($){if(!$.gsb){$.gsb={};}$.gsb.navigation=function(el,options){var base=this;base.$el=$(el);base.el=el;base.$el.data("gsb.navigation",base);base.init=function(){base.options=$.extend({},$.gsb.navigation.defaultOptions,options);base.delegateTo="#"+base.$el.attr("id")+base.options.hoverItem;base.$el.gsb_responsiveListener(base);};base._largeNavigation=function(){$(base.delegateTo).each(function(){var li=$(this),sub=li.find("li a"),ctrl=li.find("a").not(sub);li.find("a").on("focusin",function(e){li.find(base.options.displayItem).css({height:""});li.trigger("mouseenter",[!$(e.target).is(ctrl)||$(base.delegateTo).find(e.target).length]);li.siblings(".hovered").trigger("mouseleave");});li.find("a:first, a:last").blur(function(e){li.find(base.options.displayItem).css({height:0});});});$(base.delegateTo).on("mouseenter mouseleave",function(e,fromWithin){e.stopImmediatePropagation();var $box=$(this).find(base.options.displayItem).show().stop(),$height=$box.data("gsb.navigation.fullHeight"),$root=$(this),$relatedTarget=$(base.delegateTo).find(e.relatedTarget);if(!$height){$height=$box.outerHeight();$box.data("gsb.navigation.fullHeight",$height);}if(e.type==="mouseenter"){if(!fromWithin&&!$relatedTarget.length){$box.addClass("on").css({height:0,opacity:0}).animate({height:$height,opacity:1},{duration:base.options.animSpeed});}else{$box.addClass("on").css({height:$height,opacity:1});}$root.addClass("hovered");gsb.log("gsb.navigation: Add root class 'hovered' for nav node '"+$root.find("h3 > a").text()+"'");}else{if(!fromWithin&&!$relatedTarget.length){$box.removeClass("on").css({height:$height,opacity:1}).animate({height:0,opacity:0},{duration:base.options.animSpeed});}else{$box.removeClass("on").css({height:0,opacity:0});}$root.removeClass("hovered");gsb.log("gsb.navigation: Remove root class 'hovered' for nav node '"+$root.find("h3 > a").text()+"'");}});base.$el.find(base.options.navTouchElement).on("touchstart",function(e){var $box=$(this).find(base.options.displayItem).stop(),$root=$(this).children("div");if($(this).parent().parent().hasClass("hovered")){e.preventDefault();}});},base.init();};$.gsb.navigation.defaultOptions={navTouchElement:"h3 > a",displayItem:".menu-box",hoverItem:"> ul > li",animSpeed:500,respondToEvents:true,onRefresh:function(){this._largeNavigation();},responsive:[{breakpoint:1024,onRefresh:function(){}}]};$.fn.gsb_navigation=function(options){return this.each(function(){(new $.gsb.navigation(this,options));});};})(jQuery);
   /* Ende gsb_navigation */
   /* Start gsb_serviceborder */
   /* --GSBDocStart
 * @name: @gsb/gsb_serviceborder
 * @version: 3.0.1
 * @repository:
 * @description: GSB-Plugin fuer Serviceleiste unter der Buehne
 * --GSBDocEnd
*/
gsb.makeGSBModule('gsb.Serviceborder', {
  init: function init() {
    var base = this;
    gsb.log('gsb_serviceborder.init()');
    base.navnodes = base.$el.find(base.options.navnodes);
    base.$el.gsb_responsiveListener(base);
  },
  _configuration: function _configuration() {
    var base = this;
    base.closeclick = false;
    // Tab-Navigation einrichten
    if (base.navnodes.find('span.aural').length === 0) {
      base.navnodes.append('<span class="aural"> ' + base.options.show_more_text + '</span>');
    }
    base.navnodes.on('click.serviceborder.gsb', base, base.onClickNavNode).each(function () {
      var $opener = $(this);
      $(base.options.container + base.getTabNum($opener)).data(base.moduleName, { opener: $opener });
    });
    // Nummer des aktiven Tabs und des Tabs, der als nächstes angezeigt werden soll
    base.tabActive = false;
    base.tabToShow = false;
    base.$containers = base.$el.find('[id^=' + String(base.options.container).slice(1) + ']');
    base.addCloseButtons();
  },
  addCloseButtons: function addCloseButtons() {
    var base = this;
    base.$containers.each(function () {
      var $cont = $(this),
          $closeButton;
      // Wenn nicht vorhanden, Schließen-Button hinzufügen
      if (!$cont.find('.containerinner .close').length) {
        if (base.options.close_button_markup_mode === 'image') {
          $closeButton = $('<button tabindex="0" class="close" title="' + base.options.close + '" >' + '<img src="' + image_url_close + '" alt="' + base.options.close + '" />' + '</button>');
        } else {
          $closeButton = $('<button tabindex="0" class="close">' + base.options.close + '</button>');
        }
        $cont.find('> .containerinner:first').append($('<p/>').append($closeButton));
      }
    });
    base.$el.find('.close').on('click.serviceborder.gsb', base, base.onClickCloseButton);
  },
  onClickNavNode: function onClickNavNode(ev) {
    var base = ev.data;
    ev.preventDefault();
    ev.stopPropagation();
    base.showTab($(this));
    return false;
  },
  getTabNum: function getTabNum($elem) {
    var match = $elem.parent('li:first').attr('class').match(/^.*\w+-(\w+)-(\d+)( .*)?$/);
    return match ? match[2] : '';
  },
  showTab: function showTab($elem) {
    var base = this,
        tabActiveId,
        $tabActive,
        tabToShowId;
    if ($elem) {
      // Tab-Nummer aus Klassenname des li über Link parsen
      base.tabToShow = base.getTabNum($elem);
    } else {
      // Tabs schließen
      base.closeclick = true;
      base.tabToShow = false;
    }
    //Klick auf das Icon eines bereits geöffneten tabs
    if (base.tabActive === base.tabToShow) {
      tabActiveId = base.options.container + base.tabActive;
      $tabActive = base.$el.find(tabActiveId);
      $tabActive.stop(true, true).fadeOut({ duration: base.options.fadeDuration, easing: 'linear', queue: false }).slideUp({ duration: base.options.slideDuration, easing: 'linear' });
      base.tabActive = false;
      // Tab-Überschriften deaktivieren
      base.$el.find(' ul > li .aural').text(' ' + base.options.show_more_text);
      base.$el.find(' ul > li').removeClass('active');
      base.navnodes.attr('aria-expanded', false);
    } else {
      // Wenn Tab nicht bereits angezeigt wird
      if (base.tabToShow !== base.tabActive && false !== base.tabToShow) {
        // Tab-Elemente abrufen
        tabToShowId = base.options.container + base.tabToShow;
        base.$tabToShow = base.$el.find(tabToShowId);
        if (!base.$tabToShow.length) {
          gsb.error('Tab ' + tabToShowId + ' nicht vorhanden...');
          return;
        }
        // Ist gerade ein Tab geöffnet? => Ausblenden
        if (false !== base.tabActive) {
          tabActiveId = base.options.container + base.tabActive;
          $tabActive = base.$el.find(tabActiveId);
          $tabActive.slideUp();
        } else {
          base.$tabToShow.stop(true, true).fadeIn({ duration: base.options.fadeDuration, easing: 'linear', queue: false }).css('display', 'none').slideDown({ duration: base.options.slideDuration, easing: 'linear' });
        }
        // Neuen Tab einblenden
        base.$tabToShow.slideDown();
        base.tabActive = base.tabToShow;
        base.$tabToShow.find(base.options.focusables).not('[tabindex=1]').first().focus();
        // Entsprechende Tab-Überschrift aktivieren
        base.$el.find(' ul > li span.aural').text(' ' + base.options.show_more_text);
        base.$el.find(' ul > li').removeClass('active');
        base.navnodes.attr('aria-expanded', false);
        $elem.attr('aria-expanded', true).parent(':first').addClass('active');
        base.$el.find(' ul > li.active .aural').text(' ' + base.options.show_less_text);
      } else if (false === base.tabToShow && false !== base.tabActive) {
        // Tab schließen
        tabActiveId = base.options.container + base.tabActive;
        $tabActive = base.$el.find(tabActiveId);
        if (base.closeclick === true) {
          $tabActive.slideUp('fast');
          base.closeclick = false;
        } else {
          $tabActive.hide();
        }
        base.tabActive = false;
        // Tab-Überschriften deaktivieren
        base.$el.find(' ul > li span.aural').text(' ' + base.options.show_more_text);
        base.$el.find(' ul > li').removeClass('active');
        base.navnodes.attr('aria-expanded', false);
      }
    }
  },
  onClickCloseButton: function onClickCloseButton(ev) {
    var base = ev.data,
        tabData,
        tabActiveId = base.options.container + base.tabActive;
    ev.preventDefault();
    ev.stopPropagation();
    // Tab schließen
    base.$tabToShow.stop(true, true).fadeOut({ duration: base.options.fadeDuration, easing: 'linear', queue: false }).slideUp({ duration: base.options.slideDuration, easing: 'linear' });
    tabData = base.$tabToShow.data(base.moduleName);
    if (tabData && tabData.opener) {
      tabData.opener.focus();
    }
    base.tabActive = false;
    // Tab-Überschriften deaktivieren
    base.$el.find(' ul > li span.aural').text(' ' + base.options.show_more_text);
    base.$el.find(' ul > li').removeClass('active');
    base.navnodes.attr('aria-expanded', false);
  },
  _uninit: function _uninit() {
    var base = this;
    //Deaktivieren der Tab-Schließen Links
    var closeLink = base.$el.find('a.close');
    if (closeLink.length > 0) {
      if (closeLink.closest('p').length > 0) {
        closeLink.closest('p').off('click.serviceborder.gsb');
      } else {
        closeLink.off('click.serviceborder.gsb');
      }
    }
    base.$el.find('div .close').off('click.serviceborder.gsb');
    //Deaktivieren der Tabs
    base.navnodes.off('click.serviceborder.gsb');
    //Falls noch Tabs geöffnet waren -> schließen
    base.$el.find('.container').hide();
    base.$el.find(' ul > li span.aural').text(' ' + base.options.show_more_text);
    base.$el.find(' ul > li').removeClass('active');
    base.navnodes.attr('aria-expanded', false);
    if (base.$containers) {
      // Falls _configuration ausgeführt wurde, das Data Object der base.$containers leeren
      base.$containers.removeData();
    }
  },
  defaultOptions: {
    close: typeof CLOSE === 'undefined' ? 'Schließen' : CLOSE,
    close_button_markup_mode: 'image',
    navnodes: ' > ul > li > a',
    container: '#section-',
    focusables: 'a[href], area, input, button, select, textarea, audio, video, [tabindex]',
    show_more_text: typeof SHOW_MORE === 'undefined' ? 'Mehr anzeigen' : SHOW_MORE,
    show_less_text: typeof SHOW_LESS === 'undefined' ? 'Weniger anzeigen' : SHOW_LESS,
    slideDuration: 400, //MUST be integer; 200 = fast, 400 = default, 600 = slow
    fadeDuration: 600,
    respondToEvents: true,
    onRefresh: function onRefresh() {
      this._configuration();
    },
    responsive: [{
      breakpoint: 600,
      onRefresh: function onRefresh() {
        this._uninit();
      }
    }]
  }
});
   /* Ende gsb_serviceborder */
   /* Start gsb_print */
   /*!
 * --GSBDocStart
 * @module gsb_print
 * @version 1.0.0
 * @see {@link http://semver.org|Semantic Versioning}
 * @author sbaecker
 *
 * @desc GSB-Plugin zum autom. Leeren von Text-Input-Feldern
 * Das Addon fügt einen Link "Seite drucken" in eine vorhandene Liste ein
 *
 * @example
 * <ul id="navFunctions"> </ul>
 *
 * @init
 *  $('#navFunctions').gsb_printlink();
 *
 * @requires jQuery >= 1.11.1, gsb_responsiveListener
 *--GSBDocEnd
 */
(function($){if(!$.gsb){$.gsb={};}$.gsb.printlink=function(el,options){var base=this;var printInited=false;base.$el=$(el);base.el=el;base.$el.data("gsb.printlink",base);base.init=function(){base.options=$.extend({},$.gsb.printlink.defaultOptions,options);base.$el.gsb_responsiveListener(base);};base._printlink=function(){if(!base.$el.length){return;}if($("."+base.options.cssClass).length===0){var pattern=$('<li class="c-navFunctions__li '+base.options.cssClass+'">'+'<a href="#" title="'+base.options.tooltip+'" class="c-navFunctions__l">'+'<svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="42px" height="40px" viewBox="0 0 42 40" enable-background="new 0 0 42 40" xml:space="preserve"><path fill="#71777E" d="M38.507,17.178h-4.01V0.982C34.497,0.439,34.054,0,33.506,0H8.495C7.947,0,7.503,0.439,7.503,0.982v16.196h-4.01C1.567,17.178,0,18.719,0,20.613v15.951C0,38.459,1.567,40,3.493,40h5.002h25.011h0.019h4.982C40.433,40,42,38.459,42,36.564V20.613C42,18.719,40.433,17.178,38.507,17.178z M9.487,1.963h23.026v17.364H9.487V18.16V1.963z M7.503,38.036h-4.01c-0.833,0-1.509-0.66-1.509-1.472V20.613c0-0.812,0.676-1.472,1.509-1.472h4.01v1.168V38.036z M9.75,38.036l0.779-3.251h20.941l0.78,3.251H9.75z M40.017,36.564c0,0.812-0.678,1.472-1.51,1.472H34.29l-1.07-4.459c-0.105-0.443-0.506-0.755-0.965-0.755H9.745c-0.09,0-0.175,0.021-0.258,0.043V21.29h24.019c0.548,0,0.991-0.438,0.991-0.981v-1.168h4.01c0.832,0,1.51,0.66,1.51,1.472V36.564z"/><path fill="#71777E" d="M31.473,29.087c-1.667,0-3.024-1.334-3.024-2.975c0-1.642,1.357-2.976,3.024-2.976c1.668,0,3.024,1.334,3.024,2.976C34.497,27.753,33.141,29.087,31.473,29.087z M31.473,25.1c-0.573,0-1.04,0.455-1.04,1.013s0.467,1.012,1.04,1.012c0.574,0,1.041-0.454,1.041-1.012S32.047,25.1,31.473,25.1z"/><path fill="#71777E" d="M27.565,8.221H14.435c-0.548,0-0.992-0.44-0.992-0.982s0.444-0.981,0.992-0.981h13.131c0.548,0,0.991,0.439,0.991,0.981S28.113,8.221,27.565,8.221z"/><path fill="#71777E" d="M27.565,14.11H14.435c-0.548,0-0.992-0.439-0.992-0.981s0.444-0.982,0.992-0.982h13.131c0.548,0,0.991,0.44,0.991,0.982S28.113,14.11,27.565,14.11z"/></svg>'+"<span>"+base.options.page_text+"</span></a>"+"</li>");base.$el.prepend(pattern);}base.$el.parent().find("."+base.options.cssClass+" a").on("click",function(e){e.preventDefault();e.stopPropagation();window.print();});};base._uninit=function(){if(base.$el.find("."+base.options.cssClass)){base.$el.find("."+base.options.cssClass).off().remove();}};base.init();};$.gsb.printlink.defaultOptions={tooltip:typeof PRINT_TOOLTIP==="undefined"?"Drucken (öffnet Dialog)":PRINT_TOOLTIP,page_text:typeof PRINT_PAGE_TEXT==="undefined"?"drucken":PRINT_PAGE_TEXT,cssClass:"c-navFunctions__li--print",respondToEvents:true,onRefresh:function onRefresh(){this._printlink();}};$.fn.gsb_printlink=function(options){return this.each(function(){new $.gsb.printlink(this,options);});};})(jQuery);
   /* Ende gsb_print */
   /* Start gsb_slideshow */
   gsb.makeGSBModule("gsb.Slideshow",{init:function init(){gsb.log("gsb_slideshow.init()");var base=this;var allElementsUrl=base.$el.data("href");gsb.log("gsb_slideshow.setSlickOptions > ");base.setDefaultSlickOptions();delete base.options.slickOptions.onInit;base.options.slickOptions=$.extend(true,{},base.defaultSlickOptions,base.options.slickOptions);gsb.log("gsb_slideshow.setSlickOptions < ");if(allElementsUrl){gsb.log("gsb_slideshow.init > allElementsUrl=["+JSON.stringify(allElementsUrl)+"]");$.ajax({url:allElementsUrl,context:base,success:base.onReceiveAllElements});}else{base.initSlick();}},initSlick:function initSlick(){var base=this;var slickOptions=base.options.slickOptions;base.handleLegacyOptions(slickOptions,base.options);slickOptions=base.handleNavigationArrows(slickOptions);base.$el.on("beforeChange",slickOptions.onBeforeChange).on("afterChange",slickOptions.onAfterChange).on("init",slickOptions.onInit);base.$el.slick(slickOptions);},onReceiveAllElements:function onReceiveAllElements(data){var base=this;base.$el.html(data);base.initSlick();},setDefaultSlickOptions:function setDefaultSlickOptions(){var base=this;base.defaultSlickOptions={slide:".slide",fade:true,infinite:false,draggable:false,adaptiveHeight:false,gsb:{playButton:true},onInit:function onInit(event,slick){gsb.log("gsb_slideshow.on(init)");var slideshowPluginInstance=slick.$slider.data("gsb.Slideshow");var onSlickInit=slideshowPluginInstance.options.onSlickInit;if(typeof onSlickInit==="function"){onSlickInit.call(slick,slick);}base.updateNavigation(slick);base.initMultimedia();base.updateTabindex(slick);base.updatePlayButton(slick);base.$el.trigger("init.slideshow.gsb");setTimeout(base.accessible.bind(base,slick),200);},onBeforeChange:function beforeChange(event,slick){gsb.log("gsb_slideshow.on(beforeChange)");slick.$slides.find("video, object").show();},onAfterChange:function afterChange(event,slick){gsb.log("gsb_slideshow.on(afterChange)");base.updateNavigation(slick);base.updateTabindex(slick);base.updatePlayButton(slick);setTimeout(base.accessible.bind(base,slick),50);}};},initMultimedia:function initMultimedia(){var base=this;if(typeof $.fn.gsb_Multimedia==="function"){base.$el.find("video, audio").gsb_Multimedia(base.options.multimediaOptions);}},updateTabindex:function updateTabindex(slick){var base=this;var focusableItems="a, [tabindex], textarea, input, select, button, video, object",buggedItems="video, object";slick.$slides.not(".slick-active").find(focusableItems).attr("tabindex",-1).end().find(buggedItems).hide();slick.$slides.filter(".slick-active").find(focusableItems).attr("tabindex",0).end().find(buggedItems).show();},updateNavigationArrow:function updateNavigationArrow($arrow,activeImage,inactiveImage,activeArrowButtonTitle,inactiveArrowButtonTitle){var base=this;if($arrow){var $arrowButton=$arrow.is("button")?$arrow:$arrow.find("button"),$arrowImage=$arrow.find("img");if($arrow.hasClass("slick-disabled")){$arrowButton.attr("disabled","");$arrowButton.attr("title",inactiveArrowButtonTitle);$arrowImage.attr("src",inactiveImage);$arrowImage.attr("alt",inactiveArrowButtonTitle);}else{$arrowButton.removeAttr("disabled");$arrowButton.attr("title",activeArrowButtonTitle);$arrowImage.attr("src",activeImage);$arrowImage.attr("alt",activeArrowButtonTitle);}}},updateNavigation:function updateNavigation(slick){var base=this;base.updateNavigationArrow(slick.$prevArrow,base.options.prevButtonImage,base.options.prevButtonInactiveImage,base.options.prevTitle,base.options.prevTitleInactive);base.updateNavigationArrow(slick.$nextArrow,base.options.nextButtonImage,base.options.nextButtonInactiveImage,base.options.nextTitle,base.options.nextTitleInactive);},handleLegacyOptions:function handleLegacyOptions(slickOptions,options){var base=this;$.each(base.slickOptionsForLegacyOptions,function(legacyOption,mappedSlickOption){if(options.hasOwnProperty(legacyOption)){var savedValue=options[legacyOption];delete options[legacyOption];slickOptions[mappedSlickOption]=savedValue;gsb.log("gsb_slideshow.handleLegacyOption > option="+mappedSlickOption+", value="+slickOptions[mappedSlickOption]);}});},handleNavigationArrows:function handleNavigationArrows(slickOptions){var base=this;var navigationArrowOptions={nextArrow:base.$el.find(".next"),prevArrow:base.$el.find(".prev")};return $.extend({},navigationArrowOptions,slickOptions);},accessible:function accessible(slick){var base=this;var selectorList=base.options.bitvElements;if(selectorList.length>0){selectorList.forEach(function(element){$(base.el).find(element.element).each(function(){if(element.remove){gsb.log('element "'+element.element+'" remove attribute "'+element.attribute+'"');$(this).removeAttr(element.attribute);}else{gsb.log('element "'+element.element+'" attribute "'+element.attribute+'" set to "'+element.to+'"');$(this).attr(element.attribute,element.to);}});});}base.accessibilityFix(slick);},accessibilityFix:function accessibilityFix(slick){var base=this,slickDotContainer=base.$el.find(".slick-dots"),slickDotButtons=slickDotContainer.find("button"),slickListParent=base.$el.find(".slick-list").parent(),descNavigation=base.$el.find(".navigation"),navigation=descNavigation.length?descNavigation:base.$el.siblings(".navigation"),navigationParent=navigation.parent();if(slickDotButtons.length>0&&!slickListParent.children().first().is(slickDotContainer)){slickListParent.prepend(slickDotContainer);slickDotContainer.css({"z-index":1});}slickDotButtons.each(function(index,element){var $element=$(element);$element.attr("aria-label",$element.attr("aria-label").replace("of","/"));if($element.parents().hasClass("slick-active")){$element.attr("aria-current",true).removeAttr("aria-selected");}else{$element.attr("aria-current",false).removeAttr("aria-selected");}});if(!navigationParent.children().first().is(navigation)){navigationParent.prepend(navigation);}if(slick.unslicked){slick.$slides.removeAttr("tabindex aria-hidden").find("[tabindex]").attr("tabindex",0);}},updatePlayButton:function updatePlayButton(slick){var base=this,slickOptions=slick.options,$existingPlayButton=base.$el.parent().find(".navigation button.playbutton"),playButtonExists=Boolean($existingPlayButton.length),slideshowStartsPlaying=slickOptions.autoplay,initialClassForPlayButton,initialTitleAttrForPlayButton,initialSrcAttrForPlayButtonImage,initialAltAttrForPlayButtonImage,$newPlayButton;if(base.shouldCreatePlayButton(slickOptions)&&!playButtonExists){gsb.log("gsb_slideshow.createPlayButton...");initialClassForPlayButton=slideshowStartsPlaying&&"playbutton-playing"||"playbutton-paused";initialTitleAttrForPlayButton=slideshowStartsPlaying&&base.options.playButtonAltTextPlaying||base.options.playButtonAltTextPaused;initialSrcAttrForPlayButtonImage=slideshowStartsPlaying&&base.options.playButtonImagePlaying||base.options.playButtonImagePaused;initialAltAttrForPlayButtonImage=slideshowStartsPlaying&&base.options.playButtonAltTextPlaying||base.options.playButtonAltTextPaused;$newPlayButton=$("<button"+' class="playbutton '+initialClassForPlayButton+'"'+' title="'+initialTitleAttrForPlayButton+'">'+"<img"+' src="'+initialSrcAttrForPlayButtonImage+'"'+' alt="'+initialAltAttrForPlayButtonImage+'">'+"</button>");base.$el.parent().find(".navigation").append($newPlayButton);$newPlayButton.on("click",base,base.onClickPlayButton);}else{if(!base.shouldCreatePlayButton(slickOptions)&&playButtonExists){gsb.log("gsb_slideshow.removePlaybutton...");base.$el.slick("slickPause");$existingPlayButton.remove();}}},shouldCreatePlayButton:function shouldCreatePlayButton(initializedSlickOptions){var base=this;var playButtonImagesAreConfigured=base.options.playButtonImagePlaying!==null&&base.options.playButtonImagePaused!==null,isPlayButtonRequested=initializedSlickOptions.gsb.playButton;return isPlayButtonRequested&&playButtonImagesAreConfigured;},onClickPlayButton:function onClickPlayButton(ev){var base=ev.data,$playButton=$(this),playButtonImage=$playButton.find("img");if($playButton.is(".playbutton-playing")){gsb.log("gsb_slideshow.click() > pause");$playButton.removeClass("playbutton-playing").addClass("playbutton-paused").attr("title",base.options.playButtonAltTextPaused);playButtonImage.attr("src",base.options.playButtonImagePaused).attr("alt",base.options.playButtonAltTextPaused);base.$el.slick("slickPause");}else{gsb.log("gsb_slideshow.click() > play");$playButton.removeClass("playbutton-paused").addClass("playbutton-playing").attr("title",base.options.playButtonAltTextPlaying);playButtonImage.attr("src",base.options.playButtonImagePlaying).attr("alt",base.options.playButtonAltTextPlaying);base.$el.slick("slickPlay");}},defaultOptions:{bitvElements:[],nextButtonImage:null,nextButtonInactiveImage:null,nextTitle:typeof NEXT==="undefined"?"Nächste Seite":NEXT,nextTitleInactive:typeof NEXT_INACTIVE==="undefined"?"Keine nächste Seite":NEXT_INACTIVE,prevButtonImage:null,prevButtonInactiveImage:null,prevTitle:typeof BACK==="undefined"?"Vorherige Seite":BACK,prevTitleInactive:typeof BACK_INACTIVE==="undefined"?"Keine vorherige Seite":BACK_INACTIVE,playButtonImagePaused:null,playButtonImagePlaying:null,playButtonAltTextPaused:typeof PLAY==="undefined"?"Animation starten":PLAY,playButtonAltTextPlaying:typeof PAUSE==="undefined"?"Animation stoppen":PAUSE,paginationTitle:typeof PAGE==="undefined"?"Seite":PAGE,slickOptions:null,multimediaOptions:{}},slickOptionsForLegacyOptions:{containerElement:"slide",elementsToSlide:"slidesToShow",autoplay:"autoplay",autoSpeed:"autoplaySpeed",pagination:"dots",pauseOnHover:"pauseOnHover"}});
   /* Ende gsb_slideshow */
   /* Start gsb_toggle */
   /* --GSBDocStart
 * @name: @gsb/gsb_toggle
 * @version: 3.0.0
 * @repository:
 * @description: Dieses Modul erstellt in der Default-Konfiguration eine Accordion in small und ein Tab-Modul in large
 * --GSBDocEnd
*/
gsb.makeGSBModule('gsb.toggle', {
  defaultOptions: {
    richtext: false,
    richtextWrapper: '<div class="richtext-accordion"/>',
    richtextStart: '.startaccordion',
    richtextControl: '.accordionheadline',
    richtextEnd: '.endaccordion',
    tab: true,
    tabControls: '> .tabs-list > li a',
    tabControlContainer: '> .tabs-list',
    richtextTabControlContainer: '<ul class="tabs-list"/>',
    tabListHeading: '',
    elements: '> .tabs-container > div',
    heading: '> .tabs-container > .heading',
    accordionContainer: '> .tabs-container',
    richtextAccordionContainer: '<div class="tabs-container"/>',
    tabbables: 'a[href], area, input, button, select, textarea, audio, video, [tabindex]',
    accordion: true,
    accordionCloseOther: true,
    accordionNoClose: false,
    accordionPanelHeight: false,
    accordionElementToOpen: null,
    accordionElementsStopPropagation: '',
    hashControlled: false,
    autoplay: false,
    playButtonImagePaused: null,
    playButtonImagePlaying: null,
    playButtonAltTextPaused: typeof PLAY === 'undefined' ? 'Animation starten' : PLAY,
    playButtonAltTextPlaying: typeof PAUSE === 'undefined' ? 'Animation stoppen' : PAUSE,
    accordionHeadingTitleClosed: null,
    accordionHeadingTitleOpened: null,
    autoSpeed: '5000',
    playOnLoad: false,
    pauseOnHover: true,
    changeOnHover: false,
    allOpen: false,
    animateTab: false,
    respondToEvents: true,
    onRefresh: function onRefresh() {
      gsb.log('gsb_toggle: breakpoint default');
      this.initialize();
      this.refreshTab();
    },
    responsive: [{
      breakpoint: 600,
      onRefresh: function onRefresh() {
        gsb.log('gsb_toggle: breakpoint 600');
        this.initialize();
        this.autoplayStop();
        this.$el.off('mouseenter mouseleave');
        this.refreshAccordion();
      },
      autoplay: false
    }]
  },

  init: function init() {
    gsb.log('gsb_toggle.init()');
    var base = this;

    if (base.options.richtext) {
      base.addRichtextContainer();
    } else {
      if (base.$el.data('href')) {
        $.get(base.$el.data('href'), function (data) {
          base.$el.html(data);
          base.$el.gsb_responsiveListener(base);
        });
      } else {
        base.$el.gsb_responsiveListener(base);
      }
    }
  },

  /**
   * @method initialize
   * @desc Initialisierung des Scripts
   */
  initialize: function initialize() {
    var base = this;

    if (!base.$el.hasClass('gsb-toggle')) {
      base.$el.addClass('gsb-toggle');

      base.addClasses();
      base.addClickfunction();
      base.uiType = 'accordion';
      base.makeAccessible();
      base.accKeyboardCtrl();

      if (base.options.hashControlled) {
        base.addHashHandler();
      }
    }

    if (base.options.autoplay) {
      base.autoplay();
    }
  },

  /**
   * @method addClasses
   * @desc Zugehörigkeit der Überschriften festlegen
   */
  addClasses: function addClasses() {
    var base = this;

    if (base.options.tab === true) {
      //Angabe welcher Tab aktiv gesetzt werden soll
      var activeTabIndex = $.inArray(base.$el.find(base.options.tabControls + '.active-control').get(0), base.$el.find(base.options.tabControls));

      if (activeTabIndex === -1) {
        activeTabIndex = 0;
      }

      base.$el.find(base.options.tabControls).each(function (index) {
        $(this).addClass('switch-panel' + index);

        if (index === activeTabIndex) {
          $(this).addClass('active-control');
        } else {
          $(this).addClass('inactive-control');
        }
      });
      base.$el.find(base.options.elements).each(function (index) {
        $(this).addClass('switch-panel' + index);

        if (index === activeTabIndex) {
          $(this).addClass('panel-opened');
        } else {
          $(this).addClass('panel-closed');
        }
      });
    }

    if (base.options.accordion === true) {
      // Accorion hat bei start geöffnete Elemente
      var hasOpendElements = false;

      if (base.$el.find(base.options.heading).filter('.active-control').length > 0) {
        hasOpendElements = true;
      }

      base.$el.find(base.options.heading).each(function () {
        if (!$(this).is('button') || !$(this).is('a')) {
          if (base.options.accordionPanelHeight) {
            var height = 0;
            $(this).next().find('>').each(function () {
              height += $(this).outerHeight(true);
            });
            $(this).next().height(height);
          }

          if (base.options.allOpen && !base.options.tab) {
            base.show($(this).next());
            $(this).addClass('active-control');
          } else if (hasOpendElements) {
            if (!$(this).hasClass('active-control')) {
              $(this).addClass('inactive-control');
              base.hide($(this).next());
            } else {
              base.show($(this).next());
            }
          } else {
            $(this).addClass('inactive-control');
            base.hide($(this).next());
          }
        }

        base.changeAccordionHeadingTitle($(this));
      });
    }
  },

  /**
   * @method addClickfunction
   * @desc Click Events hinzufügen
   */
  addClickfunction: function addClickfunction() {
    var base = this; // Accordion

    if (base.options.accordion === true) {
      base.$el.on('click.gsb_toggle keydown.gsb_toggle', base.options.heading, function (e) {
        if (e.type === 'click' || e.which === 13) {
          e.preventDefault();
          e.stopPropagation();
          base.clickedElem = $(this);
          base.changeStateAccordion();
        }
      }).find(base.options.accordionElementsStopPropagation).on('click.gsb_toggle keydown.gsb_toggle', function (e) {
        e.stopPropagation();
      });
    }

    if (base.options.tab === true) {
      base.$el.on('activateTab.gsb_toggle', base.options.tabControls, function () {
        base.clickedElem = $(this);
        base.changeStateTab();
        $(this).focus();
      }); // Autoplay muss deaktiviert sein, da die Events focusin und focusout im Firefox derzeit nocht nicht implementiert
      // sind bzw. noch bugs enthalten

      if (base.options.changeOnHover && !base.options.autoplay) {
        base.$el.on('mouseenter.gsb_toggle touchend.gsb_toggle', base.options.tabControls, function () {
          $(this).trigger('activateTab');
        }).on('click.gsb_toggle', base.options.tabControls, function (e) {
          e.preventDefault();
          e.stopPropagation();
        });
      } else {
        base.$el.on('click.gsb_toggle', base.options.tabControls, function (ev) {
          ev.preventDefault();
          ev.stopPropagation();
          $(this).trigger('activateTab');
        }).on('focusin.gsb_toggle', base.options.tabControls, function (ev, stop) {
          if (ev.relatedTarget && !base.$el.find(ev.relatedTarget).length) {
            ev.stopPropagation();
            $(this).trigger('activateTab');
          }
        });
      }
    }
  },

  addHashHandler: function addHashHandler() {
    var base = this,
        initialHash = location.hash || '#',
        hashedElemId,
        hashedElemIndex;

    base.initialTabControl = base.$el.find(base.options.tabControls).filter('.active-control');
    if (!base.initialTabControl.length) {
      base.initialTabControl = base.initialTabControl.end().first();
    }
    base.initialAccordionHeadings = base.$el.find(base.options.heading).filter('.active-control');

    if (initialHash !== '#') {
      hashedElemId = initialHash.replace(/^#/, '');
      hashedElemIndex = base.contentPanels.index(base.contentPanels.filter('[id="' + hashedElemId + '"]'));
      if (hashedElemIndex !== -1) {
        base.initialTabControl = base.tabs.eq(hashedElemIndex);
        base.initialAccordionHeadings = base.headings.eq(hashedElemIndex);
      }
    }

    base.initialStatus = base.initialAccordionHeadings.length ? 'initiallyOpen' : 'closed';
    base.initialHash = initialHash;
    base.lastHash = base.initialHash;
    base.lastStatus = base.initialStatus;
    base.initialState = $.extend({}, history.state, {
      status: base.initialStatus,
      hash: base.initialHash
    });
    history.replaceState(base.initialState, document.title);
    $(window).on('gsb-hash-push.gsb_toggle', function (ev, who, hash, status) {
      if (base !== who && (base.lastStatus !== status || base.lastHash !== hash)) {
        base.onPopState(status);
        base.lastStatus = status;
        base.lastHash = hash;
      }
    }).on('popstate.gsb_toggle', function (ev) {
      var state = history.state,
          status;

      if (state) {
        //if this is false, hashchange is triggered
        status = state.status;
        base.onPopState(status);
        base.lastStatus = status;
        base.lastHash = location.hash || '#';
      }
    }).on('hashchange.gsb_toggle', function (ev) {
      var url = ev.originalEvent && ev.originalEvent.newURL || '',
          hash = '#' + (url.split('#')[1] || '');

      if (hash !== base.lastHash) {
        if (hash !== '#') {
          base.changeStateHash(base.$el.find('[href$=\'' + hash + '\']'), 'opened', true);
          base.onPopState('opened');
        } else {
          base.changeStateHash(base.$el.find('[href$=\'' + base.lastHash + '\']'), 'closed', true);
          base.onPopState('closed');
        }

        base.lastHash = hash;
      }
    });
  },

  onPopState: function onPopState(status) {
    var base = this,
        clickedElem = base.clickedElem || $(),
        hash,
        prevStatus;
    gsb.log('onPopState');
    hash = history.state.hash;
    prevStatus = history.state.status;
    base.popStateTriggered = true;

    if (base.uiType === 'tab') {
      if (status === 'opened' && hash !== '#') {
        clickedElem = base.$el.find('[href$=\'' + hash + '\']');
      } else if (status === 'initiallyOpen' || hash === '#') {
        clickedElem = base.initialTabControl;
      }
      /* else {
      //do nothing if status === "closed" && hash !== "#"
      }*/

      if (clickedElem.length) {
        base.clickedElem = clickedElem;
        base.changeStateTab(Boolean(base.$el.find(document.activeElement).length));
      }
    } else if (base.uiType === 'accordion') {
      if (status === 'initiallyOpen') {
        //only possible on first load
        //TODO: Open ALL initial headings, not just the first
        clickedElem = base.initialAccordionHeadings;
      } else if (status === 'opened') {
        if (prevStatus !== 'initiallyOpen' || !base.hasActiveControl(hash)) {
          clickedElem = base.$el.find('[id=\'' + hash.replace(/#/, '') + '\']').prev();
        }
      }

      if (clickedElem.length) {
        base.clickedElem = clickedElem;
        base.changeStateAccordion();
      }
    }

    base.popStateTriggered = false;
  },

  changeStateHash: function changeStateHash(elem, status, replace) {
    var base = this,
        hash = location.hash || '#',
        hashLess = location.href.split('#')[0],
        myHash = '#' + (String(elem.attr('href')).split('#')[1] || ''),
        newStatus,
        globalState;
    globalState = $.extend({}, history.state);
    globalState.hash = myHash;
    globalState.status = status;

    if (!base.popStateTriggered && !replace) {
      if (base.uiType === 'tab') {
        if (hash !== myHash) {
          history.pushState(globalState, document.title, hashLess + myHash);
          $(window).trigger('gsb-hash-push', [base, myHash, status]);
          base.lastHash = myHash;
          base.lastStatus = status;
        }
      } else if (base.uiType === 'accordion') {
        if (hash === myHash) {
          newStatus = status === 'closed' ? 'opened' : 'closed';
          history.pushState(globalState, document.title, hashLess + '#');
          $(window).trigger('gsb-hash-push', [base, '#', newStatus]);
          base.lastHash = '#';
          base.lastStatus = newStatus;
        } else if (base.lastStatus === 'initiallyOpen' && base.hasActiveControl(myHash)) {
          history.pushState(globalState, document.title, hashLess + '#');
          $(window).trigger('gsb-hash-push', [base, myHash, status]);
          base.lastHash = myHash;
          base.lastStatus = status;
        } else {
          history.pushState(globalState, document.title, hashLess + myHash);
          $(window).trigger('gsb-hash-push', [base, myHash, status]);
          base.lastHash = myHash;
          base.lastStatus = status;
        }
      }
    } else if (replace) {
      history.replaceState(globalState, document.title);
    }
  },

  hasActiveControl: function hasActiveControl(hash) {
    var base = this;
    return Boolean(base.$el.find('.active-control[href$=\'' + hash + '\']').length);
  },

  /**
   * @method changeStateAccordion
   * @param {Object} elem - Geklicktes Element
   * @desc Passt den title des headingElements je Status an (geöffnet/geschlossen)
   */
  changeAccordionHeadingTitle: function changeAccordionHeadingTitle(elem) {
    var base = this;

    if (elem.hasClass('active-control') && base.options.accordionHeadingTitleOpened) {
      elem.attr('title', base.options.accordionHeadingTitleOpened);
    } else if (!elem.hasClass('active-control') && base.options.accordionHeadingTitleClosed) {
      elem.attr('title', base.options.accordionHeadingTitleClosed);
    }
  },

  /**
   * @method changeStateAccordion
   * @desc Open-/Close-States Accordion
   */
  changeStateAccordion: function changeStateAccordion() {
    var base = this,
        contentElement,
        button,
        singleOpen,
        status;

    if (base.options.accordionElementToOpen) {
      contentElement = $(base.options.accordionElementToOpen);
    } else {
      contentElement = base.clickedElem.next();
    }

    button = base.buttons.eq(contentElement.prop('gsb_aria_index'))[0];
    singleOpen = !base.options.accordionCloseOther;

    if (base.clickedElem.hasClass('inactive-control')) {
      if (base.options.accordionCloseOther && !base.options.accordionElementToOpen) {
        var activeControl = base.$el.find(base.options.heading).filter('.active-control');
        base.animationAccordion(activeControl.next(), 'close');
        activeControl.removeClass('active-control').addClass('inactive-control');
      }

      base.clickedElem.removeClass('inactive-control').addClass('active-control');
      base.animationAccordion(contentElement, 'open', function () {
        base.aria.updateAria(button, true, singleOpen);
      });
      status = 'opened';
    } else if (!base.options.accordionCloseOther || !base.options.accordionNoClose) {
      base.clickedElem.removeClass('active-control').addClass('inactive-control');
      base.animationAccordion(contentElement, 'close', function () {
        base.aria.updateAria(button, false, singleOpen);
      });
      status = 'closed';
    }

    if (base.options.hashControlled) {
      if (contentElement.attr('id')) {
        var id = contentElement.attr('id');
        var link = base.$el.find('[href$=\'#' + id + '\']');

        if (link.length) {
          base.changeStateHash(link, status, false);
        } else {
          gsb.warn('link empty');
        }
      } else {
        gsb.warn('contentElement w/o id');
      }
    }

    base.changeAccordionHeadingTitle(base.clickedElem);
  },

  /**
   * @method changeStateTab
   * @desc Open-/Close-States Tab
   */
  changeStateTab: function changeStateTab(hasFocus) {
    var base = this,
        panelToOpen = base.$el.find(base.options.accordionContainer).find('.' + base.getSwitchPanelClass(base.clickedElem)),
        panelToClose,
        ariaControl;

    if (base.clickedElem.hasClass('inactive-control')) {
      panelToClose = base.$el.find('.panel-opened');
      base.aria.updateAria(base.clickedElem[0], true, false);
      ariaControl = base.clickedElem.attr('aria-controls');
      panelToClose.removeClass('panel-opened').addClass('panel-closed');
      base.$el.find(base.options.tabControls).filter('.active-control').removeClass('active-control').addClass('inactive-control');
      panelToOpen.removeClass('panel-closed').addClass('panel-opened');
      base.clickedElem.removeClass('inactive-control').addClass('active-control');
      base.animationTab(panelToClose, panelToOpen);
      if (base.options.hashControlled) {
        base.changeStateHash(base.clickedElem, 'opened');
      }
    }

    if (hasFocus) {
      base.clickedElem.focus();
    }
  },

  show: function show($elements) {
    var base = this,
        customShow = base.options.show;

    if (typeof customShow !== 'function') {
      $elements.show();
    } else {
      $elements.toArray().forEach(customShow);
    }
  },

  hide: function hide($elements) {
    var base = this,
        customHide = base.options.hide;

    if (typeof customHide !== 'function') {
      $elements.hide();
    } else {
      $elements.toArray().forEach(customHide);
    }
  },

  /**
   * @method animationAccordion
   * @desc Animation für OpenClose des Accordions
   *
   * @param elem {Object} Element welches animiert werden soll
   * @param type Art der Animation - {string} open / close
   */
  animationAccordion: function animationAccordion(elem, type, callback) {
    var base = this;

    if (type === 'open') {
      elem.slideDown(400).promise().done(callback, function () {
        base.show(this);

        if (base.options.accordionElementToOpen) {
          base.addA11y(elem);
        }
        base.$el.trigger('afterAnimationOpen.toggle.gsb', $(elem).prev());
      });
    } else {
      elem.slideUp().promise().done(callback, function () {
        base.hide(this);
        base.$el.trigger('afterAnimationClose.toggle.gsb', $(elem).prev());
      });
    }
  },

  /**
   * @method animationTab
   * @desc Animation für OpenClose des Tabs
   *
   * @param panelToClose {Object} Element welches animiert werden soll (ausblenden)
   * @param panelToOpen {Object} Element welches animiert werden soll (einblenden)
   */
  animationTab: function animationTab(panelToClose, panelToOpen) {
    var base = this;

    if (base.options.animateTab) {
      panelToClose.fadeOut('slow', function () {
        panelToOpen.fadeIn('slow', function () {
          gsb.log('gsb_toggle::animationTab', this);
          base.show(this);
        });
      });
    } else {
      base.hide(panelToClose);
      base.show(panelToOpen);

      if (typeof base.options.afterChange === 'function') {
        base.options.afterChange.call($(this), base.$el);
      }
    }
  },

  /**
   * @method autoplay
   * @desc Autoplay
   */
  autoplay: function autoplay() {
    var base = this;

    if (base.$el.find('> button').length === 0) {
      var button = document.createElement('button');
      button.className = 'paused';
      var image = document.createElement('img');
      image.src = base.options.playButtonImagePlaying;
      image.alt = base.options.playButtonAltTextPlaying; // playbutton = base.$el.append($(button).append(image));
    }

    base.playbutton = base.$el.find('button.paused');
    base.playbutton.on('click autoplayStart', function (e) {
      e.preventDefault();
      e.stopPropagation();

      if (base.playbutton.hasClass('paused')) {
        $(this).removeClass('paused').addClass('played');
        base.autoplayStart();
        base.changeStatePlayPause(base.options.playButtonImagePlaying, base.options.playButtonAltTextPlaying);
        base.isPaused = false;

        if (e.type !== 'autoplayStart') {
          //Damit nach Starten des Autoplays nicht nochmal autoplayStart von mouseleave aufgerufen wir
          base.isClicked = true;
        }
      } else {
        $(this).addClass('paused').removeClass('played');
        base.autoplayStop();
        base.changeStatePlayPause(base.options.playButtonImagePaused, base.options.playButtonAltTextPaused);
        base.isPaused = true;
      }
    });

    // Stop bei Hover
    if (base.options.pauseOnHover) {
      base.$el.on('mouseenter mouseleave', function (e) {
        if (!base.isPaused) {
          if (e.type === 'mouseenter') {
            base.autoplayStop();
          } else {
            if (base.playbutton.hasClass('played') && !base.isClicked) {
              base.autoplayStart();
            }

            base.isClicked = false;
          }
        }
      });
    }

    //play bei start
    if (base.options.playOnLoad) {
      base.playbutton.trigger('autoplayStart');
    }
  },

  /**
   * @method autoplayStart
   * @desc Autoplay start
   */
  autoplayStart: function autoplayStart() {
    var base = this;
    base.rotation = setInterval(function () {
      var tabControls = base.$el.find(base.options.tabControls),
          activeTab = tabControls.find('active-control'),
          activeIndex = tabControls.index(activeTab),
          lastIndex = tabControls.length - 1; //Wenn letzter Tab, wieder beim ersten anfangen

      if (activeIndex >= lastIndex) {
        tabControls.first().click();
      } else {
        tabControls.eq(activeIndex + 1).click();
      }
    }, base.options.autoSpeed);
  },

  /**
   * @method autoplayStop
   * @desc Autoplay stop
   */
  autoplayStop: function autoplayStop() {
    var base = this;
    clearInterval(base.rotation);
  },

  makeAccessible: function makeAccessible() {
    var base = this,
        tabControlContainer,
        tabListHeading,
        tabs,
        headings,
        buttons,
        contentPanels;

    if (!base.aria) {
      tabControlContainer = base.$el.find(base.options.tabControlContainer);
      tabListHeading = base.$el.find(base.options.tabListHeading);

      if (!tabListHeading.length) {
        tabListHeading = tabControlContainer.prev('h1,h2,h3,h4,h5,h6');
      }

      tabs = base.$el.find(base.options.tabControls);
      headings = base.$el.find(base.options.heading);
      contentPanels = base.$el.find(base.options.elements);
      buttons = headings.map(function () {
        var heading = $(this),
            links,
            button;

        if (!heading.is('button, a')) {
          links = heading.find('a');
          if (links.length) {
            button = links.first().attr('role', 'button');
          } else {
            button = $('<button/>').append(heading.contents());
            heading.append(button);
          }
        } else {
          button = heading;
        }

        return button[0];
      });
      base.tabs = tabs;
      base.headings = headings;
      base.contentPanels = contentPanels;
      base.buttons = buttons;
      base.aria = gsb.aria(base.el, {}, $.extend({}, base.ariaParams, {
        types: {
          tabListHeading: tabListHeading,
          tabControlContainer: tabControlContainer,
          button: buttons,
          content: contentPanels,
          tab: tabs
        }
      }));
      headings.each(function (i) {
        if ($(this).hasClass('active-control')) {
          base.aria.updateAria(buttons[i], true, true);
          base.show(contentPanels.eq(i));
        }
      });
      tabs.each(function (i) {
        if ($(this).hasClass('active-control')) {
          base.aria.updateAria(tabs[i], true, true);
          base.show(contentPanels.eq(i));
        }
      });
    }
  },

  ariaParams: {
    initial: [{
      _type: 'tabListHeading',
      id: function id(base) {
        return base.generateID();
      }
    }, {
      _type: 'tabControlContainer',
      role: 'tablist',
      'aria-labelledby': function ariaLabelledby(base) {
        if (base.types['tabControlContainer'].eq(0).attr('aria-label')) {
          return null; //delete labelledby
        } else if (base.types['tabControlContainer'].eq(0).attr('aria-labelledby')) {
          return undefined; //do nothing
        } else {
          return base.types['tabListHeading'].eq(0).attr('id') || null;
        }
      }
    }, {
      _type: 'content',
      role: 'tabpanel',
      id: function id(base, index) {
        return base.types['content'].eq(index).attr('id') || base.generateID();
      }
    }, {
      _type: 'tab',
      role: 'tab',
      id: function id(base) {
        return base.generateID();
      },
      'aria-controls': function ariaControls(base, index) {
        return base.types['content'].eq(index).attr('id');
      },
      'href': function href(base, index) {
        var contId = base.types['content'].eq(index).attr('id'),
            hashLess = location.href.split('#')[0];
        return base.types['tab'].eq(index).attr('href') || hashLess + '#' + contId;
      }
    }, {
      _type: 'button',
      id: function id(base) {
        return base.generateID();
      },
      'aria-controls': function ariaControls(base, index) {
        return base.types['content'].eq(index).attr('id');
      }
    }, {
      _type: 'content',
      'aria-labelledby': function ariaLabelledby(base, index) {
        return base.types['tab'].eq(index).attr('id') || base.types['button'].eq(index).attr('id');
      }
    }],
    toggles: {
      tab: {
        'aria-selected': ['true', 'false'],
        tabindex: [0, -1]
      },
      button: {
        'aria-expanded': ['true', 'false']
      },
      content: {
        hidden: [null, 'hidden']
      }
    }
  },

  //focuses next tabbable element outside the widget
  focusNextTabbable: function focusNextTabbable() {
    var base = this,
        allTabbables = $(base.options.tabbables).not('[tabindex=-1]'),
        lastIndex = allTabbables.length - 1,
        tabbablesInside = base.$el.find(base.options.tabbables).not('[tabindex=-1]'),
        firstIndexOutside = allTabbables.index(tabbablesInside.last()) + 1;
    allTabbables.eq(firstIndexOutside > lastIndex ? 0 : firstIndexOutside).focus();
  },

  //focuses previous tabbable element outside the widget
  focusPrevTabbable: function focusPrevTabbable() {
    var base = this,
        allTabbables = $(base.options.tabbables).not('[tabindex=-1]'),
        tabbablesInside = base.$el.find(base.options.tabbables).not('[tabindex=-1]'),
        firstIndexOutside = allTabbables.index(tabbablesInside.first()) - 1;
    allTabbables.eq(firstIndexOutside < 0 ? -1 : firstIndexOutside).focus();
  },

  activatePrevTab: function activatePrevTab() {
    var base = this,
        tabs = base.tabs,
        activeTab = tabs.filter('.active-control'),
        activeIndex = tabs.index(activeTab);

    if (activeIndex - 1 > -1) {
      tabs.eq(activeIndex - 1).trigger('activateTab');
    } else {
      tabs.last().trigger('activateTab');
    }
  },

  activateNextTab: function activateNextTab() {
    var base = this,
        tabs = base.tabs,
        activeTab = tabs.filter('.active-control'),
        activeIndex = tabs.index(activeTab);

    if (activeIndex + 1 < tabs.length) {
      tabs.eq(activeIndex + 1).trigger('activateTab');
    } else {
      tabs.first().trigger('activateTab');
    }
  },

  onKeyTab: function onKeyTab(ev) {
    var base = ev.data;
    base.tabs = base.$el.find(base.options.tabControls);

    switch (ev.key) {
      case 'ArrowLeft':
      case 'Left':
        // IE/Edge
        base.activatePrevTab();
        break;

      case 'ArrowRight':
      case 'Right':
        // IE/Edge
        base.activateNextTab();
        break;

      case 'Home':
        base.tabs.first().trigger('activateTab');
        break;

      case 'End':
        base.tabs.last().trigger('activateTab');
        break;

      default:
        //skip preventDefault etc.
        return;
    }

    ev.preventDefault();
  },

  tabKeyboardCtrl: function tabKeyboardCtrl() {
    var base = this,
        eventString = 'keydown.gsb_toggle';
    base.$el.off(eventString, base.onKeyAcc);
    base.$el.on(eventString, base, base.onKeyTab);
  },

  /**
   * @method refreshTab
   * @desc Refresh Tab
   */
  refreshTab: function refreshTab() {
    gsb.log('gsb_toggle.refreshTab()');
    var base = this;

    if (base.options.tab) {
      base.uiType = 'tab';
      base.contentPanels.attr('role', 'tabpanel');
      base.tabKeyboardCtrl();

      if (base.options.hashControlled) {
        base.onPopState('opened');
      }

      base.$el.find(base.options.heading).each(function () {
        $(this).removeAttr('aria-expanded');
      }); // Autoplay muss deaktiviert sein, da die Events focusin und focusout im Firefox derzeit nocht nicht implementiert
      // sind bzw. noch bugs enthalten

      if (base.options.changeOnHover && !base.options.autoplay) {
        base.$el.on('mouseenter focus', base.options.tabControls, function (e) {
          base.clickedElem = $(this);
          base.changeStateTab();
        });
      }

      base.hide(base.$el.find('.panel-closed'));
      base.show(base.$el.find('.panel-opened'));
    }
  },

  focusPrevHeading: function focusPrevHeading() {
    var base = this,
        buttons = base.buttons,
        activeButton = buttons.filter(document.activeElement),
        activeIndex = buttons.index(activeButton);

    if (activeIndex - 1 > -1) {
      buttons.eq(activeIndex - 1).focus();
    } else {
      buttons.last().focus();
    }
  },

  focusNextHeading: function focusNextHeading() {
    var base = this,
        buttons = base.buttons,
        activeButton = buttons.filter(document.activeElement),
        activeIndex = buttons.index(activeButton);

    if (activeIndex + 1 < buttons.length) {
      buttons.eq(activeIndex + 1).focus();
    } else {
      buttons.first().focus();
    }
  },

  onKeyAcc: function onKeyAcc(ev) {
    var base = ev.data;

    switch (ev.key) {
      case 'ArrowUp':
      case 'Up':
        // IE/Edge
        base.focusPrevHeading();
        break;

      case 'ArrowDown':
      case 'Down':
        // IE/Edge
        base.focusNextHeading();
        break;

      case 'Home':
        base.buttons.first().focus();
        break;

      case 'End':
        base.buttons.last().focus();
        break;

      default:
        //skip preventDefault etc.
        return;
    }

    ev.preventDefault();
  },

  accKeyboardCtrl: function accKeyboardCtrl() {
    var base = this,
        eventString = 'keydown.gsb_toggle';
    base.$el.off(eventString, base.onKeyTab);
    base.$el.on(eventString, base, base.onKeyAcc);
  },

  /**
   * @method refreshAccordion
   * @desc  Refresh Accordion
   */
  refreshAccordion: function refreshAccordion() {
    gsb.log('gsb_toggle.refreshAccordion()');
    var base = this,
        activeTabIndex;

    if (base.options.accordion) {
      base.uiType = 'accordion';
      if (base.contentPanels.is('div') || base.contentPanels.is('span')) {
        base.contentPanels.attr('role', 'region');
      }
      base.accKeyboardCtrl();
      base.$el.find(base.options.elements).each(function () {
        var $elem = $(this);

        if ($elem.is('[hidden]')) {
          $elem.prev('.active-control').removeClass('active-control').addClass('inactive-control');
        } else {
          $elem.prev('.inactive-control').removeClass('inactive-control').addClass('active-control');
        }
      });

      if (base.options.hashControlled) {
        base.onPopState('opened');
      }

      base.$el.find(base.options.heading).each(function () {
        if ($(this).hasClass('inactive-control')) {
          base.hide($(this).next());
        }
      });
      if (base.$el.find(document.activeElement).length > 0) {
        activeTabIndex = base.$el.find(base.options.elements).filter('.panel-opened').first().prop('gsb_aria_index');
        base.buttons.eq(activeTabIndex).focus();
      }
    }
  },

  /**
   * @method changeStatePlayPause
   * @param {string} imgsrc - Imagesource-Link
   * @param {string} alt - Alt-Text des Images
   * @desc Bild tauschen für Play/Pausebutton
   */
  changeStatePlayPause: function changeStatePlayPause(imgsrc, imgalt) {
    var base = this;
    var image = base.playbutton.find('img');
    image.prop('alt', imgalt).prop('src', imgsrc);
  },

  /**
   * @method getSwitchPanelClass
   * @param {Object} elem - geklicktes Element (durchgereicht von changeState oder autoplayStart)
   * @desc Liefert die switch-panel Klasse des geklickten Elements
   */
  getSwitchPanelClass: function getSwitchPanelClass(elem) {
    var panelClass = $.grep(elem.prop('class').split(' '), function (value) {
      return value.indexOf('switch-panel') > -1;
    });
    return panelClass;
  },

  /**
   * @method uninitAccordion
   * @desc Sollte Akkordeon "zerstören"; nur aufrufen, wenn weder die Tabfunktion noch die
   *       "hashControlled" Funktion jemals aktiv war (das galt schon immer, fehlte aber
   *       in der Beschreibung).
   */
  uninitAccordion: function uninitAccordion() {
    var base = this;

    if (base.$el.hasClass('gsb-toggle')) {
      base.$el.removeClass('gsb-toggle');
      base.$el.off('.gsb_toggle'); //entfernt nur namespace='.gsb_toggle' Events

      base.headings.each(function (i) {
        var contents = base.buttons.eq(i).contents();
        $(this).empty().append(contents);
      }).removeClass('active-control inactive-control');
      base.show(base.contentPanels);
      base.contentPanels.removeAttr('hidden role');
      base.aria.$el.data('gsb.aria', null);
      base.aria = null;
    }
  },

  /**
   * @method destroyWidget
   * @desc Zerstört das tabAkkordeon. Soll Daten/Events/etc. entfernen
   *       um Memory-Leaks zu verhindern (UNGETESTET)
   */
  destroyWidget: function destroyWidget() {
    var base = this;
    $(window).off('.gsb_toggle');
    base.uninitAccordion();
    base.$el.find(base.options.tabControlContainer).removeAttr('role');
    base.tabs.removeAttr('role aria-selected tabindex');
    base.buttons.removeAttr('aria-expanded');
    base.contentPanels.removeClass('panel-opened panel-closed');
  },

  /**
   * @method addA11y
   * @desc  setzt den focus auf das erste fokussierbare Element
   * @param elem {jQuery} Element welches nach fokussierbaren Elementen durchsucht wird. Ist mindestens ein Element vorhanden,
   * wird der Fokus gesetzt
   * @param tabPanel {jQuery} Element auf welches gesprungen werden soll, wenn im TabContainer keiner fokussierbaren Element vorhanden sind
   */
  addA11y: function addA11y(elem, tabPanel) {
    var base = this;
    elem = elem || base.$el;
    var focusElements = elem.find('input,textarea,select,a,button').not(':hidden');

    if (focusElements.length) {
      focusElements[0].focus();
      focusElements.last().keydown(function (e) {});
    }
  },

  /**
   * @method addRichtextContainer
   * @desc Sucht in base.el nach Elementen mit den Klasse startaccordion, endaccordion und accordionheadline (konfigurierbar)
   * und baut die für gsb_toggle benötigte Struktur um diese Elemente herum.
   *
   * Wenn alle benötigten Elemente eingebaut wurden, ruft sich das Script nochmal selbst auf; dann mit der Option richtext := false
   */
  addRichtextContainer: function addRichtextContainer() {
    var base = this,
        containers;
    containers = base.$el.find(base.options.richtextStart).map(function () {
      var startAcc = $(this),
          rtAccContainer = $(base.options.richtextAccordionContainer, base.el).insertBefore(startAcc),
          rtTabContainer = $(base.options.richtextTabControlContainer, base.el).insertBefore(startAcc),
          headings;
      startAcc.add(startAcc.nextUntil(base.options.richtextEnd)).add(startAcc.nextAll(base.options.richtextEnd).first()).appendTo(rtAccContainer);
      headings = rtAccContainer.find(base.options.richtextStart).add(rtAccContainer.find(base.options.richtextControl));
      headings.addClass('heading').each(function (i) {
        var heading = $(this),
            nextHeading = headings.eq(i + 1);
        rtTabContainer.append($('<li></li>').append($('<a/>').html(heading.html())));
        if (nextHeading.length) {
          heading.nextUntil(nextHeading).wrapAll('<div/>');
        }
      });
      rtAccContainer.find('.heading').last().nextUntil(base.options.richtextEnd).add(rtAccContainer.find(base.options.richtextEnd)).wrapAll('<div/>');
      return $(base.options.richtextWrapper, base.el).insertBefore(rtTabContainer).append(rtTabContainer, rtAccContainer)[0];
    });
    base.$el.removeData('gsb.toggle');
    containers.gsb_toggle($.extend({}, base.options, {
      richtext: false
    }));
  }
});
   /* Ende gsb_toggle */
   /* Start gsb_togglebar */
   /*!
 * --GSBDocStart
 * @module gsb_togglebar
 * @version 1.0.0
 * @see {@link http://kenwheeler.github.io/slick/}
 * @author sbaecker
 *
 * @desc GSB-Plugin zum Erstellung von Menue-Leiste fuer mobile Navigation
 * 
 * @requires jQuery >= 1.11.1, gsb_responsiveListener
 * 
 * @init
 * $('#wrapperDivisions').gsb_togglebar();
 *--GSBDocEnd
 */
(function($){if(!$.gsb){$.gsb={};}$.gsb.togglebar=function(el,options){var base=this;base.$el=$(el);base.el=el;base.$el.data("gsb.togglebar",base);base.init=function(){base.options=$.extend({},$.gsb.togglebar.defaultOptions,options);base.$el.gsb_responsiveListener(base);};base.generate=function(){if($("#navServiceGS").length>0&&$("#navServiceLS").length>0){var gs_link=$("#navServiceGS");gs_link.find("a").attr("title",$("#navServiceGS a").text());var gs='<li class="navServiceGS">'+gs_link.html()+"</li>";var ls_link=$("#navServiceLS");ls_link.find("a").attr("title",$("#navServiceLS a").text());var ls='<li class="navServiceLS">'+ls_link.html()+"</li>";}else{var gs="";var ls="";}if($("#togglenav").length==0){base.$el.prepend('<div id="togglenav">'+'<ul class="left">'+'<li id="navMobileMenu">'+'<a href="#">'+base.options.menuText+"</a>"+"</li>"+'<li id="navMobileSearch">'+'<a href="#">'+base.options.searchText+"</a>"+"</li>"+"</ul>"+'<ul class="right">'+gs+ls+"</ul></div>");}};base._uninit=function(){$("#togglenav").remove();};base.init();};$.gsb.togglebar.defaultOptions={menuText:typeof(NAV_MOBILE_MENU)=="undefined"?"Menü":NAV_MOBILE_MENU,searchText:typeof(NAV_MOBILE_SEARCH)=="undefined"?"Suchen":NAV_MOBILE_SEARCH,respondToEvents:true,onRefresh:function(){this._uninit();},responsive:[{breakpoint:1024,onRefresh:function(){this.generate();}}]};$.fn.gsb_togglebar=function(options){return this.each(function(){(new $.gsb.togglebar(this,options));});};})(jQuery);
   /* Ende gsb_togglebar */
   /* Start gsb_navigation_mobile */
   (function($){if(!$.gsb){$.gsb={};}$.gsb.navigation_mobile=function(el,options){var base=this;base.$el=$(el);base.el=el;base.$el.data("gsb.navigation_mobile",base);base.init=function(){base.options=$.extend({},$.gsb.navigation_mobile.defaultOptions,options);$("body").gsb_responsiveListener(base);};$.gsb.navigation_mobile.prototype.initMenu=function(){if(typeof base.options.beforeInit==="function"){base.options.beforeInit.call($(this),base);}base.createMenuContainer();if(base.options.menuHtml!=null){$.ajax({url:base.options.menuHtml,dataType:"html",success:function(data){base.menu=$("#menu");base.menu.html(data);base.registerMMenu(base);var activeNode=base.menu.find("#mm-"+$("body").data("nn")+"> a:last");$("<strong>"+activeNode.text()+"</strong>").addClass(activeNode.prop("class")).insertAfter(activeNode);activeNode.remove();base.menu.find(".mm-navbar").prepend('<div class="mobile-head"/>');var mobileHead=base.menu.find(".mobile-head");mobileHead.prepend("<h1>"+NAV_MOBILE_MENU+"</h1>");mobileHead.find("h1").append($('<button class="close-button" id="mmenuH">').append('<img src="'+image_url_close_w+'" alt="'+CLOSE+'" />'));if(typeof base.options.afterInit==="function"){base.options.afterInit.call($(this),base);}}});}};$.gsb.navigation_mobile.prototype.createMenuContainer=function(){if(!$("#menu").length){$("body").prepend('<div id="menu"/>');}};$.gsb.navigation_mobile.prototype.uninit=function(){if(base.menu){if(base.api){base.api.close();}base.menu.remove();}};$.gsb.navigation_mobile.prototype.registerMMenu=function(base){if(base.options.navbar!=null){base.options.mmenuOptions.navbars=base.options.navbar;}if(base.options.configuration!=null){base.menu.mmenu(base.options.mmenuOptions,base.options.configuration);}else{base.menu.mmenu(base.options.mmenuOptions);}if(base.options.navbar!=null){$('<span class="aural">'+base.options.lessText+"</span>").insertBefore(base.menu.find(base.options.closeButtonSelector));}if(base.options.openSubMenu){base.menu.find("#mm-"+$("body").data("nn")).parentsUntil(".mm-menu > ul").filter("li").addClass("mm-opened");}base.controlPanel=base.menu.find(".mm-vertical > .mm-next");base.contentPanel=base.menu.find("li > .mm-panel.mm-vertical > ul");base.controlPanel.attr("title",base.options.moreText);base.controlPanel.attr("aria-label",base.options.moreText);base.aria=base.$el.gsb_ariaSupport(base);base.menu.find("ul > .mm-vertical.mm-opened .mm-next").each(function(){base.aria.updateAria(this,true,true);});base.menu.find(".mm-next").on("click",function(){if($(this).parent().hasClass("mm-opened")){base.aria.updateAria(this,false,true);$(this).attr("title",base.options.moreText);$(this).attr("aria-label",base.options.moreText);}else{base.aria.updateAria(this,true,true);$(this).attr("title",base.options.lessText);$(this).attr("aria-label",base.options.lessText);}});base.api=base.menu.data("mmenu");base.$el.on("click",base.options.navOpenButton,function(e){e.stopImmediatePropagation();e.preventDefault();if(base.menu.hasClass("mm-opened")){base.api.close();}else{base.api.open();$(window).off("keydown.mm-offCanvas");base.addA11y(base.menu);}});if(base.options.navSearchButton){base.$el.on("click",base.options.navSearchButton,function(e){e.stopImmediatePropagation();e.preventDefault();base.api.open();$(window).off("keydown.mm-offCanvas");base.menu.find("input:text").focus();});}if(base.options.closeButtonSelector){base.menu.on("click",base.options.closeButtonSelector,function(e){e.preventDefault();e.stopPropagation();base.api.close();base.$el.find(base.options.navOpenButton).focus();});}if(base.options.searchImage){base.menu.find(".mm-search").append('<input type="image" class="image" src="'+base.options.searchImage+'" alt="'+base.options.searchAltText+'" title="'+base.options.searchAltText+'" aria-label="'+base.options.searchAltText+'"/>');base.menu.find('.mm-search input[type="text"]').attr("title",base.options.searchfieldTitle);base.menu.find('.mm-search input[type="text"]').attr("aria-label",base.options.searchfieldTitle);base.menu.find(".mm-search").on("keydown","input:text",function(event){if(event.keyCode==13&&$(this).val()!=""){if(!base.menu.data("gsb.AutoSuggest")||base.menu.data("gsb.AutoSuggest").enterPos<0){$("#search").find("form input:text").val($(this).val());$("#menu").find("input:image").trigger("click");}}});base.menu.find(".mm-search").on("keydown click","input:image",function(event){var textInput=$(this).siblings("input:text");if((event.keyCode==13||event.type=="click")&&textInput.val()!=""){var search=$("#search");search.find("form input:text").val(textInput.val());search.find("form input:image").trigger("click");base.api.close();}});}if(base.options.autosuggestURL){base.api.bind("opened",function mobileautosuggest(){$(this).unbind("opened",mobileautosuggest);base.menu.gsb_AutoSuggest(base.options.autosuggestURL);});}};$.gsb.navigation_mobile.prototype.addA11y=function(elem){elem=elem||base.$el;var focusElements=elem.find("button,a,input,textarea,select");focusElements[0].focus();focusElements.last().keydown(function(e){if(e.keyCode===9){e.preventDefault();focusElements[0].focus();}else{if(e.keyCode===13){return true;}}});};base.init();};$.gsb.navigation_mobile.defaultOptions={templateNavBar:"modules/navigation_mobile/templateNavBar.html",menuHtml:"modules/navigation_mobile/navigation_mobile.html",lessText:typeof(SHOW_LESS)=="undefined"?"Ausblenden":SHOW_LESS,moreText:typeof(SHOW_MORE)=="undefined"?"Ausblenden":SHOW_MORE,navOpenButton:"#navMobileMenu a",navSearchButton:"#navMobileSearch a",navAuralText:typeof MOBILE_AURAL=="undefined"?"Mobiles Menü":MOBILE_AURAL,navAuralId:"#mobilemenuH",autosuggestURL:null,searchImage:image_url_loupe_b,searchfieldTitle:typeof SEARCH_TITLE=="undefined"?"Suche Eingabe  ":SEARCH_TITLE,searchAltText:typeof SEARCH_ALTTEXT=="undefined"?"Suchen":SEARCH_ALTTEXT,closeButtonSelector:"button.close-button",configuration:null,navbar:[{content:["searchfield"]}],openSubMenu:true,ariaType:"mobilemenu",beforeInit:null,afterInit:null,mmenuOptions:{slidingSubmenus:false,extensions:["iconbar"],searchfield:{add:true,search:false,placeholder:typeof(NAV_MOBILE_SEARCH)=="undefined"?"Suchen":NAV_MOBILE_SEARCH}},respondToEvents:true,onRefresh:function(){this.uninit();},responsive:[{breakpoint:1024,onRefresh:function(){this.uninit();this.initMenu();}}]};$.fn.gsb_navigation_mobile=function(options){return this.each(function(){(new $.gsb.navigation_mobile(this,options));});};})(jQuery);
   /* Ende gsb_navigation_mobile */
   /* Start gsb_responsivetables */
   /*!
* --GSBDocStart
 * @module gsb_responsivetables
 * @version 1.0.0
 * @see {@link http://semver.org|Semantic Versioning}
 * @author sbaecker
 *
 * @desc GSB-Plugin zum Wrappen von Tabellen fuer die mobile Darstellung
 * Fügt um selektierte Tabellen ein zusätzliches div hinzu mit dem dann über CSS der responsive Umgang definiert werden kann. Z.B. die Tabelle horizontal scrollbar machen oder sie umstrukturieren.
 *
 * @init
 *  $('#content').gsb_responsiveTables();
 *--GSBDocEnd
 */
;(function($){if(!$.gsb){$.gsb={};}$.gsb.responsiveTables=function(el,options){var base=this;base.$el=$(el);base.el=el;base.$el.data("gsb.responsiveTables",base);base.init=function(){base.options=$.extend({},$.gsb.responsiveTables.defaultOptions,options);if(base.$el.find("table").length>0){base.$el.find("table:not([class^=l-content-article])").each(function(){switch(base.options.way){case"scroll":$(this).wrap('<div class="responsiveTable"></div>');break;default:$(this).wrap('<div class="responsiveTable"></div>');break;}});}};base.init();};$.gsb.responsiveTables.defaultOptions={way:"scroll"};$.fn.gsb_responsiveTables=function(options){return this.each(function(){new $.gsb.responsiveTables(this,options);});};})(jQuery);
   /* Ende gsb_responsivetables */
   /* Start gsb_tooltip */
   /*!
* --GSBDocStart
 * @module gsb_tooltip
 * @version 1.0.0
 * @see {@link http://foundation.zurb.com/docs/components/tooltips.html}
 * @author anuebel
 *
 * @desc GSB-Wrapper-Plugin fuer Foundation Tooltip-Plugin. Arbeitet als Polyfill, um von Foundation benoetigte
 * data-Attribute und Klassen hinzuzufuegen.
 * Das Addon arbeitet als Bindeglied zwischen HTML-Elementen und dem Foundation Tooltip Plugin
 * 
 * @option
 * tooltipPosition: Die Position des Tooltips(top,bottom(default),left,right)
 * tooltipCorners: Layoutmodus des Tooltip(''(default), 'radius', 'round')
 * tooltipFoundationOptions: native Optionen fuer das Foundation Plugin(undefined(default), siehe Doku oben)
 *
 * @requires modernizr(wegen Foundation)
 * @requires foundation
 * @requires foundation-tooltip
 *
 *  s. auch http://foundation.zurb.com/docs/components/tooltips.html
 *
 * @init
 * // tooltips for abbreviations
 * $('abbr').gsb_tooltip();
 * $('acronym').gsb_tooltip();
 *--GSBDocEnd

 */
(function($){if(!$.gsb){$.gsb={};}$.gsb.tooltip=function(el,options){var base=this;base.$el=$(el);base.el=el;base.$el.data("gsb.tooltip",base);base.init=function(){base.options=$.extend({},$.gsb.tooltip.defaultOptions,options);base.$el.addClass("has-tip tip-"+base.options.tooltipPosition+" "+base.options.tooltipCorners).attr("data-tooltip","").attr("aria-haspopup","true");if(base.options.tooltipFoundationOptions){var serializedFoundationOptions=JSON.stringify(base.options.tooltipFoundationOptions);base.$el.attr("data-options",serializedFoundationOptions);}};base.init();};$.gsb.tooltip.defaultOptions={tooltipPosition:"bottom",tooltipCorners:"",tooltipFoundationOptions:undefined};$.fn.gsb_tooltip=function(options){return this.each(function(){(new $.gsb.tooltip(this,options));});};})(jQuery);
   /* Ende gsb_tooltip */
   /* Start gsb_multimedia */
   gsb.makeGSBModule("gsb.Multimedia",{init:function init(){gsb.log("gsb_multimedia.init()");var base=this;base.$elWrapper=base.$el.closest(base.options.selectors.wrapper);base.initializeMediaElement();},initializeMediaElement:function initializeMediaElement(){var base=this;var mediaelementplayerOptions=$.extend({},base.options.mediaelementplayerOptions,base.options.settings.mediaelementplayerOptions,base.mediaelementplayerOptionsFromDataAttribute());var $consentWrapper,$consentButton;if(mediaelementplayerOptions.hasOwnProperty("videoWidth")&&!base.options.dontSetWidthAttribute){gsb.log("gsb_multimedia width"+mediaelementplayerOptions.videoWidth);base.$el.attr("width",mediaelementplayerOptions.videoWidth);}if(mediaelementplayerOptions.hasOwnProperty("videoHeight")&&!base.options.dontSetHeightAttribute){gsb.log("gsb_multimedia height"+mediaelementplayerOptions.videoHeight);base.$el.attr("height",mediaelementplayerOptions.videoHeight);}base.centerVideoIfRequired();base.$elWrapper.addClass("gsb-multimedia");if(base.options.externalApiRequiresConsent&&base.$elWrapper.find(base.options.selectors.isExternalApi).length&&!base.consented){var height=base.$el.height();if(height<=0){var originalHeight=Math.floor(Number(base.$el.attr("height")));var originalWidth=Math.floor(Number(base.$el.attr("width")));height=Math.floor(base.$el.width()*(originalHeight/originalWidth));}base.$elWrapper.css({height:height,minHeight:height,width:base.$el.width(),backgroundImage:"url("+base.$el.attr("poster")+")",backgroundSize:"contain"}).addClass("consent-required");base.$el.hide();$consentWrapper=$(base.options.markup.consentWrapper);$consentButton=$(base.options.markup.consentButton).text(base.options.consentButtonText).on("click",base,base.onClickConsentButton);$consentWrapper.find(base.options.selectors.consentContent).html(base.options.markup.consentContent)[base.options.consentButtonInsertion]($consentButton);base.$elWrapper.append($consentWrapper);base.$consentWrapper=$consentWrapper;if(base.options.consentSetMinHeight){$consentWrapper.css({minHeight:height});}return;}base.$el.mediaelementplayer(mediaelementplayerOptions);base.bitvTweaks();base.$elWrapper.find(base.options.selectors.volumeSlider).hide();base.$elWrapper.find(base.options.selectors.captionsSelect).find("label").on("click",base,base.onClickCaptionsLabel);base.$el.trigger("init.Multimedia.gsb");},onClickCaptionsLabel:function onClickCaptionsLabel(ev){var base=ev.data;ev.preventDefault();$(this.control).trigger("click");},onClickConsentButton:function onClickConsentButton(ev){var base=ev.data;gsb.log("gsb_multimedia.click() > consentButtonText");base.consented=true;base.$consentWrapper.remove();base.$elWrapper.css({backgroundImage:"",height:"",width:"",backgroundSize:""}).removeClass("consent-required");if(base.$el.attr("data-consent-autoplay")!=="false"){base.$el.attr("autoplay","autoplay");}base.$el.show();base.initializeMediaElement();},bitvTweaks:function bitvTweaks(ev){var base=ev?ev.data:this;base.$el.filter("audio, video").find("source").remove();base.$elWrapper.find(".mejs-volume-slider").removeAttr("href");base.$elWrapper.find(".mejs-container").prev(".mejs-offscreen").remove();base.$el.on("progress timeupdate",base,base.removeTabindex);base.$elWrapper.find(base.options.selectors.pressableButton).on("click updatePressedStatus."+base.eventName,base,base.updateAriaPressed).trigger("updatePressedStatus."+base.eventName);base.$elWrapper.find(".mejs-container").on("exitedfullscreen",base,base.onExitFullscreen);},removeTabindex:function removeTabindex(ev){var base=ev.data;if(base.options.removeTabIndexOnHidden){if(!base.$el.is(":visible")){base.$elWrapper.find("[tabindex]").attr("tabindex",-1);}}},updateAriaPressed:function updateAriaPressed(ev){var base=ev.data,$parent=$(ev.currentTarget),$button=$parent.children("button"),isPressed=base.options.selectors.isPressed;if($parent.is(isPressed)){$button.attr("aria-pressed",true);}else{$button.attr("aria-pressed",false);}},onExitFullscreen:function onExitFullscreen(ev){var base=ev.data;setTimeout(function(){base.$elWrapper.find(".mejs-fullscreen-button").trigger("updatePressedStatus");});},centerVideoIfRequired:function centerVideoIfRequired(){var base=this;var mediaelementplayerOptions=base.options.mediaelementplayerOptions;var videoWidth=mediaelementplayerOptions&&mediaelementplayerOptions.videoWidth||base.$el.attr("width");if(base.options.center&&videoWidth){var centerContainer;var parent=base.$el.parent();if(!parent.is(base.options.selectors.center)){centerContainer=$(base.options.markup.center);centerContainer.css({width:videoWidth,margin:"0 auto"});base.$el.wrap(centerContainer);}else{centerContainer=parent;centerContainer.css({width:videoWidth});}}},mediaelementplayerOptionsFromDataAttribute:function mediaelementplayerOptionsFromDataAttribute(){var base=this,optionsFromDataAttributeAsString=base.$el.data("options");var opts={},ii,p,opts_arr=(optionsFromDataAttributeAsString||":").split(";");ii=opts_arr.length;function isNumber(o){return !isNaN(o-0)&&o!==null&&o!==""&&o!==false&&o!==true;}function trim(str){if(typeof str==="string"){return $.trim(str);}return str;}while(ii--){p=opts_arr[ii].split(":");p=[p[0],p.slice(1).join(":")];if(/true/i.test(p[1])){p[1]=true;}if(/false/i.test(p[1])){p[1]=false;}if(isNumber(p[1])){if(p[1].indexOf(".")===-1){p[1]=parseInt(p[1],10);}else{p[1]=parseFloat(p[1]);}}if(p.length===2&&p[0].length>0){opts[trim(p[0])]=trim(p[1]);}}return opts;},defaultOptions:{center:false,mediaelementplayerOptions:{flashName:"/static/mediaElementPlayer/flashmediaelement.swf",showPosterWhenEnded:true,features:["playpause","current","progress","duration","tracks","a11y","volume","fullscreen"],fakeNodeName:"mediaelement-wrapper",classPrefix:"mejs-"},settings:{},selectors:{captionsSelect:".mejs-captions-selector",center:".mejs-centered",consentContent:".consent-container",isExternalApi:'source[type="video/vimeo"], source[type="video/youtube"]',isPressed:".audio-description-on, .video-description-on, .mejs-unfullscreen",pressableButton:".mejs-audio-description-button, .mejs-video-description-button, .mejs-fullscreen-button",volumeSlider:".mejs-volume-slider",wrapper:".mejs-wrapper"},markup:{center:"<div class='mejs-centered' />",consentWrapper:"<div class='consent-wrapper'><div class='consent-container' /></div>",consentContent:"<h3>Aktivierung erforderlich</h3><p>Wir möchten Sie darauf hinweisen, dass nach der Aktivierung Daten an YouTube übermittelt werden.</p>",consentButton:"<button type='button' class='consent-button' />"},externalApiRequiresConsent:true,consentButtonText:"Video aktivieren",consentButtonInsertion:"append",dontSetWidthAttribute:false,dontSetHeightAttribute:false,consentSetMinHeight:false,removeTabIndexOnHidden:true}});
   /* Ende gsb_multimedia */
   /* Start gsb_map */
   /*!!
 * --GSBDocStart
 * @module map
 * @version 1.6.2
 * @author jelseber
 *
 * @desc Beschreibung des Moduls
 *
 * @requires {@link external:jQuery}
 * @requires {@link external:openlayers}
 *
 * @init Verwendung innerhalb der init beschreiben
 *--GSBDocEnd
 *
*/
'use strict';
function _objectSpread(e) {
  for (var t = 1; t < arguments.length; t++) {
    var o = null != arguments[t] ? arguments[t] : {},
        n = Object.keys(o);
    "function" == typeof Object.getOwnPropertySymbols && (n = n.concat(Object.getOwnPropertySymbols(o).filter(function (e) {
      return Object.getOwnPropertyDescriptor(o, e).enumerable;
    }))), n.forEach(function (t) {
      _defineProperty(e, t, o[t]);
    });
  }
  return e;
}
function _defineProperty(e, t, o) {
  return t in e ? Object.defineProperty(e, t, { value: o, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = o, e;
}
;(function ($) {
  'use strict';
  if (!$.gsb) {
    $.gsb = {};
  }
  $.gsb.map = function (el, options) {
    var base = {};
    base.$el = $(el);
    base.el = el;
    base.$el.data('gsb.map', base);
    base.prepareElements = function prepareElements() {
      base.$listTabPanel = base.$el.find(base.options.selectors.listTabPanel);
      base.$toggleListElement = $(base.options.html.toggleListElement);
      base.$listEntries = base.$el.find(base.options.selectors.listEntry);
      base.$tabList = base.$el.find(base.options.selectors.tabList);
      base.$previousTabItem = base.$tabList.find(base.options.selectors.tabItem).last();
      base.$previousTabHeading = base.$el.find(base.options.selectors.tabListHeading).last();
      base.$previousTabContent = base.$el.find(base.options.selectors.tabListHeading + ' + div').last();
    };
    base.prepareState = function prepareState() {
      base.isMapCreated = false;
      base.markerLayer = null;
      base.removedMarkers = [];
      base.markerTypesToBeRemovedWhenMapIsCreated = [];
    };
    base.init = function init() {
      gsb.log('gsb_map.init()');
      base.options = $.extend(true, {}, $.gsb.map.defaultOptions, options);
      base.prepareElements();
      base.prepareState();
      base.hasData = base.checkListForData();
      if (base.hasData) {
        base.createDataFromListEntries();
        base.createToggleTab(base.createMap);
        base.addFilterElementsToList();
        base.addFiltersToListView();
      } else {
        console.debug('The list did not contain an entries to be shown on a map.');
      }
    };
    // ----------------------------------------------------------------------------------------------------
    /**
     * Prüft ob Koordinaten für MapMarker in der Listenansicht vorhanden sind.
     * @returns boolean
     */
    base.checkListForData = function checkListForData() {
      return base.$listEntries.is('[data-geo-long]') && base.$listEntries.is('[data-geo-lat]');
    };
    /**
     * Erstellt das zur Erstellung der Map nötige Datenobjekt für die Marker und Popups.
     */
    base.createDataFromListEntries = function createDataFromListEntries() {
      base.data = [];
      base.$listEntries.each(function (index, listEntry) {
        var $listEntry = $(listEntry);
        var $teaser = $listEntry.find(base.options.selectors.listEntryTeaser).first();
        base.data.push({
          geo: [parseFloat($listEntry.attr('data-geo-long')), parseFloat($listEntry.attr('data-geo-lat'))],
          markerType: $listEntry.attr('data-geo-marker-type'),
          markerLabel: $listEntry.attr('data-geo-marker-label'),
          markerIcon: $listEntry.attr('data-geo-marker-image'),
          filterIcon: $listEntry.attr('data-geo-filter-image'),
          raw: $.clone($teaser.get(0)), // used as content of popup
          isActive: true
        });
      });
    };
    /**
     * Fügt dem DOM ein ToggleTab hinzu welches die Kartenansicht enthält und initialisiert gsb_toggle.
     * Falls die Seite nicht mit dem Anker '#section-liste' aufgerufen wird wird außerdem die Karte selbst initialisiert und die Kartenansicht ausgewählt.
     * @param toggleCallback
     */
    base.createToggleTab = function createToggleTab(toggleCallback) {
      base.$tabList.prepend(base.$toggleListElement);
      base.$previousTabHeading.before(base.prepareMapHTML());
      base.$el.gsb_toggle({
        accordion: base.options.gsbToggleOptions.accordion,
        accordionContainer: base.options.gsbToggleOptions.accordionContainer,
        elements: base.options.gsbToggleOptions.elements,
        heading: base.options.gsbToggleOptions.heading,
        tabControls: base.options.gsbToggleOptions.tabControls,
        tabControlContainer: base.options.gsbToggleOptions.tabControlContainer,
        tabListHeading: base.options.gsbToggleOptions.tabListHeading,
        responsive: base.options.gsbToggleOptions.responsive
      });
      base.$el.find(base.options.gsbToggleOptions.tabControlContainer).children('li').not('[role=tab]').attr({ role: 'presentation' });
      var href = base.$previousTabItem.find('a').attr('href').split('#')[0] + '#section-karte';
      base.$toggleListElement.on('click', toggleCallback);
      base.$toggleListElement.find('a').attr('href', href);
      if (window.location.href.indexOf('#section-liste') === -1) {
        base.selectMapOnFirstLoad(toggleCallback);
      }
    };
    /**
     * Initialisieren der Karte.
     */
    base.createMap = function createMap() {
      if (!base.isMapCreated) {
        setTimeout(function () {
          // Damit die Karte korrekt initialisiert werden kann, muss das togglen durch gsb_toggle auf die Kartenansicht abgeschlossen sein und das Element im DOM sichtbar sein.
          base.map = new ol.Map({
            target: base.$el.find(base.options.selectors.canvas).get(0),
            layers: base.createLayers(),
            overlays: base.createOverlays(),
            view: base.createView(),
            controls: base.createControls(),
            pixelRatio: 1
          });
          base.addMapEventListeners();
          base.fitMapToMarkersExtent({ minResolution: base.options.initialFitMinResolution });
          base.isMapCreated = true;
          // Falls die Seite in der Listenansicht aufgerufen wurde, und bereits Filter geklickt wurden, müssen diese Filterklicks nach dem Erstellen der Map an die Map weitergereicht werden.
          base.markerTypesToBeRemovedWhenMapIsCreated.forEach(function (markerType) {
            base.toggleMapMarker(markerType);
          });
          setTimeout(function () {
            base.accessibilityFix();
          }, 0);
        }, 0);
      } else {
        base.$el.find('canvas').css({ display: 'block' });
        setTimeout(function () {
          base.map.updateSize();
        }, 0);
      }
    };
    /**
     * Sorgt dafür, dass im mapPanel nichts antabbar ist.
     */
    base.accessibilityFix = function () {
      var toggleBase = base.$el.data('gsb.toggle'),
          mapPanel = toggleBase.$el.find('.panel-opened');
      mapPanel.find('a, button').attr('tabindex', '-1');
    };
    /**
     * Fügt die vorhandenen mapMarkerTypes der Filterliste unter der Map hinzu.
     */
    base.addFilterElementsToList = function addFilterElementsToList() {
      /* This is the Dom Structure which the function should produce:
      <li class="c-map__filter-item c-map__filter-item--{{markerType}}">
        <button role="checkbox" aria-checked="false" class="c-map__filter c-map__filter--checked">markerLabel
          <img>
        </button>
      </li>
      */
      var $filterList = base.$el.find(base.options.selectors.filterList);
      // nur ein FilterListen Element pro markerType
      var dataUniqueMarkerTypes = base.data.filter(function (entry, index, originalArray) {
        return originalArray.map(function (originalEntry) {
          return originalEntry.markerType;
        }).indexOf(entry.markerType) === index;
      });
      if (dataUniqueMarkerTypes.length > 1) {
        // mehr als einen Typ von Markern
        dataUniqueMarkerTypes.forEach(function (entry) {
          console.debug(entry);
          var $filterListElement = $('<li/>');
          $filterListElement.addClass(base.options.classes.filterListItem);
          $filterListElement.addClass(base.options.classes.filterListItem + '--' + entry.markerType);
          $filterListElement.attr('data-marker-type', entry.markerType);
          var $button = $('<button/>');
          $button.addClass(base.options.classes.filterListItemButton);
          $button.addClass(base.options.classes.filterListItemButton + '--checked');
          $button.attr('aria-checked', true);
          $button.attr('role', 'checkbox');
          $button.html(entry.markerLabel);
          var $img = $('<img/>');
          $img.attr('src', entry.filterIcon);
          $img.attr('alt', '');
          $button.append($img);
          $filterListElement.append($button);
          $filterList.append($filterListElement);
          $filterListElement.on('click', base.handleFilterListElementClick);
        });
      } else {
        // nur ein Typ von Markern
        var $ui = base.$el.find(base.options.selectors.ui);
        $ui.remove(); // Legende entfernen
      }
    };
    /**
     * Klont die Filterliste welche unter der Map angezeigt werden soll und fügt sie in der Listenansicht über der Liste ein.
     */
    base.addFiltersToListView = function addFiltersToListView() {
      var $ui = base.$el.find(base.options.selectors.ui);
      if ($ui.length > 0) {
        // keine vorhanden da diese in addFilterElementsToList entfernt wurde, also zeugen wir auch keine Legende
        base.$listTabPanel.prepend($ui.clone(true));
      }
    };
    // -------------------------------------------------- Map Creation --------------------------------------------------
    base.createLayers = function createLayers() {
      var mapLayer = new ol.layer.Tile({
        source: new ol.source.TileWMS({
          url: 'https://sgx.geodatenzentrum.de/wms_topplus_open',
          params: { 'SERVICE': 'WMS', 'LAYERS': 'web', 'TILED': true, 'VERSION': '1.1.1', 'FORMAT': 'image/png', 'WIDTH': '256', 'HEIGHT': '256' },
          serverType: 'geoserver',
          transition: 0
        })
      });
      base.markerLayer = base.createMarkerLayer();
      return [].concat(mapLayer, base.markerLayer);
    };
    base.createOverlays = function createOverlays() {
      var popupOverlay = base.createPopupOverlay();
      return [popupOverlay];
    };
    base.createView = function createView() {
      // no zoom or center needed, the view will be fitted to the extent after creation
      return new ol.View({});
    };
    base.createControls = function createMapControls() {
      return new ol.control.defaults({ zoom: false }).extend([base.createFullscreenControls(), base.createZoomControls()]);
    };
    base.createFullscreenControls = function createFullscreenControls() {
      var imgOpenFullscreen = $(base.options.html.openFullscreenButtonContent).get(0);
      var imgCloseFullscreen = $(base.options.html.closeFullscreenButtonContent).get(0);
      return new ol.control.FullScreen({
        label: imgOpenFullscreen,
        labelActive: imgCloseFullscreen,
        tipLabel: base.options.texts.fullscreenTipLabel,
        source: base.$el.find(base.options.selectors.map).get(0)
      });
    };
    base.createZoomControls = function createZoomControls() {
      var imgZoomIn = $(base.options.html.zoomInButtonContent).get(0);
      var imgZoomOut = $(base.options.html.zoomOutButtonContent).get(0);
      return new ol.control.Zoom({
        zoomInLabel: imgZoomIn,
        zoomOutLabel: imgZoomOut,
        zoomInTipLabel: base.options.texts.zoomInTipLabel,
        zoomOutTipLabel: base.options.texts.zoomOutTipLabel
      });
    };
    base.createMarkerLayer = function createMarkerLayer() {
      var markerFeatures = base.data.map(function (entry) {
        if (entry.isActive) {
          var markerStyle = base.createMarkerStyle(entry);
          var markerFeature = new ol.Feature(_objectSpread({ geometry: new ol.geom.Point(ol.proj.fromLonLat(entry.geo)) }, entry));
          markerFeature.setStyle(markerStyle);
          markerFeature.setId(markerFeature.ol_uid);
          entry.markerId = markerFeature.getId();
          return markerFeature;
        }
      });
      var vectorSource = new ol.source.Vector({
        features: markerFeatures
      });
      var markerLayer = new ol.layer.Vector({
        source: vectorSource
      });
      return markerLayer;
    };
    base.createMarkerStyle = function createMarkerStyle(entry) {
      var markerStyle = new ol.style.Style({
        image: new ol.style.Circle({
          fill: new ol.style.Fill({ color: base.options.fallbackMarkerFillColor }),
          radius: base.options.fallbackMarkerRadius
        })
      });
      if (entry.markerIcon) {
        markerStyle = new ol.style.Style({
          image: new ol.style.Icon({
            anchor: [0.5, 1],
            anchorXUnits: 'fraction',
            anchorYUnits: 'fraction',
            src: entry.markerIcon,
            scale: base.options.markerScale
          })
        });
      }
      return markerStyle;
    };
    base.createPopupOverlay = function createPopupOverlay() {
      var $popupCloser = base.$el.find(base.options.selectors.olPopupCloser);
      /*register the click handler before a new Overlay is created, because whilst creation of the overlay the popup element will be
        unreachable until the map has finished creation*/
      $popupCloser.on('click', function () {
        popupOverlay.setPosition(undefined);
        $popupCloser.blur();
        return false;
      });
      /* a new Overlay is created */
      var popupOverlay = new ol.Overlay({
        id: 'popupOverlay',
        element: base.$el.find(base.options.selectors.olPopup).get(0),
        autoPan: true,
        autoPanAnimation: { duration: base.options.popupAutoPanAnimationDuration }
      });
      return popupOverlay;
    };
    // -------------------------------------------------- Events --------------------------------------------------
    base.addMapEventListeners = function addMapEventListeners() {
      base.map.on('click', base.handleMapClick);
      if (base.options.clickToEnableScrollNeeded) {
        base.clickToEnableScrollNeeded();
      }
    };
    /**
     * Bevor die Map durch Scrollen gezoomed werden kann, muss erst einmal mit der Maus geklickt werden.
     */
    base.clickToEnableScrollNeeded = function clickToEnableScrollNeeded() {
      var mouseWheelZoom = void 0;
      base.map.getInteractions().forEach(function (interaction) {
        if (interaction instanceof ol.interaction.MouseWheelZoom) {
          mouseWheelZoom = interaction;
          mouseWheelZoom.setActive(false);
          $('.c-map__canvas').on('click', function () {
            console.log('foo');
            mouseWheelZoom.setActive(true);
          });
        }
      });
    };
    /**
     * Öffnen und Schließen von Popups
     * @param e Openlayers Event
     */
    base.handleMapClick = function handleMapClick(e) {
      var popupOverlay = base.map.getOverlayById('popupOverlay');
      var feature = base.map.forEachFeatureAtPixel(e.pixel, function (feature) {
        return feature;
      });
      var $popupContent = base.$el.find(base.options.selectors.olPopupContent);
      if (feature) {
        var coordinates = feature.getGeometry().getCoordinates();
        $popupContent.html(feature.values_.raw);
        popupOverlay.setPosition(coordinates); // open popup
      } else if (base.options.closePopupOnMapClick) {
        popupOverlay.setPosition(undefined); // close popup
      }
    };
    /**
     * Behandelt Klicks der Filter in Kartenansicht und Listenansicht
     * @param e jQuery Event
     */
    base.handleFilterListElementClick = function handleFilterListElementClick(e) {
      var selector = base.getSelector(e.currentTarget);
      var $filterListElements = base.$el.find(selector);
      var $filterButtons = $filterListElements.find('button');
      var markerType = $filterListElements.attr('data-marker-type');
      if (base.isMapCreated) {
        base.toggleMapMarker(markerType);
      } else {
        // Wenn die Map noch nicht erstellt worden ist, können wir die Marker noch nicht aus der Map entfernen.
        // Außerdem können wir die Map nicht korrekt in einem unsichtbaren Container erstellen.
        // Also müssen wir uns die in der Listenansicht angeklickten Filter, vor der Map Erstellung merken und diese dann beim Erstellen der Map berücksichtigen.
        base.rememberListViewFilterClicks(markerType);
      }
      base.toggleFilterButtons($filterButtons);
      base.toggleListViewEntriesVisibility(markerType);
      if (base.options.enableFitOnFilterChange) {
        base.fitMapToMarkersExtent();
      }
    };
    // ----------------------------------------------------------------------------------------------------
    /**
     * Werden Filter in der Listenansicht geklickt, bevor die Map erstellt worden ist, werden die zu entferndenen Marker zwischengespeichert.
     * Dies kann passieren wenn die Seite mit dem Anker '#section-liste' aufgerufen wird.
     * @param markerType
     */
    base.rememberListViewFilterClicks = function rememberListViewFilterClicks(markerType) {
      var index = base.markerTypesToBeRemovedWhenMapIsCreated.indexOf(markerType);
      if (index === -1) {
        base.markerTypesToBeRemovedWhenMapIsCreated.push(markerType);
      } else {
        base.markerTypesToBeRemovedWhenMapIsCreated.splice(index, 1);
      }
    };
    /**
     * Passt die View der Map so an, das alle Marker sichtbar sein sollten.
     * @param options OpenLayers Optionen für View.fit() https://openlayers.org/en/latest/apidoc/module-ol_View-View.html#fit
     */
    base.fitMapToMarkersExtent = function fitMapToMarkersExtent(options) {
      if (!options) {
        options = {};
      }
      options.constrainResolution = false;
      options.padding = options.padding ? options.padding : [50, 50, 50, 50];
      // options.duration = options.duration ? options.duration : base.options.fitAnimationDuration;
      base.map.getView().fit(base.markerLayer.getSource().getExtent(), options);
    };
    /**
     * Hinzufügen oder Entfernen des '--checked' Status als Klasse des Filter Buttons.
     * @param $filterButtons jQuery Objekt der Filterbuttons der Map und der Liste
     */
    base.toggleFilterButtons = function toggleFilterButtons($filterButtons) {
      if ($filterButtons.hasClass(base.options.classes.filterListItemButton + '--checked')) {
        $filterButtons.removeClass(base.options.classes.filterListItemButton + '--checked');
        $filterButtons.attr('aria-selected', false);
      } else {
        $filterButtons.addClass(base.options.classes.filterListItemButton + '--checked');
        $filterButtons.attr('aria-selected', true);
      }
    };
    /**
     * Hinzufügen oder Entfernen von Markern in der Map.
     * @param markerType Typ des Markers der entfernt werden soll.
     */
    base.toggleMapMarker = function toggleMapMarker(markerType) {
      base.data.forEach(function (entry) {
        if (entry.markerType === markerType) {
          entry.isActive = !entry.isActive;
          if (!entry.isActive) {
            base.markerLayer.getSource().forEachFeature(function (marker) {
              if (entry.markerId === marker.getId()) {
                base.markerLayer.getSource().removeFeature(marker);
                base.removedMarkers.push(marker);
              }
            });
          } else {
            base.removedMarkers.forEach(function (marker) {
              if (entry.markerId === marker.getId()) {
                base.markerLayer.getSource().addFeature(marker);
              }
            });
          }
        }
      });
    };
    base.toggleListViewEntriesVisibility = function toggleListViewEntriesVisibility(markerType) {
      base.$listEntries.each(function (index, entry) {
        var $entry = $(entry);
        $entry.removeClass('is-last-visible-entry');
        if ($entry.attr('data-geo-marker-type') === markerType) {
          if ($entry.hasClass('is-hidden')) {
            $entry.removeClass('is-hidden');
          } else {
            $entry.addClass('is-hidden');
          }
        }
      });
      base.$listEntries.filter(':visible').last().addClass('is-last-visible-entry'); // used to overwrite last-child:after css
    };
    base.selectMapOnFirstLoad = function selectMapOnFirstLoad(toggleCallback) {
      var toggleBase = base.$el.data('gsb.toggle');
      var panelToOpen = toggleBase.$el.find('.panel-closed');
      var panelToClose = toggleBase.$el.find('.panel-opened');
      toggleBase.aria.updateAria(base.$toggleListElement.find('a').get(0), true, false);
      panelToClose.removeClass('panel-opened').addClass('panel-closed');
      toggleBase.$el.find(toggleBase.options.tabControls).filter('.active-control').removeClass('active-control').addClass('inactive-control');
      panelToOpen.removeClass('panel-closed').addClass('panel-opened');
      base.$toggleListElement.find('a').first().removeClass('inactive-control').addClass('active-control');
      toggleBase.animationTab(panelToClose, panelToOpen);
      toggleCallback();
    };
    base.prepareMapHTML = function prepareMapHTML() {
      var $mapHTML = $(base.options.html.map);
      var legendText = base.$el.attr('data-geo-legend');
      if (legendText) {
        $mapHTML.find(base.options.selectors.legend).append(legendText);
      } else {
        console.debug('gsb_map: Label der Legende wird entfernt da das Attribut \'data-geo-legend\' im Element mit der Klasse \'' + base.$el.attr('class') + '\' nicht vorhanden ist');
        $mapHTML.find(base.options.selectors.legend).remove();
      }
      return $mapHTML;
    };
    base.getSelector = function getSelector(element) {
      var selector = '';
      // element.classList does not work as expected in IE
      element.className.split(' ').forEach(function (cssClass) {
        selector = selector + '.' + cssClass;
      });
      return selector;
    };
    base.init();
  };
  $.gsb.map.defaultOptions = {
    closePopupOnMapClick: true, // whether or not to close a popup whenever the map is clicked
    clickToEnableScrollNeeded: true, // we need to click the map once first before we allow to zoom by scrolling, this keeps normal scroll behavior of the page intact when scrolling while the
    // mouse is over the map
    markerScale: 0.25, // the size of the marker icons on the map, 1 means 100%
    enableFitOnFilterChange: false,
    popupAutoPanAnimationDuration: 500,
    fitAnimationDuration: 500,
    fallbackMarkerFillColor: 'red',
    fallbackMarkerRadius: 12, // in px
    initialFitMinResolution: 1, // use 0 to turn off
    classes: {
      filterListItem: 'c-map__filter-item',
      filterListItemButton: 'c-map__filter'
    },
    selectors: {
      tabList: '.c-locations__tab-list',
      tabItem: '.c-locations__tab-item',
      tabListHeading: '.c-locations__subheading',
      map: '.c-map',
      canvas: '.c-map__canvas',
      legend: '.c-map__legend',
      listTabPanel: '.js-locations-content',
      listEntry: '.c-teaser',
      listEntryTeaser: '.c-teaser__text',
      olPopup: '.ol-popup',
      olPopupCloser: '.ol-popup-closer',
      olPopupContent: '.ol-popup-content',
      filterList: '.c-map__filter-list',
      ui: '.c-map__ui'
    },
    gsbToggleOptions: {
      accordion: false,
      accordionContainer: '.c-locations__content',
      elements: '.c-locations__subheading + div',
      heading: '.c-locations__subheading',
      tabControls: '.c-locations__tab-list a',
      tabControlContainer: '.c-locations__tab-list',
      tabListHeading: '.c-locations__heading',
      responsive: null
    },
    texts: {
      zoomInTipLabel: typeof MAP_ZOOM_IN_BUTTON_TITLE === 'undefined' ? 'MAP_ZOOM_IN_BUTTON_TITLE ist nicht definiert' : MAP_ZOOM_IN_BUTTON_TITLE,
      zoomOutTipLabel: typeof MAP_ZOOM_OUT_BUTTON_TITLE === 'undefined' ? 'MAP_ZOOM_OUT_BUTTON_TITLE ist nicht definiert' : MAP_ZOOM_OUT_BUTTON_TITLE,
      fullscreenTipLabel: typeof MAP_FULLSCREEN_BUTTON_TITLE === 'undefined' ? 'MAP_FULLSCREEN_BUTTON_TITLE' : MAP_FULLSCREEN_BUTTON_TITLE
    },
    html: {
      zoomInButtonContent: '<img alt="" src="' + (typeof image_url_zoom_in === 'undefined' ? 'image_url_zoom_in ist nicht definiert' : image_url_zoom_in) + '">',
      zoomOutButtonContent: '<img alt="" src="' + (typeof image_url_zoom_out === 'undefined' ? 'image_url_zoom_out ist nicht definiert' : image_url_zoom_out) + '">',
      openFullscreenButtonContent: '<img alt="" src="' + (typeof image_url_open_fullscreen === 'undefined' ? 'image_url_open_fullscreen ist nicht definiert' : image_url_open_fullscreen) + '">',
      closeFullscreenButtonContent: '<img alt="" src="' + (typeof image_url_close_fullscreen === 'undefined' ? 'image_url_close_fullscreen ist nicht definiert' : image_url_close_fullscreen) + '">',
      toggleListElement: '' + '<li class="c-locations__tab-item">' + '  <a id="tabheading2" role="tab" aria-controls="tabpanel2" aria-selected="false" class="c-locations__tab-link" href="#">' + (typeof MAP_TAB_LABEL === 'undefined' ? 'MAP_TAB_LABEL ist nicht definiert' : MAP_TAB_LABEL) + '  </a>' + '</li>',
      map: '' + '<h3 class="c-locations__subheading">' + (typeof MAP_TAB_LABEL === 'undefined' ? 'MAP_TAB_LABEL ist nicht definiert' : MAP_TAB_LABEL) + '</h3>' + '<div id="tabpanel2" role="tabpanel" aria-labelledby="tabheading2">' + '  <div class="c-map c-locations__map fullscreen">' + '    <div class="c-map__canvas" aria-hidden="true" />' + '    <p class="aural">' + (typeof MAP_FILTER_LIST_AURAL === 'undefined' ? 'MAP_FILTER_LIST_AURAL ist nicht definiert' : MAP_FILTER_LIST_AURAL) + '    </p>' + '    <div class="c-map__ui">' + // Klasse options.selectors.ui
      '      <h4 class="c-map__legend"></h4>' + '      <ul class="c-map__filter-list"/>' + // wird durch das Modul gefüllt
      '    </div>' + '  </div>' + '  <div class="ol-popup">' + '    <a href="#" class="ol-popup-closer"/>' + '    <div class="ol-popup-content"/>' + '  </div>' + '</div>'
    }
  };
  $.fn.gsb_map = function (options) {
    return this.each(function () {
      $.gsb.map(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_map */
   /* Start gsb_feedback */
   /**
 * @name gsb_feedback
 * @version 0.0.1
 * @see {@link http://semver.org|Semantic Versioning}
 * @author cmadmin
 *
 * @desc Feedbackformular:
 * - bei Auswahl 'nein' wird ein zusätzliches Feedback-Feld angezeigt
 * - bei Auswahl 'ja' wird das Formular abgeschickt
 *
 * @requires  {@link external:jQuery}
 *
 * @example
 * $('.c-feedback').gsb_feedback();
 *
 */
(function ($) {
  "use strict";

  if (!$.gsb) {
    $.gsb = {};
  }

  $.gsb.feedback = function (el, options) {
    // To avoid scope issues, use 'base' instead of 'this'
    // to reference this class from internal events and functions.
    var base = this;

    // Access to jQuery and DOM versions of element
    base.$el = $(el);
    base.el = el;

    // Add a reverse reference to the DOM object
    base.$el.data("gsb.feedback", base);

    base.init = function () {
      base.options = $.extend({}, $.gsb.feedback.defaultOptions, options);
      base.addClickFunctions();
    };

    // Implementierung
    $.gsb.feedback.prototype.addClickFunctions = function () {
      base.toggleContainer(false);
      base.$el.find(base.options.wrapper).append('<a href="#" class="c-feedback__close" title="' + CLOSE + '"><img src="' + base.options.closeBtn + '" width="10" alt=""/></a>');

      base.$el.find('input[value="1"]').on("click", function () {
        base.toggleContainer(true);
        //base.$el.find('input[type="submit"]').trigger("click");
      });

      base.$el.find('input[value="0"]').on("click", function () {
        base.toggleContainer(true);
      });

      base.$el.find(".c-feedback__close").on("click", function (e) {
        e.preventDefault();
        e.stopPropagation();

        base.toggleContainer(false);
        base.$el.find('input[value="0"],input[value="1"]').prop("checked", false);
      });
    };

    $.gsb.feedback.prototype.toggleContainer = function (show) {
      if (show === false && !base.$el.hasClass('c-feedback--closed')) {
        base.$el.find('textarea').val('');
        base.$el.find(base.options.wrapper).hide();
        base.$el.removeClass('c-feedback--opened').addClass('c-feedback--closed');
      } else {
        base.$el.find(base.options.wrapper).show();
        base.$el.removeClass('c-feedback--closed').addClass('c-feedback--opened');
        base.$el.find('textarea').focus();
      }
    };

    // Run initializer
    base.init();
  };

  $.gsb.feedback.defaultOptions = {
    wrapper: '.c-feedback__wrapper',
    closeBtn: image_url_close_b
  };

  $.fn.gsb_feedback = function (options) {
    return this.each(function () {
      new $.gsb.feedback(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_feedback */
   /* Start gsb_googlemaps */
   (function($){if(!$.gsb){$.gsb={};}$.gsb.googlemaps=function(el,options){var base=this;base.$el=$(el);base.el=el;base.$el.data("gsb.googlemaps",base);base.init=function(){base.options=$.extend({},$.gsb.googlemaps.defaultOptions,options);base.latLng=new google.maps.LatLng(base.$el.attr("data-geoLat"),base.$el.attr("data-geoLon"));base.$el.gsb_responsiveListener(base);};$.gsb.googlemaps.prototype.initMap=function(){base.map=new google.maps.Map(base.el,{center:base.latLng,zoom:base.options.zoom,minZoom:base.options.minZoom,maxZoom:base.options.maxZoom,zoomControl:true,mapTypeControl:false,scaleControl:false,streetViewControl:false,rotateControl:false,fullscreenControl:false});base.marker=new google.maps.Marker({position:base.latLng,icon:image_url_gmaps_marker,map:base.map});};$.gsb.googlemaps.prototype.setCenter=function(zoom){base.map.setCenter(base.latLng);base.map.setZoom(zoom);};$.ajax({url:"//maps.googleapis.com/maps/api/js?key=AIzaSyB1EJSvaRHXY1iAFib9WDz4d7TPdetgf5I",dataType:"script",cache:true,success:onGoogleMapsAPILoaded});function onGoogleMapsAPILoaded(){base.init();}};$.gsb.googlemaps.defaultOptions={zoom:16,minZoom:12,maxZoom:18,respondToEvents:true,onRefresh:function onRefresh(){this.initMap();this.setCenter(16);},responsive:[{breakpoint:9999,onRefresh:function onRefresh(){this.initMap();this.setCenter(16);}},{breakpoint:1024,onRefresh:function onRefresh(){this.initMap();this.setCenter(15);}}]};$.fn.gsb_googlemaps=function(options){return this.each(function(){if(!$.data(this,"plugin_gsb_googlemaps")){$.data(this,"plugin_gsb_googlemaps",new $.gsb.googlemaps(this,options));}});};})(jQuery);
   /* Ende gsb_googlemaps */
   /* Start gsb_glossary */
   /**
 * @name gsb_glossary
 * @version 0.0.1
 * @see {@link http://semver.org|Semantic Versioning}
 * @author cmadmin
 *
 * @desc Erstellt ein Tooltip/Popup für den Glossar-Link
 *
 * @requires  {@link external:jQuery}
 *
 * @example
 * $('.GlossarEntry[data-lightbox-href]').gsb_glossary();
 */
(function ($) {
  "use strict";

  if (!$.gsb) {
    $.gsb = {};
  }

  $.gsb.glossary = function (el, options) {
    // To avoid scope issues, use 'base' instead of 'this'
    // to reference this class from internal events and functions.
    var base = this;

    // Access to jQuery and DOM versions of element
    base.$el = $(el);
    base.el = el;

    // Add a reverse reference to the DOM object
    base.$el.data("gsb.glossary", base);

    base.init = function () {
      base.options = $.extend({}, $.gsb.glossary.defaultOptions, options);
      base.addClasses();
      base.addTemplate();
      base.addClickFunctions();
    };

    $.gsb.glossary.prototype.addClasses = function () {
      base.$el.attr('aria-haspopup', 'true');
      base.$el.attr('aria-describedby', 'c-glossarypopup');
    };

    $.gsb.glossary.prototype.addTemplate = function () {
      $('body').append(base.options.template);
      $('.c-glossarypopup').find('.c-glossarypopup__close').text(base.options.closeLabel);
    };

    $.gsb.glossary.prototype.addClickFunctions = function () {
      var element = $(base.options.class);
      var parent = element.parent().parent();

      base.$el.on("click", function (e) {
        e.preventDefault();
        e.stopPropagation();

        var offset = $('body').offset();
        var left = e.pageX - offset.left - 50;
        var top = e.pageY - offset.top - 135;

        $.ajax({
          url: $(this).data('lightbox-href'),
          data: {}
        }).done(function (data) {
          element.empty().prepend(data);
          parent.show();
          parent.css({ "left": left, "top": top - parent.height() });
          $('html,body').animate({
            scrollTop: top - parent.height() - 20
          }, 1000, function () {
            element.parent().find('.c-glossarypopup__close').focus();
          });
        });
      });

      element.on("keydown", function (e) {
        if (e.which === 13) {
          parent.hide();
        }
      });

      element.parent().find('.c-glossarypopup__close').on("click", function () {
        parent.hide();
      });
    };

    // Run initializer
    base.init();
  };

  $.gsb.glossary.defaultOptions = {
    class: '.c-glossarypopup__item',
    template: '<div id="c-glossarypopup" class="c-glossarypopup">' + '<div class="c-glossarypopup__wrapper">' + '<div class="c-glossarypopup__item"></div>' + '<button class="c-glossarypopup__close"></button>' + '</div>' + '</div>',
    closeLabel: typeof CLOSE === 'undefined' ? 'Schließen (Esc)' : CLOSE
  };

  $.fn.gsb_glossary = function (options) {
    return this.each(function () {
      new $.gsb.glossary(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_glossary */
   /* Start gsb_flyoutNavigation */
   /*!
 * Licensed under the MIT license
 * --GSBDocStart
 * @module gsb_flyoutNavigation
 * @version 1.1.0
 * @see {@link http://semver.org|Semantic Versioning}
 * @author pespeloe
 *
 * @desc Das Addon dient der Darstellung des Flyout-Menüs auf der Seite
 *
 * @requires jQuery >= 1.11.1, gsb_responsiveListener, jsonQ
 *
 * @init
 *  $('#navPrimary').gsb_flyoutNavigation();
 *--GSBDocEnd
 * */
(function ($) {
  "use strict";

  if (!$.gsb) {
    $.gsb = {};
  }

  $.gsb.flyoutNavigation = function (el, options) {
    // To avoid scope issues, use 'base' instead of 'this'
    // to reference this class from internal events and functions.
    var base = this,
        isHomePage = $('.startseite').length;

    // Access to jQuery and DOM versions of element
    base.$el = $(el);
    base.el = el;

    // Cache für spezielle Flyout-Inhalte
    base.customContentCache = {};

    base.init = function () {
      base.options = $.extend({}, $.gsb.flyoutNavigation.defaultOptions, options);
      base.currentNavNode = $('body').data('nn');
      if (base.options.jsonurl.indexOf("?") > 0) {
        base.options.jsonurl = base.options.jsonurl + "&nn=" + base.currentNavNode;
      } else {
        base.options.jsonurl = base.options.jsonurl + "?nn=" + base.currentNavNode;
      }

      base.initializeMenu();
    };

    /**
     * @method initializeMenu
     * @desc macht die Vorbereitungen für das Flyout und das mobile Menü
     */
    $.gsb.flyoutNavigation.prototype.initializeMenu = function () {
      $.get(base.options.jsonurl, function (data) {
        base.data = data;
        base.$el.gsb_responsiveListener(base);
      });
    };

    $.gsb.flyoutNavigation.prototype.createOverviewLinkIfAllowed = function (model, breadcrumb) {
      if (!breadcrumb.activeNode.notSelectable) {
        model.overviewLink = breadcrumb.activeNode;
      }
    };

    /**
     * @method _largeflyoutNavigation
     * @desc Setzt Event-Listener (mouseenter / mouseleave) auf die hover-Items und blendet die untergeordneten
     * Container ein oder aus
     */
    $.gsb.flyoutNavigation.prototype.largeFlyoutNavigation = function () {

      $.get(base.options.large.mstTemplate, assembleLargeFlyoutNavigationWithTemplate);

      function assembleLargeFlyoutNavigationWithTemplate(template) {
        var $largeTriggerLinks = $(base.options.large.triggerLinks, base.$el),
            navigationData = base.data.navigation,
            jsonObj = jsonQ(navigationData);

        base.flyoutContainer = $(base.options.flyoutContainer);

        resetLargeFlyoutStateAfterBreakpointChangeIfNecessary($largeTriggerLinks);

        $largeTriggerLinks.on('click', onLargeFlyoutTriggerLinkClicked);
        base.flyoutContainer.on('click', base.options.large.closeButton, onCloseButtonClicked);
        base.flyoutContainer.on('click', base.options.navigationLinks, onNavigationLinkWithinLargeFlyoutClicked);
        base.flyoutContainer.on('gsb.flyoutNavigation.onFlyoutRendered', base.onFlyoutRendered);

        function resetLargeFlyoutStateAfterBreakpointChangeIfNecessary($largeTriggerLinks) {
          base.flyoutContainer.empty();
          $largeTriggerLinks.off('click').addClass('navPrimary--closed').attr('aria-haspopup', true).attr('aria-expanded', false);
          base.flyoutContainer.off("click");
          $('html,body').removeClass('mobileFixed');
        }

        function onCloseButtonClicked(e) {
          e.preventDefault();
          e.stopPropagation();

          base.$el.find('.navPrimary--opened').focus().attr({ 'aria-expanded': false }).removeClass('navPrimary--opened').addClass('navPrimary--closed');
          base.flyoutContainer.empty();
        }

        function onLargeFlyoutTriggerLinkClicked() {
          /*jshint validthis: true */

          var $flyoutTriggerLink = $(this);

          if (base.flyoutContainer) {
            base.flyoutContainer.empty();
          }

          var uniqueParentNodeId = base.$el.find('.topinpath h3 a').data('nn');
          base.openedFlyoutNodeId = determineNodeToOpenForFlyout(uniqueParentNodeId, base.currentNavNode);

          //keine animation durchführen, einfach nur flyout anzeigen
          base.direction = null;

          $largeTriggerLinks.attr({ 'aria-expanded': false }).removeClass('navPrimary--opened').addClass('navPrimary--closed');
          $flyoutTriggerLink.attr({ 'aria-expanded': true }).addClass('navPrimary--opened').removeClass('navPrimary--closed');

          function determineNodeToOpenForFlyout(uniqueParentNodeId, currentNavNode) {
            var flyoutTriggerLinkId = $flyoutTriggerLink.data('nn');
            if (uniqueParentNodeId) {
              var activeNavPrimaryParentNode = jsonObj.find("id").parent().filter({ "id": uniqueParentNodeId }),
                  clickedNodeIsActiveNavPrimaryParentNode = flyoutTriggerLinkId === activeNavPrimaryParentNode.value()[0].id,
                  currentNavNodeIsBelowActiveNavPrimaryParentNode = activeNavPrimaryParentNode.find("id").parent().filter({ "id": currentNavNode }).length > 0;
              if (clickedNodeIsActiveNavPrimaryParentNode && currentNavNodeIsBelowActiveNavPrimaryParentNode) {
                return currentNavNode;
              }
            }
            return flyoutTriggerLinkId;
          }

          return !largeUpdateFlyout(template, uniqueParentNodeId);
        }

        function onNavigationLinkWithinLargeFlyoutClicked(e) {
          /*jshint validthis: true */

          e.preventDefault();
          e.stopPropagation();

          var $navigationLink = $(this);
          base.openedFlyoutNodeId = $navigationLink.data('nn');
          base.direction = $navigationLink.data('direction');
          largeUpdateFlyout(template);
          base.addA11y(base.flyoutContainer);
        }

        function largeUpdateFlyout(template, uniqueParentNodeId) {
          var didUpdateFlyout = false;

          var _createModelForLargeF = createModelForLargeFlyout(),
              model = _createModelForLargeF.model,
              customContentURL = _createModelForLargeF.customContentURL;

          if (customContentURL || model.childNodes.length) {
            didUpdateFlyout = true;
            base.renderFlyoutConsideringCustomContent(customContentURL, template, model);
          }

          function createModelForLargeFlyout() {
            var model = {},
                path = base.getPath(uniqueParentNodeId, jsonObj),
                jsonPath = navigationData;

            model.home = getHomeNode(jsonObj);
            var breadcrumb = base.getBreadcrumb(path, jsonPath);
            // erste Ebene entfernen, da Startseite nicht in der Breadcrumb auftauchen soll
            model.parentNodes = breadcrumb.parentNodes.slice(1);
            model.activeNode = breadcrumb.activeNode;
            base.createOverviewLinkIfAllowed(model, breadcrumb);
            model.childNodes = base.getChildNodes(model.activeNode);

            var customContentURL = model.activeNode.customContentURL;
            return { model: model, customContentURL: customContentURL };
          }

          function getHomeNode(jsonObj) {
            var home = void 0;

            var homeNode = jsonObj.find('isRoot', 'first').parent().value();
            if (homeNode.length) {
              home = homeNode[0];
              home.isActive = isHomePage;
            }

            return home;
          }

          return didUpdateFlyout;
        }
      }
    };

    /**
     * @method _largeflyoutNavigation
     * @desc Setzt Event-Listener (mouseenter / mouseleave) auf die hover-Items und blendet die untergeordneten Container ein oder aus
     */
    $.gsb.flyoutNavigation.prototype.smallFlyoutNavigation = function () {

      $.get(base.options.small.mstTemplate, assembleSmallFlyoutNavigationWithTemplate);

      function assembleSmallFlyoutNavigationWithTemplate(template) {
        var $smallTriggerLinks = $(base.options.small.triggerLinks, base.$el);

        base.flyoutContainer = $(base.options.flyoutContainer);

        resetSmallFlyoutStateAfterBreakpointChangeIfNecessary($smallTriggerLinks);

        $smallTriggerLinks.on('click', onSmallFlyoutTriggerLinkClicked);
        base.flyoutContainer.on('click', base.options.navigationLinks, onNavigationLinkWithinSmallFlyoutClicked);
        base.flyoutContainer.on('gsb.flyoutNavigation.onFlyoutRendered', base.onFlyoutRendered);

        function resetSmallFlyoutStateAfterBreakpointChangeIfNecessary($smallTriggerLinks) {
          base.flyoutContainer.empty();
          $smallTriggerLinks.off().attr({ 'aria-expanded': false }).addClass('navPrimary--closed');
          base.flyoutContainer.off("click");
        }

        function onSmallFlyoutTriggerLinkClicked(e) {
          /*jshint validthis: true */

          e.preventDefault();
          e.stopPropagation();

          var $flyoutTriggerLink = $(this);
          base.openedFlyoutNodeId = $flyoutTriggerLink.data('nn') || base.currentNavNode;
          base.direction = null;

          updateSmallFlyoutTriggerLinksStateAfterClick($smallTriggerLinks, $flyoutTriggerLink);

          var uniqueParentNodeId = base.$el.find('.topinpath h3 a').data('nn'),
              $body = $('body');

          if ($flyoutTriggerLink.hasClass('navPrimary--closed')) {
            openSmallFlyoutForTriggerLink();
          } else {
            closeSmallFlyout();
          }

          $smallTriggerLinks.not($flyoutTriggerLink).attr({ 'aria-expanded': false }).removeClass('navPrimary--opened').addClass('navPrimary--closed');

          function updateSmallFlyoutTriggerLinksStateAfterClick($smallTriggerLinks, $clickedTriggerLink) {
            toggleClickedTriggerLink();
            deactivateOtherTriggerLinks();

            function toggleClickedTriggerLink() {
              var $clickedTriggerLinkImage = $clickedTriggerLink.find('img').first(),
                  targetState = $clickedTriggerLinkImage.attr('src') === $clickedTriggerLinkImage.data('active-src') ? 'inactive' : 'active';
              updateImageAttributesForState($clickedTriggerLinkImage, targetState);
            }

            function deactivateOtherTriggerLinks() {
              $smallTriggerLinks.not($clickedTriggerLink).find('img').each(function () {
                var $image = $(this);
                updateImageAttributesForState($image, 'inactive');
              });
            }

            function updateImageAttributesForState($image, state) {
              var inactiveAltAttr = $image.attr('data-' + state + '-alt'),
                  inactiveSrcAttr = $image.attr('data-' + state + '-src');
              if (inactiveSrcAttr && inactiveAltAttr) {
                $image.attr('src', inactiveSrcAttr);
                $image.attr('alt', inactiveAltAttr);
              }
            }
          }

          function openSmallFlyoutForTriggerLink() {
            $flyoutTriggerLink.attr({ 'aria-expanded': true }).addClass('navPrimary--opened').removeClass('navPrimary--closed');
            smallUpdateFlyout(template, uniqueParentNodeId);
            $('html,body').addClass('mobileFixed');
          }

          function closeSmallFlyout() {
            base.$el.find('.navPrimary--opened').focus().attr({ 'aria-expanded': false }).removeClass('navPrimary--opened').addClass('navPrimary--closed');
            base.flyoutContainer.empty();
            $('html,body').removeClass('mobileFixed');
          }
        }

        function onNavigationLinkWithinSmallFlyoutClicked(e) {
          /*jshint validthis: true */

          e.preventDefault();
          e.stopPropagation();

          var $navigationLink = $(this);
          base.openedFlyoutNodeId = $navigationLink.data('nn');
          base.direction = $navigationLink.data('direction');
          smallUpdateFlyout(template);
        }

        function smallUpdateFlyout(template, uniqueParentNodeIdPath) {
          var _createModelForSmallF = createModelForSmallFlyout(),
              model = _createModelForSmallF.model,
              customContentURL = _createModelForSmallF.customContentURL;

          base.renderFlyoutConsideringCustomContent(customContentURL, template, model);

          function createModelForSmallFlyout() {
            var model = {},
                navigationData = base.data.navigation,
                servicenavigationData = base.data.servicenavigation,
                jsonObj = jsonQ(navigationData),
                path = base.getPath(uniqueParentNodeIdPath, jsonObj);

            var breadcrumb = base.getBreadcrumb(path, navigationData),
                activeFlyoutNode = breadcrumb.activeNode,
                customContentURL = activeFlyoutNode.customContentURL;

            createOverviewAndBackLinksForNonRootNodes(breadcrumb, model);
            model.childNodes = base.getChildNodes(activeFlyoutNode);
            model.serviceNodes = getServiceNodes(servicenavigationData);

            function createOverviewAndBackLinksForNonRootNodes(breadcrumb, model) {
              if (!breadcrumb.activeNode.isRoot) {
                var parentNodeOfActiveNode = breadcrumb.parentNodes[breadcrumb.parentNodes.length - 1];
                model.backLink = parentNodeOfActiveNode;
                model.backLink.nn = parentNodeOfActiveNode.id;
                base.createOverviewLinkIfAllowed(model, breadcrumb);
              }
            }

            function getServiceNodes(servicenavigationData) {
              var serviceNodes = [];
              servicenavigationData.forEach(function (serviceNode) {
                var serviceLink = serviceNode;
                serviceLink.isActive = serviceNode.id === base.currentNavNode;
                serviceNodes.push(serviceLink);
              });
              return serviceNodes;
            }

            return { model: model, customContentURL: customContentURL };
          }
        }
      }
    };

    // Helper Funktionen
    $.gsb.flyoutNavigation.prototype.getPath = function (uniqueParentNodeId, jsonObj) {
      var path = void 0;

      if (uniqueParentNodeId) {
        base.jsonQOpenedFlyoutNode = jsonObj.find("id").parent().filter({ "id": uniqueParentNodeId }).find("id").parent().filter({ "id": base.openedFlyoutNodeId });
        if (base.jsonQOpenedFlyoutNode.length) {
          path = base.jsonQOpenedFlyoutNode.path();

          //Wenn der Aktive Knoten keine Kindelemente hat, zeige flyout mit siblings
          if (!base.jsonQOpenedFlyoutNode.value()[0].hasOwnProperty("childs")) {
            path.splice(-2, 2);
          }
        }
      }
      if (!path) {
        base.jsonQOpenedFlyoutNode = jsonObj.find("id").parent().filter({ "id": base.openedFlyoutNodeId });
        if (base.jsonQOpenedFlyoutNode.length) {
          path = base.jsonQOpenedFlyoutNode.path();
        } else {
          path = jsonObj.find("isRoot", "first").parent().path();
        }
      }
      return path;
    };

    $.gsb.flyoutNavigation.prototype.getBreadcrumb = function (path, jsonPath) {

      var breadcrumb = {};
      breadcrumb.parentNodes = [];

      //Breadcrumb
      path.forEach(function (element, index) {
        jsonPath = jsonPath[element];

        if (element !== "childs" && index !== path.length - 1) {

          var pathLink = jsonPath;
          pathLink.nn = pathLink.id;
          breadcrumb.parentNodes.push(pathLink);
        } else {

          breadcrumb.activeNode = jsonPath;

          //Wenn in Übersicht Link aktiv gesetzt werden soll
          if (jsonPath.id === base.currentNavNode) {
            breadcrumb.activeNode.isActive = true;
          }
        }
      });

      return breadcrumb;
    };

    $.gsb.flyoutNavigation.prototype.getChildNodes = function (activeFlyoutNode) {
      var childNodes = [];
      if (activeFlyoutNode.hasOwnProperty("childs")) {
        activeFlyoutNode.childs.forEach(function (child) {
          child.nn = child.id;
          child.isActive = child.nn === base.currentNavNode;
          child.hasChilds = child.hasOwnProperty("childs");
          childNodes.push(child);
        });
      }

      return childNodes;
    };

    $.gsb.flyoutNavigation.prototype.addA11y = function (elem) {
      elem = elem || base.$el;
      var focusElements = elem.find('button,a,input,textarea,select');

      focusElements[1].focus();
      focusElements.last().keydown(function (e) {
        if (e.keyCode === 9) {
          e.preventDefault();
          focusElements[0].focus();
        } else if (e.keyCode === 13) {
          return true;
        }
      });
    };

    $.gsb.flyoutNavigation.prototype.renderFlyoutConsideringCustomContent = function (customContentURL, template, model) {
      if (customContentURL && !base.customContentCache[base.openedFlyoutNodeId]) {
        $.get(customContentURL, function (customContent) {
          base.customContentCache[base.openedFlyoutNodeId] = customContent;
          model.customContent = customContent;
          base.renderFlyout(template, model, base.openedFlyoutNodeId);
        });
      } else {
        model.customContent = base.customContentCache[base.openedFlyoutNodeId];
        base.renderFlyout(template, model);
      }
    };

    $.gsb.flyoutNavigation.prototype.renderFlyout = function (template, model) {

      var rendered = $(Mustache.render(template, model));

      if (base.direction) {

        var slideOut = base.flyoutContainer.find('.slideContainer').addClass('toHide').clone(),
            slideWrapper = base.flyoutContainer.find('.slideWrapper');

        rendered.find('.slideWrapper').height(slideWrapper.height());

        //linksrausschieben
        slideOut.insertAfter(rendered.find('.slideContainer').addClass('slideContainer--' + base.direction + ' toShow'));
      }

      base.flyoutContainer.empty().append(rendered).find('[data-autosuggest-url]').each(function () {
        var $autosuggestContainer = $(this);
        $autosuggestContainer.gsb_AutoSuggest($autosuggestContainer.data('autosuggest-url'));
      });

      //Wenn üeber Primärnavigation geöffnet wurde, Höhe anhand slideContainer setzen
      if (base.direction === null) {
        var flyoutHeight = base.flyoutContainer.find('.slideContainer').outerHeight();
        base.flyoutContainer.find('.slideWrapper').height(flyoutHeight);
      }

      var oldContainer = base.flyoutContainer.find('.toHide').removeClass('toHide'),
          newContainer = base.flyoutContainer.find('.toShow');

      //Wenn Container zum sliden vorhanden sind
      if (oldContainer.length > 0) {

        var slideOutdirection = "rightoutside",
            slideInContainer = "leftoutside";

        if (base.direction === "rightoutside") {
          slideOutdirection = "leftoutside";
          slideInContainer = "rightoutside";
        }

        setTimeout(function () {
          oldContainer.removeClass('toHide').addClass("slideContainer--" + slideOutdirection);
          newContainer.removeClass("slideContainer--" + slideInContainer);
        }, 100);

        setTimeout(function () {
          base.flyoutContainer.find('.slideWrapper').height(newContainer.outerHeight());
          oldContainer.remove();
          base.addA11y(base.flyoutContainer);
        }, 300);
      }

      base.flyoutContainer.trigger('gsb.flyoutNavigation.onFlyoutRendered');
    };

    $.gsb.flyoutNavigation.prototype.onFlyoutRendered = function () {
      base.flyoutContainer.find('[data-focus]').first().focus();
    };

    // Run initializer
    base.init();
  };

  $.gsb.flyoutNavigation.defaultOptions = {
    jsonurl: json_url_navPrimary,
    navigationLinks: ".flyout-link",
    flyoutContainer: '#js-flyout',
    large: {
      mstTemplate: json_url_largeFlyoutTemplate,
      triggerLinks: ".navPrimary__desktop .flyout-trigger-link",
      closeButton: '.c-flyoutNavigation__close button'
    },
    small: {
      mstTemplate: json_url_smallFlyoutTemplate,
      triggerLinks: ".navPrimary__mobile .flyout-trigger-link",
      mobileSearchTrigger: '.navPrimary__mobile--search'
    },
    respondToEvents: true,
    onRefresh: function onRefresh() {
      this.largeFlyoutNavigation();
    },
    responsive: [{
      breakpoint: 1024,
      onRefresh: function onRefresh() {
        this.smallFlyoutNavigation();
      }
    }]
  };

  //Search Reset
  $.fn.gsb_flyoutNavigation = function (options) {
    return this.each(function () {
      if (!$.data(this, "plugin_gsb_flyoutNavigation")) {
        $.data(this, "plugin_gsb_flyoutNavigation", new $.gsb.flyoutNavigation(this, options));
      }
    });
  };
})(jQuery);
   /* Ende gsb_flyoutNavigation */
   /* Start gsb_picture_support */
   /*!
 * @name picture_support
 * @author pespeloe
 * Licensed under the MIT license
 *
 * @requires jQuery >= 1.7.2,
 * */
;
(function ($) {
  if (!$.gsb) {
    $.gsb = {};
  }
  ;

  $.gsb.picture_support = function (el, options) {
    // To avoid scope issues, use 'base' instead of 'this'
    // to reference this class from internal events and functions.
    var base = this;

    // Access to jQuery and DOM versions of element
    base.$el = $(el);
    base.el = el;

    // Add a reverse reference to the DOM object
    base.$el.data("gsb.picture_support", base);

    base.init = function () {
      base.options = $.extend({}, $.gsb.picture_support.defaultOptions, options);
      var picture = document.createElement("picture");
      var source = document.createElement("source");
      $('<img src=""/>').insertBefore(base.$el.find('noscript'));
      base.$el.find('> img').attr("alt", base.$el.data("alttext"));
      try {
        if (picture.constructor == HTMLPictureElement) {
          return;
        }
      } catch (e) {
        base.largeSrc = base.$el.find(".l").data("src");
        base.$el.materna_responsiveListener(base);
      }
    };

    $.gsb.picture_support.prototype.changeToLarge = function () {
      if (base.$el.find('> img').prop('src') != base.largeSrc) {
        base.$el.find('> img').prop('src', base.largeSrc);
      }
    };

    $.gsb.picture_support.prototype.changeToSmall = function () {
      base.$el.find('> img').prop('src', base.$el.find('.s').data("src"));
    };
    // Run initializer
    base.init();
  };

  $.gsb.picture_support.defaultOptions = {
    respondToEvents: true,
    onRefresh: function onRefresh() {
      this.changeToLarge();
    },
    responsive: [{
      breakpoint: 600,
      onRefresh: function onRefresh() {
        this.changeToSmall();
      }
    }]
  };

  $.fn.gsb_picture_support = function (options) {
    return this.each(function () {
      new $.gsb.picture_support(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_picture_support */
   /* Start gsb_shariff */
   /**
 * @name gsb_shariff
 * @version 1.1.0
 * @see {@link http://semver.org|Semantic Versioning}
 * @author rkrusenb
 *
 * @desc Control/Wrapper-Modul für heise shariff
 *
 * @requires  {@link external:jQuery} {@link external:shariff}
 *
 * @example
 *
 *   $("#navFunctionsWrapper").gsb_shariff({
 *     toggleElement: '#navFunctionsRecommend a',
 *     wrapperClass: 'share',
 *     closeButton: true
 *   });
 */
;(function ($) {
    'use strict';

    if (!$.gsb) {
        $.gsb = {};
    }

    $.gsb.shariff = function shariff(el, options) {
        var base = Object.create(shariff.prototype);
        base.$el = $(el);
        base.el = el;
        base.moduleName = "gsb.shariff";
        base.$el.data(base.moduleName, base);
        base.options = $.extend({}, $.gsb.shariff.defaultOptions, options);
        if (base.$el.gsb_responsiveListener) {
            base.$el.gsb_responsiveListener(base);
        }
        base.init();
    };

    $.gsb.shariff.prototype = {
        init: function init() {
            var base = this,
                options = this.options;
            gsb.log('gsb.shariff.init()');
            base.wrapper = $('<' + options.wrapperTag + ' />').attr('id', options.wrapperId).addClass(options.wrapperClass);
            base.wrapperInner = $('<div/>').addClass(options.wrapperInnerClass);
            base.wrapper.append(base.wrapperInner);

            if (options.insert === 'prepend') {
                base.$el.prepend(base.wrapper);
            } else if (options.insert === 'append') {
                base.$el.append(base.wrapper);
            } else if (options.insert === 'before') {
                base.$el.before(base.wrapper);
            } else if (options.insert === 'after') {
                base.$el.after(base.wrapper);
            }

            base.shariffInstance = new Shariff(base.wrapperInner, $.extend({}, options.shariffOptions, base.$el.data()));
            base.shariffInstance.getLocalized = base.getLocalized;
            base.wrapperInner.data('shariff', base.shariffInstance);

            base.wrapperInner.prepend('<h3>' + options.labelHeader + '</h3>').find('.switch, .settings').attr('tabindex', 0).keydown(function (ev) {
                if (ev.which === 13) {
                    $(this).trigger('click');
                }
            });
            if (options.toggleElement) {
                base.toggleElement = $(options.toggleElement, base.$el);
                if (options.showMailFormLink) {
                    base.wrapper.find('li:first').before($('<li class="email"><a>' + options.labelFormLink + '</a></li>').find('a').attr('href', base.toggleElement.attr('href')).end());
                }
                base.toggleElement.attr('href', '#');
                base.wrapper.data(base.moduleName, { oldHeight: base.wrapper.height() }).css({ top: 0, display: 'none' }).attr('aria-hidden', 'true');
                base.toggleElement.attr('aria-haspopup', true).attr('aria-owns', options.wrapperId).attr('title', options.toggleTitleClosed).click(function (ev) {
                    var oldHeight = base.wrapper.data(base.moduleName).oldHeight;
                    ev.preventDefault();
                    ev.stopPropagation();
                    if (base.wrapper.is('[aria-hidden=true]')) {
                        if (!base.options.useOpacityAnimation) {
                            base.wrapper.attr('aria-hidden', 'false').css({ height: 0, display: 'block' }).css({ top: -oldHeight - 2, height: oldHeight }).promise().done(function () {
                                $(this).css('height', '').css({ top: -$(this).height() - 2 });
                            });
                        } else {
                            base.wrapper.attr('aria-hidden', 'false').css({ opacity: 0, display: 'block' }).animate({ opacity: 1 }, 'slow').promise().done(function () {});
                        }
                        base.wrapper.find('.close').focus();
                        // base.toggleElementContents = base.toggleElement.contents().remove();
                        // base.toggleElement.text(options.toggleTitleOpened);
                        base.toggleElement.addClass('opened');
                        base.toggleElement.attr("title", options.toggleTitleOpened);
                    } else {
                        if (!base.options.useOpacityAnimation) {
                            base.wrapper.attr('aria-hidden', 'true').data(base.moduleName, { oldHeight: base.wrapper.height() }).css({ top: 0, height: 0 }).promise().done(function () {
                                $(this).css({ display: 'none' });
                            });
                        } else {
                            base.wrapper.attr('aria-hidden', 'true').animate({ opacity: 0 }, 'slow').promise().done(function () {
                                $(this).css({ display: 'none' });
                            });
                        }
                        // base.toggleElement.empty().append(base.toggleElementContents);
                        base.toggleElement.removeClass('opened');
                        base.toggleElement.attr("title", options.toggleTitleClosed);
                    }
                });
            }
            if (options.closeButton) {
                base.closeButton = $('<button class="close" title="' + options.labelCloseButton + '" tabindex="0">' + options.labelCloseButton + '</button>').click(function () {
                    base.toggleElement.trigger('click');
                    base.toggleElement.focus();
                });
                base.wrapperInner.prepend(base.closeButton);
            }
        }
    };

    $.gsb.shariff.defaultOptions = {
        //responsiveListener options
        respondToEvents: true,
        onRefresh: function onRefresh() {},
        responsive: [{
            breakpoint: 480,
            onRefresh: function onRefresh() {
                //do nothing
            }
        }],
        //module options
        useOpacityAnimation: false, //whether to use an opacity animation instead of a slide-down
        insert: 'after', //where the wrapper is inserted, in relation to el,
        wrapperId: 'share', //ID of the wrapper element,
        wrapperClass: '',
        wrapperTag: 'div', //HTML tag of the wrapper element
        toggleElement: '',
        toggleTitleClosed: typeof SHOW_MORE !== "undefined" ? SHOW_MORE : 'Mehr anzeigen',
        toggleTitleOpened: typeof SHOW_LESS !== "undefined" ? SHOW_LESS : 'Schließen',
        wrapperInnerClass: 'wrapper-share shariff',
        labelHeader: typeof SHARIFF_TITLE !== "undefined" ? SHARIFF_TITLE : 'In sozialen Medien teilen',
        labelFormLink: typeof SHARIFF_FORMLINKTEXT !== "undefined" ? SHARIFF_FORMLINKTEXT : 'E-Mail',
        closeButton: false,
        labelCloseButton: typeof CLOSE !== "undefined" ? CLOSE : 'Schließen',
        labelMailBodytext: "<{url}>",
        showMailFormLink: false,
        shariffOptions: null
    };

    $.fn.gsb_shariff = function (options) {
        return this.each(function () {
            $.gsb.shariff(this, options);
        });
    };
})(jQuery);
   /* Ende gsb_shariff */
   /* Start gsb_shrinkheader */
   /**
 * @module gsb_shrinkheader
 * @author boelenbe / pespeloe
 * @desc Setzt Klassen nach dem Scrollen an das base-Element. Mit weiteren CSS Anweisungen kann dann z.B.
 * der Header verkleinert werden o.ä.
 *
 * @example
 * $('#header').gsb_shrinkheader({options})
 *
 * @requires  jQuery >= 1.11.1
 * @requires  gsb_responsiveListener
 *
 * */
;(function ($) {
  if (!$.gsb) {
    $.gsb = {};
  };

  $.gsb.shrinkheader = function (el, options) {
    // To avoid scope issues, use 'base' instead of 'this'
    // to reference this class from internal events and functions.
    var base = this;
    base.$el = $(el);
    base.el = el;

    // Add a reverse reference to the DOM object
    base.$el.data("gsb.shrinkheader", base);

    base.init = function () {
      //base.myFunctionParam = myFunctionParam;
      base.options = $.extend({}, $.gsb.shrinkheader.defaultOptions, options);
      base.$el.gsb_responsiveListener(base);
    };

    /**
     * @method initScrollEvent
     * @desc Initialisierung des Scripts bzw. des Scroll-Events
     */
    $.gsb.shrinkheader.prototype.initScrollEvent = function () {

      if (!$.isEmptyObject(base.options.changeImage)) {
        base.imageArray = [];
        base.setImageArray();
      }

      base.checkPosition();

      $(window).on('scroll.shrinkheader', function () {
        base.checkPosition();
      });
    };

    /**
     * @method checkPosition
     * @desc Prüft ob die Klasse small gesetzt werden muss oder nicht
     */
    $.gsb.shrinkheader.prototype.checkPosition = function () {
      var distanceY = window.pageYOffset;

      if (distanceY > base.options.shrinkOn) {
        if (!base.$el.hasClass(base.options.shrinkCssClass)) {
          // Header verkleinern
          if (base.options.changeImage && base.imageArray) {
            base.changeImage(base.options.changeImage.from, base.options.changeImage.to);
          }
          base.$el.addClass(base.options.shrinkCssClass);
        }
      } else {
        // Header Ausgangszustand
        if (base.$el.hasClass(base.options.shrinkCssClass)) {
          if (base.options.changeImage && base.imageArray) {
            base.changeImage(base.options.changeImage.to, base.options.changeImage.from);
          }
          base.$el.removeClass(base.options.shrinkCssClass);
        }
      }
    };

    /**
     * @method removeScrollEvent
     * @desc Entfernt das Scroll-Event scroll.shrinkheader
     */
    $.gsb.shrinkheader.prototype.removeScrollEvent = function () {
      if (base.$el.hasClass(base.options.shrinkCssClass)) {
        base.$el.removeClass(base.options.shrinkCssClass);
      }
      $(window).off('scroll.shrinkheader');
    };

    /**
     * @method changeImage
     * @param from {string} was gesucht werden soll
     * @param to {string} wodurch es ersetzt werden soll
     * @desc tauscht blob=x durch blob=y
     */
    $.gsb.shrinkheader.prototype.changeImage = function (from, to) {
      $.each(base.imageArray, function () {
        var image = base.$el.find(this);
        $.each(image, function () {
          $(this).prop("src", $(this).prop("src").replace(from, to));
        });
      });
    };

    /**
     * @method setImageArray
     * @desc erstellt einen Array aus Bildern, die getauscht werden sollen
     */
    $.gsb.shrinkheader.prototype.setImageArray = function () {
      // Wurden mehrere Bilder selektiert? - Array von Selektoren
      if ($.isArray(base.options.changeImage.img)) {
        $.each(base.options.changeImage.img, function () {
          base.imageArray.push(base.$el.find(this.toString()));
        });
      } else {
        base.imageArray.push(base.$el.find(base.options.changeImage.img));
      }
    };

    // Run initializer
    base.init();
  };

  /**
   * @typedef defaultOptions
   * @type {object}
   * @property {object}   options                                       - Default Options des Scripts
   * @property {int} [options.shrinkOn = 300]                           - Wert in Pixel, wann der Header verkleinert werden soll.
   * @property {string} [options.shrinkCssClass = smaller]              - Name der CSS-Klasse, die gesetzt werden soll.
   * @property {Object} [options.changeImage = {}]                      - Properties fuer changeImage
   * @property {string | Object[]} [options.changeImage.img = no value] - ein Selektor > string, mehrere Selektoren > Object[string,string]
   * @property {string} [options.changeImage.from = no value]           - was soll gesucht werden
   * @property {string} [options.changeImage.to = no value]             - durch was soll ersetzt werden
   */
  $.gsb.shrinkheader.defaultOptions = {
    shrinkOn: 300,
    shrinkCssClass: 'smaller',
    respondToEvents: true,
    changeImage: {},
    onRefresh: function onRefresh() {
      this.initScrollEvent();
    },
    responsive: [{
      breakpoint: 1024,
      onRefresh: function onRefresh() {
        this.removeScrollEvent();
      }
    }]
  };

  $.fn.gsb_shrinkheader = function (options) {
    return this.each(function () {
      new $.gsb.shrinkheader(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_shrinkheader */
   /* Start gsb_toc */
   /**
 * @name gsb_toc
 * @version 0.0.1
 * @see {@link http://semver.org|Semantic Versioning}
 * @author cmadmin
 *
 * @desc Modulbeschreibung (TODO)
 *
 * @requires  {@link external:jQuery}
 *
 * @example
 * Beispielaufruf (TODO)
 */
(function ($) {
  "use strict";

  if (!$.gsb) {
    $.gsb = {};
  }

  $.gsb.toc = function (el, options) {
    // To avoid scope issues, use 'base' instead of 'this'
    // to reference this class from internal events and functions.
    var base = this;

    // Access to jQuery and DOM versions of element
    base.$el = $(el);
    base.el = el;
    base.anchor = "";

    // Add a reverse reference to the DOM object
    base.$el.data("gsb.toc", base);

    base.init = function () {
      base.options = $.extend({}, $.gsb.toc.defaultOptions, options);
      base.$el.gsb_responsiveListener(base);
      if (base.$el.find(base.options.wrapper).length > 0) {
        base.checkScrollPosition();
        base.initClick();
        // base.resize();
      }
    };

    $.gsb.toc.prototype.initClick = function () {
      base.$el.find('a[href*=doc]').each(function () {
        $(this).on("click", function () {
          base.removeActiveNode();
          $(this).attr({ 'aria-current': true }).addClass(base.options.cssClass);
        });
      });
    };

    $.gsb.toc.prototype.checkScrollPosition = function () {
      base.anchor = base.$el.find('a[id*=doc]');
      base.currentAnchor = "";
      base.tmpAnchor = 0;

      var initialPositionTop = base.$el.find(base.options.wrapper).offset().top;

      /* inital */
      base.setActiveNode(base.anchor.get(0), "add");
      $(window).scroll(function () {
        if ($(window).scrollTop() >= initialPositionTop) {
          // base.$el.find('.c-toc__wrapper').css({'top': $(window).scrollTop()+20});
          base.$el.find(base.options.wrapper).addClass("fixed");
          // $('body').find('#wrapperDivisions').addClass('fixed');
        } else {
          base.$el.find(base.options.wrapper).removeClass("fixed");
          // $('body').find('#wrapperDivisions').removeClass('fixed');
        }

        base.anchor.each(function (i) {

          /* mark first headline */
          if (i === 0 && $(window).scrollTop() < this.offsetTop) {
            base.setActiveNode(base.anchor.get(0), "add");
          }
          if (i === 0 && this.getBoundingClientRect().top > 0 + base.options.offset) {
            base.currentAnchor = -1;
          } else if (this.getBoundingClientRect().top <= 0 + base.options.offset) {
            base.currentAnchor = i;
          }
        });

        if (base.tmpAnchor !== base.currentAnchor) {
          if (base.currentAnchor >= 0) {
            base.setActiveNode(base.anchor.get(base.currentAnchor), "add");
          }
          base.setActiveNode(base.anchor.get(base.currentAnchor - 1), "remove");
          base.setActiveNode(base.anchor.get(base.currentAnchor + 1), "remove");
          base.tmpAnchor = base.currentAnchor;
        }

        //Calculating height and top-pos if TOC is colliding with another element.
        if (topCollidingElement !== undefined) {
          var _ = base.$el.find(base.options.wrapper);
          var collider = new ElementWithBounds(topCollidingElement.elem);

          //The integer may be replaced by any prefered padding between TOC and the colliding element.
          var colliderYPos = collider.yPos - 25;
          var windowHeight = $(window).height();

          //If diff <= 0, then the colliding element is visible on the screen.
          //Otherwise it is below the lower browser-window bound.
          var diff = colliderYPos - windowHeight;

          //If the colliding element is visible, TOC should end directly before the coliding element.
          if (diff <= 0) {
            // _.css({height: colliderYPos});
          } else {}
            // _.css({height: "100vh"});


            //If both breakpoints are reached, move TOC out of the window.
          if (diff <= 0 && _.height() <= parseInt(_.css("min-height"))) {
            // _.css({top: colliderYPos-_.outerHeight()});
          } else {
              // _.css({top: 0});
            }
        }
      });
    };

    $.gsb.toc.prototype.removeActiveNode = function () {
      base.$el.find('a[href*=doc]').each(function () {
        $(this).attr({ 'aria-current': null }).removeClass(base.options.cssClass);
      });
    };

    $.gsb.toc.prototype.setActiveNode = function (elem, type) {
      if (elem !== undefined) {
        var activeToc = $("a[href$=" + "#" + elem.id + "]");
        if (type === "add") {
          activeToc.attr({ 'aria-current': true }).addClass(base.options.cssClass);
        } else {
          activeToc.attr({ 'aria-current': null }).removeClass(base.options.cssClass);
        }
      }
    };

    var topCollidingElement;
    var ElementWithBounds = function ElementWithBounds(elem) {
      this.elem;
      this.lowerBound;
      this.upperBound;
      this.yPos;
      if (elem !== undefined && elem.getBoundingClientRect !== undefined) {
        this.elem = elem;
        var rect = elem.getBoundingClientRect();
        this.lowerBound = rect.left;
        this.upperBound = this.lowerBound + rect.width;
        this.yPos = rect.top;
      }
    };

    $.gsb.toc.prototype.resize = function () {
      var _ = base.$el.find(base.options.wrapper);
      _.css({ 'height': $(window).height() });

      //Needed when TOC is colliding (calculatedHeight < minHeight serves as a breakpoint)
      var padding = _.innerHeight() - _.height();
      var minHeight = _.find(".c-toc__wrapper").outerHeight() + padding;
      _.css({ 'min-height': minHeight });

      //Finding the highest element that can collide with TOC.
      var __ = _.get(0);
      var tocBounds = new ElementWithBounds(__);
      var candidates = $(".c-toc").siblings().add("#footer");
      topCollidingElement = null;
      $.each(candidates, function (key, value) {
        var tmp = new ElementWithBounds(value);
        if (tmp.upperBound > tocBounds.lowerBound && tmp.lowerBound < tocBounds.upperBound) {
          if (topCollidingElement === null) {
            topCollidingElement = tmp;
          } else if (topCollidingElement.yPos > tmp.yPos) {
            topCollidingElement = tmp;
          }
        }
      });
    };

    // Run initializer
    base.init();
  };

  $.gsb.toc.defaultOptions = {
    cssClass: 'active-control',
    offset: 100,
    respondToEvents: true,
    onRefresh: function onRefresh() {
      // this.resize();
    },
    responsive: [{
      breakpoint: 1261,
      onRefresh: function onRefresh() {
        //nothing to do for medium/small
      }
    }]
  };

  $.fn.gsb_toc = function (options) {
    return this.each(function () {
      new $.gsb.toc(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_toc */
   /* Start gsb_toggleList */
   /**
 * @name gsb_toggleList
 * @version 0.0.1
 * @see {@link http://semver.org|Semantic Versioning}
 * @author tlietz
 *
 * @desc Javascript für das Modul "Linkliste Breit", hier wird der Container
 * falls zu groß ausgefadet und kann mittels Button auf und zu geklappt werden.
 *
 * @requires  {@link external:jQuery}
 *
 * @example
 * $('.js-content-linklist').gsb_toggleList();
 */

(function ($) {
  'use strict';

  if (!$.gsb) {
    $.gsb = {};
  }

  $.gsb.toggleList = function (el, options) {

    // To avoid scope issues, use 'base' instead of 'this'
    // to reference this class from internal events and functions.
    var base = this;

    // Access to jQuery and DOM versions of element
    base.$el = $(el);
    base.el = el;

    // Add a reverse reference to the DOM object
    base.$el.data("gsb.toggleList", base);

    base.init = function () {
      base.options = $.extend({}, $.gsb.toggleList.defaultOptions, options);
    };

    /**
     * @method prepare
     * @desc Prüft ob der Container die minimale Höhe besitzt und blendet diesen zum Teil aus,
     * und fügt einen Button für das toggeln ein.
     */
    $.gsb.toggleList.prototype.prepare = function () {
      var contentHeight = base.$el.height();
      if (contentHeight > base.options.minHeight + base.options.offset) {
        base.$el.addClass('closed');
        base.$el.find(base.options.wrapper).addClass('js-active-control').css({ "height": base.options.minHeight + "px" });
        var elem = $("<div>" + base.options.buttonMarkup + "</div>").addClass('c-seo-teaser__wrapper');
        base.$el.append(elem);
        base.$el.find(base.options.button).text(base.options.buttonTextClosed);
        base.addClick();
      }
    };

    /**
     * @method addClick
     * @desc fügt die Click-Funktion hinzu und blendet Container ein oder aus
     */
    $.gsb.toggleList.prototype.addClick = function () {
      base.$el.on("click", base.options.button, function (e) {
        e.preventDefault();
        e.stopPropagation();

        var btn = $(this);
        if (base.$el.find(base.options.wrapper).hasClass('js-active-control')) {
          btn.text(base.options.buttonTextOpened);
          base.$el.removeClass('closed').addClass('opened');
          base.$el.find(base.options.wrapper).toggleClass('js-active-control').css({ "height": "auto" });
        } else {
          btn.text(base.options.buttonTextClosed);
          base.$el.removeClass('opened').addClass('closed');
          base.$el.find(base.options.wrapper).toggleClass('js-active-control').css({ "height": base.options.minHeight + "px" });
        }
      });
    };

    // Run initializer
    base.init();
    base.prepare();
  };

  $.gsb.toggleList.defaultOptions = {
    minHeight: 330,
    offset: 105,
    wrapper: '.c-seo-teaser__wrapper--first',
    button: '.c-seo-teaser__l',
    buttonTextOpened: typeof SHOW_LESS == 'undefined' ? 'Ausblenden' : SHOW_LESS,
    buttonTextClosed: typeof SHOW_MORE == 'undefined' ? 'Einblenden' : SHOW_MORE,
    buttonMarkup: '<p class="c-seo-teaser__p">' + '<a href="#" class="c-seo-teaser__l"></a>' + '</p>'

  };

  $.fn.gsb_toggleList = function (options) {
    return this.each(function () {
      new $.gsb.toggleList(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_toggleList */
   /* Start gsb_toggleTab */
   /**
 * @name gsb_toggleTab
 * @version 0.0.2
 * @see {@link http://semver.org|Semantic Versioning}
 * @author jtran
 *
 * @desc Dropdown-Liste steuert Tabs
 *
 * @requires  {@link external:jQuery}
 *
 * @example
 * $.gsb_toggleTab({options})
 */
(function ($) {
    "use strict";

    if (!$.gsb) {
        $.gsb = {};
    }

    $.gsb.toggleTab = function (el, options) {
        var toggleTabOptions = $.extend(true, {}, $.gsb.toggleTab.defaultOptions, options);

        var init = function init() {
            if (!$(el).hasClass('gsb-toggle')) {
                $(el).addClass('gsb-toggle');
            }
            prepareContent();
            addClickHandler();
        };

        var prepareContent = function prepareContent() {
            $(el).find(toggleTabOptions.contentContainer).each(function () {
                $(this).attr('aria-hidden', 'true');
            });

            el.buttonIcon = $(el).find(toggleTabOptions.button).find('span').clone();
            $(el).attr('aria-hidden', 'false');
        };

        var addClickHandler = function addClickHandler() {
            $(el).find(toggleTabOptions.button).on('click', function (e) {
                if (e.type === 'click') {
                    e.preventDefault();
                    e.stopPropagation();
                    toggleDropdown();
                }
            });

            $(el).find(toggleTabOptions.dropdownItems).on('click', function (e) {
                if (e.type === 'click') {
                    e.preventDefault();
                    e.stopPropagation();
                    toggleContent(e.target);
                }
            });
        };

        var processDropdownFocusListener = function processDropdownFocusListener(e) {
            var buttonElement = $(el).find(toggleTabOptions.button);
            var dropdownContainer = $(el).find(toggleTabOptions.dropdownContainer);
            processKeyEvent(buttonElement, e.target, dropdownContainer);
        };

        var processDropdownNavigation = function processDropdownNavigation(e) {
            switch (e.which) {
                case 38:
                case 40:
                case 13:
                case 32:
                case 35:
                case 36:
                case 27:
                    e.preventDefault();
                    e.stopPropagation();
                    break;
                default:
                    return;
            }
            var buttonElement = $(el).find(toggleTabOptions.button);
            var dropdownItems = $(el).find(toggleTabOptions.dropdownItems);
            var dropdownContainer = $(el).find(toggleTabOptions.dropdownContainer);
            var currentItem = $(el).find(toggleTabOptions.dropdownItems + ":focus");
            if (currentItem.length === 0) {
                $(dropdownItems).first().focus();
            }

            switch (e.which) {
                case 35:
                    // end
                    $(dropdownItems).last().focus();
                    currentItem = $(el).find(toggleTabOptions.dropdownItems + ":focus");
                    break;
                case 36:
                    // home
                    $(dropdownItems).first().focus();
                    currentItem = $(el).find(toggleTabOptions.dropdownItems + ":focus");
                    break;
                case 38:
                    // up
                    $(currentItem).prev().focus();
                    currentItem = $(el).find(toggleTabOptions.dropdownItems + ":focus");
                    break;
                case 40:
                    // down
                    $(currentItem).next().focus();
                    currentItem = $(el).find(toggleTabOptions.dropdownItems + ":focus");
                    break;
                case 13: // enter
                case 32:
                    // space
                    toggleContent(currentItem);
                    break;
                case 27:
                    // ESC
                    processRollback(buttonElement, dropdownContainer);
                    break;
            }
        };

        var processKeyEvent = function processKeyEvent(_buttonElement, _currItem, _dropdownContainer) {
            $(_dropdownContainer).attr('aria-activedescendant', $(_currItem).attr('id'));
            $(_buttonElement).text($(_currItem).text()).append(el.buttonIcon);
        };

        var processRollback = function processRollback(_buttonElement, _dropdownContainer) {
            var lastRealSelected = $(_buttonElement).data(toggleTabOptions.constants.dataKeyTempSelected);
            toggleContent(lastRealSelected);
            var ariaDescendant = $(lastRealSelected).attr('id') || '';
            $(_dropdownContainer).attr('aria-activedescendant', ariaDescendant);
        };

        var openDropdown = function openDropdown() {
            var buttonElement = $(el).find(toggleTabOptions.button);
            var dropdownItems = $(el).find(toggleTabOptions.dropdownItems);

            buttonElement.attr('aria-expanded', 'true');
            dropdownItems.attr('aria-hidden', 'false');

            $('body *').not($(el)).on('click', closeDropdown);
            $(document).on('keydown', processDropdownNavigation);
            $(dropdownItems).on('focus', processDropdownFocusListener);
        };

        var closeDropdown = function closeDropdown() {
            var buttonElement = $(el).find(toggleTabOptions.button);
            var dropdownItems = $(el).find(toggleTabOptions.dropdownItems);
            buttonElement.attr('aria-expanded', 'false');
            dropdownItems.attr('aria-hidden', 'true');

            $('body *').not($(el)).off('click', closeDropdown);
            $(document).off('keydown', processDropdownNavigation);
            $(dropdownItems).off('focus', processDropdownFocusListener);
        };

        var toggleDropdown = function toggleDropdown() {
            var dropdownItems = $(el).find(toggleTabOptions.dropdownItems);
            var buttonElement = $(el).find(toggleTabOptions.button);
            if ($(buttonElement).attr('aria-expanded') === 'false') {
                openDropdown();
            } else {
                closeDropdown();
            }
        };

        var toggleContent = function toggleContent(clickedElement) {
            closeDropdown();
            var toggleId = $(clickedElement).data('toggle');
            var contentItem = $(el).next(toggleTabOptions.contentContainer + '[data-toggle="' + toggleId + '"]');

            $(el).find(toggleTabOptions.contentContainer).each(function (element) {
                $(this).attr('aria-hidden', toggleId !== $(this).attr('data-toggle'));
            });

            $(el).find(toggleTabOptions.button).data(toggleTabOptions.constants.dataKeyTempSelected, clickedElement);
            var t = $(clickedElement).text() || toggleTabOptions.default;
            $(el).find(toggleTabOptions.button).text(t).append(el.buttonIcon);

            $(el).find(toggleTabOptions.button).focus();
        };

        init();
    };

    $.gsb.toggleTab.defaultOptions = {
        controlAnchor: '.c-site-overview__tabs',
        button: 'button.heading',
        dropdownContainer: '.tabs-list',
        dropdownItems: '.tabs-list li',
        contentContainer: '.c-site-overview__tabsContent',
        default: BITTE_AUSWAHL,
        constants: {
            dataKeyTempSelected: 'toggle-temp-selected'
        }
    };

    $.fn.gsb_toggleTab = function (options) {
        return this.each(function () {
            new $.gsb.toggleTab(this, options);
        });
    };
})(jQuery);
   /* Ende gsb_toggleTab */
   /* Start gsb_textlength */
   "use strict";

gsb.makeGSBModule("gsb.textlength", {
  init: function init() {
    var base = this;

    base.inputs = base.$el.find(base.options.inputs);

    if (base.options.textareaHasMaxSize === true && base.options.countCharacter === true) {
      base.inputs.filter('textarea').each(function () {
        var input = $(this),
            maxTextareaChars = input.data('max-textarea-chars') || base.options.maxTextareaChars,
            maxTextareaCharsAdviceElem = base.initMaxTextareaCharsAdvice(input, maxTextareaChars);

        if (base.options.countExistingChars) {
          base.updateCharacters(input, maxTextareaChars, maxTextareaCharsAdviceElem);
        }
        input.keydown(function () {
          base.updateCharacters(input, maxTextareaChars, maxTextareaCharsAdviceElem);
        });
      });
    }
  },
  initMaxTextareaCharsAdvice: function initMaxTextareaCharsAdvice(input, maxTextareaChars) {
    var base = this,
        countElem = $('<strong></strong>').text(maxTextareaChars),
        elemAdvice = $('<span></span>');

    elemAdvice.addClass('formLabel counter').attr({
      'aria-live': 'polite',
      role: 'status'
    }).append(TEXTAREA_COUNT_PREFIX).append(countElem).append(' ' + TEXTAREA_COUNT_POSTFIX);

    input.closest('span').after(elemAdvice);

    return elemAdvice;
  },
  updateCharacters: function updateCharacters(input, maxTextareaChars, maxTextareaCharsAdviceElem) {
    var base = this,
        currentChars = base._countCharacters(input),
        remainingChars = maxTextareaChars - currentChars;

    base.updateMaxTextareaCharsAdvice(maxTextareaCharsAdviceElem, remainingChars);

    if (currentChars > maxTextareaChars) {
      input.addClass('error');
    } else if (currentChars < maxTextareaChars && base.$el.hasClass('error')) {
      input.removeClass('error');
    }
  },
  _countCharacters: function _countCharacters(input) {
    var base = this;

    return input.val().length;
  },
  updateMaxTextareaCharsAdvice: function updateMaxTextareaCharsAdvice(maxTextareaCharsAdviceElem, remainingChars) {
    var base = this;

    if (remainingChars < 1) {
      maxTextareaCharsAdviceElem.hide();
    } else {
      if (maxTextareaCharsAdviceElem.is(':hidden')) {
        maxTextareaCharsAdviceElem.show();
      }
      maxTextareaCharsAdviceElem.find('strong').text(remainingChars);
    }
  },
  defaultOptions: {
    textareaHasMaxSize: true,
    maxTextareaChars: 30,
    inputs: 'input[type="text"], input[type="password"], textarea',
    countCharacter: false,
    countExistingChars: false
  }
});
   /* Ende gsb_textlength */
   /* Start gsb_infinitescrolling */
   /**
 * GSB-Plugin infinitescrolling
 *
 * Author: pespeloe
 */
;(function ($) {
  if (!$.gsb) {
    $.gsb = {};
  }
  $.gsb.infinitescrolling = function (el, instanceId, options) {
    // To avoid scope issues, use 'base' instead of 'this'
    // to reference this class from internal events and functions.
    var base = this;
    // Access to $ and DOM versions of element
    base.$el = $(el);
    base.el = el;
    // Add a reverse reference to the DOM object
    base.$el.data("gsb.infinitescrolling", base);
    base.options = $.extend(true, {}, $.gsb.infinitescrolling.defaultOptions, options);
    base.init = function () {

      if (typeof base.options.paginationElements == 'function') {
        base.pagination = base.options.paginationElements.call(this, base);
      } else {
        base.pagination = base.$el.find(base.options.paginationElements);
      }

      $.get(base.$el.data('href'), function (data) {
        base.nextLink = base.getLink(data);
      });

      if (base.pagination.length != 0) {
        base.addMoreFromRequestButton();
        base.pagination.closest(base.options.paginationBoxClass).hide();
      }
    };

    $.gsb.infinitescrolling.prototype.addMoreFromRequestButton = function () {

      $.get(json_url_moreButtonURL).done(function (data) {
        base.moreButton = $(data);
        base.addMoreButton();
      }).fail(function (data) {
        base.moreButton = $(base.options.moreButton);
        base.addMoreButton();
      });
    };

    $.gsb.infinitescrolling.prototype.addMoreButton = function () {
      base.moreButton.insertAfter($(base.options.elementToAppendButtonTo)).on('click', function (e) {
        e.preventDefault();
        e.stopPropagation();

        $.get(base.nextLink, function (data) {
          var elementToAppendTo = base.options.elementToAppendTo;
          var elementToAppend = $(data).find(base.options.resultClass);
          var elementToFocus = base.options.elementToFocus;
          if (elementToAppendTo === '') {
            base.$el.append(elementToAppend);
            base.$el.find(elementToAppend.first().find(elementToFocus)).focus();
          } else {
            base.$el.find(elementToAppendTo).append(elementToAppend);
            base.$el.find(elementToAppend.first().find(elementToFocus)).focus();
          }
          base.nextLink = base.getLink(data);
          if ($(data).find(base.options.forwardButton).length == 0) {
            base.moreButton.remove();
          }
        });
      });
    };

    $.gsb.infinitescrolling.prototype.getLink = function (data) {
      return $(data).find(base.options.forwardButton).attr('href');
    };

    // Run initializer
    base.init();
  };

  $.gsb.infinitescrolling.defaultOptions = {
    paginationElements: 'li.forward a',
    forwardButton: 'li.forward a',
    paginationBoxClass: '.navIndex',
    elementToAppendTo: '',
    elementToFocus: '',
    elementToAppendButtonTo: '.l-content-article',
    resultClass: '.section-results .row',
    moreButton: '<button class="loadmore">mehr anzeigen</button>',
    moreButtonSelector: '.l-content-wrapper .l-content-wrapper--no-space-before'
  };

  $.fn.gsb_infinitescrolling = function (options) {
    return this.each(function (index, value) {
      new $.gsb.infinitescrolling($(value), index, options);
    });
  };
})(jQuery);
   /* Ende gsb_infinitescrolling */
   /* Start gsb_numberFromJson */
   /**
 * @name gsb_number_from_json
 * @version 0.0.1
 * @see {@link http://semver.org|Semantic Versioning}
 * @author sthiel
 *
 * @desc Modulbeschreibung (TODO)
 *
 * @requires  {@link external:jQuery}
 *
 * @example
 * Beispielaufruf (TODO)
 */
;(function ($) {
  "use strict";

  if (!$.gsb) {
    $.gsb = {};
  }

  $.gsb.numberFromJson = function numberFromJson(el, options) {
    var base = Object.create(numberFromJson.prototype);
    base.$el = $(el);
    base.el = el;
    base.moduleName = "gsb.numberFromJson";
    base.$el.data(base.moduleName, base);
    base.options = $.extend(true, {}, $.gsb.numberFromJson.defaultOptions, options);

    base.updateNumber = function updateNumber(response) {
      var numEntries = response.numEntries;
      base.$el.find(base.options.selectors.numberValue).text(numEntries);
    };

    base.getJSONNumer = function getJSONNumer() {
      if (base.options.jsonUrl) {
        $.ajax({
          type: 'GET',
          url: base.options.jsonUrl,
          dataType: 'json',
          success: base.updateNumber,
          error: base.ajaxError
        });
      } else {
        console.debug('gsb_numberFromJson: jsonUrl wird benötigt, ist aber nicht definiert.');
      }
    };

    base.ajaxError = function ajaxError(e) {
      console.debug(e);
    };

    base.init();
  };

  $.gsb.numberFromJson.prototype = {
    init: function init() {
      var base = this;

      base.getJSONNumer();
    }
  };

  $.gsb.numberFromJson.defaultOptions = {
    jsonUrl: null, // Muss zwingend in der init definiert werden, es gibt keinen sinnvollen default
    selectors: {
      numberWrapper: '.js-number-wrapper',
      numberValue: '.js-number-value'
    }
  };

  $.fn.gsb_numberFromJson = function (options) {
    return this.each(function () {
      $.gsb.numberFromJson(this, options);
    });
  };
})(jQuery);
   /* Ende gsb_numberFromJson */
   /* Start gsb_bva_servicecontact */
   gsb.makeGSBModule("gsb.bva_servicecontact", {
  init: function init() {
    var base = this;

    base.topicSelect = base.$el.find('select[name="topic"]');
    base.agencySelect = base.$el.find('select[name="agency"]');
    base.loadingElem = base.agencySelect.parents('.row').first();

    base.statusMsg = $("<div></div>").addClass('c-servicecontact-status-msg');
    base.statusMsg.addClass('aural').attr({
      id: base.generateID(),
      'aria-live': 'polite'
    });

    base.$el.find('input[name="select"]').hide();

    base.topicSelect.on("change", base, base.onChangeFirstSelect).after(base.statusMsg).attr('aria-describedby', base.statusMsg.attr('id'));

    base.agencySelect.select2();
  },
  onChangeFirstSelect: function onChangeFirstSelect(ev) {
    var base = ev.data;

    base.statusMsg.addClass('aural').text(base.options.msgTextLoading);

    base.agencySelect.attr('disabled', 'disabled');
    base.loadingElem.addClass('loading');

    $.ajax({
      type: "GET",
      cache: true,
      url: base.$el.find('form').attr('action'),
      data: base.$el.find('form').serialize(),
      context: base,
      success: base.onAjaxSuccess,
      error: base.onAjaxError
    });
  },
  onAjaxSuccess: function onAjaxSuccess(response) {
    var base = this;
    var $data = $(response);

    base.loadingElem.removeClass('loading');
    base.statusMsg.removeClass('c-servicecontact-error-msg').addClass('aural').text('');

    base.agencySelect.html($data.find('select[name="agency"]').html()).removeAttr('disabled').val("").trigger("change");
  },
  onAjaxError: function onAjaxError() {
    var base = this;

    base.loadingElem.removeClass('loading');
    base.statusMsg.addClass('c-servicecontact-error-msg').removeClass('aural').text(base.options.msgTextError);
  },
  generateID: function generateID() {
    // Math.random should be unique because of its seeding algorithm.
    // Convert it to base 36 (numbers + letters), and grab the first 9 characters
    // after the decimal.
    return '_' + Math.random().toString(36).substr(2, 9);
  },
  defaultOptions: {
    msgTextError: '',
    msgTextLoading: ''
  }
});
   /* Ende gsb_bva_servicecontact */
   /* Start variables_FIELDS */
   jQuery.gsb_clearfields = function(){
// attach events to search form input
      jQuery('#f568908d569428').attachToField('f568908d569428','');
      jQuery('#f568902d569428').attachToField('f568902d569428','');
      jQuery('#f568854d569496').attachToField('f568854d569496','');
      jQuery('#f568834d569494').attachToField('f568834d569494','');
return;
};
   /* Ende variables_FIELDS */
   /* Start init */
   var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var _paq = _paq || [];

$(document).ready(function () {
  'use strict';

  var content = $('#content');
  var breakpoint_small = 440,
      breakpoint_medium = 610,
      breakpoint_large = 1023,
      breakpoint_xlarge = 1261;

  // set js class
  $('body').addClass('js-on').removeClass('js-off');

  var lang = $('html').attr('lang');
  var langi18n = lang === 'de' ? 'de-DE' : 'en-US';
  if ((typeof mejs === 'undefined' ? 'undefined' : _typeof(mejs)) === "object") {
    $.extend(true, mejs, { i18n: { locale: { language: lang } } });
  }

  // super hacky closing of hover-flyouts via keyboard-events on body
  $('body').on('closeAllFlyouts.gsb', function (ev) {
    // $('.navPrimary').find('> ul > li').filter('.hovered').trigger('mouseout');
    $('.mejs-volume-slider').hide();
    $('.mejs-captions-selector').addClass('mejs-offscreen');
  }).on('keydown', function (ev) {
    var key = ev.key;
    if (key === "Esc" || key === "Escape") {
      $(ev.currentTarget).trigger('closeAllFlyouts.gsb');
    }
  });

  $('body').on('init.Multimedia.gsb', function (ev) {
    var medium = ev.target,
        $container = $(medium && medium.player && medium.player.container);
    if (ev.namespace === "Multimedia.gsb") {
      $container.find('.mejs-captions-button').on('keydown', function (event) {
        var key = event.key;
        if (key === "Esc" || key === "Escape") {
          $(event.currentTarget).trigger('closeAllFlyouts.gsb');
        }
      });
    }
  });

  $(document).on('fullscreenchange webkitfullscreenchange', function (event) {
    var $fullscreenElem = $(document.fullscreenElement);
    gsb.log('fullscreenchange', event);
    if ($fullscreenElem.is('.mejs-container')) {
      $fullscreenElem.parentsUntil('body').siblings().addClass('is-hidden-when-fullscreen');
    } else {
      $('.is-hidden-when-fullscreen').removeClass('is-hidden-when-fullscreen');
    }
  });

  // flyout
  $('#navPrimary').gsb_flyoutNavigation();

  // responsive table wrapper
  content.gsb_responsiveTables();

  // service tabs
  $('.c-serviceborder__tabs').gsb_toggle({
    hashControlled: true
  });

  // phase tabs
  $('.c-phase__tabs').gsb_toggle();

  // siteoverview tabs
  $('.c-site-overview__tabs').gsb_toggleTab();

  // packages tabs
  $('.c-packages__tabs').gsb_toggle({
    onRefresh: function onRefresh() {
      this.uninitAccordion();
    },
    responsive: [{
      breakpoint: 9999,
      onRefresh: function onRefresh() {
        this.uninitAccordion();
        var _ = this;
        if (_.$el.find('.tabs-container-item').length === 0) {

          for (var i = 0; i < 3; i++) {
            _.$el.find('.tabs-container').append($('<div class="tabs-container-item"></div>').append(_.$el.find('.heading').eq(0)).append(_.$el.find('.tabs-container > div:not(.tabs-container-item)').eq(0)));
          }
        }
      },
      tab: false,
      accordion: false
    }, {
      breakpoint: breakpoint_large,
      onRefresh: function onRefresh() {
        this.initialize();
        this.refreshAccordion();
      },
      tab: false,
      accordion: true
    }]
  });

  /* Breadcrumb slider */
  var breadCrumb = $('.c-breadcrumb');
  if (breadCrumb.length) {
    var breadCrumbLength = 0;
    breadCrumb.find('.c-breadcrumb__li').each(function () {
      breadCrumbLength += $(this).outerWidth();
    });
    if (breadCrumbLength >= $(window).width()) {
      breadCrumb.addClass('c-breadcrumb--slider');
      breadCrumb.find('ol').gsb_Slideshow({
        bitvElements: [{
          element: '.c-breadcrumb__li',
          attribute: 'tabindex',
          remove: true
        }, {
          element: '.c-breadcrumb__li > a',
          attribute: 'tabindex',
          remove: true
        }],
        autoplay: false,
        slideshowControls: false,
        slickOptions: {
          dots: false,
          slide: '.c-breadcrumb__li',
          fade: false,
          variableWidth: true,
          infinite: false,
          slidesToShow: 1,
          swipeToSlide: true,
          draggable: true,
          responsive: [{
            breakpoint: 9999,
            settings: "unslick"
          }, {
            breakpoint: breakpoint_large,
            settings: {
              slidesToShow: 1,
              slidesToScroll: 1
            }
          }]
        }
      });
    }
  }

  // facets
  var facets = $('.c-facets');
  if (facets.length > 0) {
    if (!facets.hasClass('c-facets--standalone')) {
      $('body').addClass('search');
    }
    facets.find('.c-facets__btn').each(function () {
      $(this).attr('aria-expanded', $(this).hasClass('c-facets__btn--opened'));
    }).on("click", function (e) {
      e.preventDefault();
      if ($(this).hasClass('c-facets__btn--opened')) {
        facets.find('.c-facets__wrapper').removeClass('c-facets__wrapper--opened').addClass('c-facets__wrapper--closed');
        $(this).attr('aria-expanded', false).removeClass('c-facets__btn--opened').addClass('c-facets__btn--closed');
      } else {
        facets.find('.c-facets__wrapper').removeClass('c-facets__wrapper--closed').addClass('c-facets__wrapper--opened');
        $(this).attr('aria-expanded', true).removeClass('c-facets__btn--closed').addClass('c-facets__btn--opened');
      }
    });
  }

  // serviceContact
  var serviceContact = $('.c-servicecontact').gsb_bva_servicecontact({
    msgTextError: MSG_ANSPRECHPARTNER_AJAX_ERROR,
    msgTextLoading: MSG_ANSPRECHPARTNER_AJAX_LOADING
  });
  if (serviceContact.length > 0) {
    var anchor = $('.js-servicecontact').last();
    if (anchor.length > 0) {
      if (anchor.find('.c-servicecontact-facets__ul').length > 0) {
        anchor = anchor.find('.c-servicecontact-facets__ul').last();
      }
      setTimeout(function () {
        $('html, body').animate({ scrollTop: anchor.offset().top - 100 }, 550);
      }, 250);
    }
  }

  // sortorder
  $('.c-sortorder__wrapper').gsb_toggle({
    tab: false,
    accordionPanelHeight: true,
    onRefresh: function onRefresh() {
      this.initialize();
      this.refreshAccordion();
    }
  });

  // glossary
  $('.c-glossary__wrapper').gsb_toggle({
    tab: false,
    accordion: true,
    accordionCloseOther: true,
    onRefresh: function onRefresh() {
      this.initialize();
      this.refreshAccordion();
    },
    responsive: []
  });

  // accordeon
  $('.c-accordeon__wrapper').gsb_toggle({
    tab: false,
    accordion: true,
    accordionCloseOther: true,
    onRefresh: function onRefresh() {
      this.initialize();
      this.refreshAccordion();
    },
    responsive: []
  });

  // contact tabs
  $('.c-contact__tabs').gsb_Serviceborder({
    navnodes: '.navPhone, .navChat, .navHotline'
  });

  // aktuelles
  content.find('.js-current-topics').gsb_Slideshow({
    containerElement: '.c-current-topics__wrapper--teaser',
    bitvElements: [{
      element: 'div.c-current-topics__wrapper--teaser[tabindex]',
      attribute: 'tabindex',
      remove: true
    }],
    autoplay: false,
    pagination: true,
    slickOptions: {
      dots: true,
      slidesToShow: 3,
      slidesToScroll: 3,
      fade: false,
      responsive: [{
        breakpoint: 9999,
        settings: "unslick"
      }, {
        breakpoint: breakpoint_large,
        settings: {
          slidesToShow: 2,
          slidesToScroll: 2
        }
      }, {
        breakpoint: breakpoint_small,
        settings: {
          slidesToShow: 1,
          slidesToScroll: 1
        }
      }]
    }
  });

  // -----------------------------------------
  // gsb_infinitescrolling
  var sectionresults = $('#content').find('.c-image-wall-js');
  if (sectionresults.length > 0) {
    if (sectionresults.find('ul.advancedSearch li.forward a') !== undefined) {
      sectionresults.gsb_infinitescrolling({
        forwardButton: '.forward a',
        resultClass: '.c-image-wall__li',
        elementToAppendTo: '.c-image-wall__ul',
        elementToFocus: '.c-image-wall__wrapper',
        elementToAppendButtonTo: '.c-image-wall__ul'
      });
    }
  }

  //:focus-within Fix

  $('.c-image-wall__wrapper').each(function () {
    var base = $(this);
    base.on('focusin', function (ev) {
      $(this).find('.c-image-wall__text').addClass('focus-within');
    });
    base.on('focusout', function (ev) {
      $(this).find('.c-image-wall__text').removeClass('focus-within');
    });
  });

  /* Toggle Seo Text Linklist */
  // content.find('.js-seo-teaser').gsb_toggleList();

  /* Inhaltsverzeichnis */
  $('.main').gsb_toc({
    wrapper: '.c-toc'
  });

  // print link
  $('.c-navFunctions__ul').gsb_printlink();

  // feedback
  $('.c-feedback').gsb_feedback();

  $('.c-map__mapContainer').gsb_bkgMap();

  // gallery slider
  $('.galleryBox').gsb_Slideshow({
    slideshowControls: true,
    generateButtonContainer: false,
    autoplay: false,
    pagination: false,
    nextButtonImage: image_url_next,
    prevButtonImage: image_url_back,
    prevButtonInactiveImage: image_url_back_g,
    nextButtonInactiveImage: image_url_next_g,
    slickOptions: {
      adaptiveHeight: false,
      fade: false
    }
  });

  // glossary
  $('.GlossarEntry[data-lightbox-href]').gsb_glossary();

  // lightboxes
  $('.picture .loupe').not('.galleryBox *').gsb_lightbox();
  $('.galleryBox').gsb_lightbox({
    lightboxType: 'multiple',
    element: '.slide',
    imagePrev: image_url_back,
    imageNext: image_url_next,
    imagePrevInactive: image_url_back_g,
    imageNextInactive: image_url_next_g
  });

  // lightbox: Bildnachweis
  $('body').gsb_imageSourceLightbox({
    images: '#content img[data-source], #supplement img[data-source], .c-stage img[data-source]'
  });

  //datepicker
  $('input[type=text][data-datepicker]').datepicker({
    language: langi18n
  });

  // shariff share
  $(".c-navFunctions").gsb_shariff({
    toggleElement: '#navFunctionsRecommend a',
    wrapperClass: 'share',
    closeButton: true,
    insert: 'after',
    showMailFormLink: false,
    mailUrl: 'mailto:',
    shariffOptions: {
      lang: lang,
      services: ["mail", "twitter", "facebook", "info"],
      infoUrl: json_url_shariffInfo,
      mailUrl: "mailto:",
      title: SHARIFF_MAIL_SUBJECT,
      mailBody: SHARIFF_MAIL_BODY
    }
  });

  // clearfields
  $.gsb_clearfields();

  // toggle for footer - small
  $("#siteInfo").find('.smallAccordion').gsb_toggle({
    elements: '> .tabs-container > ul',
    onRefresh: function onRefresh() {
      this.uninitAccordion();
    },
    responsive: [{
      breakpoint: breakpoint_large,
      onRefresh: function onRefresh() {
        this.initialize();
        this.refreshAccordion();
      },
      tab: false,
      accordion: true
    }]
  });

  // toggle for faq and glossary
  $("#content").find(".toggleEntry").gsb_toggle({
    tab: false,
    accordion: true,
    accordionCloseOther: false,
    onRefresh: function onRefresh() {
      this.initialize();
      this.refreshAccordion();
    },
    responsive: []
  });

  // open selected facets
  $('.selected .toggle').click();

  // player for multimedia content
  var screenwidth = screen.width;
  $('video').each(function (i) {
    var $el = $($('video')[i]);
    var vidwidth = $el.attr('width');
    var vidheight = $el.attr('height');
    var vidratio = vidheight / vidwidth;
    if (vidwidth + $el.offset().left * 2 > screenwidth) {
      $el.attr('width', screenwidth - $el.offset().left * 2);
      $el.attr('height', (screenwidth - $el.offset().left * 2) * vidratio);
    }
  });

  $('video.youtube').gsb_Multimedia({
    externalApiRequiresConsent: !$('body').hasClass('js-external-video-api-consent-not-required')
  });
  $('video:not(.youtube)').gsb_Multimedia({});

  // player for multimedia content
  $('audio').each(function (i) {
    var $el = $($('audio')[i]);
    var audiowidth = $el.attr('width');
    if (audiowidth + $el.offset().left * 2 > screenwidth) {
      $el.attr('width', screenwidth - $el.offset().left * 2);
    }
  });

  $('audio').gsb_Multimedia({});

  $('textarea[data-max-textarea-chars]').parent().gsb_textlength({
    textareaHasMaxSize: true,
    maxTextareaChars: $(this).data('max-textarea-char'),
    inputs: 'textarea[data-max-textarea-chars]',
    countCharacter: true,
    countExistingChars: true
  });
  // carousel slider
  var $carousel = content.find(".c-carousel__wrapper");
  if ($carousel.length > 0) {
    $carousel.gsb_Slideshow({
      containerElement: '.teaser',
      bitvElements: [{
        element: 'div.teaser[tabindex]',
        attribute: 'tabindex',
        remove: true
      }, {
        element: 'ul.slick-dots > li > button[tabindex]',
        attribute: 'tabindex',
        remove: true
      }],
      autoplay: false,
      pagination: true,
      nextButtonImage: image_url_next,
      prevButtonImage: image_url_back,
      prevButtonInactiveImage: image_url_back_g,
      nextButtonInactiveImage: image_url_next_g,
      slickOptions: {
        slidesToShow: 5,
        slidesToScroll: 5,
        fade: false,
        nextArrow: $carousel.parent().find('.next'),
        prevArrow: $carousel.parent().find('.prev'),
        responsive: [{
          breakpoint: 1023,
          settings: {
            slidesToShow: 3,
            slidesToScroll: 3
          }
        }, {
          breakpoint: 610,
          settings: {
            slidesToShow: 2,
            slidesToScroll: 2
          }
        }, {
          breakpoint: 440,
          settings: {
            slidesToShow: 1,
            slidesToScroll: 1
          }
        }]
      }
    });
  }

  $('.js-map').gsb_map({
    markerScale: 0.75
  });

  $.each($('.js-banner'), function () {
    var $el = $(this),
        opener = $('.js-banner-opener');
    $el.on("mfpOpen", function () {
      $('.c-accordeon__wrapper').gsb_toggle({
        tab: false,
        accordion: true,
        accordionCloseOther: true,
        onRefresh: function onRefresh() {
          this.initialize();
          this.refreshAccordion();
        },
        responsive: []
      });
      // confirmSelection-Button soll sich wie ein Reject-Button verhalten, damit auf der Datenschutz-Seite ein Opt-Out auch ohne sichtbare Radio-Buttons erfolgen kann
      var baseBanner = $el.data("gsb.banner"),
          confirmSelection = $el.find(baseBanner.options.trackingSelectors.confirmSelection);
      confirmSelection.off('click').on('click', baseBanner, baseBanner.applyChoice).on('click', baseBanner, function (ev) {
        baseBanner.$el.find(baseBanner.options.trackingSelectors.controlElement).attr("checked", false);
        baseBanner.confirmModules(ev, false);
      });
    });
    $el.gsb_banner({
      animation: false,
      lightboxHidden: typeof $el.attr('data-lightbox-hidden') === "string",
      restrictAccess: true,
      trackingConfigUrl: $el.attr('data-banner-extended-config'),
      trackingEnabled: true,
      responsive: []
    });
    opener.on('click', function (ev) {
      $el.magnificPopup('open');
      ev.preventDefault();
    });
  });

  //Anzahl Stellenangebote
  $('.js-joboffer-wrapper').gsb_numberFromJson({
    jsonUrl: json_url_jobofferLink,
    selectors: {
      numberWrapper: '.js-joboffer-wrapper',
      numberValue: '.js-joboffer-number'
    }
  });

  // Foundation initialisieren
  $(document).foundation();
});
   /* Ende init */
jQuery(document).ready(function (jQuery){
  // Autosuggest
  var searchforms = [];
  searchforms[1] = {
    id : 'searchExpert',
    action : 'SiteGlobals/Forms/Suche/Expertensuche/Expertensuche_Autosuggest_Formular.html?nn=517786'
  };
  searchforms[2] = {
    id : 'searchService',
    action : 'SiteGlobals/Forms/Suche/Expertensuche/Servicesuche_Autosuggest_Formular.html?nn=517786'
  };
  searchforms[3] = {
    id : 'searchExpertEN',
    action : 'SiteGlobals/Forms/Suche/Expertensuche/EN/Expertensuche_Autosuggest_Formular.html?nn=517786'
  };
  searchforms[4] = {
    id : 'searchServiceEN',
    action : 'SiteGlobals/Forms/Suche/Expertensuche/EN/Servicesuche_Autosuggest_Formular.html?nn=517786'
  };
  searchforms[5] = {
    id : 'searchProvenience',
    action : 'SiteGlobals/Forms/Suche/Provenienzrecherche/Provenienzrecherche_Autosuggest_Formular.html?nn=517786'
  };
  searchforms[6] = {
    id : 'searchExpertTMS',
    action : 'SiteGlobals/Forms/Webs/TMS/Suche/Expertensuche/Expertensuche_Autosuggest_Formular.html?nn=517786'
  };
  searchforms[7] = {
    id : 'searchCareer',
    action : 'SiteGlobals/Forms/Suche/Karrieresuche/Karrieresuche_Autosuggest_Formular.html?nn=517786'
  };
  searchforms[8] = {
    id : 'searchServiceTMS',
    action : 'SiteGlobals/Forms/Webs/TMS/Suche/Expertensuche/Servicesuche_Autosuggest_Formular.html?nn=517786'
  };
  if(searchforms.length > 0){
    $(searchforms).each(function(index){
      var valueObj = searchforms[index],form;
      if(valueObj !== undefined){
        form = jQuery('form[name="'+ valueObj.id +'"]');
        if(form.length > 0){
          form.gsb_AutoSuggest(valueObj.action);
        }
      }
    });
  }
});